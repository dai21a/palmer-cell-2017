(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1138713,      28024]
NotebookOptionsPosition[   1114624,      27339]
NotebookOutlinePosition[   1115244,      27363]
CellTagsIndexPosition[   1115201,      27360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Figure 4A - Recurrent platinum-sensitive ovarian cancer\n",
 StyleBox["Highly similar code is used to conduct all analyses in Figures \
4A-G, Figure 5D, and Supplementary Figure 5B; excepting that plot ranges and \
labels are adjusted to their data sets.\nFor each of Figures 4A-G, and 5D, \
the same range of response correlation is employed, based on the distribution \
of response correlations in PDX data: \[Rho] = 0.28 +/- 0.2.\nIn order to \
obtain the same level of response correlation for each data set, a parameter \
\[OpenCurlyDoubleQuote]amountofrankrandomization\[CloseCurlyDoubleQuote] has \
been adjusted by trial and error to produce the suitable degree of \
correlation in response; this differs simply because different data sets are \
obtained from published images of different sizes, which therefore contain \
different numbers of pixels per image.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.685714618392047*^9, 3.6857146207140517`*^9}, {
  3.6857147848644753`*^9, 3.685714861870096*^9}, {3.685717960419218*^9, 
  3.6857181750055943`*^9}, {3.685757881696206*^9, 3.685757931960081*^9}, {
  3.691334851309169*^9, 3.6913348536813045`*^9}, {3.691334979586506*^9, 
  3.691334995870437*^9}, {3.6913425631652613`*^9, 3.6913428448793745`*^9}, {
  3.7161411653367987`*^9, 3.716141181912747*^9}, {3.716141252087761*^9, 
  3.716141252376777*^9}}],

Cell[CellGroupData[{

Cell["\<\
Importing survival data as tabulated in 'Table of survival \
distributions.xlsx' :\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857179675202293`*^9, 3.685717973349243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure4ARawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "3", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "the", " ", "third", " ", "tab", " ", "of", " ", "this", " ", 
       "spreadsheet", " ", "contains", " ", "the", " ", "PFS", " ", "data", 
       " ", "for", " ", "platinum"}], "-", 
      RowBox[{
      "sensitive", " ", "recurrent", " ", "ovarian", " ", "cancer", " ", 
       "treated", " ", "with", " ", "chemotherapy", " ", "plus", " ", 
       "olaparib"}]}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemotherapySurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4ARawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", 
        "chemotherapy"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OlaparibSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4ARawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "olaparib"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4ARawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "the", " ", 
        "combination", " ", "of", " ", "chemotherapy", " ", "plus", " ", 
        "olaparib"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Randomly sampling monotherapy response distributions with partial \
correlation",
  FontSize->24],
 "\nThis is achieved by starting with the two monotherapies response \
distributions in a perfectly correlated joint distribution, and then adding a \
random number (up to a user-specified size) to the rank (that is, row number) \
of each entry. As the degree of rank-randomization increases, the rank \
correlation decreases from 1 and approaches 0. Identifying the appropriate \
value of the rank randomization parameter to produce a desired Spearman Rank \
Correlation is matter of manual adjustment.\n\nFirst, our goal is \[Rho] = \
0.28"
}], "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
  3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
  3.685715304379286*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "these", " ", "two", " ", "distributions", " ", "are", " ", "not", " ", 
     "of", " ", "exactly", " ", "the", " ", "same", " ", "length", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "this", " ", "depends", " ", "on", " ", "image", " ", "size", " ", 
         "and", " ", "resolution", " ", "of", " ", "the", " ", "Kaplan"}], 
        "-", 
        RowBox[{
        "Meier", " ", "plots", " ", "from", " ", "which", " ", "data", " ", 
         "was", " ", "extracted"}]}], ")"}], ".", " ", "Therefore"}]}], ",", 
    " ", 
    RowBox[{
    "we", " ", "shall", " ", "need", " ", "to", " ", "randomly", " ", 
     "subsample", " ", "the", " ", "longer", " ", "distribution", " ", "to", 
     " ", "produce", " ", "distributions", " ", "with", " ", "exactly", " ", 
     "matching", " ", 
     RowBox[{"lengths", ".", " ", "To"}], " ", "minimize", " ", "the", " ", 
     "introduction", " ", "of", " ", "error", " ", "from", " ", "the", " ", 
     "possibility", " ", "that", " ", "one", " ", "part", " ", "of", " ", 
     "the", " ", "distribution", " ", "is", " ", "sampled", " ", "less", " ", 
     "than", " ", "other", " ", "parts"}], ",", " ", 
    RowBox[{"we", " ", "introduce", " ", "a", " ", 
     RowBox[{"parameter", " ", "'"}], "resampling", " ", 
     RowBox[{"factor", "'"}], " ", "such", " ", "that", " ", "this", " ", 
     "process", " ", "is", " ", "repeated", " ", "many", " ", "times", " ", 
     "over", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"here", ",", " ", 
        RowBox[{"we", " ", "take", " ", "10", " ", "times"}]}], ")"}], ".", 
      " ", "In"}], " ", "practice", " ", "this", " ", "produces", " ", 
     "highly", " ", "reproducible", " ", "results", " ", "on", " ", "repeat", 
     " ", "executions", " ", "of", " ", "the", " ", "program", " ", 
     RowBox[{"(", 
      RowBox[{
      "demonstrated", " ", "below", " ", "in", " ", "a", " ", "histogram", 
       " ", "of", " ", "response", " ", "correlation"}], ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Length", "[", "OlaparibSurvivalDistribution", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Length", "[", "ChemotherapySurvivalDistribution", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"within", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"resample", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{"need", " ", "to", " ", "sub"}], "-", 
      RowBox[{"sample", " ", "the", " ", "olaparib", " ", "distribution", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "more", " ", "vertical", " ", "pixels", " ", "than", " ", "the", " ",
           "chemotherapy", " ", "distribution"}], ")"}], ".", " ", "The"}], 
       " ", "number", " ", "of", " ", "pixels", " ", "is", " ", "vastly", " ",
        "in", " ", "excess", " ", "of", " ", "the", " ", "number", " ", "of", 
       " ", "patients", " ", "so", " ", "no", " ", "individual", " ", 
       RowBox[{"patient", "'"}], "s", " ", "information", " ", "is", " ", 
       RowBox[{"lost", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledOLAPSurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"OlaparibSurvivalDistribution", ",", 
            RowBox[{
            "Length", "[", "ChemotherapySurvivalDistribution", "]"}]}], "]"}],
           ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledChemotherapySurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"ChemotherapySurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913353121545277`*^9, 3.6913353123515387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "13000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedCHEMODistribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledChemotherapySurvivalDistribution", 
            "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledChemotherapySurvivalDistribution", 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedOLAPDistribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledOLAPSurvivalDistribution", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledOLAPSurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedCHEMODistribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyFkowwEAx/FFa0uNjbAcK9LWtKg9zFXyf2FkLDkWCzky2eForGmNLFFS
rmTlevHClFpZckSOtbIQKR4oxeofGUvmmv/v//DtU9+UJkNFaxiDwUimgkpz
S0KBnCQ6ZuJE8GmvUA4XOOkKOPL7WAtDUwVqaO+K2oRSmdAFK9dU29B1v78D
L4f8J1Ao+6aVnRefwlfjMK32bO6gt5wkHDljR9A2n/cHLanFISjcLWX2UZo8
ZbQ/XhUXKljeaLgp9MVDbTWPT/+Km3z4cSsiYOjaXAJVhIvW1/YifqC8MHsk
sER5WMtVksT0slsNv+qDbTCONaGBS5OJepivH+6DjEi+DX4y7aNwUBPxzqOU
iGNpO+WZRat1JBFwPlfBztVAAzQFr5phEl+qhw4rxwAFIp32q5skxuvtOijI
nuiG7pWaHuiJCTfB3FlDP2RbnFa4uHU8AJ13jet+I0mMGdM2YNbdW/sPZQb7
nfYfJCnkwA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", 
    "100", " ", "times", " ", "to", " ", "show", " ", "that", " ", "response",
     " ", "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "13000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedCHEMODistribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledChemotherapySurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledChemotherapySurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedOLAPDistribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledOLAPSurvivalDistribution", "\[LeftDoubleBracket]", 
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledOLAPSurvivalDistribution", "]"}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "100", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
  3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
  3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
  3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
  3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
  3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
  3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
  3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
  3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
  3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857168498562803`*^9, 
  3.68571686945732*^9}, {3.685737295652752*^9, 3.685737295654752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Randomly sampling monotherapy response distributions with partial \
correlation",
  FontSize->24],
 "\nSecond, our goal is \[Rho] = 0.08"
}], "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"within", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"resample", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{"need", " ", "to", " ", "sub"}], "-", 
      RowBox[{"sample", " ", "the", " ", "olaparib", " ", "distribution", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "more", " ", "vertical", " ", "pixels", " ", "than", " ", "the", " ",
           "chemotherapy", " ", "distribution"}], ")"}], ".", " ", "The"}], 
       " ", "number", " ", "of", " ", "pixels", " ", "is", " ", "vastly", " ",
        "in", " ", "excess", " ", "of", " ", "the", " ", "number", " ", "of", 
       " ", "patients", " ", "so", " ", "no", " ", "individual", " ", 
       RowBox[{"patient", "'"}], "s", " ", "information", " ", "is", " ", 
       RowBox[{"lost", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledOLAPSurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"OlaparibSurvivalDistribution", ",", 
            RowBox[{
            "Length", "[", "ChemotherapySurvivalDistribution", "]"}]}], "]"}],
           ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledChemotherapySurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"ChemotherapySurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, {
  3.691335316674786*^9, 3.6913353168887987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "44400"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedCHEMODistribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledChemotherapySurvivalDistribution", 
            "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledChemotherapySurvivalDistribution", 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedOLAPDistribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledOLAPSurvivalDistribution", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledOLAPSurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedCHEMODistribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyFsoQ3EAx/ETLVLumYVWpLMmpaTlUtr/hZHLWi5rhFwamc2lsSYhSwi1
IVm5vXiZKbWy5B6jFSFSPFAKdSKL5D7ndzx8+9Q3tlqnqPOhKErIBuXG2iip
jCGNE3wRvN/MksGZwIR8OPBzp4LeMWk5tLYEr8BkCe2ERYvKNei82V6HZ32e
fUhLvjglJzmH8Fnfz6k5ntppL2SIPW14D5qmM35hV1yOF9IbebwOVoO7gPP7
SBkC8/2OwuAK/RAJNSWhAu4rLjPh25WIQO+FMRcqiZPzQf0kvmU9NboTYa58
VxUiZ8j4/EE5/Kz4UEO+n7kezlmitTBT298BqSCBCb7zrIOwtz7gJZQ1URzB
2SxLyraVMeTV8VgMm22vldDwcV4DYwTJWmjvDtRBoahJ89nKkNEKaxMUpppb
4cFCaRt0h/saYPqkrhP6dzm64eyqqwc6rquWPHqGDOvjl6HCYnLBLUuKG6pG
3hq+WYcm/v0DzrrvJA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", 
    "100", " ", "times", " ", "to", " ", "show", " ", "that", " ", "response",
     " ", "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "44400"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedCHEMODistribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledChemotherapySurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledChemotherapySurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedOLAPDistribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledOLAPSurvivalDistribution", "\[LeftDoubleBracket]", 
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledOLAPSurvivalDistribution", "]"}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "100", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
  3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
  3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
  3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
  3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
  3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
  3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
  3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
  3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
  3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
  3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
  3.6857170313489685`*^9, 3.685717034561973*^9}, {3.685737295750757*^9, 
  3.685737295752757*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Randomly sampling monotherapy response distributions with partial \
correlation",
  FontSize->24],
 "\nThirdly, our goal is \[Rho] = 0.48"
}], "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"within", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"resample", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{"need", " ", "to", " ", "sub"}], "-", 
      RowBox[{"sample", " ", "the", " ", "olaparib", " ", "distribution", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "more", " ", "vertical", " ", "pixels", " ", "than", " ", "the", " ",
           "chemotherapy", " ", "distribution"}], ")"}], ".", " ", "The"}], 
       " ", "number", " ", "of", " ", "pixels", " ", "is", " ", "vastly", " ",
        "in", " ", "excess", " ", "of", " ", "the", " ", "number", " ", "of", 
       " ", "patients", " ", "so", " ", "no", " ", "individual", " ", 
       RowBox[{"patient", "'"}], "s", " ", "information", " ", "is", " ", 
       RowBox[{"lost", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledOLAPSurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"OlaparibSurvivalDistribution", ",", 
            RowBox[{
            "Length", "[", "ChemotherapySurvivalDistribution", "]"}]}], "]"}],
           ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledChemotherapySurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"ChemotherapySurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
  3.691335320326995*^9, 3.6913353205420074`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "7600"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedCHEMODistribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledChemotherapySurvivalDistribution", 
            "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledChemotherapySurvivalDistribution", 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedOLAPDistribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledOLAPSurvivalDistribution", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledOLAPSurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedCHEMODistribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyGkogwEAh/HlyFEYwkJC2ppWSlqOkvcLm4y1HAshR8gOR2NNQtaipDaW
rBhfpBylVpabXC2WM0WiFOqNLEvmmvf/+vD0qyeuWimp82AwGLFUUKypjcwS
kESTMZwDHzeyBXAiIFEE+38eSqF7OKscmlqClmAyn22FhXPSVWi921qD532O
fcjmf9HyT4RH8FWlo5Udj223F5DEfNrgLtSOZ/zCrnihG7LX87w7KNW2fNpv
u5QJRT72ELjEfoqAsuJgFv0lV5nw/ZpDQPelJhdKCSvtU/0L957yVGPjwVzx
TilTTBIjUwfl8LPCVQ/DffQNcNIQpYCZCl0HZASytPDD2zQAexv834Ipedww
2mZBUs5sGUk4Lc9FsHnWWQnVrosaGM1KVsD57gAljOHIZZ+tJDFUYZLDmFR9
KzyYLmmDtlBPNUwfVXZC3y5LNzQv7/VAy23VgkNFEoOqhEUoMWj34KYhxQbT
D41nkOtYof3Y9buBcyFy2nOzq/Gb0mvm3z8PMQNd
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", 
    "100", " ", "times", " ", "to", " ", "show", " ", "that", " ", "response",
     " ", "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "7600"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedCHEMODistribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledChemotherapySurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledChemotherapySurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedOLAPDistribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledOLAPSurvivalDistribution", "\[LeftDoubleBracket]", 
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledOLAPSurvivalDistribution", "]"}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "100", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies \
(chemotherapy or olaparib), the observed combination, and the simulated \
effects with high, medium, or low response correlation (respectively, \[Rho] \
= 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ChemotherapySurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "OlaparibSurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "these", " ", "parameters", " ", "are", " ", "used", " ", "to", " ", 
    "adjust", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
    "legend", " ", "inset"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"legend", " ", "vertical", " ", "offset"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"vertical", " ", "offset", " ", "of", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"simulated", "'"}], " ", "legend", " ", "entry"}], "*)"}], 
   RowBox[{
    RowBox[{"slo", "=", 
     RowBox[{"-", "0.03"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lho", "=", 
     RowBox[{"-", "0.1"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "ChemotherapySurvivalDistribution", 
          "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "OlaparibSurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "ComboSurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "16"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "15.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"18", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median PFS:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"Mono1Median", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.25"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"Mono2Median", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.25", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"ComboMedian", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", "Black", 
        ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"Sim2Median", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "0.8"}], ",", 
            RowBox[{"0.1", "-", "0.03", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.6"}], ",", 
            RowBox[{"0.1", "+", "0.03", "+", "lo", "+", "slo"}]}], "}"}]}], 
         "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Paclitaxel + Carboplatin\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Olaparib\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<Figure 4A.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "12"}], 
   RowBox[{"(*", " ", "months", " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "SubSampledBestOfMidCorrelatedMonoPairs", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "ComboSurvivalDistribution", ",", "PatientsPerArmOfSimulatedTrial"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probability at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
   3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
   3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
   3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
   3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}, 
   3.716125594829217*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"OvarianHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparison of Independent Drug Action with Synergy models by Akaike \
Information Criterion (AIC)\
\>", "Section",
 CellChangeTimes->{{3.7043711029084554`*^9, 3.70437111295003*^9}, {
  3.704380475085513*^9, 3.704380499638918*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"first", ",", " ", 
    RowBox[{
    "we", " ", "compute", " ", "a", " ", "survival", " ", "distribution", " ",
      "based", " ", "on", " ", "the", " ", "monotherapy", " ", 
     "distributions", " ", "assuming", " ", "no", " ", "synergy"}], ",", " ", 
    RowBox[{
    "and", " ", "perfect", " ", "correlation", " ", "in", " ", "response", 
     " ", "between", " ", 
     RowBox[{"drugs", ".", " ", "Therefore"}], " ", "at", " ", "each", " ", 
     "time", " ", "point"}], ",", " ", 
    RowBox[{
     RowBox[{
     "PFS", " ", "is", " ", "the", " ", "higher", " ", "of", " ", "the", " ", 
      "single"}], "-", 
     RowBox[{"drug", " ", "PFS", " ", "rates", " ", "at", " ", "that", " ", 
      RowBox[{"time", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Max", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sort", "[", "ReSampledOLAPSurvivalDistribution", "]"}], 
          ",", 
          RowBox[{
          "Sort", "[", "ReSampledChemotherapySurvivalDistribution", "]"}]}], 
         "}"}], "\[Transpose]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Sort", "[", "MaximumOfMonotherapyResponses", "]"}], "]"}], 
       ",", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.70437116068976*^9, 3.7043711781427584`*^9}, {
  3.7043713179347544`*^9, 3.704371322535017*^9}, {3.7043715470068564`*^9, 
  3.704371589078263*^9}, {3.704371724639016*^9, 3.704371728007209*^9}, {
  3.704378697255827*^9, 3.704378723832347*^9}, {3.704380511279584*^9, 
  3.704380601831763*^9}, {3.7045333462930365`*^9, 3.704533346297037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Maximum", " ", "time"}], ",", " ", 
    RowBox[{"in", " ", "months"}], ",", " ", 
    RowBox[{
    "over", " ", "which", " ", "to", " ", "compare", " ", "survival", " ", 
     "distributions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LongestTime", "=", "15"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.704371741400975*^9, 3.704371803535529*^9}, {
  3.7043720439182777`*^9, 3.7043720686466923`*^9}, {3.7043787247994027`*^9, 
  3.7043787498548355`*^9}, {3.7043806086641536`*^9, 3.7043806338065915`*^9}}],

Cell[CellGroupData[{

Cell["\<\
A \[OpenCurlyQuote]synergy-fitting\[CloseCurlyQuote] model is created by \
defining two adjustable parameters:
a vertical scaling, which affects a fractional decrease in progression \
probability at each time
a horizontal scaling, which affects a fractional extension in duration of \
progression-free survival for all patients

SynergyModel[0,0] has no synergistic effect.
SynergyModel[X,0] has, for each patient, +X*100% longer PFS time. E.g. in \
SynergyModel[0.5, 0], all patients have +50% longer PFS.
SynergyModel[0,Y] has, at each time point, a 1/Y probability of progression. \
E.g. in SynergyModel[0, 1], at each time the progression rate is halved.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7043714031986313`*^9, 3.7043714851893206`*^9}, {
  3.7043787620225315`*^9, 3.704378762374552*^9}, {3.7043793812069473`*^9, 
  3.70437943773518*^9}, {3.7043806566869*^9, 3.7043806969352026`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SynergyModel", "[", 
   RowBox[{"HorizontalScaling_", ",", "VerticalScaling_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "HorizontalScaling"}], ")"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"LongestTime", ",", 
      RowBox[{"{", 
       RowBox[{"VerticalScaling", "*", 
        RowBox[{"Length", "[", "MaximumOfMonotherapyResponses", "]"}]}], 
       "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.704372031151548*^9, 3.704372038717981*^9}, {
   3.704372093902137*^9, 3.704372137942656*^9}, {3.7043721988711405`*^9, 
   3.7043722473669147`*^9}, {3.7043723375350723`*^9, 
   3.7043723481906815`*^9}, {3.7043723975975075`*^9, 3.7043724429271*^9}, {
   3.7043724942550364`*^9, 3.7043726163020163`*^9}, 3.704378761031475*^9, {
   3.7043794409433637`*^9, 3.7043794500318837`*^9}, {3.7045333463050375`*^9, 
   3.7045333463070374`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"for", " ", "Kolmorogov"}], "-", 
     RowBox[{
     "Smirnov", " ", "test", " ", "to", " ", "be", " ", "comparable", " ", 
      "across", " ", "data", " ", "sets", " ", "and", " ", "model", " ", 
      "types"}]}], ",", " ", 
    RowBox[{
    "the", " ", "population", " ", "size", " ", "that", " ", "comprises", " ",
      "each", " ", "survival", " ", "distribution", " ", "is", " ", 
     "normalized", " ", "to", " ", "a", " ", "consistent", " ", 
     RowBox[{"value", ".", " ", "This"}], " ", "does", " ", "not", " ", 
     "change", " ", "the", " ", "distribution", " ", "shape", " ", "except", 
     " ", "for", " ", "insignificant", " ", "rounding", " ", 
     RowBox[{"differences", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TrialPopulationSize", "=", "200"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "survivaldistribution_", ",", "LongestTime_", ",", "PopulationSize_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalDistributionWithMaximumTime", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"LongestTime", ",", "#"}], "}"}], "]"}], "&"}], ",", 
           "survivaldistribution"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SurvivalDistributionWithDefinedPopulationSize", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{"SurvivalDistributionWithMaximumTime", ",", 
             RowBox[{"{", "PopulationSize", "}"}]}], "]"}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", 
          RowBox[{
          "Length", "[", "SurvivalDistributionWithMaximumTime", "]"}]}], 
         "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043734358438916`*^9, 3.704373550262436*^9}, {
   3.7043738010417795`*^9, 3.70437384073405*^9}, {3.7043739047527113`*^9, 
   3.7043739049997263`*^9}, 3.704379791719427*^9, {3.704380130446801*^9, 
   3.7043802453673744`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "observed", " ", "data"}], ";", " ", 
    RowBox[{
    "set", " ", "to", " ", "consistent", " ", "population", " ", "size", " ", 
     "and", " ", "capped", " ", "with", " ", "a", " ", "consistent", " ", 
     "maximum", " ", "survival", " ", "time"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ObservedDistribution", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "ComboSurvivalDistribution", ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7043741526488905`*^9, 3.7043741703599033`*^9}, {
   3.7043807153752575`*^9, 3.70438074951221*^9}, 3.704381101874364*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "horizontal", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.2"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "0"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "Steps"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithHorizontalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{
     "SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704379488746098*^9, 3.7043795311195216`*^9}, {
   3.70437968075208*^9, 3.704379707304599*^9}, {3.7043807545124955`*^9, 
   3.7043808135208707`*^9}, {3.7043835980161347`*^9, 3.704383598216146*^9}, 
   3.7043836402165484`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043824822853184`*^9, 3.7043825489501314`*^9}, {
  3.704382619695178*^9, 3.704382643976567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "vertical", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.3"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"0", ",", "VerticalScaling"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "Steps"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithVerticalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043795383919373`*^9, 3.704379558304076*^9}, {
  3.704379658102784*^9, 3.704379676542839*^9}, {3.7043797161021023`*^9, 
  3.704379745456781*^9}, {3.7043808179211226`*^9, 3.7043808213913207`*^9}, {
  3.7043836667920685`*^9, 3.704383666864073*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043824822853184`*^9, 3.7043825489501314`*^9}, {
   3.704382619695178*^9, 3.704382643976567*^9}, 3.7043836128559837`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{"using", " ", "two", " ", "parameters"}], ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.2"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.3"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StepsPerParameter", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", "VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "VerticalScaling"}], "]"}], 
             ",", "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "StepsPerParameter"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "StepsPerParameter"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
    " ", 
   RowBox[{"BestLikelihoodWithTwoParameterFit", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043739959649286`*^9, 3.7043740011432247`*^9}, {
  3.7043740342081165`*^9, 3.7043740722872944`*^9}, {3.7043741137046633`*^9, 
  3.704374126255381*^9}, {3.7043741669857106`*^9, 3.7043741691348333`*^9}, {
  3.7043743037685337`*^9, 3.7043744065914154`*^9}, {3.7043746382406645`*^9, 
  3.7043746388807015`*^9}, {3.7043747047754707`*^9, 3.704374706456567*^9}, {
  3.704377713519561*^9, 3.7043777172077713`*^9}, {3.7043784069112206`*^9, 
  3.704378427272385*^9}, {3.704379847560621*^9, 3.704379981744296*^9}, {
  3.704380827784686*^9, 3.7043808347840867`*^9}, {3.7043836832950125`*^9, 
  3.704383691007454*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameters", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043818001673036`*^9, 3.7043818094148326`*^9}, {
  3.7043819032311983`*^9, 3.7043819250144444`*^9}, {3.7043821556226344`*^9, 
  3.70438215571064*^9}, {3.704384170135858*^9, 3.704384178880358*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
    "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
    RowBox[{"(", 
     RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
    " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
    " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "To", " ", "minimize", " ", "noise", " ", "from", " ", "the", " ", 
     "sampling", " ", "procedure", " ", "of", " ", "the", " ", "independent", 
     " ", "action", " ", "model"}], ",", " ", 
    RowBox[{
    "we", " ", "take", " ", "the", " ", "average", " ", "of", " ", "many", 
     " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionSimulation", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", 
        " ", "randomization", " ", "that", " ", "produces", " ", "Spearman", 
        " ", "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ",
         "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"amountofrankrandomization", "=", "13000"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedCHEMODistribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledChemotherapySurvivalDistribution", 
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledChemotherapySurvivalDistribution", 
               "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedOLAPDistribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledOLAPSurvivalDistribution", "\[LeftDoubleBracket]", 
               "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledOLAPSurvivalDistribution", "]"}]}], 
             "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", "SlightlyRandomizedCHEMODistribution", "]"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], 
          ",", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumberOfIndependentActionSimulations", "=", "20"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReplicateIndependentActionSimulations", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IndependentActionSimulation", "[", "]"}], ",", 
         RowBox[{"{", "NumberOfIndependentActionSimulations", "}"}]}], "]"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "final", " ", "model", " ", "is", " ", "the", " ", "population"}], "-", 
     RowBox[{
     "normalized", " ", "average", " ", "of", " ", "many", " ", "replicate", 
      " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndependentActionModel", "=", 
     RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
      RowBox[{
      "ReplicateIndependentActionSimulations", ",", "LongestTime", ",", 
       "TrialPopulationSize"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
     "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
     RowBox[{"(", 
      RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
     " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
     " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"IndependentActionModelLikelihood", "=", 
    RowBox[{"KolmogorovSmirnovTest", "[", 
     RowBox[{
     "ObservedDistribution", ",", "IndependentActionModel", ",", 
      "\"\<PValue\>\""}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704380310986127*^9, 3.70438035351256*^9}, {
   3.7043808394793553`*^9, 3.7043808719832144`*^9}, {3.704549367919421*^9, 
   3.704549410839876*^9}, {3.7045494549553995`*^9, 3.7045495430564384`*^9}, {
   3.70454959045815*^9, 3.704549613089444*^9}, {3.7045496637053394`*^9, 
   3.7045496646893954`*^9}, {3.7045497077138567`*^9, 3.704549723096736*^9}, {
   3.704549803136314*^9, 3.7045498661379175`*^9}, {3.704550006481945*^9, 
   3.7045500205307484`*^9}, 3.704552326961669*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Tabulating", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ",
      "observed", " ", "combination", " ", "drug", " ", "response", " ", 
     "would", " ", "be", " ", "observed", " ", "if", " ", "the", " ", "true", 
     " ", "distribution", " ", "were", " ", "one", " ", "of", " ", "the", " ",
      "various", " ", "models"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"order", ":", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"independent", " ", "drug", " ", "action"}], ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "horizontal", " ", "parameter"}],
         ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "vertical", " ", "parameter"}], 
        ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "two", " ", "parameters"}]}], 
       " ", "}"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"OvarianModelLikelihoods", "=", 
   RowBox[{"{", 
    RowBox[{
    "IndependentActionModelLikelihood", ",", 
     "BestLikelihoodWithHorizontalParameter", ",", 
     "BestLikelihoodWithVerticalParameter", ",", 
     "BestLikelihoodWithTwoParameterFit"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.704380296464297*^9, 3.704380308921009*^9}, {
   3.7043803605989647`*^9, 3.7043804465438805`*^9}, {3.70438088886318*^9, 
   3.704380980143401*^9}, 3.7043812661837616`*^9, 3.7161276626694903`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["plotting model fits", "Subsection",
 CellChangeTimes->{{3.7045335958673115`*^9, 3.7045336044888043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximumOfMonotherapyResponsesModel", "=", 
   RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
    RowBox[{
    "MaximumOfMonotherapyResponses", ",", "LongestTime", ",", 
     "TrialPopulationSize"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7045332975502486`*^9, 3.7045333014874735`*^9}, 
   3.704533346316038*^9, {3.7045333841182003`*^9, 3.7045333933027253`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestHorizontalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyHorizontalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestHorizontalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"BestHorizontalSynergyParameter", ",", "0"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestHorizontalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<OvarianCancerOlaparibChemotherapyBestHorizontalSynergy.pdf\>\""}], 
   ",", "%", ",", "\"\<PDF\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.7045318972951584`*^9, 3.704531962684899*^9}, {
  3.70453199750289*^9, 3.704532132143591*^9}, {3.7045321737649717`*^9, 
  3.7045322964879913`*^9}, {3.7045323746424613`*^9, 3.7045323753155*^9}, {
  3.704533375263694*^9, 3.704533413559884*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestVerticalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestVerticalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"0", ",", "BestVerticalSynergyParameter"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestVerticalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<OvarianCancerOlaparibChemotherapyBestVerticalSynergy.pdf\>\""}], ",",
    "%", ",", "\"\<PDF\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532504895911*^9, 3.704532506584008*^9}, 
   3.70453342765669*^9, {3.7045334751834087`*^9, 3.7045334813837633`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestTwoParameterSynergyParameters", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"SynergyModelTwoParameterFits", ",", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestTwoParameterSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], "]"}], ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestTwoParameterSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<OvarianCancerOlaparibChemotherapyBestTwoParameterSynergy.pdf\>\""}], 
   ",", "%", ",", "\"\<PDF\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, 3.7045326817550273`*^9, 
   3.704533431520911*^9, {3.704533491519343*^9, 3.704533491896364*^9}, {
   3.7045335282314425`*^9, 3.7045335291784973`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "IndependentActionModel", "]"}],
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<OvarianCancerOlaparibChemotherapyIndependentModel.pdf\>\""}], ",", 
   "%", ",", "\"\<PDF\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, {3.7045326817550273`*^9, 
   3.704532743454556*^9}, {3.7045332534247246`*^9, 3.704533255279831*^9}, 
   3.7045334337040358`*^9, {3.7045335562110434`*^9, 3.704533578090295*^9}, {
   3.7045497868193808`*^9, 3.704549789536536*^9}, {3.7045498968526745`*^9, 
   3.7045499043241014`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Supplementary figure - how PFS depends on response correlation\
\>", "Section",
 CellChangeTimes->{{3.6816516976190557`*^9, 3.681651703529394*^9}, {
  3.685717146503318*^9, 3.685717161605383*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "as", " ", "its", " ", 
     "input", " ", "an", " ", "amount", " ", "of", " ", "rank", " ", 
     "randomization"}], ",", " ", 
    RowBox[{
    "and", " ", "returns", " ", "a", " ", "response", " ", "correlation", " ",
      "and", " ", "predicted", " ", "median", " ", "PFS", " ", "at", " ", 
     "this", " ", "level", " ", "of", " ", "correlation", " ", "in", " ", 
     "drug", " ", "response"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PFSvsCorrelation", "[", "amountofrankrandomization_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SubSampledOLAPSurvivalDistribution", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"RandomSample", "[", 
         RowBox[{"OlaparibSurvivalDistribution", ",", 
          RowBox[{"Length", "[", "ChemotherapySurvivalDistribution", "]"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SlightlyRandomizedCHEMODistribution", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"i", "+", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "amountofrankrandomization"}], ",", 
                 "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
             RowBox[{
             "ChemotherapySurvivalDistribution", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
             "Length", "[", "ChemotherapySurvivalDistribution", "]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
           RowBox[{
           "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SlightlyRandomizedOLAPDistribution", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"i", "+", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "amountofrankrandomization"}], ",", 
                 "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
             RowBox[{
             "SubSampledOLAPSurvivalDistribution", "\[LeftDoubleBracket]", 
              "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
             "Length", "[", "SubSampledOLAPSurvivalDistribution", "]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
           RowBox[{
           "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ResponseCorrelation", "=", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{
         "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"BestOfPartiallyCorrelatedSamplesofMonotherapyResponses", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "SlightlyRandomizedCHEMODistribution", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "SlightlyRandomizedOLAPDistribution", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "SlightlyRandomizedCHEMODistribution", "]"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MedianPFS", "=", 
       RowBox[{"Quantile", "[", 
        RowBox[{
        "BestOfPartiallyCorrelatedSamplesofMonotherapyResponses", ",", 
         "0.5"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ResponseCorrelation", ",", "MedianPFS"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617586751399307`*^9, 3.6617587767057395`*^9}, {
   3.6617590422109256`*^9, 3.6617590813141623`*^9}, {3.6617591912184486`*^9, 
   3.661759202018066*^9}, {3.6617599284826174`*^9, 3.6617599371941156`*^9}, {
   3.661759970771036*^9, 3.6617599820586815`*^9}, {3.6617600635473423`*^9, 
   3.66176006385036*^9}, {3.6617601063067884`*^9, 3.6617601082018967`*^9}, {
   3.665540628806692*^9, 3.6655406523820405`*^9}, {3.665541105862978*^9, 
   3.66554111428546*^9}, {3.6655411623982115`*^9, 3.6655411624622154`*^9}, {
   3.6655412507752666`*^9, 3.665541270438391*^9}, {3.665541311254726*^9, 
   3.6655413125417995`*^9}, {3.6655416228225465`*^9, 
   3.6655416412456007`*^9}, {3.6655417158388667`*^9, 
   3.6655417177579765`*^9}, {3.665762639450184*^9, 3.6657626623274927`*^9}, {
   3.665855190134801*^9, 3.665855206269724*^9}, {3.665855295792844*^9, 
   3.665855300532115*^9}, {3.6658553448616486`*^9, 3.6658554202009573`*^9}, {
   3.665855520751709*^9, 3.6658555648132286`*^9}, {3.665858456325257*^9, 
   3.665858456661276*^9}, {3.6719396414775925`*^9, 3.671939759428339*^9}, {
   3.6719398396459274`*^9, 3.6719398706867027`*^9}, {3.671939953565443*^9, 
   3.6719399604218354`*^9}, {3.6741052745277777`*^9, 
   3.6741052907267046`*^9}, {3.674105326054725*^9, 3.6741053268787727`*^9}, {
   3.6816517232575226`*^9, 3.681651723881558*^9}, {3.681651886265846*^9, 
   3.681651962760221*^9}, {3.681653582322855*^9, 3.6816536071312733`*^9}, {
   3.682725700083665*^9, 3.682725746522321*^9}, {3.6827257825203805`*^9, 
   3.682725798964321*^9}, 3.6857148951011515`*^9, {3.6857160237682667`*^9, 
   3.6857160240582676`*^9}, {3.685716193970583*^9, 3.6857162157346177`*^9}, {
   3.685716297028781*^9, 3.6857162980187817`*^9}, {3.6857179003830233`*^9, 
   3.6857179152010574`*^9}, {3.685737296076776*^9, 3.685737296079776*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "executing", " ", "the", " ", "above", " ", "function", " ", "over", " ", 
    "a", " ", "wide", " ", "range", " ", "of", " ", "rank", " ", 
    "randomization", " ", "values", " ", 
    RowBox[{"(", 
     RowBox[{"log", "-", 
      RowBox[{
      "distributed", " ", "to", " ", "achieve", " ", "the", " ", "necessary", 
       " ", "range"}]}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PFSvsCorrelationTable", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PFSvsCorrelation", "[", 
       SuperscriptBox["10", "i"], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1.5", ",", "5", ",", "0.02"}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.681651954088725*^9, 3.6816521045543313`*^9}, {
   3.6816522847296367`*^9, 3.6816522847946405`*^9}, {3.6816524774566603`*^9, 
   3.681652477818681*^9}, {3.6816529083073034`*^9, 3.6816529298265343`*^9}, {
   3.681652972362967*^9, 3.6816529724409714`*^9}, 3.6816536480036116`*^9, {
   3.685716164806532*^9, 3.6857161825095634`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"fitting", " ", "a", " ", "linear"}], "-", "plus", "-", 
    RowBox[{
    "sigmoidal", " ", "curve", " ", "to", " ", "the", " ", "relationship", 
     " ", "between", " ", "response", " ", "correlation", " ", "and", " ", 
     RowBox[{"PFS", ".", " ", "We"}], " ", "attach", " ", "no", " ", 
     "importance", " ", "to", " ", "the", " ", "specific", " ", "function"}], 
    " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "simply", " ", "a", " ", "versatile", " ", "line",
      " ", "to", " ", "show", " ", "the", " ", "trend"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nh", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"model", "=", 
     RowBox[{"b", "-", 
      RowBox[{"h", "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", "x", ")"}], "nh"], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", "x", ")"}], "nh"], "+", 
         SuperscriptBox["k", "nh"]}]]}], "-", 
      RowBox[{"m", "*", "x"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"sigmoidfit50", "=", 
    RowBox[{"NonlinearModelFit", "[", 
     RowBox[{"PFSvsCorrelationTable", ",", "model", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "8"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1"}], "}"}]}], "}"}], ",", "x"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.681653625841344*^9, 3.681653634832858*^9}, 
   3.681653762036134*^9, {3.681653802077424*^9, 3.6816538247547207`*^9}, {
   3.681656071218211*^9, 3.6816560815868044`*^9}, {3.682724150932*^9, 
   3.6827241586940193`*^9}, {3.6827243839723883`*^9, 3.682724448685089*^9}, {
   3.682726158165866*^9, 3.6827262852441344`*^9}, {3.68571624888468*^9, 
   3.6857162767017384`*^9}, {3.685716360340891*^9, 3.6857164324510155`*^9}, {
   3.6857175020533066`*^9, 3.685717502703308*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"supplementary", " ", 
     RowBox[{"figure", ":", " ", 
      RowBox[{
      "relationship", " ", "between", " ", "median", " ", "PFS", " ", "and", 
       " ", "correlation"}]}]}], ",", " ", 
    RowBox[{"showing", " ", "each", " ", "simulation", " ", "point"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"PFSvsCorrelationTable", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "13.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
          RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
          RowBox[{"AbsolutePointSize", "[", "3", "]"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "170", "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"N", "[", "i", "]"}], ",", "i", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "1"}], ",", "1", ",", 
                 RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"N", "[", "i", "]"}], ",", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.025"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "1"}], ",", "1", ",", 
                 RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], "\[Rule]", "\"\<0.5\>\""}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], "\[Rule]", "\"\<-0.5\>\""}]}], 
            "}"}]}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.035"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "20", ",", "3"}], "}"}]}], "]"}]}], 
         "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Correlation in response \>\"", ",", 
          "\"\<Median PFS (months)\>\""}], "}"}]}]}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sigmoidfit50", "[", "x", "]"}], ",", "ComboMedian", ",", 
         "Mono1Median"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.04", ",", "0.05"}], "}"}], "]"}], ",", 
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "6"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.04", ",", "0.05"}], "}"}], "]"}], ",", 
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "4"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.05", ",", "0.03"}], "}"}], "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
       ",", 
       RowBox[{"Filling", "\[Rule]", "None"}], ",", 
       RowBox[{"FillingStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "13.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "170", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"45", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"N", "[", "i", "]"}], ",", "i", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "1"}], ",", "1", ",", 
                 RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"N", "[", "i", "]"}], ",", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.025"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "1"}], ",", "1", ",", 
                 RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], "\[Rule]", "\"\<0.5\>\""}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], "\[Rule]", "\"\<-0.5\>\""}]}], 
            "}"}]}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.035"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "20", ",", "3"}], "}"}]}], "]"}]}], 
         "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Correlation in response \>\"", ",", 
          "\"\<Median PFS (months)\>\""}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<Supplementary Figure S5A, olaparib and chemotherapy.pdf\>\""}], 
     ",", "%", ",", "\"\<PDF\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.681651994894059*^9, 3.681651998336256*^9}, {
   3.681652039568614*^9, 3.6816520475780725`*^9}, {3.681652212704517*^9, 
   3.6816522791533175`*^9}, {3.6816524483929977`*^9, 
   3.6816524637038736`*^9}, {3.681652510288538*^9, 3.6816525472106495`*^9}, {
   3.6816525877539687`*^9, 3.6816526930759926`*^9}, {3.6816527535624523`*^9, 
   3.6816528745323715`*^9}, {3.6816530654052887`*^9, 
   3.6816530654742928`*^9}, {3.68165325844233*^9, 3.681653311123343*^9}, {
   3.6816538505001936`*^9, 3.681653969432996*^9}, {3.6816552499502373`*^9, 
   3.681655253697452*^9}, {3.681655350581993*^9, 3.6816553516590548`*^9}, 
   3.6816553880351353`*^9, 3.6816566989181137`*^9, {3.682724496326814*^9, 
   3.682724586443969*^9}, {3.6827263474446917`*^9, 3.6827263641686487`*^9}, {
   3.6827263954854403`*^9, 3.6827264046379633`*^9}, {3.6857160810383883`*^9, 
   3.6857160813483887`*^9}, {3.685716331081839*^9, 3.685716332951842*^9}, {
   3.6857164452040396`*^9, 3.6857165384142284`*^9}, {3.685717528354357*^9, 
   3.6857175800464582`*^9}, 3.716125958070993*^9, 3.7161330617373*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 4B - HER2-positive breast cancer\n",
 StyleBox["Near-identical code as for Figure 4A is here employed to generate \
Figure 4B. Comments will be more brief.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6913349412163115`*^9, 3.691334947328661*^9}, {
  3.6913350087441735`*^9, 3.69133509102588*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure4BRawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "4", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "fourth", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet"}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.691335120807583*^9, 
  3.691335121159603*^9}, {3.691335153027426*^9, 3.6913351618209295`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Therapy1SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4BRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", 
        "chemotherapy"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy2SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4BRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "trastuzumab"}],
        "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4BRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "the", " ", 
        "combination"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6913351250408254`*^9, 
  3.6913351370215106`*^9}, {3.691335177937851*^9, 3.691335183565173*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"within", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"resample", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{"need", " ", "to", " ", "sub"}], "-", 
      RowBox[{
      "sample", " ", "the", " ", "trastuzumab", " ", "distribution", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "more", " ", "vertical", " ", "pixels", " ", "than", " ", "the", " ",
           "chemotherapy", " ", "distribution"}], ")"}], ".", " ", "The"}], 
       " ", "number", " ", "of", " ", "pixels", " ", "is", " ", "vastly", " ",
        "in", " ", "excess", " ", "of", " ", "the", " ", "number", " ", "of", 
       " ", "patients", " ", "so", " ", "no", " ", "individual", " ", 
       RowBox[{"patient", "'"}], "s", " ", "information", " ", "is", " ", 
       RowBox[{"lost", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Therapy2SurvivalDistribution", ",", 
            RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
  3.6913353590842123`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "17400"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyGkog3EAx/FF2lKOkVloIm0mUV7MVfJ/w8hYy7FmIUfIbEOzNQmRKClX
snK9UcKiVpYckasVIVIopFAPMiT3PL/nxbdPfcNKdYoKNxaLFUoH5ebyoFQp
RWqGeCJ4t5YmhWNeUTLY9Xurgq6BVDW01PkswjiJ0A5zZ5XL0H61vgKP2507
UCj5ZpQcZuzBZ0Mno+ZgZKMxhyJziT1bsGM0+Q82h2e4oHA1y8NIa3JkM/7s
K32hjL3vBxeF94FQk8/lM19xlgLfz0UEuk7NmVBJ7Iz3lU/iG9ojsyMaZso3
Vb5yigxO7qrhV9FnJeSx+6rgRH+wFqZoO42Q5c3vgB8elm7YVuX5yqWNFgcw
6qWx6TOFFHmzPeZB/cxbMTR9npTBEH6cFs61eOmgQFSr+aqnSG+RpRYKEvrq
4e5UQQN0+LubYNKwrglymm0tcHxpuxXaLkusTgNFegwRCzD+8qX6hzaG88rI
k81fTLdSJFJNrqHVqHmAHNXeI/wH2Dj2RA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "17400"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
  3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
  3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
  3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
  3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
  3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
  3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
  3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
  3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
  3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857168498562803`*^9, 
  3.68571686945732*^9}, {3.685737295652752*^9, 3.685737295654752*^9}, {
  3.6913355434777584`*^9, 3.691335555414441*^9}, {3.6913356045112495`*^9, 
  3.6913356077674356`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy1SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "63000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyGkog3EAx/EnEil3WEi5tkiUtByl/d8wcqzlWCPkCJnN0ViTXEsIZUhW
rpRyllpZcsesp8iZ4gWlUE9EJPc8v8eLb5/6BhSppKU2FEUFsEGJtsRHJGZI
5ZCXAN5tJIrhmFNYGuz8uZVD64AoDxpqXJZhlJBvgpnzslVout5ag6ftz3uQ
L/ziFB4l78MndQen4nBkuz6DIQuxPbtQNxr/C5sCk62Qv55q18CqodM5vw9k
rjDN/sAdLvPvvaEi243HfelFAny7FBBoPdemQBkxcd6XPYbesB5r6XCYItmR
u0oYMjhpyYOf+R9l0Mu+vxxO6H2VMEHZ0QApZ54OvtsZumBrueOLG2t4qCdn
tTgyaS6XIa/GhyxYPfdaADUfZ8XQjxelhAvNTiroL6hSfNYypC/fUAX9Y/pr
oWU6pw7SHrYaGDesaoQOTcZmOL5iboHGq8LFZzVDetTBS1Cq15nhpj6ahvLe
t4pv1u6hf6dFyp+ZFoYsml+oWVZf2nEKKixBnBEhh2bYdnnC+Qc+AQpc
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "63000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIAwAwnpwj
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy1SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
  3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
  3.691337277744953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "10200"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0FtIU3EAx/GDJaagboZzlA2MsbEYCBLDG2PnxaY4G6PLmmKSika72GQ5
FsNJQxRM2UqiQS1fQpwWwcChZil5YcxRXhASURDKOBROh7nNXOf39+HHB36P
34J7Jk1zCkVRQnZQbWu6oFAy9INBnhj+/FShhK8zr6hgz78fOph8pqiDnofZ
47BIJgrAG6PaKRjYnvkIV59EFqBIliDKvlUuwT1LN1H/9eXso+sMPVbSNwed
r8pOoP1yZRKKpqtTO1itwRricVjLgaq0cA4cF+3mQf0tLp/8mu9yeLghpmFy
3VYFtXSAuNvyR7LDumwLSmGV+ouOo2bo50OLdTBeH2uBvDRXK3zjvmiEcmN3
B6Sy+E54lOrphV2tGQdcVqkkl9imLLzmq2XoqP/3Tdjmi96F1thaI8znFxnh
WGemCQrEBn3czND99R4DFBS7zHDx7e12GDx/xgpLX5gew3N2fyf0Tsw7oH+r
4V3EwtB9FuEHqHE75+Fn99UgLA0NrkBJZJJ4NJe+CUdzDMRVb+z+MevZ4VOn
fb96Rhxsj/y/ROoSbwA+vdNMTKwIvLAhVEHcf1+yAMPL5cT/dLknlg==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "10200"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy2SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "offset"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", "0.56"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "simulated", "*)"}], 
   RowBox[{
    RowBox[{"slo", "=", 
     RowBox[{"-", "0.03"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lho", "=", "8.4"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy2SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "ComboSurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "19"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "15"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"18", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median PFS:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<4.6\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<4.8\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.00"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<7.4\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", "Black", 
        ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<7.2\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "0.8"}], ",", 
            RowBox[{"0.1", "-", "0.03", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.6"}], ",", 
            RowBox[{"0.1", "+", "0.03", "+", "lo", "+", "slo"}]}], "}"}]}], 
         "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Chemotherapy\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Trastuzumab\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<Figure 4B.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9, {
   3.6913370241064453`*^9, 3.6913371276353674`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "12"}], 
   RowBox[{"(*", " ", "months", " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "SubSampledBestOfMidCorrelatedMonoPairs", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "ComboSurvivalDistribution", ",", "PatientsPerArmOfSimulatedTrial"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probability at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
   3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
   3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
   3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
   3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}, 
   3.7161255950182276`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"BreastCancerHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}, {3.7042088017467666`*^9, 3.7042088059760084`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparison of Independent Drug Action with Synergy models by Akaike \
Information Criterion (AIC)\
\>", "Section",
 CellChangeTimes->{{3.7043711029084554`*^9, 3.70437111295003*^9}, {
  3.704380475085513*^9, 3.704380499638918*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"first", ",", " ", 
    RowBox[{
    "we", " ", "compute", " ", "a", " ", "survival", " ", "distribution", " ",
      "based", " ", "on", " ", "the", " ", "monotherapy", " ", 
     "distributions", " ", "assuming", " ", "no", " ", "synergy"}], ",", " ", 
    RowBox[{
    "and", " ", "perfect", " ", "correlation", " ", "in", " ", "response", 
     " ", "between", " ", 
     RowBox[{"drugs", ".", " ", "Therefore"}], " ", "at", " ", "each", " ", 
     "time", " ", "point"}], ",", " ", 
    RowBox[{
     RowBox[{
     "PFS", " ", "is", " ", "the", " ", "higher", " ", "of", " ", "the", " ", 
      "single"}], "-", 
     RowBox[{"drug", " ", "PFS", " ", "rates", " ", "at", " ", "that", " ", 
      RowBox[{"time", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Max", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sort", "[", "ReSampledTherapy1SurvivalDistribution", "]"}],
           ",", 
          RowBox[{
          "Sort", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
         "}"}], "\[Transpose]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Sort", "[", "MaximumOfMonotherapyResponses", "]"}], "]"}], 
       ",", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.70437116068976*^9, 3.7043711781427584`*^9}, {
  3.7043713179347544`*^9, 3.704371322535017*^9}, {3.7043715470068564`*^9, 
  3.704371589078263*^9}, {3.704371724639016*^9, 3.704371728007209*^9}, {
  3.704378697255827*^9, 3.704378723832347*^9}, {3.704380511279584*^9, 
  3.704380601831763*^9}, {3.7043810488253293`*^9, 3.704381050512426*^9}, {
  3.7045333463590403`*^9, 3.70453334636104*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Maximum", " ", "time"}], ",", " ", 
    RowBox[{"in", " ", "months"}], ",", " ", 
    RowBox[{
    "over", " ", "which", " ", "to", " ", "compare", " ", "survival", " ", 
     "distributions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LongestTime", "=", "15"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.704371741400975*^9, 3.704371803535529*^9}, {
  3.7043720439182777`*^9, 3.7043720686466923`*^9}, {3.7043787247994027`*^9, 
  3.7043787498548355`*^9}, {3.7043806086641536`*^9, 3.7043806338065915`*^9}, {
  3.7045341649848633`*^9, 3.704534165071868*^9}, {3.7045342279914665`*^9, 
  3.704534228142475*^9}}],

Cell[CellGroupData[{

Cell["\<\
A \[OpenCurlyQuote]synergy-fitting\[CloseCurlyQuote] model is created by \
defining two adjustable parameters:
a vertical scaling, which affects a fractional decrease in progression \
probability at each time
a horizontal scaling, which affects a fractional extension in duration of \
progression-free survival for all patients

SynergyModel[0,0] has no synergistic effect.
SynergyModel[X,0] has, for each patient, +X*100% longer PFS time. E.g. in \
SynergyModel[0.5, 0], all patients have +50% longer PFS.
SynergyModel[0,Y] has, at each time point, a 1/Y probability of progression. \
E.g. in SynergyModel[0, 1], at each time the progression rate is halved.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7043714031986313`*^9, 3.7043714851893206`*^9}, {
  3.7043787620225315`*^9, 3.704378762374552*^9}, {3.7043793812069473`*^9, 
  3.70437943773518*^9}, {3.7043806566869*^9, 3.7043806969352026`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SynergyModel", "[", 
   RowBox[{"HorizontalScaling_", ",", "VerticalScaling_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "HorizontalScaling"}], ")"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"LongestTime", ",", 
      RowBox[{"{", 
       RowBox[{"VerticalScaling", "*", 
        RowBox[{"Length", "[", "MaximumOfMonotherapyResponses", "]"}]}], 
       "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.704372031151548*^9, 3.704372038717981*^9}, {
   3.704372093902137*^9, 3.704372137942656*^9}, {3.7043721988711405`*^9, 
   3.7043722473669147`*^9}, {3.7043723375350723`*^9, 
   3.7043723481906815`*^9}, {3.7043723975975075`*^9, 3.7043724429271*^9}, {
   3.7043724942550364`*^9, 3.7043726163020163`*^9}, 3.704378761031475*^9, {
   3.7043794409433637`*^9, 3.7043794500318837`*^9}, {3.704533346370041*^9, 
   3.7045333463710413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"for", " ", "Kolmorogov"}], "-", 
     RowBox[{
     "Smirnov", " ", "test", " ", "to", " ", "be", " ", "comparable", " ", 
      "across", " ", "data", " ", "sets", " ", "and", " ", "model", " ", 
      "types"}]}], ",", " ", 
    RowBox[{
    "the", " ", "population", " ", "size", " ", "that", " ", "comprises", " ",
      "each", " ", "survival", " ", "distribution", " ", "is", " ", 
     "normalized", " ", "to", " ", "a", " ", "consistent", " ", 
     RowBox[{"value", ".", " ", "This"}], " ", "does", " ", "not", " ", 
     "change", " ", "the", " ", "distribution", " ", "shape", " ", "except", 
     " ", "for", " ", "insignificant", " ", "rounding", " ", 
     RowBox[{"differences", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TrialPopulationSize", "=", "200"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "survivaldistribution_", ",", "LongestTime_", ",", "PopulationSize_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalDistributionWithMaximumTime", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"LongestTime", ",", "#"}], "}"}], "]"}], "&"}], ",", 
           "survivaldistribution"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SurvivalDistributionWithDefinedPopulationSize", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{"SurvivalDistributionWithMaximumTime", ",", 
             RowBox[{"{", "PopulationSize", "}"}]}], "]"}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", 
          RowBox[{
          "Length", "[", "SurvivalDistributionWithMaximumTime", "]"}]}], 
         "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043734358438916`*^9, 3.704373550262436*^9}, {
   3.7043738010417795`*^9, 3.70437384073405*^9}, {3.7043739047527113`*^9, 
   3.7043739049997263`*^9}, 3.704379791719427*^9, {3.704380130446801*^9, 
   3.7043802453673744`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "observed", " ", "data"}], ";", " ", 
    RowBox[{
    "set", " ", "to", " ", "consistent", " ", "population", " ", "size", " ", 
     "and", " ", "capped", " ", "with", " ", "a", " ", "consistent", " ", 
     "maximum", " ", "survival", " ", "time"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ObservedDistribution", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "ComboSurvivalDistribution", ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7043741526488905`*^9, 3.7043741703599033`*^9}, {
   3.7043807153752575`*^9, 3.70438074951221*^9}, 3.7043812846478176`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "horizontal", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.7"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "0"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "Steps"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithHorizontalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{
     "SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704379488746098*^9, 3.7043795311195216`*^9}, {
  3.70437968075208*^9, 3.704379707304599*^9}, {3.7043807545124955`*^9, 
  3.7043808135208707`*^9}, {3.7043813924169817`*^9, 3.7043813925189877`*^9}, {
  3.704381658680211*^9, 3.7043816587832165`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043824822853184`*^9, 3.7043825489501314`*^9}, {
   3.704382619695178*^9, 3.704382643976567*^9}, 3.7043836128559837`*^9, 
   3.7043842632151823`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "vertical", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.4"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"0", ",", "VerticalScaling"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "Steps"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithVerticalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043795383919373`*^9, 3.704379558304076*^9}, {
  3.704379658102784*^9, 3.704379676542839*^9}, {3.7043797161021023`*^9, 
  3.704379745456781*^9}, {3.7043808179211226`*^9, 3.7043808213913207`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043824822853184`*^9, 3.7043825489501314`*^9}, {
   3.704382619695178*^9, 3.704382643976567*^9}, 3.7043836128559837`*^9, {
   3.7043842632151823`*^9, 3.70438427069761*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{"using", " ", "two", " ", "parameters"}], ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.7"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.2"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StepsPerParameter", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", "VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "VerticalScaling"}], "]"}], 
             ",", "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "StepsPerParameter"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "StepsPerParameter"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
    " ", 
   RowBox[{"BestLikelihoodWithTwoParameterFit", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043739959649286`*^9, 3.7043740011432247`*^9}, {
  3.7043740342081165`*^9, 3.7043740722872944`*^9}, {3.7043741137046633`*^9, 
  3.704374126255381*^9}, {3.7043741669857106`*^9, 3.7043741691348333`*^9}, {
  3.7043743037685337`*^9, 3.7043744065914154`*^9}, {3.7043746382406645`*^9, 
  3.7043746388807015`*^9}, {3.7043747047754707`*^9, 3.704374706456567*^9}, {
  3.704377713519561*^9, 3.7043777172077713`*^9}, {3.7043784069112206`*^9, 
  3.704378427272385*^9}, {3.704379847560621*^9, 3.704379981744296*^9}, {
  3.704380827784686*^9, 3.7043808347840867`*^9}, {3.7043817220628366`*^9, 
  3.704381722159842*^9}, {3.7043817950160093`*^9, 3.7043817964000883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameters", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043818001673036`*^9, 3.7043818094148326`*^9}, {
  3.7043819032311983`*^9, 3.7043819250144444`*^9}, {3.7043821556226344`*^9, 
  3.70438215571064*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
    "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
    RowBox[{"(", 
     RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
    " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
    " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "To", " ", "minimize", " ", "noise", " ", "from", " ", "the", " ", 
     "sampling", " ", "procedure", " ", "of", " ", "the", " ", "independent", 
     " ", "action", " ", "model"}], ",", " ", 
    RowBox[{
    "we", " ", "take", " ", "the", " ", "average", " ", "of", " ", "many", 
     " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionSimulation", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", 
        " ", "randomization", " ", "that", " ", "produces", " ", "Spearman", 
        " ", "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ",
         "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"amountofrankrandomization", "=", "17400"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}],
              "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}],
              "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
           "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], 
          ",", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumberOfIndependentActionSimulations", "=", "20"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReplicateIndependentActionSimulations", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IndependentActionSimulation", "[", "]"}], ",", 
         RowBox[{"{", "NumberOfIndependentActionSimulations", "}"}]}], "]"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "final", " ", "model", " ", "is", " ", "the", " ", "population"}], "-", 
     RowBox[{
     "normalized", " ", "average", " ", "of", " ", "many", " ", "replicate", 
      " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndependentActionModel", "=", 
     RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
      RowBox[{
      "ReplicateIndependentActionSimulations", ",", "LongestTime", ",", 
       "TrialPopulationSize"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
     "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
     RowBox[{"(", 
      RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
     " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
     " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"IndependentActionModelLikelihood", "=", 
    RowBox[{"KolmogorovSmirnovTest", "[", 
     RowBox[{
     "ObservedDistribution", ",", "IndependentActionModel", ",", 
      "\"\<PValue\>\""}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704380310986127*^9, 3.70438035351256*^9}, {
   3.7043808394793553`*^9, 3.7043808719832144`*^9}, {3.704549367919421*^9, 
   3.704549410839876*^9}, {3.7045494549553995`*^9, 3.7045495430564384`*^9}, {
   3.70454959045815*^9, 3.704549613089444*^9}, {3.7045496637053394`*^9, 
   3.7045496646893954`*^9}, {3.7045497077138567`*^9, 3.704549723096736*^9}, {
   3.704549803136314*^9, 3.7045498661379175`*^9}, {3.704550006481945*^9, 
   3.7045500205307484`*^9}, {3.7045503106013393`*^9, 3.704550342768179*^9}, {
   3.7045503883467865`*^9, 3.704550390176891*^9}, 3.7045522985230417`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Tabulating", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ",
      "observed", " ", "combination", " ", "drug", " ", "response", " ", 
     "would", " ", "be", " ", "observed", " ", "if", " ", "the", " ", "true", 
     " ", "distribution", " ", "were", " ", "one", " ", "of", " ", "the", " ",
      "various", " ", "models"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"order", ":", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"independent", " ", "drug", " ", "action"}], ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "horizontal", " ", "parameter"}],
         ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "vertical", " ", "parameter"}], 
        ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "two", " ", "parameters"}]}], 
       " ", "}"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"BreastCancerModelLikelihoods", "=", 
   RowBox[{"{", 
    RowBox[{
    "IndependentActionModelLikelihood", ",", 
     "BestLikelihoodWithHorizontalParameter", ",", 
     "BestLikelihoodWithVerticalParameter", ",", 
     "BestLikelihoodWithTwoParameterFit"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.704380296464297*^9, 3.704380308921009*^9}, {
   3.7043803605989647`*^9, 3.7043804465438805`*^9}, {3.70438088886318*^9, 
   3.704380980143401*^9}, {3.7043819476307383`*^9, 3.704381961183513*^9}, {
   3.704382285600069*^9, 3.7043822927444773`*^9}, 3.716127662679491*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["plotting model fits", "Subsection",
 CellChangeTimes->{{3.7045335958673115`*^9, 3.7045336044888043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximumOfMonotherapyResponsesModel", "=", 
   RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
    RowBox[{
    "MaximumOfMonotherapyResponses", ",", "LongestTime", ",", 
     "TrialPopulationSize"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7045332975502486`*^9, 3.7045333014874735`*^9}, 
   3.704533346316038*^9, {3.7045333841182003`*^9, 3.7045333933027253`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestHorizontalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyHorizontalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestHorizontalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"BestHorizontalSynergyParameter", ",", "0"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestHorizontalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<BreastCancerTrastuzumabChemotherapyBestHorizontalSynergy.pdf\>\""}],
     ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318972951584`*^9, 3.704531962684899*^9}, {
   3.70453199750289*^9, 3.704532132143591*^9}, {3.7045321737649717`*^9, 
   3.7045322964879913`*^9}, {3.7045323746424613`*^9, 3.7045323753155*^9}, {
   3.704533375263694*^9, 3.704533413559884*^9}, {3.704533705256568*^9, 
   3.7045337125749865`*^9}, 3.7161260447449503`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestVerticalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestVerticalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"0", ",", "BestVerticalSynergyParameter"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestVerticalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<BreastCancerTrastuzumabChemotherapyBestVerticalSynergy.pdf\>\""}], 
    ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532504895911*^9, 3.704532506584008*^9}, 
   3.70453342765669*^9, {3.7045334751834087`*^9, 3.7045334813837633`*^9}, 
   3.704533736958381*^9, 3.7161260447579513`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestTwoParameterSynergyParameters", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"SynergyModelTwoParameterFits", ",", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestTwoParameterSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], "]"}], ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestTwoParameterSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<BreastCancerTrastuzumabChemotherapyBestTwoParameterSynergy.pdf\>\""}\
], ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, 3.7045326817550273`*^9, 
   3.704533431520911*^9, {3.704533491519343*^9, 3.704533491896364*^9}, {
   3.7045335282314425`*^9, 3.7045335291784973`*^9}, 3.7045337397975435`*^9, 
   3.7161260447659516`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "IndependentActionModel", "]"}],
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<BreastCancerTrastuzumabChemotherapyIndependentModel.pdf\>\""}], ",",
     "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, {3.7045326817550273`*^9, 
   3.704532743454556*^9}, {3.7045332534247246`*^9, 3.704533255279831*^9}, 
   3.7045334337040358`*^9, {3.7045335562110434`*^9, 3.704533578090295*^9}, 
   3.704533744349804*^9, {3.7045504224497366`*^9, 3.7045504252248955`*^9}, 
   3.716126044769952*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 4C - Advanced pancreatic cancer\n",
 StyleBox["Near-identical code as for Figure 4A is here employed to generate \
Figure 4C. Comments will be more brief.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6913349412163115`*^9, 3.691334947328661*^9}, {
  3.6913350087441735`*^9, 3.69133509102588*^9}, {3.6913371794183292`*^9, 
  3.6913371948222103`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure4CRawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "5", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "fifth", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet"}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.691335120807583*^9, 
  3.691335121159603*^9}, {3.691335153027426*^9, 3.6913351618209295`*^9}, {
  3.6913373428176746`*^9, 3.6913373574995146`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Therapy1SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4CRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "gemcitabine"}],
        "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy2SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4CRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "erlotinib"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4CRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "the", " ", 
        "combination"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6913351250408254`*^9, 
  3.6913351370215106`*^9}, {3.691335177937851*^9, 3.691335183565173*^9}, {
  3.6913373331711235`*^9, 3.69133736336185*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"within", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"resample", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{"need", " ", "to", " ", "sub"}], "-", 
      RowBox[{
      "sample", " ", "the", " ", "erlotinib", " ", "distribution", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "more", " ", "vertical", " ", "pixels", " ", "than", " ", "the", " ",
           "gemcitabine", " ", "distribution"}], ")"}], ".", " ", "The"}], 
       " ", "number", " ", "of", " ", "pixels", " ", "is", " ", "vastly", " ",
        "in", " ", "excess", " ", "of", " ", "the", " ", "number", " ", "of", 
       " ", "patients", " ", "so", " ", "no", " ", "individual", " ", 
       RowBox[{"patient", "'"}], "s", " ", "information", " ", "is", " ", 
       RowBox[{"lost", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Therapy2SurvivalDistribution", ",", 
            RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
  3.6913353590842123`*^9}, {3.6913373740764627`*^9, 3.6913373806838408`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "28000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyGkog3EAx/FFspQ7M0dC2pAoL+Yq+b9hZCw51izkCJnN0WxNQiRKypWs
XG+UY4taWcIiVwshIpSrUA9yJfc8v+fFt099AwqVGSU2LBbLnw6KtcXeCUKK
VPRz+PDWnCiEw46hItj+eyOF1t4EGdRVO8/BSAHPBDOnJQvQdLG8CA9anjcg
T/DNKNhL3oZPqjZG+e7gSl06RfQxnWuwdSjuDzYEJlshbynVTk2rsaQx/uxI
XKDIfscNzvHuPKE825XL/IyTePh+yifQeqRNgRJiYrwrfQy5pt3XWsJginhV
6iKmSN/Ypgx+5X2WQo59dxkc7fFRwHhFmxqynLit8MNO1wGbyxxeXWnDQjwY
q4QRSVO5FHkzPmTBqqm3fKj5PCyCvtxIBdQ3OiqhH79S/lVDka48XSX0i+6u
gZvjObXQ4m6rgbEDynrIbjA2wpH59SZoPC8wPKso0qkKmoVR5y/lP7Th7FdG
jmjmbKKJIsEycgkNavk9ZEu3H+Dqlvl4ktbr6YrxH50YAOo=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "28000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4DoZWnWeZ+AdNyidQUgOuLxl8w/QHrXZwh9xvP9u5UN
rx2lnHM/gGiNmAnfQPTVvh9g+o2d/a1VQPrimTQwDQBso51Z
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy1SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "100000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyGtIU2EAh/FDMYzB1BXZcDLIamMhCUOGFxh7v9SUzDGsxjYsynDiLl6Y
jsmY1RCLFbga0aAsAqFsg2CwEd2UWuNAY2UiNMhASOFQKBvDeZvn//rh4QfP
8WtOw40DDMPU8kG9p7taq+NIX6hKAVc+ntXBp6LT7XBi568Jlh5oLTA8UBGH
KrU8ATtfG9/BxJ/Z9/Dn7fWvUK7eoqq/t36Da65xqi3zeG64gyORpsAX6H/S
sgu9ta0lKP9wXjDC62YvULfTxkrYXpY+DOPy1WPQdkksod/wSwMLWQWBpUVP
GzSSBHW1579ymfeHh62DbfrPpko9Rx4+T1ngZlexB1aVTVrhs6DUATWO8RHI
lEv8cEMQvgNvWoU5MW+d8ii1X1d/bsbMkXzs30XYP5O/At3FheuwRqJywIhP
5IQyhd22OciR+11hO5Q1Tg7C1PTlIcgeOeiGzY+co/CQN+aDU2+TYzC2dDW6
7uJIwHXyDTQE/Un4KdjAQtO9Qu82793QvtNax87LMY5EkznmFa+UFb6AttQJ
6plTmSS8lZ2nmifSWRgT/abuATinFA8=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "100000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIT/my9BmIZrG/BqYBS3Wl
4g==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy1SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
  3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
  3.691337277744953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "16300"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0FtIU3EAx/GDJVbgbdIaagOjNiaCMGJsU4bnZc2RNUaXZWKSjU3azcl0
TESjIYbT2EyiQa1eIpoWwcBRqSl5YdgoNYIiCiKdHJKWQzdnzvP7+/DjA7/H
b9l1q1afRVHUKXZQ47pRXKNi6JvDXCFcnVSq4KPc8jrY93+lHmaGahqgvzV/
DIolgjC8MKJ7C8M/p8bh8u34HBRI0kTJp9oP8K+jl2j6+GC6/TxDj8o8M9D9
sGoXdp2ozUDBxNnsDlZn5BxxJ6orgHU5UQ4cE8SOQdOlQh75tV8VcPObkIaZ
Ly411NFhYsywLvrFuuiKVEC15n19gYah7z2Zb4DbjSkD5OZ4jfCxr8QCFZbe
Dkjl8dwwme2/A28Zj2wUslaIjhJtqsozwasMnQj9uQhtwcQ16Ex9boalPLEF
jnbnWiFfaDZt2xl6sNFvhnyp1w7nn15ug5GiA04ov2/thIe6Qt0w8Hq2B4Z+
NL2IOxja4zj5Cmp97ln4znc6AuULw0tQFH9DTM4c/g5HOGbiciDVssN68Nm+
E8G1vuc9bI/SLSJ1nHsXDlzRE9NL/ABsWlAS/72UzcHoYjVRKlP/hsqWfuIe
MxowAg==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "16300"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}, {3.6913375351756773`*^9, 
   3.691337536029726*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy2SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "vertical", " ", "offset"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", "0.55"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "simulated", "*)"}], 
   RowBox[{
    RowBox[{"slo", "=", 
     RowBox[{"-", "0.03"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lho", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy2SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "ComboSurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "13"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "12.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"18", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.07", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<3.5\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.7", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<1.6\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<3.7\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.7"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<3.8\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.35"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "0.8"}], ",", 
            RowBox[{"0.1", "-", "0.03", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.6"}], ",", 
            RowBox[{"0.1", "+", "0.03", "+", "lo", "+", "slo"}]}], "}"}]}], 
         "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Gemcitabine\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Erlotinib\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 4C.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9, {
   3.6913370241064453`*^9, 3.6913371276353674`*^9}, {3.69133732349457*^9, 
   3.69133732367258*^9}, {3.6913376565896215`*^9, 3.6913376949968185`*^9}, 
   3.7161260447759523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "12"}], 
   RowBox[{"(*", " ", "months", " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "SubSampledBestOfMidCorrelatedMonoPairs", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "ComboSurvivalDistribution", ",", "PatientsPerArmOfSimulatedTrial"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probability at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
   3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
   3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
   3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
   3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}, 
   3.7161255952602415`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"PancreaticCancerHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}, {3.704208905403695*^9, 3.704208908317862*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparison of Independent Drug Action with Synergy models by Akaike \
Information Criterion (AIC)\
\>", "Section",
 CellChangeTimes->{{3.7043711029084554`*^9, 3.70437111295003*^9}, {
  3.704380475085513*^9, 3.704380499638918*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"first", ",", " ", 
    RowBox[{
    "we", " ", "compute", " ", "a", " ", "survival", " ", "distribution", " ",
      "based", " ", "on", " ", "the", " ", "monotherapy", " ", 
     "distributions", " ", "assuming", " ", "no", " ", "synergy"}], ",", " ", 
    RowBox[{
    "and", " ", "perfect", " ", "correlation", " ", "in", " ", "response", 
     " ", "between", " ", 
     RowBox[{"drugs", ".", " ", "Therefore"}], " ", "at", " ", "each", " ", 
     "time", " ", "point"}], ",", " ", 
    RowBox[{
     RowBox[{
     "PFS", " ", "is", " ", "the", " ", "higher", " ", "of", " ", "the", " ", 
      "single"}], "-", 
     RowBox[{"drug", " ", "PFS", " ", "rates", " ", "at", " ", "that", " ", 
      RowBox[{"time", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Max", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sort", "[", "ReSampledTherapy1SurvivalDistribution", "]"}],
           ",", 
          RowBox[{
          "Sort", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
         "}"}], "\[Transpose]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Sort", "[", "MaximumOfMonotherapyResponses", "]"}], "]"}], 
       ",", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.70437116068976*^9, 3.7043711781427584`*^9}, {
  3.7043713179347544`*^9, 3.704371322535017*^9}, {3.7043715470068564`*^9, 
  3.704371589078263*^9}, {3.704371724639016*^9, 3.704371728007209*^9}, {
  3.704378697255827*^9, 3.704378723832347*^9}, {3.704380511279584*^9, 
  3.704380601831763*^9}, {3.7043810488253293`*^9, 3.704381050512426*^9}, {
  3.704533346426044*^9, 3.7045333464290447`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Maximum", " ", "time"}], ",", " ", 
    RowBox[{"in", " ", "months"}], ",", " ", 
    RowBox[{
    "over", " ", "which", " ", "to", " ", "compare", " ", "survival", " ", 
     "distributions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LongestTime", "=", "12"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.704371741400975*^9, 3.704371803535529*^9}, {
  3.7043720439182777`*^9, 3.7043720686466923`*^9}, {3.7043787247994027`*^9, 
  3.7043787498548355`*^9}, {3.7043806086641536`*^9, 3.7043806338065915`*^9}, {
  3.7043824491274223`*^9, 3.704382449231428*^9}}],

Cell[CellGroupData[{

Cell["\<\
A \[OpenCurlyQuote]synergy-fitting\[CloseCurlyQuote] model is created by \
defining two adjustable parameters:
a vertical scaling, which affects a fractional decrease in progression \
probability at each time
a horizontal scaling, which affects a fractional extension in duration of \
progression-free survival for all patients

SynergyModel[0,0] has no synergistic effect.
SynergyModel[X,0] has, for each patient, +X*100% longer PFS time. E.g. in \
SynergyModel[0.5, 0], all patients have +50% longer PFS.
SynergyModel[0,Y] has, at each time point, a 1/Y probability of progression. \
E.g. in SynergyModel[0, 1], at each time the progression rate is halved.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7043714031986313`*^9, 3.7043714851893206`*^9}, {
  3.7043787620225315`*^9, 3.704378762374552*^9}, {3.7043793812069473`*^9, 
  3.70437943773518*^9}, {3.7043806566869*^9, 3.7043806969352026`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SynergyModel", "[", 
   RowBox[{"HorizontalScaling_", ",", "VerticalScaling_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "HorizontalScaling"}], ")"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"LongestTime", ",", 
      RowBox[{"{", 
       RowBox[{"VerticalScaling", "*", 
        RowBox[{"Length", "[", "MaximumOfMonotherapyResponses", "]"}]}], 
       "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.704372031151548*^9, 3.704372038717981*^9}, {
   3.704372093902137*^9, 3.704372137942656*^9}, {3.7043721988711405`*^9, 
   3.7043722473669147`*^9}, {3.7043723375350723`*^9, 
   3.7043723481906815`*^9}, {3.7043723975975075`*^9, 3.7043724429271*^9}, {
   3.7043724942550364`*^9, 3.7043726163020163`*^9}, 3.704378761031475*^9, {
   3.7043794409433637`*^9, 3.7043794500318837`*^9}, {3.704533346437045*^9, 
   3.7045333464380445`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"for", " ", "Kolmorogov"}], "-", 
     RowBox[{
     "Smirnov", " ", "test", " ", "to", " ", "be", " ", "comparable", " ", 
      "across", " ", "data", " ", "sets", " ", "and", " ", "model", " ", 
      "types"}]}], ",", " ", 
    RowBox[{
    "the", " ", "population", " ", "size", " ", "that", " ", "comprises", " ",
      "each", " ", "survival", " ", "distribution", " ", "is", " ", 
     "normalized", " ", "to", " ", "a", " ", "consistent", " ", 
     RowBox[{"value", ".", " ", "This"}], " ", "does", " ", "not", " ", 
     "change", " ", "the", " ", "distribution", " ", "shape", " ", "except", 
     " ", "for", " ", "insignificant", " ", "rounding", " ", 
     RowBox[{"differences", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TrialPopulationSize", "=", "200"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "survivaldistribution_", ",", "LongestTime_", ",", "PopulationSize_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalDistributionWithMaximumTime", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"LongestTime", ",", "#"}], "}"}], "]"}], "&"}], ",", 
           "survivaldistribution"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SurvivalDistributionWithDefinedPopulationSize", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{"SurvivalDistributionWithMaximumTime", ",", 
             RowBox[{"{", "PopulationSize", "}"}]}], "]"}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", 
          RowBox[{
          "Length", "[", "SurvivalDistributionWithMaximumTime", "]"}]}], 
         "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043734358438916`*^9, 3.704373550262436*^9}, {
   3.7043738010417795`*^9, 3.70437384073405*^9}, {3.7043739047527113`*^9, 
   3.7043739049997263`*^9}, 3.704379791719427*^9, {3.704380130446801*^9, 
   3.7043802453673744`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "observed", " ", "data"}], ";", " ", 
    RowBox[{
    "set", " ", "to", " ", "consistent", " ", "population", " ", "size", " ", 
     "and", " ", "capped", " ", "with", " ", "a", " ", "consistent", " ", 
     "maximum", " ", "survival", " ", "time"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ObservedDistribution", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "ComboSurvivalDistribution", ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7043741526488905`*^9, 3.7043741703599033`*^9}, {
   3.7043807153752575`*^9, 3.70438074951221*^9}, 3.7043812846478176`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "horizontal", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.3"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "0"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "Steps"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithHorizontalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{
     "SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704379488746098*^9, 3.7043795311195216`*^9}, {
  3.70437968075208*^9, 3.704379707304599*^9}, {3.7043807545124955`*^9, 
  3.7043808135208707`*^9}, {3.7043813924169817`*^9, 3.7043813925189877`*^9}, {
  3.704381658680211*^9, 3.7043816587832165`*^9}, {3.704382462704199*^9, 
  3.704382464791318*^9}, {3.704382501176399*^9, 3.7043825012714043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043824822853184`*^9, 3.7043825489501314`*^9}, {
  3.704382619695178*^9, 3.704382643976567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "vertical", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.2"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"0", ",", "VerticalScaling"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "Steps"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithVerticalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043795383919373`*^9, 3.704379558304076*^9}, {
  3.704379658102784*^9, 3.704379676542839*^9}, {3.7043797161021023`*^9, 
  3.704379745456781*^9}, {3.7043808179211226`*^9, 3.7043808213913207`*^9}, {
  3.704382471342693*^9, 3.7043824714076967`*^9}, {3.7043826551592064`*^9, 
  3.704382655286214*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7043826610715446`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{"using", " ", "two", " ", "parameters"}], ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.3"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.2"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StepsPerParameter", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", "VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "VerticalScaling"}], "]"}], 
             ",", "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "StepsPerParameter"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "StepsPerParameter"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
    " ", 
   RowBox[{"BestLikelihoodWithTwoParameterFit", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043739959649286`*^9, 3.7043740011432247`*^9}, {
  3.7043740342081165`*^9, 3.7043740722872944`*^9}, {3.7043741137046633`*^9, 
  3.704374126255381*^9}, {3.7043741669857106`*^9, 3.7043741691348333`*^9}, {
  3.7043743037685337`*^9, 3.7043744065914154`*^9}, {3.7043746382406645`*^9, 
  3.7043746388807015`*^9}, {3.7043747047754707`*^9, 3.704374706456567*^9}, {
  3.704377713519561*^9, 3.7043777172077713`*^9}, {3.7043784069112206`*^9, 
  3.704378427272385*^9}, {3.704379847560621*^9, 3.704379981744296*^9}, {
  3.704380827784686*^9, 3.7043808347840867`*^9}, {3.7043817220628366`*^9, 
  3.704381722159842*^9}, {3.7043817950160093`*^9, 3.7043817964000883`*^9}, {
  3.704382473934841*^9, 3.7043824748548937`*^9}, {3.7043826910242577`*^9, 
  3.704382694143436*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameters", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043818001673036`*^9, 3.7043818094148326`*^9}, {
  3.7043819032311983`*^9, 3.7043819250144444`*^9}, {3.7043821556226344`*^9, 
  3.70438215571064*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
    "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
    RowBox[{"(", 
     RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
    " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
    " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "To", " ", "minimize", " ", "noise", " ", "from", " ", "the", " ", 
     "sampling", " ", "procedure", " ", "of", " ", "the", " ", "independent", 
     " ", "action", " ", "model"}], ",", " ", 
    RowBox[{
    "we", " ", "take", " ", "the", " ", "average", " ", "of", " ", "many", 
     " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionSimulation", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", 
        " ", "randomization", " ", "that", " ", "produces", " ", "Spearman", 
        " ", "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ",
         "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"amountofrankrandomization", "=", "28000"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}],
              "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}],
              "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
           "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], 
          ",", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumberOfIndependentActionSimulations", "=", "20"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReplicateIndependentActionSimulations", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IndependentActionSimulation", "[", "]"}], ",", 
         RowBox[{"{", "NumberOfIndependentActionSimulations", "}"}]}], "]"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "final", " ", "model", " ", "is", " ", "the", " ", "population"}], "-", 
     RowBox[{
     "normalized", " ", "average", " ", "of", " ", "many", " ", "replicate", 
      " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndependentActionModel", "=", 
     RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
      RowBox[{
      "ReplicateIndependentActionSimulations", ",", "LongestTime", ",", 
       "TrialPopulationSize"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
     "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
     RowBox[{"(", 
      RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
     " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
     " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"IndependentActionModelLikelihood", "=", 
    RowBox[{"KolmogorovSmirnovTest", "[", 
     RowBox[{
     "ObservedDistribution", ",", "IndependentActionModel", ",", 
      "\"\<PValue\>\""}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704380310986127*^9, 3.70438035351256*^9}, {
   3.7043808394793553`*^9, 3.7043808719832144`*^9}, {3.704549367919421*^9, 
   3.704549410839876*^9}, {3.7045494549553995`*^9, 3.7045495430564384`*^9}, {
   3.70454959045815*^9, 3.704549613089444*^9}, {3.7045496637053394`*^9, 
   3.7045496646893954`*^9}, {3.7045497077138567`*^9, 3.704549723096736*^9}, {
   3.704549803136314*^9, 3.7045498661379175`*^9}, {3.704550006481945*^9, 
   3.7045500205307484`*^9}, {3.7045503106013393`*^9, 3.704550342768179*^9}, {
   3.7045503883467865`*^9, 3.704550390176891*^9}, 3.7045515753156767`*^9, 
   3.7045522886034746`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Tabulating", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ",
      "observed", " ", "combination", " ", "drug", " ", "response", " ", 
     "would", " ", "be", " ", "observed", " ", "if", " ", "the", " ", "true", 
     " ", "distribution", " ", "were", " ", "one", " ", "of", " ", "the", " ",
      "various", " ", "models"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"order", ":", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"independent", " ", "drug", " ", "action"}], ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "horizontal", " ", "parameter"}],
         ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "vertical", " ", "parameter"}], 
        ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "two", " ", "parameters"}]}], 
       " ", "}"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"PancreaticCancerModelLikelihoods", "=", 
   RowBox[{"{", 
    RowBox[{
    "IndependentActionModelLikelihood", ",", 
     "BestLikelihoodWithHorizontalParameter", ",", 
     "BestLikelihoodWithVerticalParameter", ",", 
     "BestLikelihoodWithTwoParameterFit"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.704380296464297*^9, 3.704380308921009*^9}, {
   3.7043803605989647`*^9, 3.7043804465438805`*^9}, {3.70438088886318*^9, 
   3.704380980143401*^9}, {3.7043819476307383`*^9, 3.704381961183513*^9}, {
   3.704382285600069*^9, 3.7043822927444773`*^9}, {3.704382400504641*^9, 
   3.704382401943723*^9}, 3.7161276626994925`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["plotting model fits", "Subsection",
 CellChangeTimes->{{3.7045335958673115`*^9, 3.7045336044888043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximumOfMonotherapyResponsesModel", "=", 
   RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
    RowBox[{
    "MaximumOfMonotherapyResponses", ",", "LongestTime", ",", 
     "TrialPopulationSize"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7045332975502486`*^9, 3.7045333014874735`*^9}, 
   3.704533346316038*^9, {3.7045333841182003`*^9, 3.7045333933027253`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestHorizontalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyHorizontalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestHorizontalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"BestHorizontalSynergyParameter", ",", "0"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestHorizontalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<PancreaticCancerErlotinibGemcitabineBestHorizontalSynergy.pdf\>\""}]\
, ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318972951584`*^9, 3.704531962684899*^9}, {
   3.70453199750289*^9, 3.704532132143591*^9}, {3.7045321737649717`*^9, 
   3.7045322964879913`*^9}, {3.7045323746424613`*^9, 3.7045323753155*^9}, {
   3.704533375263694*^9, 3.704533413559884*^9}, {3.704533705256568*^9, 
   3.7045337125749865`*^9}, 3.7045344846621475`*^9, 3.7161260447839527`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestVerticalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestVerticalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"0", ",", "BestVerticalSynergyParameter"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestVerticalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<PancreaticCancerErlotinibGemcitabineBestVerticalSynergy.pdf\>\""}], 
    ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532504895911*^9, 3.704532506584008*^9}, 
   3.70453342765669*^9, {3.7045334751834087`*^9, 3.7045334813837633`*^9}, 
   3.704533736958381*^9, 3.704534487061285*^9, 3.7161260447959538`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestTwoParameterSynergyParameters", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"SynergyModelTwoParameterFits", ",", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestTwoParameterSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], "]"}], ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestTwoParameterSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<PancreaticCancerErlotinibGemcitabineBestTwoParameterSynergy.pdf\>\"\
"}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, 3.7045326817550273`*^9, 
   3.704533431520911*^9, {3.704533491519343*^9, 3.704533491896364*^9}, {
   3.7045335282314425`*^9, 3.7045335291784973`*^9}, 3.7045337397975435`*^9, 
   3.704534488917391*^9, 3.716126044804954*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "IndependentActionModel", "]"}],
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<PancreaticCancerErlotinibGemcitabineIndependentModel.pdf\>\""}], 
    ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, {3.7045326817550273`*^9, 
   3.704532743454556*^9}, {3.7045332534247246`*^9, 3.704533255279831*^9}, 
   3.7045334337040358`*^9, {3.7045335562110434`*^9, 3.704533578090295*^9}, 
   3.704533744349804*^9, 3.704534490940507*^9, {3.7045515891134663`*^9, 
   3.704551591185585*^9}, 3.716126044807954*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 4D - BRAF-mutant metastatic melanoma\n",
 StyleBox["Near-identical code as for Figure 4A is here employed to generate \
Figure 4D. Comments will be more brief.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6913349412163115`*^9, 3.691334947328661*^9}, {
  3.6913350087441735`*^9, 3.69133509102588*^9}, {3.6913371794183292`*^9, 
  3.6913371948222103`*^9}, {3.691337767326956*^9, 3.6913377848789597`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure4DRawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "6", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "sixth", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet"}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.691335120807583*^9, 
  3.691335121159603*^9}, {3.691335153027426*^9, 3.6913351618209295`*^9}, {
  3.6913373428176746`*^9, 3.6913373574995146`*^9}, {3.6913377883631587`*^9, 
  3.6913377939564786`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Therapy1SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4DRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "dabrafenib"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy2SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4DRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "trametinib"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4DRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "the", " ", 
        "combination"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6913351250408254`*^9, 
  3.6913351370215106`*^9}, {3.691335177937851*^9, 3.691335183565173*^9}, {
  3.6913373331711235`*^9, 3.69133736336185*^9}, {3.6913377983627305`*^9, 
  3.691337808963337*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"within", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"resample", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{"need", " ", "to", " ", "sub"}], "-", 
      RowBox[{
      "sample", " ", "the", " ", "dabrafenib", " ", "distribution", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "more", " ", "vertical", " ", "pixels", " ", "than", " ", "the", " ",
           "trastuzumab", " ", "distribution"}], ")"}], ".", " ", "The"}], 
       " ", "number", " ", "of", " ", "pixels", " ", "is", " ", "vastly", " ",
        "in", " ", "excess", " ", "of", " ", "the", " ", "number", " ", "of", 
       " ", "patients", " ", "so", " ", "no", " ", "individual", " ", 
       RowBox[{"patient", "'"}], "s", " ", "information", " ", "is", " ", 
       RowBox[{"lost", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Therapy1SurvivalDistribution", ",", 
            RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
  3.6913353590842123`*^9}, {3.6913373740764627`*^9, 3.6913373806838408`*^9}, {
  3.691337831883648*^9, 3.6913378629224234`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "17500"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGBQBGIQHVCVIuXg8doxe6qYOoh+vt/NA0TP49XyBdEdf59F
gej/kx1iQPSsQv7tINrITG0HiA5ZE7EHRO94cHAviL7S/PE4iFYz+w2mzS56
ngXRH0rbwHTOhZmHyvxfO6617DkKolvmWv8D0bVKnv9BtNo+H9ZyIF1xyg9M
/zkXIQCifdnPCYHo7WovxEF0TpigBFg86JYdiP52W90RRP+/XuUFoiMcd4Dp
F+nvNB8D6UtVp3RAtFfAkSiBgNeOUxaeiAHRv+J+poNoMfaJGSB6wSTpPBBt
l9dWDqIZ+CRaQPQP1lmdILoxg+uzIJDW0RQF0wUe+u6ro187ftnyNhREF6z+
Eg+iK35eTQbRMhJGeSB6bT1vPoiWU8/N+VX02rEvblYuiJazmFgEok8sCy8G
0aeEmStAtNX0/GoQzVG7pR5Ez991rAFEb7mfsO5j6WvHnlKVjSDa/P6nzD9A
Wo/jM5gW891wZ2XDa0eNGMeHIHpdec4bEM0RdfYtiD5yZv+NVUBa8sMjMJ29
MFVsNZD+srQZTAMA83QJUg==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "17500"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4DoZWnWeZ+AdNyidQUgOuLxl8w/QHrXZwh9xvP9u5UN
rx2lnHM/gGiNmAnfQPTVvh9g+o2d/a1VQPrimTQwzabNI74aSHesMAbTAHKE
o9Y=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}, 
   3.691337966153328*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "63000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyG9IE2EAx/GjkIUwc0U2VISybhiiMGRogux5k5tkjVE2pliUsklzs8V0
LMSlQ1asYCuJBv0jEGxtEAw2Is3CznHQmJYIDlIQanAYiUNyTtf9nl58+cD3
xHWbvvcAwzDVYlDn6ilXawRyc6JMAX99PKeBz6Vn2qF376cRFh6pu2Dw1uEY
VKrYOLz01vABxtc+TcPvY5vzkFXtUlUL2q/wj2Ocakk9/Tx4USDhJt8X6HnW
vA+HT2oLkJ05XzQk6uQvUPNJQylslySPwBibOQ4tHTI5/fqVFridVhBYWHa1
QQOJUzOm3zXroosuvha26eaMpTqBPH6V6IK57h0TLJP4zfBloMIKW6zjQ5Ap
kXvg36LgPXjXXLwlE62tOUYd0NS3hjoFko1uXIYDoexV6NxZugEr5UorDI9I
bbBK0W/J2QXysDvYD6sa/XaYmLxyG/JHDzrh2Se2O/DQcHQEvnjPuWF09Vpk
0yEQn+PUO6gPeDg4G2jgofHBdl9e9P7EfyfV1r0pt0Ai3BbzRrSCL34NLYlq
at3pFAdH09+ond5kGkalP6i81y8Pic6Wx6j/AMRSHGI=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "63000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIT/my9BmIZrG/BqYn/Q5V
XA2klx3LBtMA9qqujA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
   3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
   3.691337277744953*^9}, 3.6913379775659804`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "10300"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0FtIk2EAxvGPUixB80BzqA2V+MZEKESG0xDfm7UNtTGyloqJKSrtYMZy
TESjIUZmOBVxkKsbEadFMHCUx/DEsOERwRCFqIwPxZWY8zS/5/Xi4QfP5T+x
1Kgpv8AwDMsPqi1lsdkKjjzuFIjh7zG5AvaEJefC5pNfBTDQnl0E7U+uDMFU
KeuGdwe0w9C9OTECl1/4ZiArPaJKF5Tf4K6piaqb7/767A5HBmUtU9D6NvMU
1icpA5AdzQmu5TV78qjHXm0EzA3xRsEhdisG6u5FCumvWcuC+9/FBAZWLSqo
JW7qVsWO5AfvosWTAlXqyYIINUc63s8WwcNifwUUhLRVwne2OAPMMjTVQiZc
aIUHwfaX8Hll6L9I3hTJVWq14sZtZyFH9lzb+bDaufcQmv0rj2C8MNUABxvC
jFAk1usOazjSWmzXQ1F6Ww2c7b3/FHqiL5phRpexDl6qdzVAx+fpRujaKPng
M3GkxXT9E9TYrNNw3JbmgRlznUtQ4vtCPZi6vA4HovTUZYe/6pg3qO/cUeef
5v5Gvkf8fypzTfAGvn5QTj1aEjlgyZyc+vejbAZ6F29R02Wqn1Be9YqqIfIE
J+/NMiX1DGoCNqc=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "10300"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}, {3.6913375351756773`*^9, 
   3.691337536029726*^9}, {3.6913380016593585`*^9, 3.691338001718362*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy2SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "vertical", " ", "offset"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "simulated", "*)"}], 
   RowBox[{
    RowBox[{"slo", "=", 
     RowBox[{"-", "0.03"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lho", "=", 
     RowBox[{"-", "0.3"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy2SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "ComboSurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "13"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "12.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"18", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median PFS:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.15", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<8.7\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.35", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<3.8\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<9.3\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.35"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<9.3\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.35"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "0.8"}], ",", 
            RowBox[{"0.1", "-", "0.03", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.6"}], ",", 
            RowBox[{"0.1", "+", "0.03", "+", "lo", "+", "slo"}]}], "}"}]}], 
         "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Dabrafenib\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Trametinib\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 4D.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9, {
   3.6913370241064453`*^9, 3.6913371276353674`*^9}, {3.69133732349457*^9, 
   3.69133732367258*^9}, {3.6913376565896215`*^9, 3.6913376949968185`*^9}, {
   3.6913377625116796`*^9, 3.6913377626866903`*^9}, {3.691338104164222*^9, 
   3.6913381171199627`*^9}, {3.6913381542350855`*^9, 
   3.6913381648576927`*^9}, {3.6913381979015827`*^9, 3.6913382016737986`*^9}, 
   3.7161260448149543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "12"}], 
   RowBox[{"(*", " ", "months", " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "SubSampledBestOfMidCorrelatedMonoPairs", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "ComboSurvivalDistribution", ",", "PatientsPerArmOfSimulatedTrial"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probability at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
   3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
   3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
   3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
   3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}, 
   3.7161255954662533`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"MelanomaKinaseHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}, {3.704209009812667*^9, 3.704209010630714*^9}, {
  3.7045348860871077`*^9, 3.70453488700016*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparison of Independent Drug Action with Synergy models by Akaike \
Information Criterion (AIC)\
\>", "Section",
 CellChangeTimes->{{3.7043711029084554`*^9, 3.70437111295003*^9}, {
  3.704380475085513*^9, 3.704380499638918*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"first", ",", " ", 
    RowBox[{
    "we", " ", "compute", " ", "a", " ", "survival", " ", "distribution", " ",
      "based", " ", "on", " ", "the", " ", "monotherapy", " ", 
     "distributions", " ", "assuming", " ", "no", " ", "synergy"}], ",", " ", 
    RowBox[{
    "and", " ", "perfect", " ", "correlation", " ", "in", " ", "response", 
     " ", "between", " ", 
     RowBox[{"drugs", ".", " ", "Therefore"}], " ", "at", " ", "each", " ", 
     "time", " ", "point"}], ",", " ", 
    RowBox[{
     RowBox[{
     "PFS", " ", "is", " ", "the", " ", "higher", " ", "of", " ", "the", " ", 
      "single"}], "-", 
     RowBox[{"drug", " ", "PFS", " ", "rates", " ", "at", " ", "that", " ", 
      RowBox[{"time", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Max", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sort", "[", "ReSampledTherapy1SurvivalDistribution", "]"}],
           ",", 
          RowBox[{
          "Sort", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
         "}"}], "\[Transpose]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Sort", "[", "MaximumOfMonotherapyResponses", "]"}], "]"}], 
       ",", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.70437116068976*^9, 3.7043711781427584`*^9}, {
  3.7043713179347544`*^9, 3.704371322535017*^9}, {3.7043715470068564`*^9, 
  3.704371589078263*^9}, {3.704371724639016*^9, 3.704371728007209*^9}, {
  3.704378697255827*^9, 3.704378723832347*^9}, {3.704380511279584*^9, 
  3.704380601831763*^9}, {3.7043810488253293`*^9, 3.704381050512426*^9}, {
  3.7045333464900475`*^9, 3.704533346496048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Maximum", " ", "time"}], ",", " ", 
    RowBox[{"in", " ", "months"}], ",", " ", 
    RowBox[{
    "over", " ", "which", " ", "to", " ", "compare", " ", "survival", " ", 
     "distributions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LongestTime", "=", "12"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.704371741400975*^9, 3.704371803535529*^9}, {
  3.7043720439182777`*^9, 3.7043720686466923`*^9}, {3.7043787247994027`*^9, 
  3.7043787498548355`*^9}, {3.7043806086641536`*^9, 3.7043806338065915`*^9}, {
  3.7043824491274223`*^9, 3.704382449231428*^9}}],

Cell[CellGroupData[{

Cell["\<\
A \[OpenCurlyQuote]synergy-fitting\[CloseCurlyQuote] model is created by \
defining two adjustable parameters:
a vertical scaling, which affects a fractional decrease in progression \
probability at each time
a horizontal scaling, which affects a fractional extension in duration of \
progression-free survival for all patients

SynergyModel[0,0] has no synergistic effect.
SynergyModel[X,0] has, for each patient, +X*100% longer PFS time. E.g. in \
SynergyModel[0.5, 0], all patients have +50% longer PFS.
SynergyModel[0,Y] has, at each time point, a 1/Y probability of progression. \
E.g. in SynergyModel[0, 1], at each time the progression rate is halved.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7043714031986313`*^9, 3.7043714851893206`*^9}, {
  3.7043787620225315`*^9, 3.704378762374552*^9}, {3.7043793812069473`*^9, 
  3.70437943773518*^9}, {3.7043806566869*^9, 3.7043806969352026`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SynergyModel", "[", 
   RowBox[{"HorizontalScaling_", ",", "VerticalScaling_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "HorizontalScaling"}], ")"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"LongestTime", ",", 
      RowBox[{"{", 
       RowBox[{"VerticalScaling", "*", 
        RowBox[{"Length", "[", "MaximumOfMonotherapyResponses", "]"}]}], 
       "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.704372031151548*^9, 3.704372038717981*^9}, {
   3.704372093902137*^9, 3.704372137942656*^9}, {3.7043721988711405`*^9, 
   3.7043722473669147`*^9}, {3.7043723375350723`*^9, 
   3.7043723481906815`*^9}, {3.7043723975975075`*^9, 3.7043724429271*^9}, {
   3.7043724942550364`*^9, 3.7043726163020163`*^9}, 3.704378761031475*^9, {
   3.7043794409433637`*^9, 3.7043794500318837`*^9}, {3.7045333465040483`*^9, 
   3.7045333465050488`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"for", " ", "Kolmorogov"}], "-", 
     RowBox[{
     "Smirnov", " ", "test", " ", "to", " ", "be", " ", "comparable", " ", 
      "across", " ", "data", " ", "sets", " ", "and", " ", "model", " ", 
      "types"}]}], ",", " ", 
    RowBox[{
    "the", " ", "population", " ", "size", " ", "that", " ", "comprises", " ",
      "each", " ", "survival", " ", "distribution", " ", "is", " ", 
     "normalized", " ", "to", " ", "a", " ", "consistent", " ", 
     RowBox[{"value", ".", " ", "This"}], " ", "does", " ", "not", " ", 
     "change", " ", "the", " ", "distribution", " ", "shape", " ", "except", 
     " ", "for", " ", "insignificant", " ", "rounding", " ", 
     RowBox[{"differences", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TrialPopulationSize", "=", "200"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "survivaldistribution_", ",", "LongestTime_", ",", "PopulationSize_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalDistributionWithMaximumTime", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"LongestTime", ",", "#"}], "}"}], "]"}], "&"}], ",", 
           "survivaldistribution"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SurvivalDistributionWithDefinedPopulationSize", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{"SurvivalDistributionWithMaximumTime", ",", 
             RowBox[{"{", "PopulationSize", "}"}]}], "]"}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", 
          RowBox[{
          "Length", "[", "SurvivalDistributionWithMaximumTime", "]"}]}], 
         "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043734358438916`*^9, 3.704373550262436*^9}, {
   3.7043738010417795`*^9, 3.70437384073405*^9}, {3.7043739047527113`*^9, 
   3.7043739049997263`*^9}, 3.704379791719427*^9, {3.704380130446801*^9, 
   3.7043802453673744`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "observed", " ", "data"}], ";", " ", 
    RowBox[{
    "set", " ", "to", " ", "consistent", " ", "population", " ", "size", " ", 
     "and", " ", "capped", " ", "with", " ", "a", " ", "consistent", " ", 
     "maximum", " ", "survival", " ", "time"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ObservedDistribution", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "ComboSurvivalDistribution", ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7043741526488905`*^9, 3.7043741703599033`*^9}, {
   3.7043807153752575`*^9, 3.70438074951221*^9}, 3.7043812846478176`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "horizontal", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.4"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "0"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "Steps"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithHorizontalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{
     "SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704379488746098*^9, 3.7043795311195216`*^9}, {
  3.70437968075208*^9, 3.704379707304599*^9}, {3.7043807545124955`*^9, 
  3.7043808135208707`*^9}, {3.7043813924169817`*^9, 3.7043813925189877`*^9}, {
  3.704381658680211*^9, 3.7043816587832165`*^9}, {3.704382462704199*^9, 
  3.704382464791318*^9}, {3.704382501176399*^9, 3.7043825012714043`*^9}, {
  3.7043832067837577`*^9, 3.7043832068557615`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043824822853184`*^9, 3.7043825489501314`*^9}, {
  3.704382619695178*^9, 3.704382643976567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "vertical", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.3"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"0", ",", "VerticalScaling"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "Steps"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithVerticalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043795383919373`*^9, 3.704379558304076*^9}, {
  3.704379658102784*^9, 3.704379676542839*^9}, {3.7043797161021023`*^9, 
  3.704379745456781*^9}, {3.7043808179211226`*^9, 3.7043808213913207`*^9}, {
  3.704382471342693*^9, 3.7043824714076967`*^9}, {3.7043826551592064`*^9, 
  3.704382655286214*^9}, {3.7043832129911127`*^9, 3.7043832131021185`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7043826610715446`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{"using", " ", "two", " ", "parameters"}], ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.4"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.3"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StepsPerParameter", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", "VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "VerticalScaling"}], "]"}], 
             ",", "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "StepsPerParameter"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "StepsPerParameter"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
    " ", 
   RowBox[{"BestLikelihoodWithTwoParameterFit", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043739959649286`*^9, 3.7043740011432247`*^9}, {
  3.7043740342081165`*^9, 3.7043740722872944`*^9}, {3.7043741137046633`*^9, 
  3.704374126255381*^9}, {3.7043741669857106`*^9, 3.7043741691348333`*^9}, {
  3.7043743037685337`*^9, 3.7043744065914154`*^9}, {3.7043746382406645`*^9, 
  3.7043746388807015`*^9}, {3.7043747047754707`*^9, 3.704374706456567*^9}, {
  3.704377713519561*^9, 3.7043777172077713`*^9}, {3.7043784069112206`*^9, 
  3.704378427272385*^9}, {3.704379847560621*^9, 3.704379981744296*^9}, {
  3.704380827784686*^9, 3.7043808347840867`*^9}, {3.7043817220628366`*^9, 
  3.704381722159842*^9}, {3.7043817950160093`*^9, 3.7043817964000883`*^9}, {
  3.704382473934841*^9, 3.7043824748548937`*^9}, {3.7043826910242577`*^9, 
  3.704382694143436*^9}, {3.704383218414423*^9, 3.7043832191994677`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameters", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043818001673036`*^9, 3.7043818094148326`*^9}, {
  3.7043819032311983`*^9, 3.7043819250144444`*^9}, {3.7043821556226344`*^9, 
  3.70438215571064*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
    "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
    RowBox[{"(", 
     RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
    " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
    " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "To", " ", "minimize", " ", "noise", " ", "from", " ", "the", " ", 
     "sampling", " ", "procedure", " ", "of", " ", "the", " ", "independent", 
     " ", "action", " ", "model"}], ",", " ", 
    RowBox[{
    "we", " ", "take", " ", "the", " ", "average", " ", "of", " ", "many", 
     " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionSimulation", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", 
        " ", "randomization", " ", "that", " ", "produces", " ", "Spearman", 
        " ", "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ",
         "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"amountofrankrandomization", "=", "17500"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}],
              "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}],
              "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
           "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], 
          ",", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumberOfIndependentActionSimulations", "=", "20"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReplicateIndependentActionSimulations", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IndependentActionSimulation", "[", "]"}], ",", 
         RowBox[{"{", "NumberOfIndependentActionSimulations", "}"}]}], "]"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "final", " ", "model", " ", "is", " ", "the", " ", "population"}], "-", 
     RowBox[{
     "normalized", " ", "average", " ", "of", " ", "many", " ", "replicate", 
      " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndependentActionModel", "=", 
     RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
      RowBox[{
      "ReplicateIndependentActionSimulations", ",", "LongestTime", ",", 
       "TrialPopulationSize"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
     "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
     RowBox[{"(", 
      RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
     " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
     " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"IndependentActionModelLikelihood", "=", 
    RowBox[{"KolmogorovSmirnovTest", "[", 
     RowBox[{
     "ObservedDistribution", ",", "IndependentActionModel", ",", 
      "\"\<PValue\>\""}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704380310986127*^9, 3.70438035351256*^9}, {
   3.7043808394793553`*^9, 3.7043808719832144`*^9}, {3.704549367919421*^9, 
   3.704549410839876*^9}, {3.7045494549553995`*^9, 3.7045495430564384`*^9}, {
   3.70454959045815*^9, 3.704549613089444*^9}, {3.7045496637053394`*^9, 
   3.7045496646893954`*^9}, {3.7045497077138567`*^9, 3.704549723096736*^9}, {
   3.704549803136314*^9, 3.7045498661379175`*^9}, {3.704550006481945*^9, 
   3.7045500205307484`*^9}, {3.7045503106013393`*^9, 3.704550342768179*^9}, {
   3.7045503883467865`*^9, 3.704550390176891*^9}, 3.7045515753156767`*^9, {
   3.7045519657600093`*^9, 3.7045519672410936`*^9}, 3.7045522682323093`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Tabulating", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ",
      "observed", " ", "combination", " ", "drug", " ", "response", " ", 
     "would", " ", "be", " ", "observed", " ", "if", " ", "the", " ", "true", 
     " ", "distribution", " ", "were", " ", "one", " ", "of", " ", "the", " ",
      "various", " ", "models"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"order", ":", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"independent", " ", "drug", " ", "action"}], ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "horizontal", " ", "parameter"}],
         ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "vertical", " ", "parameter"}], 
        ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "two", " ", "parameters"}]}], 
       " ", "}"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MelanomaKinaseModelLikelihoods", "=", 
   RowBox[{"{", 
    RowBox[{
    "IndependentActionModelLikelihood", ",", 
     "BestLikelihoodWithHorizontalParameter", ",", 
     "BestLikelihoodWithVerticalParameter", ",", 
     "BestLikelihoodWithTwoParameterFit"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.704380296464297*^9, 3.704380308921009*^9}, {
   3.7043803605989647`*^9, 3.7043804465438805`*^9}, {3.70438088886318*^9, 
   3.704380980143401*^9}, {3.7043819476307383`*^9, 3.704381961183513*^9}, {
   3.704382285600069*^9, 3.7043822927444773`*^9}, {3.704382400504641*^9, 
   3.704382401943723*^9}, {3.7043831758559885`*^9, 3.704383181791328*^9}, 
   3.7161276588552723`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["plotting model fits", "Subsection",
 CellChangeTimes->{{3.7045335958673115`*^9, 3.7045336044888043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximumOfMonotherapyResponsesModel", "=", 
   RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
    RowBox[{
    "MaximumOfMonotherapyResponses", ",", "LongestTime", ",", 
     "TrialPopulationSize"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7045332975502486`*^9, 3.7045333014874735`*^9}, 
   3.704533346316038*^9, {3.7045333841182003`*^9, 3.7045333933027253`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestHorizontalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyHorizontalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestHorizontalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"BestHorizontalSynergyParameter", ",", "0"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestHorizontalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<MelanomaDabrafenibTrametinibBestHorizontalSynergy.pdf\>\""}], ",", 
    "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318972951584`*^9, 3.704531962684899*^9}, {
   3.70453199750289*^9, 3.704532132143591*^9}, {3.7045321737649717`*^9, 
   3.7045322964879913`*^9}, {3.7045323746424613`*^9, 3.7045323753155*^9}, {
   3.704533375263694*^9, 3.704533413559884*^9}, {3.704533705256568*^9, 
   3.7045337125749865`*^9}, 3.7045344846621475`*^9, 3.704535688129982*^9, 
   3.716126044823955*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestVerticalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestVerticalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"0", ",", "BestVerticalSynergyParameter"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestVerticalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<MelanomaDabrafenibTrametinibBestVerticalSynergy.pdf\>\""}], ",", 
    "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532504895911*^9, 3.704532506584008*^9}, 
   3.70453342765669*^9, {3.7045334751834087`*^9, 3.7045334813837633`*^9}, 
   3.704533736958381*^9, 3.704534487061285*^9, 3.704535688851023*^9, 
   3.7161260448359556`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestTwoParameterSynergyParameters", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"SynergyModelTwoParameterFits", ",", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestTwoParameterSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], "]"}], ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestTwoParameterSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<MelanomaDabrafenibTrametinibBestTwoParameterSynergy.pdf\>\""}], ",",
     "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, 3.7045326817550273`*^9, 
   3.704533431520911*^9, {3.704533491519343*^9, 3.704533491896364*^9}, {
   3.7045335282314425`*^9, 3.7045335291784973`*^9}, 3.7045337397975435`*^9, 
   3.704534488917391*^9, 3.704535689514061*^9, 3.716126044838956*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "IndependentActionModel", "]"}],
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<MelanomaDabrafenibTrametinibIndependentModel.pdf\>\""}], ",", "%", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, {3.7045326817550273`*^9, 
   3.704532743454556*^9}, {3.7045332534247246`*^9, 3.704533255279831*^9}, 
   3.7045334337040358`*^9, {3.7045335562110434`*^9, 3.704533578090295*^9}, 
   3.704533744349804*^9, 3.704534490940507*^9, 3.7045356928102493`*^9, {
   3.704551982800984*^9, 3.7045519848331003`*^9}, 3.7045523618486643`*^9, 
   3.716126044841956*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Metastatic melanoma, combination Immunotherapy\n",
 StyleBox["Code here is not used for main figures of Ipilimumab plus \
Nivolumab, but is used to compute hazard ratio attributable to synergy, and \
to apply Akaike Information Criterion to model selection.",
  FontSize->18],
 "\n",
 StyleBox["Near-identical code as for Figure 4A is here employed to generate \
Figure 4D. Comments will be more brief.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6913349412163115`*^9, 3.691334947328661*^9}, {
  3.6913350087441735`*^9, 3.69133509102588*^9}, {3.6913371794183292`*^9, 
  3.6913371948222103`*^9}, {3.691337767326956*^9, 3.6913377848789597`*^9}, {
  3.7043843759436293`*^9, 3.704384452919032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure1BRawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "2", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "second", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet"}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.691335120807583*^9, 
  3.691335121159603*^9}, {3.691335153027426*^9, 3.6913351618209295`*^9}, {
  3.6913373428176746`*^9, 3.6913373574995146`*^9}, {3.6913377883631587`*^9, 
  3.6913377939564786`*^9}, {3.7043844558241987`*^9, 3.7043844760723567`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Therapy1SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure1BRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "Ipilimumab"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy2SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure1BRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "Nivolumab"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure1BRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "the", " ", 
        "combination"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6913351250408254`*^9, 
  3.6913351370215106`*^9}, {3.691335177937851*^9, 3.691335183565173*^9}, {
  3.6913373331711235`*^9, 3.69133736336185*^9}, {3.6913377983627305`*^9, 
  3.691337808963337*^9}, {3.7043844845208397`*^9, 3.7043844999197206`*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Therapy1SurvivalDistribution", ",", 
            RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
   3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
   3.6913353590842123`*^9}, {3.6913373740764627`*^9, 
   3.6913373806838408`*^9}, {3.691337831883648*^9, 3.6913378629224234`*^9}, 
   3.7043845169126925`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "16500"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyFtIk2EAh/FhyEZgOaW5SgaJbBqi4MU6wfC9yU2aDkkdc6h4wMW+bbZY
G4vhYSIFFniIcODpIkGnojB0RCqKp0YOE8XIwA6QwufCtRF5XN//vXj4wXOj
2lJcF8fj8dK4oMZZey1PyRLja5EM7s3dV8K+hJtq+Pzslw7GuvL00PP48jTM
lUv98OGo9j30f5ufgZvu8AqUyk+o8k+qNXhoa6My6z0LT4tYMnanfQm29t47
h640VQxKZx/E2zkdgULqaVCbCNX8YBKclu6nQKZUKKa/+IsC/t2RERjbdhZA
LfFT9+t/Z/7k3HAGsmCBZlGXqGFJ9+CqHh5XHNVDEb/DAAc6r5uhwtxmh7xL
4lb4L97zAjYbLkaEnFmZV6gNypx8bzlLor5QCWzwRiuh42irBqaKc81wrDHB
AiUyE3NsZcmrCo8JSm53WOHqUNkTGEi+4IB331ieQYHL1wj73y03Qd9u1XjY
xpJ2W/okvLX759EpZ7YgQhWpJ74ON7EkQ0++w3E7cwAFurUQXPw493mE8+rh
D6pxsE7k5Yy+dVN1Zk3Lyx6W9H6YcsP/0c0SMA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "16500"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4DoZWnWeZ+AdNyidQUgOuLxl8w/QHrXZwh9xvP9u5UN
rx2lnHM/gGiNmAnfQPTVvh9g+o2d/a1VQPrimTQwzabNI74aSHesMAbT82/n
tPfOfO14OSkfTAMAAqitEw==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}, 
   3.691337966153328*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "63000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyG9IE2EAx/GjkIUwc0U2VISybhiiMGRogux5k5tkjVE2pliUsklzs8V0
LMSlQ1asYCuJBv0jEGxtEAw2Is3CznHQmJYIDlIQanAYiUNyTtf9nl58+cD3
xHWbvvcAwzDVYlDn6ilXawRyc6JMAX99PKeBz6Vn2qF376cRFh6pu2Dw1uEY
VKrYOLz01vABxtc+TcPvY5vzkFXtUlUL2q/wj2Ocakk9/Tx4USDhJt8X6HnW
vA+HT2oLkJ05XzQk6uQvUPNJQylslySPwBibOQ4tHTI5/fqVFridVhBYWHa1
QQOJUzOm3zXroosuvha26eaMpTqBPH6V6IK57h0TLJP4zfBloMIKW6zjQ5Ap
kXvg36LgPXjXXLwlE62tOUYd0NS3hjoFko1uXIYDoexV6NxZugEr5UorDI9I
bbBK0W/J2QXysDvYD6sa/XaYmLxyG/JHDzrh2Se2O/DQcHQEvnjPuWF09Vpk
0yEQn+PUO6gPeDg4G2jgofHBdl9e9P7EfyfV1r0pt0Ai3BbzRrSCL34NLYlq
at3pFAdH09+ond5kGkalP6i81y8Pic6Wx6j/AMRSHGI=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "63000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIT/my9BmIZrG/BqYn/Q5V
XA2klx3LBtMA9qqujA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
   3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
   3.691337277744953*^9}, 3.6913379775659804`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "9800"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0FtIk2EAxvEPD5jiygOtoTYyYmMhFBLDaYjvzdqGhzGslopKKirtYMp0
LESjIUYecCriQJc3Ws0DwsCRZSp5YNjwFEEhClIZH0VTSafW+p7Xi4cfPJf/
xPtGTVkQwzBiblBtKY3LULDkQTdfDL+/kytgP+9qFmz++y0PBjozCqD94bkJ
mCwVuWHusPYNdG/NvIXrT3wLUCQ9pkpXlB/gb1MTVbfcO1ubw5IRWcsctPal
/YP1l5UBKJrKDK3jNHuyqSdebRTMCvPGwAnRzgWouxMtoL/mczr880VMYOCT
RQW1xE3dKf8l2eZctXiSoEr9Pi9KzZKugcUCeFToL4f8sI4K+NwWb4DphqY6
yJwVWOFhqP0pfFwRsRfNmSQ5T61SXLvlzGfJvuvnbVjl3C+CZv/HEpggSDbA
kQaeEQrFet1RNUvaCu16KEzpqIaLg3droCc22AxTe4yP4Jl6VwN0vJ5vhK7N
4lGfiSUtpivjUGOzzsNp2w0PTF3qXoMS3yT1cC58Aw7H6KnrDn/lCWfIi1On
nD+aXzVyPRIOqMxFfjtsvVdGPV4TOmDxkpy6OyZbgN7Vm9QUmeorlFc+o2qI
/JKT83qpkhqcGTnU2suSOF7JS/gfCnM9gQ==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "9800"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}, {3.6913375351756773`*^9, 
   3.691337536029726*^9}, {3.6913380016593585`*^9, 3.691338001718362*^9}, {
   3.704384850406767*^9, 3.7043848510728054`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy2SurvivalDistribution", "]"}], ",", 
    "0.1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.1"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}, {3.7043851145298743`*^9, 3.7043851217042847`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "vertical", " ", "offset"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "simulated", "*)"}], 
   RowBox[{
    RowBox[{"slo", "=", 
     RowBox[{"-", "0.03"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lho", "=", 
     RowBox[{"-", "0.3"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy2SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "ComboSurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "16"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "15.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"18", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.15", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "Mono1Median", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.35", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "Mono2Median", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "ComboMedian", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.35"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "Sim2Median", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.35"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "0.8"}], ",", 
            RowBox[{"0.1", "-", "0.03", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.6"}], ",", 
            RowBox[{"0.1", "+", "0.03", "+", "lo", "+", "slo"}]}], "}"}]}], 
         "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.8"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Ipilimumab\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Nivolumab\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<Figure 1B, using PDX level of correlation.pdf\>\""}], ",", "%", 
       ",", "\"\<PDF\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9, {
   3.6913370241064453`*^9, 3.6913371276353674`*^9}, {3.69133732349457*^9, 
   3.69133732367258*^9}, {3.6913376565896215`*^9, 3.6913376949968185`*^9}, {
   3.6913377625116796`*^9, 3.6913377626866903`*^9}, {3.691338104164222*^9, 
   3.6913381171199627`*^9}, {3.6913381542350855`*^9, 
   3.6913381648576927`*^9}, {3.6913381979015827`*^9, 
   3.6913382016737986`*^9}, {3.7043848592572737`*^9, 
   3.7043849029207706`*^9}, {3.7043850480020695`*^9, 
   3.7043851020961633`*^9}, {3.7045796177126102`*^9, 3.704579619001684*^9}, 
   3.7161260448479567`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "15"}], 
   RowBox[{"(*", " ", "months", " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "SubSampledBestOfMidCorrelatedMonoPairs", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "ComboSurvivalDistribution", ",", "PatientsPerArmOfSimulatedTrial"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}, {3.7043851422094574`*^9, 3.704385142296462*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probability at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
   3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
   3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
   3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
   3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}, 
   3.7161255956442633`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"MelanomaImmunotherapyHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}, {3.704209009812667*^9, 3.704209010630714*^9}, {
  3.7043851552562037`*^9, 3.7043851567592897`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparison of Independent Drug Action with Synergy models by Akaike \
Information Criterion (AIC)\
\>", "Section",
 CellChangeTimes->{{3.7043711029084554`*^9, 3.70437111295003*^9}, {
  3.704380475085513*^9, 3.704380499638918*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"first", ",", " ", 
    RowBox[{
    "we", " ", "compute", " ", "a", " ", "survival", " ", "distribution", " ",
      "based", " ", "on", " ", "the", " ", "monotherapy", " ", 
     "distributions", " ", "assuming", " ", "no", " ", "synergy"}], ",", " ", 
    RowBox[{
    "and", " ", "perfect", " ", "correlation", " ", "in", " ", "response", 
     " ", "between", " ", 
     RowBox[{"drugs", ".", " ", "Therefore"}], " ", "at", " ", "each", " ", 
     "time", " ", "point"}], ",", " ", 
    RowBox[{
     RowBox[{
     "PFS", " ", "is", " ", "the", " ", "higher", " ", "of", " ", "the", " ", 
      "single"}], "-", 
     RowBox[{"drug", " ", "PFS", " ", "rates", " ", "at", " ", "that", " ", 
      RowBox[{"time", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Max", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sort", "[", "ReSampledTherapy1SurvivalDistribution", "]"}],
           ",", 
          RowBox[{
          "Sort", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
         "}"}], "\[Transpose]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Sort", "[", "MaximumOfMonotherapyResponses", "]"}], "]"}], 
       ",", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.70437116068976*^9, 3.7043711781427584`*^9}, {
  3.7043713179347544`*^9, 3.704371322535017*^9}, {3.7043715470068564`*^9, 
  3.704371589078263*^9}, {3.704371724639016*^9, 3.704371728007209*^9}, {
  3.704378697255827*^9, 3.704378723832347*^9}, {3.704380511279584*^9, 
  3.704380601831763*^9}, {3.7043810488253293`*^9, 3.704381050512426*^9}, {
  3.7045333465730524`*^9, 3.7045333465750523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Maximum", " ", "time"}], ",", " ", 
    RowBox[{"in", " ", "months"}], ",", " ", 
    RowBox[{
    "over", " ", "which", " ", "to", " ", "compare", " ", "survival", " ", 
     "distributions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LongestTime", "=", "15"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.704371741400975*^9, 3.704371803535529*^9}, {
  3.7043720439182777`*^9, 3.7043720686466923`*^9}, {3.7043787247994027`*^9, 
  3.7043787498548355`*^9}, {3.7043806086641536`*^9, 3.7043806338065915`*^9}, {
  3.7043824491274223`*^9, 3.704382449231428*^9}, {3.7043851858239517`*^9, 
  3.7043851859109573`*^9}}],

Cell[CellGroupData[{

Cell["\<\
A \[OpenCurlyQuote]synergy-fitting\[CloseCurlyQuote] model is created by \
defining two adjustable parameters:
a vertical scaling, which affects a fractional decrease in progression \
probability at each time
a horizontal scaling, which affects a fractional extension in duration of \
progression-free survival for all patients

SynergyModel[0,0] has no synergistic effect.
SynergyModel[X,0] has, for each patient, +X*100% longer PFS time. E.g. in \
SynergyModel[0.5, 0], all patients have +50% longer PFS.
SynergyModel[0,Y] has, at each time point, a 1/Y probability of progression. \
E.g. in SynergyModel[0, 1], at each time the progression rate is halved.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7043714031986313`*^9, 3.7043714851893206`*^9}, {
  3.7043787620225315`*^9, 3.704378762374552*^9}, {3.7043793812069473`*^9, 
  3.70437943773518*^9}, {3.7043806566869*^9, 3.7043806969352026`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SynergyModel", "[", 
   RowBox[{"HorizontalScaling_", ",", "VerticalScaling_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"MaximumOfMonotherapyResponses", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", "HorizontalScaling"}], ")"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"LongestTime", ",", 
      RowBox[{"{", 
       RowBox[{"VerticalScaling", "*", 
        RowBox[{"Length", "[", "MaximumOfMonotherapyResponses", "]"}]}], 
       "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.704372031151548*^9, 3.704372038717981*^9}, {
   3.704372093902137*^9, 3.704372137942656*^9}, {3.7043721988711405`*^9, 
   3.7043722473669147`*^9}, {3.7043723375350723`*^9, 
   3.7043723481906815`*^9}, {3.7043723975975075`*^9, 3.7043724429271*^9}, {
   3.7043724942550364`*^9, 3.7043726163020163`*^9}, 3.704378761031475*^9, {
   3.7043794409433637`*^9, 3.7043794500318837`*^9}, {3.704533346583053*^9, 
   3.7045333465850534`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"for", " ", "Kolmorogov"}], "-", 
     RowBox[{
     "Smirnov", " ", "test", " ", "to", " ", "be", " ", "comparable", " ", 
      "across", " ", "data", " ", "sets", " ", "and", " ", "model", " ", 
      "types"}]}], ",", " ", 
    RowBox[{
    "the", " ", "population", " ", "size", " ", "that", " ", "comprises", " ",
      "each", " ", "survival", " ", "distribution", " ", "is", " ", 
     "normalized", " ", "to", " ", "a", " ", "consistent", " ", 
     RowBox[{"value", ".", " ", "This"}], " ", "does", " ", "not", " ", 
     "change", " ", "the", " ", "distribution", " ", "shape", " ", "except", 
     " ", "for", " ", "insignificant", " ", "rounding", " ", 
     RowBox[{"differences", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TrialPopulationSize", "=", "200"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "survivaldistribution_", ",", "LongestTime_", ",", "PopulationSize_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalDistributionWithMaximumTime", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"LongestTime", ",", "#"}], "}"}], "]"}], "&"}], ",", 
           "survivaldistribution"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SurvivalDistributionWithDefinedPopulationSize", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{"SurvivalDistributionWithMaximumTime", ",", 
             RowBox[{"{", "PopulationSize", "}"}]}], "]"}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}], ";;", 
          RowBox[{
          "Length", "[", "SurvivalDistributionWithMaximumTime", "]"}]}], 
         "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043734358438916`*^9, 3.704373550262436*^9}, {
   3.7043738010417795`*^9, 3.70437384073405*^9}, {3.7043739047527113`*^9, 
   3.7043739049997263`*^9}, 3.704379791719427*^9, {3.704380130446801*^9, 
   3.7043802453673744`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "observed", " ", "data"}], ";", " ", 
    RowBox[{
    "set", " ", "to", " ", "consistent", " ", "population", " ", "size", " ", 
     "and", " ", "capped", " ", "with", " ", "a", " ", "consistent", " ", 
     "maximum", " ", "survival", " ", "time"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ObservedDistribution", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
     "ComboSurvivalDistribution", ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7043741526488905`*^9, 3.7043741703599033`*^9}, {
   3.7043807153752575`*^9, 3.70438074951221*^9}, 3.7043812846478176`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "horizontal", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.5"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "0"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "Steps"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithHorizontalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{
     "SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704379488746098*^9, 3.7043795311195216`*^9}, {
  3.70437968075208*^9, 3.704379707304599*^9}, {3.7043807545124955`*^9, 
  3.7043808135208707`*^9}, {3.7043813924169817`*^9, 3.7043813925189877`*^9}, {
  3.704381658680211*^9, 3.7043816587832165`*^9}, {3.704382462704199*^9, 
  3.704382464791318*^9}, {3.704382501176399*^9, 3.7043825012714043`*^9}, {
  3.7043832067837577`*^9, 3.7043832068557615`*^9}, {3.7043851979196444`*^9, 
  3.7043851980156493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyHorizontalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043824822853184`*^9, 3.7043825489501314`*^9}, {
  3.704382619695178*^9, 3.704382643976567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "using", " ", "the", " ", "vertical", " ", "parameter", " ", "only"}], 
    ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.4"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Steps", "=", "50"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"0", ",", "VerticalScaling"}], "]"}], ",", 
             "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "Steps"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BestLikelihoodWithVerticalParameter", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043795383919373`*^9, 3.704379558304076*^9}, {
  3.704379658102784*^9, 3.704379676542839*^9}, {3.7043797161021023`*^9, 
  3.704379745456781*^9}, {3.7043808179211226`*^9, 3.7043808213913207`*^9}, {
  3.704382471342693*^9, 3.7043824714076967`*^9}, {3.7043826551592064`*^9, 
  3.704382655286214*^9}, {3.7043832129911127`*^9, 3.7043832131021185`*^9}, {
  3.70438520187087*^9, 3.704385212662487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameter", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelOnlyVerticalParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Parameter choice\>\"", ",", "\"\<Likelihood\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.7043826610715446`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computing", " ", "which", " ", "synergy", " ", "model"}], ",", 
    " ", 
    RowBox[{"using", " ", "two", " ", "parameters"}], ",", " ", 
    RowBox[{
    "has", " ", "the", " ", "highest", " ", "likelihood", " ", "of", " ", 
     "consistency", " ", "with", " ", "the", " ", "observed", " ", "data"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MaximumHorizontalScaling", "=", "0.4"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaximumVerticalScaling", "=", "0.4"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StepsPerParameter", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HorizontalScaling", ",", "VerticalScaling", ",", 
         RowBox[{"KolmogorovSmirnovTest", "[", 
          RowBox[{"ObservedDistribution", ",", 
           RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
            RowBox[{
             RowBox[{"SynergyModel", "[", 
              RowBox[{"HorizontalScaling", ",", "VerticalScaling"}], "]"}], 
             ",", "LongestTime", ",", "TrialPopulationSize"}], "]"}], ",", 
           "\"\<PValue\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "HorizontalScaling", ",", "0", ",", "MaximumHorizontalScaling", ",", 
         RowBox[{"MaximumHorizontalScaling", "/", "StepsPerParameter"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "VerticalScaling", ",", "0", ",", "MaximumVerticalScaling", ",", 
         RowBox[{"MaximumVerticalScaling", "/", "StepsPerParameter"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
    " ", 
   RowBox[{"BestLikelihoodWithTwoParameterFit", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7043739959649286`*^9, 3.7043740011432247`*^9}, {
  3.7043740342081165`*^9, 3.7043740722872944`*^9}, {3.7043741137046633`*^9, 
  3.704374126255381*^9}, {3.7043741669857106`*^9, 3.7043741691348333`*^9}, {
  3.7043743037685337`*^9, 3.7043744065914154`*^9}, {3.7043746382406645`*^9, 
  3.7043746388807015`*^9}, {3.7043747047754707`*^9, 3.704374706456567*^9}, {
  3.704377713519561*^9, 3.7043777172077713`*^9}, {3.7043784069112206`*^9, 
  3.704378427272385*^9}, {3.704379847560621*^9, 3.704379981744296*^9}, {
  3.704380827784686*^9, 3.7043808347840867`*^9}, {3.7043817220628366`*^9, 
  3.704381722159842*^9}, {3.7043817950160093`*^9, 3.7043817964000883`*^9}, {
  3.704382473934841*^9, 3.7043824748548937`*^9}, {3.7043826910242577`*^9, 
  3.704382694143436*^9}, {3.704383218414423*^9, 3.7043832191994677`*^9}, {
  3.7043852164547043`*^9, 3.7043852259822493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "confirming", " ", "that", " ", "the", " ", "synergy", " ", "parameters", 
    " ", "spanned", " ", "the", " ", "optimal", " ", "range"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"SynergyModelTwoParameterFits", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7043818001673036`*^9, 3.7043818094148326`*^9}, {
  3.7043819032311983`*^9, 3.7043819250144444`*^9}, {3.7043821556226344`*^9, 
  3.70438215571064*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
    "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
    RowBox[{"(", 
     RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
    " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
    " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "To", " ", "minimize", " ", "noise", " ", "from", " ", "the", " ", 
     "sampling", " ", "procedure", " ", "of", " ", "the", " ", "independent", 
     " ", "action", " ", "model"}], ",", " ", 
    RowBox[{
    "we", " ", "take", " ", "the", " ", "average", " ", "of", " ", "many", 
     " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionSimulation", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", 
        " ", "randomization", " ", "that", " ", "produces", " ", "Spearman", 
        " ", "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ",
         "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"amountofrankrandomization", "=", "16500"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}],
              "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "amountofrankrandomization"}], ",", 
                  "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
              RowBox[{
              "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]",
                "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}],
              "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], 
          ",", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumberOfIndependentActionSimulations", "=", "20"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReplicateIndependentActionSimulations", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"IndependentActionSimulation", "[", "]"}], ",", 
         RowBox[{"{", "NumberOfIndependentActionSimulations", "}"}]}], "]"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "final", " ", "model", " ", "is", " ", "the", " ", "population"}], "-", 
     RowBox[{
     "normalized", " ", "average", " ", "of", " ", "many", " ", "replicate", 
      " ", "simulations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndependentActionModel", "=", 
     RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
      RowBox[{
      "ReplicateIndependentActionSimulations", ",", "LongestTime", ",", 
       "TrialPopulationSize"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "computing", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ", 
     "Independent", " ", "Drug", " ", "Action", " ", "model", " ", 
     RowBox[{"(", 
      RowBox[{"with", " ", "zero", " ", "fitted", " ", "parameters"}], ")"}], 
     " ", "is", " ", "consistent", " ", "with", " ", "the", " ", "observed", 
     " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"IndependentActionModelLikelihood", "=", 
    RowBox[{"KolmogorovSmirnovTest", "[", 
     RowBox[{
     "ObservedDistribution", ",", "IndependentActionModel", ",", 
      "\"\<PValue\>\""}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704380310986127*^9, 3.70438035351256*^9}, {
   3.7043808394793553`*^9, 3.7043808719832144`*^9}, {3.704549367919421*^9, 
   3.704549410839876*^9}, {3.7045494549553995`*^9, 3.7045495430564384`*^9}, {
   3.70454959045815*^9, 3.704549613089444*^9}, {3.7045496637053394`*^9, 
   3.7045496646893954`*^9}, {3.7045497077138567`*^9, 3.704549723096736*^9}, {
   3.704549803136314*^9, 3.7045498661379175`*^9}, {3.704550006481945*^9, 
   3.7045500205307484`*^9}, {3.7045503106013393`*^9, 3.704550342768179*^9}, {
   3.7045503883467865`*^9, 3.704550390176891*^9}, 3.7045515753156767`*^9, {
   3.7045519657600093`*^9, 3.7045519672410936`*^9}, 3.7045522682323093`*^9, {
   3.7045524347218323`*^9, 3.7045524474485598`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Tabulating", " ", "the", " ", "likelihood", " ", "that", " ", "the", " ",
      "observed", " ", "combination", " ", "drug", " ", "response", " ", 
     "would", " ", "be", " ", "observed", " ", "if", " ", "the", " ", "true", 
     " ", "distribution", " ", "were", " ", "one", " ", "of", " ", "the", " ",
      "various", " ", "models"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"order", ":", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"independent", " ", "drug", " ", "action"}], ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "horizontal", " ", "parameter"}],
         ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "vertical", " ", "parameter"}], 
        ",", " ", 
        RowBox[{"synergy", " ", "with", " ", "two", " ", "parameters"}]}], 
       " ", "}"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MelanomaImmunotherapyModelLikelihoods", "=", 
   RowBox[{"{", 
    RowBox[{
    "IndependentActionModelLikelihood", ",", 
     "BestLikelihoodWithHorizontalParameter", ",", 
     "BestLikelihoodWithVerticalParameter", ",", 
     "BestLikelihoodWithTwoParameterFit"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.704380296464297*^9, 3.704380308921009*^9}, {
  3.7043803605989647`*^9, 3.7043804465438805`*^9}, {3.70438088886318*^9, 
  3.704380980143401*^9}, {3.7043819476307383`*^9, 3.704381961183513*^9}, {
  3.704382285600069*^9, 3.7043822927444773`*^9}, {3.704382400504641*^9, 
  3.704382401943723*^9}, {3.7043831758559885`*^9, 3.704383181791328*^9}, {
  3.704385233550682*^9, 3.7043852380389385`*^9}, {3.71612764850368*^9, 
  3.716127648583685*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["plotting model fits", "Subsection",
 CellChangeTimes->{{3.7045335958673115`*^9, 3.7045336044888043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaximumOfMonotherapyResponsesModel", "=", 
   RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
    RowBox[{
    "MaximumOfMonotherapyResponses", ",", "LongestTime", ",", 
     "TrialPopulationSize"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7045332975502486`*^9, 3.7045333014874735`*^9}, 
   3.704533346316038*^9, {3.7045333841182003`*^9, 3.7045333933027253`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestHorizontalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyHorizontalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestHorizontalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"BestHorizontalSynergyParameter", ",", "0"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestHorizontalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<MelanomaIpilimumabNivolumabBestHorizontalSynergy.pdf\>\""}], ",", 
    "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318972951584`*^9, 3.704531962684899*^9}, {
   3.70453199750289*^9, 3.704532132143591*^9}, {3.7045321737649717`*^9, 
   3.7045322964879913`*^9}, {3.7045323746424613`*^9, 3.7045323753155*^9}, {
   3.704533375263694*^9, 3.704533413559884*^9}, {3.704533705256568*^9, 
   3.7045337125749865`*^9}, 3.7045344846621475`*^9, 3.704535688129982*^9, 
   3.704538728180863*^9, 3.716126044855957*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestVerticalSynergyParameter", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"SynergyModelOnlyVerticalParameterFits", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestVerticalSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{"0", ",", "BestVerticalSynergyParameter"}], "]"}], ",", 
      "LongestTime", ",", "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestVerticalSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<MelanomaIpilimumabNivolumabBestVerticalSynergy.pdf\>\""}], ",", "%",
     ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532504895911*^9, 3.704532506584008*^9}, 
   3.70453342765669*^9, {3.7045334751834087`*^9, 3.7045334813837633`*^9}, 
   3.704533736958381*^9, 3.704534487061285*^9, 3.704535688851023*^9, 
   3.704538728906904*^9, 3.7161260448639574`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestTwoParameterSynergyParameters", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"SynergyModelTwoParameterFits", ",", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ">", 
        RowBox[{
        "#2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestTwoParameterSynergyModel", "=", 
    RowBox[{"SetMaximumTimeAndNormalizePopulationSize", "[", 
     RowBox[{
      RowBox[{"SynergyModel", "[", 
       RowBox[{
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "BestTwoParameterSynergyParameters", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], "]"}], ",", "LongestTime", ",", 
      "TrialPopulationSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestTwoParameterSynergyModel", "]"}], 
        "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<MelanomaIpilimumabNivolumabBestTwoParameterSynergy.pdf\>\""}], ",", 
    "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, 3.7045326817550273`*^9, 
   3.704533431520911*^9, {3.704533491519343*^9, 3.704533491896364*^9}, {
   3.7045335282314425`*^9, 3.7045335291784973`*^9}, 3.7045337397975435`*^9, 
   3.704534488917391*^9, 3.704535689514061*^9, 3.7045387296109447`*^9, 
   3.7161260448709574`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "MaximumOfMonotherapyResponsesModel", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "IndependentActionModel", "]"}],
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", "ObservedDistribution", "]"}], 
        "]"}], "[", "x", "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "LongestTime"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "LongestTime"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "10"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"2", "\[Rule]", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "150", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<MelanomaIpilimumabNivolumabIndependentModel.pdf\>\""}], ",", "%", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7045318202667527`*^9, 3.704531876038943*^9}, {
   3.7045320132247896`*^9, 3.704532025334482*^9}, {3.7045323259566765`*^9, 
   3.7045323465198526`*^9}, {3.7045324031910944`*^9, 
   3.7045324139677105`*^9}, {3.704532448439682*^9, 3.704532526783163*^9}, {
   3.7045326284209766`*^9, 3.704532629659047*^9}, {3.7045326817550273`*^9, 
   3.704532743454556*^9}, {3.7045332534247246`*^9, 3.704533255279831*^9}, 
   3.7045334337040358`*^9, {3.7045335562110434`*^9, 3.704533578090295*^9}, 
   3.704533744349804*^9, 3.704534490940507*^9, 3.7045356928102493`*^9, 
   3.7045387304669933`*^9, {3.704552692289564*^9, 3.704552694706702*^9}, 
   3.7161260448779583`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparison of Akaike Information Criterion across 5 trials of combination \
therapies that are proposed to be consistent with independent drug action\
\>", "Section",
 CellChangeTimes->{{3.704400222534003*^9, 3.704400232312562*^9}, {
  3.716126586758952*^9, 3.716126588615058*^9}, {3.7161275092717166`*^9, 
  3.7161275473028917`*^9}}],

Cell[CellGroupData[{

Cell["\<\
From prior code analyzing each trial we have a list of likelihoods, according \
to the Kolmorogov Smirnov test, that the clinically observed distribution of \
progression free survival times was sampled from a given model distribution.
For each trial these likelihoods are listed in the following order of models:
- Independent Drug Action
- Synergy modeled by horizontal scaling of PFS
- Synergy modeled by vertical scaling of PFS
- Synergy modeled by both horizontal and vertical scaling of PFS\
\>", "Subsubsection",
 CellChangeTimes->{{3.716127549964044*^9, 3.7161276363269835`*^9}, {
  3.716127756582862*^9, 3.7161278000393476`*^9}}],

Cell[BoxData["OvarianModelLikelihoods"], "Input",
 CellChangeTimes->{{3.704400247889453*^9, 3.7044002499765725`*^9}}],

Cell[BoxData["BreastCancerModelLikelihoods"], "Input",
 CellChangeTimes->{{3.7044002519436846`*^9, 3.7044002539377985`*^9}}],

Cell[BoxData["PancreaticCancerModelLikelihoods"], "Input",
 CellChangeTimes->{{3.704400255073864*^9, 3.7044002564099407`*^9}}],

Cell[BoxData["MelanomaImmunotherapyModelLikelihoods"], "Input",
 CellChangeTimes->{{3.7044002362667885`*^9, 3.704400238898939*^9}}],

Cell[BoxData["MelanomaKinaseModelLikelihoods"], "Input",
 CellChangeTimes->{{3.704400240558034*^9, 3.7044002424591427`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For each model, the likelihood that the observed PFS distributions from each \
of the above trials were sampled from that model is the product of the \
likelihoods across the above trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7161278061006947`*^9, 3.716127811238988*^9}, {
  3.716128046824463*^9, 3.7161280644234695`*^9}, {3.7161281301992316`*^9, 
  3.716128216759183*^9}}],

Cell[BoxData[
 RowBox[{"ProductOfLikelihoods", "=", 
  RowBox[{
  "OvarianModelLikelihoods", "*", "BreastCancerModelLikelihoods", "*", 
   "PancreaticCancerModelLikelihoods", "*", 
   "MelanomaImmunotherapyModelLikelihoods", "*", 
   "MelanomaKinaseModelLikelihoods"}]}]], "Input",
 CellChangeTimes->{{3.704400290031863*^9, 3.7044003168964*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Akaike Information Criterion is calculated as\nAIC = Log( likelihood) - 2\
\[Times]",
 StyleBox["k",
  FontSlant->"Italic"],
 "\nwhere ",
 StyleBox["k",
  FontSlant->"Italic"],
 " is the number of fitted parameters."
}], "Subsubsection",
 CellChangeTimes->{{3.71612822563669*^9, 3.7161282523592186`*^9}}],

Cell[BoxData[
 RowBox[{"Log", "[", "ProductOfLikelihoods", "]"}]], "Input",
 CellChangeTimes->{{3.7045404778689394`*^9, 3.70454048102312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "Independent", " ", "action", " ", "model"}], ",", 
    " ", 
    RowBox[{"as", " ", "implemented", " ", "here"}], ",", " ", 
    RowBox[{
     RowBox[{"applied", " ", "one", " ", "parameter"}], " ", "-", " ", 
     RowBox[{"response", " ", "correlation"}], " ", "-", " ", 
     RowBox[{"for", " ", "all", " ", "five", " ", 
      RowBox[{"trials", ".", " ", "Though"}], " ", "in", " ", "this", " ", 
      "case", " ", "it", " ", "is", " ", 
      RowBox[{"not", " ", "'"}], 
      RowBox[{"fitted", "'"}], " ", "but", " ", "determined", " ", "from", 
      " ", "experimental", " ", "data", " ", 
      RowBox[{"(", 
       RowBox[{"see", " ", "Figure", " ", "2", "A"}], ")"}]}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionParameterCount", "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"the", " ", "'"}], "horizontal", " ", 
      RowBox[{"parameter", "'"}], " ", 
      RowBox[{"and", " ", "'"}], "vertical", " ", 
      RowBox[{"parameter", "'"}], " ", "synergy", " ", "models", " ", 
      "involve", " ", "one", " ", "scaling", " ", "parameter", " ", "per", 
      " ", "trial"}], ",", " ", 
     RowBox[{
     "for", " ", "a", " ", "total", " ", "of", " ", "5", " ", "fitted", " ", 
      "parameters"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyHorizontalParameterCount", "=", "5"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyVerticalParameterCount", "=", "5"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"the", " ", "'"}], "horizontal", " ", "and", " ", 
      RowBox[{"vertical", "'"}], " ", "scaling", " ", "synergy", " ", "model",
       " ", "involves", " ", "two", " ", "parameters", " ", "per", " ", 
      "trial"}], ",", " ", 
     RowBox[{
     "for", " ", "a", " ", "total", " ", "of", " ", "10", " ", "fitted", " ", 
      "parameters"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SynergyHorizontalandVerticalParameterCount", "=", "10"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"calculating", " ", "AIC", " ", "scores"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionAIC", "=", 
    RowBox[{
     RowBox[{"2", "*", "IndependentActionParameterCount"}], "-", 
     RowBox[{"2", "*", 
      RowBox[{"Log", "[", 
       RowBox[{
       "ProductOfLikelihoods", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"SynergyHorizontalAIC", "=", 
    RowBox[{
     RowBox[{"2", "*", "SynergyHorizontalParameterCount"}], "-", 
     RowBox[{"2", "*", 
      RowBox[{"Log", "[", 
       RowBox[{
       "ProductOfLikelihoods", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"SynergyVerticalAIC", "=", 
    RowBox[{
     RowBox[{"2", "*", "SynergyVerticalParameterCount"}], "-", 
     RowBox[{"2", "*", 
      RowBox[{"Log", "[", 
       RowBox[{
       "ProductOfLikelihoods", "\[LeftDoubleBracket]", "3", 
        "\[RightDoubleBracket]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"SynergyTwoParameterAIC", "=", 
    RowBox[{
     RowBox[{"2", "*", "SynergyHorizontalandVerticalParameterCount"}], "-", 
     RowBox[{"2", "*", 
      RowBox[{"Log", "[", 
       RowBox[{
       "ProductOfLikelihoods", "\[LeftDoubleBracket]", "4", 
        "\[RightDoubleBracket]"}], "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7044003551605883`*^9, 3.704400519864009*^9}, {
  3.704400606472963*^9, 3.704400622001851*^9}, {3.7044011478579283`*^9, 
  3.7044011630957994`*^9}, {3.7044014054996643`*^9, 3.704401405559668*^9}, {
  3.71612826671204*^9, 3.7161284442001915`*^9}, {3.7161286056574264`*^9, 
  3.7161286059764442`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "smallest", " ", "AIC", " ", "value", " ", "is", " ", "used", 
    " ", "to", " ", "calculate", " ", "the", " ", "relative", " ", 
    "likelihoods", " ", "that", " ", "different", " ", "models", " ", 
    "minimize", " ", "information", " ", "loss"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"AICmin", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"{", 
     RowBox[{
     "IndependentActionAIC", ",", "SynergyHorizontalAIC", ",", 
      "SynergyVerticalAIC", ",", "SynergyTwoParameterAIC"}], "}"}], 
    "]"}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The relative likelihood that a given model minimizes information\\loss, \
according to Akaike, is  Exp( ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     SubscriptBox["AIC", "minimum"], " ", "-", " ", "AIC"}], "2"], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 " )"
}], "Subsubsection",
 CellChangeTimes->{{3.7161285538384624`*^9, 3.7161285790639052`*^9}}],

Cell[BoxData[{
 RowBox[{"RelativeLikelihoodOfIndependentAction", "=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"AICmin", "-", "IndependentActionAIC"}], ")"}], "/", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeLikelihoodOfSynergyHorizontal", "=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"AICmin", "-", "SynergyHorizontalAIC"}], ")"}], "/", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeLikelihoodOfSynergyVertical", "=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"AICmin", "-", "SynergyVerticalAIC"}], ")"}], "/", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeLikelihoodOfSynergyTwoParameter", "=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"AICmin", "-", "SynergyTwoParameterAIC"}], ")"}], "/", "2"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7044006288782444`*^9, 3.704400663754239*^9}, {
  3.704400697914193*^9, 3.7044007372794447`*^9}, {3.716128447304369*^9, 
  3.7161284967761984`*^9}, {3.716128594391782*^9, 3.7161285952078285`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "calculating", " ", "the", " ", "inverse", " ", "of", " ", "the", " ", 
    "relative", " ", "likelihood", " ", "to", " ", "express", " ", 
    "likelihood", " ", "as", " ", "a", " ", "ratio", " ", 
    RowBox[{"(", 
     RowBox[{
     "see", " ", "table", " ", "in", " ", "Supplementary", " ", "Note", " ", 
      "on", " ", "Akaike", " ", "Information", " ", "Criterion"}], ")"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "RelativeLikelihoodOfIndependentAction", "/", 
    "RelativeLikelihoodOfSynergyHorizontal"}], "\[IndentingNewLine]", 
   RowBox[{
   "RelativeLikelihoodOfIndependentAction", "/", 
    "RelativeLikelihoodOfSynergyVertical"}], "\[IndentingNewLine]", 
   RowBox[{
   "RelativeLikelihoodOfIndependentAction", "/", 
    "RelativeLikelihoodOfSynergyTwoParameter"}]}]}]], "Input",
 CellChangeTimes->{{3.704400686712552*^9, 3.704400690289757*^9}, {
  3.7044007263048167`*^9, 3.704400745097892*^9}, {3.7161285009364367`*^9, 
  3.7161285304561253`*^9}}]
}, Open  ]],

Cell["\<\
Akaike information criterion is not applied to the trials analyzed in Figures \
4E, F, G because the clinically observed responses clearly surpass the model \
of independent action and must involve additive or synergistic benefit within \
individual patients. \
\>", "Subsubsection",
 CellChangeTimes->{{3.716128626282606*^9, 3.7161286899752493`*^9}, {
  3.716129069782973*^9, 3.7161290730951624`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 4E - Recurrent platinum-sensitive ovarian cancer (bevacizumab + \
gemcitabine/carboplatin)\n",
 StyleBox["Near-identical code as for Figure 4A is here employed to generate \
Figure 4E. Comments will be more brief.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6913349412163115`*^9, 3.691334947328661*^9}, {
  3.6913350087441735`*^9, 3.69133509102588*^9}, {3.6913371794183292`*^9, 
  3.6913371948222103`*^9}, {3.691337767326956*^9, 3.6913377848789597`*^9}, {
  3.6913382689076443`*^9, 3.6913383289650793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure4ERawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "7", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "seventh", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet"}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.691335120807583*^9, 
  3.691335121159603*^9}, {3.691335153027426*^9, 3.6913351618209295`*^9}, {
  3.6913373428176746`*^9, 3.6913373574995146`*^9}, {3.6913377883631587`*^9, 
  3.6913377939564786`*^9}, {3.691338332081258*^9, 3.6913383487372103`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Therapy1SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4ERawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
         "contains", " ", "PFS", " ", "data", " ", "for", " ", 
         "gemcitabine"}], "+", "carboplatin"}], "*)"}], 
      "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy2SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4ERawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "bevacizumab"}],
        "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4ERawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "the", " ", 
        "combination"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6913351250408254`*^9, 
  3.6913351370215106`*^9}, {3.691335177937851*^9, 3.691335183565173*^9}, {
  3.6913373331711235`*^9, 3.69133736336185*^9}, {3.6913377983627305`*^9, 
  3.691337808963337*^9}, {3.691338335527455*^9, 3.691338362775013*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"within", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"resample", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{"need", " ", "to", " ", "sub"}], "-", 
      RowBox[{"sample", " ", "the", " ", "gemcitabine"}], "+", 
      RowBox[{"carboplatin", " ", "distribution", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "more", " ", "vertical", " ", "pixels", " ", "than", " ", "the", " ",
           "bevacizumab", " ", "distribution"}], ")"}], ".", " ", "The"}], 
       " ", "number", " ", "of", " ", "pixels", " ", "is", " ", "vastly", " ",
        "in", " ", "excess", " ", "of", " ", "the", " ", "number", " ", "of", 
       " ", "patients", " ", "so", " ", "no", " ", "individual", " ", 
       RowBox[{"patient", "'"}], "s", " ", "information", " ", "is", " ", 
       RowBox[{"lost", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Therapy1SurvivalDistribution", ",", 
            RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
  3.6913353590842123`*^9}, {3.6913373740764627`*^9, 3.6913373806838408`*^9}, {
  3.691337831883648*^9, 3.6913378629224234`*^9}, {3.6913383787029243`*^9, 
  3.6913383875924325`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "15500"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyH0o43EAx/FFspTzlG24lKUNLVf+GE7J9x9m2d3SHWu30N0tZDZHu61J
XKS70tU8dN3Kw/7Y1RlytbLkOefWQuguQnkq1O9cG+s6DvP7fP3x7lXvlJeG
Um0Ih8MRskGl5XVigYwhdX08MTyZLZTBgcgMBXx/c6yGwZ4CDbS9iZqAWVKR
Gz4bUU1B9/78NPzZ7v8BRdL/VOl68Qr0GTupurXPC2+fMmQ0t+s77OjPu4Ut
wuIgFM2UhJlYzd4n1OtVVTRUhK/GwgnRKR/qymIE9Jdu58O/O2ICg5sWOVQR
N/W0+k/6EeuGxSuBcuWiOlrJkF67RwOvKi6rIS/cWgOHupP0MF/faYKcB4IO
+C/M9gG+q4m4iGGVpMdTG2SPipwvGBJwnT2HDc5AJTRf/noFHwqy9HC0NdIA
k8X1uqtGhnyssNXD5BxrI/R8KW+C3rhQM3z8ydAMuS2uVjg4udQGXXtVY34j
Q7qMqd9g9t557TVrJveCylOM735tY0iahhzAMZPuN+SqV87g4vLs1jBrgu+Q
WmfX8pysAUf7vXP2csg3OKh32xQSLw==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "15500"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4DoZWnWeZ+AdNyidQUgOuLxl8w/QHrXZwh9xvP9u5UN
rx2lnHM/gGiNmAnfQPTVvh9g+o2d/a1VQPrimTQwzabNI74aSHesMAbTEQHu
kSBa8rA3mAYA7UOrTQ==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}, 
   3.691337966153328*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "53000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617586751399307`*^9, 3.6617587767057395`*^9}, {
   3.6617590422109256`*^9, 3.6617590813141623`*^9}, {3.6617591912184486`*^9, 
   3.661759202018066*^9}, {3.6617599284826174`*^9, 3.6617599371941156`*^9}, {
   3.661759970771036*^9, 3.6617599820586815`*^9}, {3.6617600635473423`*^9, 
   3.66176006385036*^9}, {3.6617601063067884`*^9, 3.6617601082018967`*^9}, {
   3.665540628806692*^9, 3.6655406523820405`*^9}, {3.665541105862978*^9, 
   3.66554111428546*^9}, {3.6655411623982115`*^9, 3.6655411624622154`*^9}, {
   3.6655412507752666`*^9, 3.665541270438391*^9}, {3.665541311254726*^9, 
   3.6655413125417995`*^9}, {3.6655416228225465`*^9, 
   3.6655416412456007`*^9}, {3.6655417158388667`*^9, 
   3.6655417177579765`*^9}, {3.665762639450184*^9, 3.6657626623274927`*^9}, {
   3.665855190134801*^9, 3.665855206269724*^9}, {3.665855295792844*^9, 
   3.665855300532115*^9}, {3.6658553448616486`*^9, 3.6658554202009573`*^9}, {
   3.665855520751709*^9, 3.6658555648132286`*^9}, {3.665858456325257*^9, 
   3.665858456661276*^9}, {3.6719396414775925`*^9, 3.671939759428339*^9}, {
   3.6719398396459274`*^9, 3.6719398706867027`*^9}, {3.671939953565443*^9, 
   3.6719399604218354`*^9}, {3.684160355411025*^9, 3.6841603648240423`*^9}, {
   3.6841604045381002`*^9, 3.684160410739109*^9}, {3.6841604480961657`*^9, 
   3.6841604754872103`*^9}, {3.6841605096402626`*^9, 3.684160518210281*^9}, {
   3.6857153150273075`*^9, 3.685715337139349*^9}, {3.6857155081428614`*^9, 
   3.685715537642914*^9}, {3.685737295704755*^9, 3.6857372957057543`*^9}, {
   3.6913356594453917`*^9, 3.691335687618003*^9}, {3.691336984337171*^9, 
   3.6913369851182156`*^9}, {3.6913372705045385`*^9, 
   3.6913372706205454`*^9}, {3.691337438454145*^9, 3.6913374389391727`*^9}, {
   3.691337924547948*^9, 3.6913379257220154`*^9}, 3.691338490112296*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "53000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIT/my9BmIZrG/BqYn/Q5V
XA2klx3LBtNV16QSQPSlB4pgGgAqkLc4
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
   3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
   3.691337277744953*^9}, 3.6913379775659804`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "8900"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0FtIk2EAxvGPUkzBM85RNkxkayIoIsOZiO/N2obmGKlLxbOotIMZ0zER
jYYoWuJMwoHObkScFsFgI4+FJ4bOUiMooiAq46NwJenUWt/zdvHwg+fyf6nG
oK4/wzCMiBtUmevO58lZcnOYJ4JfF2VyOBaeUgB7/nwphYGhvHJouxXpghkS
oRten9bMQffH5/Nw965vDQolJ1TJK8Um3Dd2U7UvR160FrJkRtq/Ai2jV/7C
jiRFAAoX8oPbOE2ea9RTryYKFoR4Y6BLuBcPtcXRfPqr3+bC3+9EBAbemJVQ
Q9zUvYYf4k+c22ZPKlSqlkujVCx58Gi9HB5X+BsgL2SwEY5bL+hhrr67DTIR
fAs8Crb1wjuNYb+iOVPFcdRmedpVRxlLDpzfi2Cz46ASmvyva2ECP0MPZzrD
DVAg0mmPW1hyv8Kmg4KswRa4PlFyG3piz5pg9kNDOzzX4eyE9merXdD5oeqx
z8iSfmPyU6i2WlbhkjXTA7M3hneg2DdLPVoJfQ+nY3TUXbu/6ZQzaPK/C45v
PVNdXI+EQypzkTcA792op57sCOywakNG/flEuga92znULKnyM5Q19VHVRJbo
4EyvU1DHL3ur4X7lFvUfI8U/zA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "8900"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}, {3.6913375351756773`*^9, 
   3.691337536029726*^9}, {3.6913380016593585`*^9, 3.691338001718362*^9}, {
   3.6913385153667407`*^9, 3.6913385154457455`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy2SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "vertical", " ", "offset"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", "0.58"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "simulated", "*)"}], 
   RowBox[{
    RowBox[{"slo", "=", 
     RowBox[{"-", "0.03"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lho", "=", "13"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy2SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "ComboSurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "26"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "24.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"24", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<8.3\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<4.6\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<12.2\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<10.3\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.7"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.7"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.7"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "0.7"}], ",", 
            RowBox[{"0.1", "-", "0.03", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.6"}], ",", 
            RowBox[{"0.1", "+", "0.03", "+", "lo", "+", "slo"}]}], "}"}]}], 
         "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.7"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Gemcitabine + Carboplatin\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Bevacizumab\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 4E.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9, {
   3.6913370241064453`*^9, 3.6913371276353674`*^9}, {3.69133732349457*^9, 
   3.69133732367258*^9}, {3.6913376565896215`*^9, 3.6913376949968185`*^9}, {
   3.6913377625116796`*^9, 3.6913377626866903`*^9}, {3.691338104164222*^9, 
   3.6913381171199627`*^9}, {3.6913381542350855`*^9, 
   3.6913381648576927`*^9}, {3.6913381979015827`*^9, 
   3.6913382016737986`*^9}, {3.6913385941242456`*^9, 3.691338655953782*^9}, 
   3.7161260448829584`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "12"}], 
   RowBox[{"(*", " ", "months", " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "SubSampledBestOfMidCorrelatedMonoPairs", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "ComboSurvivalDistribution", ",", "PatientsPerArmOfSimulatedTrial"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probability at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
   3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
   3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
   3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
   3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}, 
   3.7161255958372746`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"OvarianBevacizumabHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}, {3.7042090844199343`*^9, 3.704209087256097*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 4F - Previously treated metastatic colorectal carcinoma\n",
 StyleBox["Near-identical code as for Figure 4A is here employed to generate \
Figure 4F. Comments will be more brief.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6913349412163115`*^9, 3.691334947328661*^9}, {
  3.6913350087441735`*^9, 3.69133509102588*^9}, {3.6913371794183292`*^9, 
  3.6913371948222103`*^9}, {3.691337767326956*^9, 3.6913377848789597`*^9}, {
  3.6913382689076443`*^9, 3.6913383289650793`*^9}, {3.6913387511922293`*^9, 
  3.691338775797637*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure4FRawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "8", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "eighth", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet"}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.691335120807583*^9, 
  3.691335121159603*^9}, {3.691335153027426*^9, 3.6913351618209295`*^9}, {
  3.6913373428176746`*^9, 3.6913373574995146`*^9}, {3.6913377883631587`*^9, 
  3.6913377939564786`*^9}, {3.691338332081258*^9, 3.6913383487372103`*^9}, {
  3.69133877882581*^9, 3.691338778983819*^9}, {3.691338957177011*^9, 
  3.6913389612082415`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Therapy1SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4FRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
         "contains", " ", "PFS", " ", "data", " ", "for", " ", "FOLFOX"}], 
        "-", "4"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy2SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4FRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "bevacizumab"}],
        "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4FRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "the", " ", 
        "combination"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6913351250408254`*^9, 
  3.6913351370215106`*^9}, {3.691335177937851*^9, 3.691335183565173*^9}, {
  3.6913373331711235`*^9, 3.69133736336185*^9}, {3.6913377983627305`*^9, 
  3.691337808963337*^9}, {3.691338335527455*^9, 3.691338362775013*^9}, {
  3.69133878249802*^9, 3.691338795157744*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"within", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"resample", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{"need", " ", "to", " ", "sub"}], "-", 
      RowBox[{"sample", " ", "the", " ", "FOLFOX"}], "-", 
      RowBox[{"4", " ", "distribution", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "more", " ", "vertical", " ", "pixels", " ", "than", " ", "the", " ",
           "bevacizumab", " ", "distribution"}], ")"}], ".", " ", "The"}], 
       " ", "number", " ", "of", " ", "pixels", " ", "is", " ", "vastly", " ",
        "in", " ", "excess", " ", "of", " ", "the", " ", "number", " ", "of", 
       " ", "patients", " ", "so", " ", "no", " ", "individual", " ", 
       RowBox[{"patient", "'"}], "s", " ", "information", " ", "is", " ", 
       RowBox[{"lost", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Therapy1SurvivalDistribution", ",", 
            RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
  3.6913353590842123`*^9}, {3.6913373740764627`*^9, 3.6913373806838408`*^9}, {
  3.691337831883648*^9, 3.6913378629224234`*^9}, {3.6913383787029243`*^9, 
  3.6913383875924325`*^9}, {3.6913388353150406`*^9, 3.6913388482777824`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "12700"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyFtIk2EAh/GRjA3BnEZzZQimbBqi4MU6COJ7k3O0GmJtrLHCs+zbQWNu
TExjwxSGoCbhwHIXC2oqBQNHVKvQkqGioigVrAxM+FRmDvFU6/u/XTz84Mmu
tlTWneDxeDlcUO2sPVumYIlxUCyDv8JXFfBJygUV7P6zroOJgTI99DanTsBi
uTQEq0a1b2Do+4e3cMm18xlK5UdU+ULFLIzZuqjM/NDH1hssGbvsmYLu4ZK/
sP18RQJK313j2zkdkevU4zmtCKoEc+lwQrqRAZlbaRL6K7+Uwr2vMgITK04l
1JIQdaNhO/8n56IzUgCV6kmdSM2SR75pPTw0HDRAsaCvEY70Z5phqbnLDnkn
JW64z/f2wAeNybtpnAX5p6lWRVF54DZL4sGtm9AaiN+BjoPlGnhOUmyGYx0p
FpglMzGHLSzpNXhNMOtSXwucfqa5ByOnkhzwymNLGxS2Bzvg09efOmEwend8
x8YSjy33FbwY/d10zFko3KWKVS+/Pe9kSZ6e/IDjdmYTCnWzW3ByJrz6gvNM
bI1q9NWJA5xxv+u/730amGHxUyVMfT+8P/CQ+g9CYxqE
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "12700"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4DoZWnWeZ+AdNyidQUgOuLxl8w/QHrXZwh9xvP9u5UN
rx2lnHM/gGiNmAnfQPTVvh9g+o2d/a1VQPrimTQwzabNI74aSHesMAbTEQHu
kSBa8rA3mGaWfTYbRAs8YJ8DogHjirMw
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}, 
   3.691337966153328*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "44500"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617586751399307`*^9, 3.6617587767057395`*^9}, {
   3.6617590422109256`*^9, 3.6617590813141623`*^9}, {3.6617591912184486`*^9, 
   3.661759202018066*^9}, {3.6617599284826174`*^9, 3.6617599371941156`*^9}, {
   3.661759970771036*^9, 3.6617599820586815`*^9}, {3.6617600635473423`*^9, 
   3.66176006385036*^9}, {3.6617601063067884`*^9, 3.6617601082018967`*^9}, {
   3.665540628806692*^9, 3.6655406523820405`*^9}, {3.665541105862978*^9, 
   3.66554111428546*^9}, {3.6655411623982115`*^9, 3.6655411624622154`*^9}, {
   3.6655412507752666`*^9, 3.665541270438391*^9}, {3.665541311254726*^9, 
   3.6655413125417995`*^9}, {3.6655416228225465`*^9, 
   3.6655416412456007`*^9}, {3.6655417158388667`*^9, 
   3.6655417177579765`*^9}, {3.665762639450184*^9, 3.6657626623274927`*^9}, {
   3.665855190134801*^9, 3.665855206269724*^9}, {3.665855295792844*^9, 
   3.665855300532115*^9}, {3.6658553448616486`*^9, 3.6658554202009573`*^9}, {
   3.665855520751709*^9, 3.6658555648132286`*^9}, {3.665858456325257*^9, 
   3.665858456661276*^9}, {3.6719396414775925`*^9, 3.671939759428339*^9}, {
   3.6719398396459274`*^9, 3.6719398706867027`*^9}, {3.671939953565443*^9, 
   3.6719399604218354`*^9}, {3.684160355411025*^9, 3.6841603648240423`*^9}, {
   3.6841604045381002`*^9, 3.684160410739109*^9}, {3.6841604480961657`*^9, 
   3.6841604754872103`*^9}, {3.6841605096402626`*^9, 3.684160518210281*^9}, {
   3.6857153150273075`*^9, 3.685715337139349*^9}, {3.6857155081428614`*^9, 
   3.685715537642914*^9}, {3.685737295704755*^9, 3.6857372957057543`*^9}, {
   3.6913356594453917`*^9, 3.691335687618003*^9}, {3.691336984337171*^9, 
   3.6913369851182156`*^9}, {3.6913372705045385`*^9, 
   3.6913372706205454`*^9}, {3.691337438454145*^9, 3.6913374389391727`*^9}, {
   3.691337924547948*^9, 3.6913379257220154`*^9}, 3.691338490112296*^9, {
   3.6913389864226837`*^9, 3.6913389866826982`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "44500"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIT/my9BmIZrG/BqYn/Q5V
XA2klx3LBtNV16QSQPSlB4pgenWUyjwQ3XjaEEwDAOcwv8k=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
   3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
   3.691337277744953*^9}, 3.6913379775659804`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "7400"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0FtIk2EAxvGPSqzA8kBrlA6L2EGERGI4DfG9mdvIHKNsHtisFBV3MGU6
FqbmEENLXEo0qNlNSPOAMHBoaUUeGDpNDaEQgyiVj8KpmVNrfs/bxcMPnsv/
uVtmTfEhhmHE3KDaVnQmQ8GS8k6eCK6MyhXweURCFmz++yMPhh5nFEDnnZOD
MFkq9MJrPdrX0Pv13Ru40BiYgELpHlX6UTkN1y1NVMPs0/fV2SzplbWOQfuz
tH+w9rwyBIUjV8JqOK2+q9R9vzYSZoX7o+GgcPU0NORE8emv+ZwOt7+ICAwt
2lRQS7zU1ZJfkm+cczZfIlSpP+RFqlnS8WKyAO7qgiWQF95eCrscZ00w3dRU
A5kTfDvcCXM+gA2lxzejOBMlp6gViouZ7nyWbHl+XocV7i09tAY/3Yax/GQT
7K2LMEOByGjYrWTJI53TCAUp7ZVw8uWNKuiLOWyFqU/Md+HRWk8ddA2N10PP
cmFfwMKSVsuFAahx2MfhW8clH0yd6pyHksAwdWfs2BLsiTZSF1zBsn3OI93/
HXGvNb+q53rE/qEycbw2+DC3mLo3L3DBwik5daNfNgH9c5epKTLVdygva6Fq
iDzezZlUpKR2if034bp+hnpf3OiC9363UQ8AbVRI6A==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "7400"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}, {3.6913375351756773`*^9, 
   3.691337536029726*^9}, {3.6913380016593585`*^9, 3.691338001718362*^9}, {
   3.6913385153667407`*^9, 3.6913385154457455`*^9}, {3.69133901730945*^9, 
   3.691339017845481*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy2SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "vertical", " ", "offset"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", "0.58"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "simulated", "*)"}], 
   RowBox[{
    RowBox[{"slo", "=", 
     RowBox[{"-", "0.03"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lho", "=", "6.5"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy2SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "ComboSurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "13"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "12.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"18", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<4.4\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<2.6\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<7.4\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<5.6\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.9"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.9"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.9"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "0.9"}], ",", 
            RowBox[{"0.1", "-", "0.03", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.6"}], ",", 
            RowBox[{"0.1", "+", "0.03", "+", "lo", "+", "slo"}]}], "}"}]}], 
         "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.9"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<FOLFOX4\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Bevacizumab\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 4F.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9, {
   3.6913370241064453`*^9, 3.6913371276353674`*^9}, {3.69133732349457*^9, 
   3.69133732367258*^9}, {3.6913376565896215`*^9, 3.6913376949968185`*^9}, {
   3.6913377625116796`*^9, 3.6913377626866903`*^9}, {3.691338104164222*^9, 
   3.6913381171199627`*^9}, {3.6913381542350855`*^9, 
   3.6913381648576927`*^9}, {3.6913381979015827`*^9, 
   3.6913382016737986`*^9}, {3.6913385941242456`*^9, 3.691338655953782*^9}, {
   3.6913387457729197`*^9, 3.6913387459679303`*^9}, {3.6913390895755835`*^9, 
   3.691339117371174*^9}, 3.716126044893959*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "12"}], 
   RowBox[{"(*", " ", "months", " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "SubSampledBestOfMidCorrelatedMonoPairs", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "ComboSurvivalDistribution", ",", "PatientsPerArmOfSimulatedTrial"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probability at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
   3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
   3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
   3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
   3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}, 
   3.716125595997284*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ColorectalBevacizumabHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}, {3.7042090844199343`*^9, 3.704209087256097*^9}, {
  3.704209147499542*^9, 3.7042091489836273`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 4G - Advanced pancreatic cancer, 5-fluorouracil plus oxaliplatin\n",
 StyleBox["Near-identical code as for Figure 4A is here employed to generate \
Figure 4G. Comments will be more brief.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6913349412163115`*^9, 3.691334947328661*^9}, {
  3.6913350087441735`*^9, 3.69133509102588*^9}, {3.6913371794183292`*^9, 
  3.6913371948222103`*^9}, {3.691337767326956*^9, 3.6913377848789597`*^9}, {
  3.6913382689076443`*^9, 3.6913383289650793`*^9}, {3.6913387511922293`*^9, 
  3.691338775797637*^9}, {3.7099336621377287`*^9, 3.7099336871781607`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure4GRawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "9", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "ninth", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet"}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.691335120807583*^9, 
  3.691335121159603*^9}, {3.691335153027426*^9, 3.6913351618209295`*^9}, {
  3.6913373428176746`*^9, 3.6913373574995146`*^9}, {3.6913377883631587`*^9, 
  3.6913377939564786`*^9}, {3.691338332081258*^9, 3.6913383487372103`*^9}, {
  3.69133877882581*^9, 3.691338778983819*^9}, {3.691338957177011*^9, 
  3.6913389612082415`*^9}, {3.7099336920174375`*^9, 3.7099336924584627`*^9}, {
  3.70993372369825*^9, 3.7099337284415207`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Therapy1SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4GRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
         "contains", " ", "PFS", " ", "data", " ", "for", " ", "5"}], "-", 
        "fluorouracil"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy2SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4GRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "oxaliplatin"}],
        "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4GRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "the", " ", 
        "combination"}], "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6913351250408254`*^9, 
  3.6913351370215106`*^9}, {3.691335177937851*^9, 3.691335183565173*^9}, {
  3.6913373331711235`*^9, 3.69133736336185*^9}, {3.6913377983627305`*^9, 
  3.691337808963337*^9}, {3.691338335527455*^9, 3.691338362775013*^9}, {
  3.69133878249802*^9, 3.691338795157744*^9}, {3.7099336945945845`*^9, 
  3.7099336978257694`*^9}, {3.709933741082244*^9, 3.709933747929635*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Therapy2SurvivalDistribution", ",", 
            RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
  3.6913353590842123`*^9}, {3.6913373740764627`*^9, 3.6913373806838408`*^9}, {
  3.691337831883648*^9, 3.6913378629224234`*^9}, {3.6913383787029243`*^9, 
  3.6913383875924325`*^9}, {3.6913388353150406`*^9, 3.6913388482777824`*^9}, {
  3.709933789606019*^9, 3.709933830074334*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "12500"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyF9IU2EAhvGhyIZgqeFcfxB0smmIwS5mJYjfTU5pOqRyzKFlmorHzZS1
MVlTHNNAhDklGmgNMtKpFA0cUamhJcOJhVJooBaUcJw4HZHLWuf9unj4wZNe
oy+vi+HxeJlcUGWuPVWoYEnToFAKf0xfUsDhhLNK2PPnuwZGnYVa6Lp9fArK
5BIfvDKufgV9m7Ov4UpX6D2UyH9T5R+KA3DPYKcyyw/e3iljycSF3nloG8r/
Cy0ZxVEoeXM5zshp8pdSj5bUiVDJX0qGU5LtVMhcSxLRX75WAH+uSwmMfjKX
QDXxUbfrd7O/cX40+3NgiWpOk6hiyYB7QQsjVYf1UMh3NMBH/ad1sEBnN0Le
MZEN/opz3YOdDfEHSZw52SnUFsW5Ik8lS8Le4FXY4glXQ9Ph6k14RiTTwQlr
gh6mSZuZSCtL+qpczTDtvKMVLjypaIP+E7EmePG+vh0KLF4rfPjyXQf0blyf
DBlY0mvIfA7zNvYbjzhzBQdUofLZl9EOlmRpyRacNDI7UKAJBOHc4vTnMc6T
e1+pTe46oYczPNL13xl3BUzVj1BFzK1+eNfZTX3qqBaLH7PkRfIN6j8owiFv

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "12500"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4DoZWnWeZ+AdNyidQUgOuLxl8w/QHrXZwh9xvP9u5UN
rx2lnHM/gGiNmAnfQPTVvh9g+o2d/a1VQPrimTQwzabNI74aSHesMAbTEQHu
kSBa8rA3mGaWfTYbRAs8YJ8DovPeSKgoL3nteOO8HJgGAFcVupY=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy1SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}, 
   3.691337966153328*^9, 3.7099338802582045`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "44000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617586751399307`*^9, 3.6617587767057395`*^9}, {
   3.6617590422109256`*^9, 3.6617590813141623`*^9}, {3.6617591912184486`*^9, 
   3.661759202018066*^9}, {3.6617599284826174`*^9, 3.6617599371941156`*^9}, {
   3.661759970771036*^9, 3.6617599820586815`*^9}, {3.6617600635473423`*^9, 
   3.66176006385036*^9}, {3.6617601063067884`*^9, 3.6617601082018967`*^9}, {
   3.665540628806692*^9, 3.6655406523820405`*^9}, {3.665541105862978*^9, 
   3.66554111428546*^9}, {3.6655411623982115`*^9, 3.6655411624622154`*^9}, {
   3.6655412507752666`*^9, 3.665541270438391*^9}, {3.665541311254726*^9, 
   3.6655413125417995`*^9}, {3.6655416228225465`*^9, 
   3.6655416412456007`*^9}, {3.6655417158388667`*^9, 
   3.6655417177579765`*^9}, {3.665762639450184*^9, 3.6657626623274927`*^9}, {
   3.665855190134801*^9, 3.665855206269724*^9}, {3.665855295792844*^9, 
   3.665855300532115*^9}, {3.6658553448616486`*^9, 3.6658554202009573`*^9}, {
   3.665855520751709*^9, 3.6658555648132286`*^9}, {3.665858456325257*^9, 
   3.665858456661276*^9}, {3.6719396414775925`*^9, 3.671939759428339*^9}, {
   3.6719398396459274`*^9, 3.6719398706867027`*^9}, {3.671939953565443*^9, 
   3.6719399604218354`*^9}, {3.684160355411025*^9, 3.6841603648240423`*^9}, {
   3.6841604045381002`*^9, 3.684160410739109*^9}, {3.6841604480961657`*^9, 
   3.6841604754872103`*^9}, {3.6841605096402626`*^9, 3.684160518210281*^9}, {
   3.6857153150273075`*^9, 3.685715337139349*^9}, {3.6857155081428614`*^9, 
   3.685715537642914*^9}, {3.685737295704755*^9, 3.6857372957057543`*^9}, {
   3.6913356594453917`*^9, 3.691335687618003*^9}, {3.691336984337171*^9, 
   3.6913369851182156`*^9}, {3.6913372705045385`*^9, 
   3.6913372706205454`*^9}, {3.691337438454145*^9, 3.6913374389391727`*^9}, {
   3.691337924547948*^9, 3.6913379257220154`*^9}, 3.691338490112296*^9, {
   3.6913389864226837`*^9, 3.6913389866826982`*^9}, {3.709933866793434*^9, 
   3.709933866841437*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "44000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIT/my9BmIZrG/BqYn/Q5V
XA2klx3LBtNV16QSQPSlB4pgenWUyjwQ3XjaEEyv4finqbzkteOcmwxaIBoA
JZPHKg==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy1SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy1SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
   3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
   3.691337277744953*^9}, 3.6913379775659804`*^9, 3.7099339110419645`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "7400"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0FtIk2EAxvGPSqzA8kBrlA6L2EGERGI4DfG9mdvIHKNsHtisFBV3MGU6
FqbmEENLXEo0qNlNSPOAMHBoaUUeGDpNDaEQgyiVj8KpmVNrfs/bxcMPnsv/
uVtmTfEhhmHE3KDaVnQmQ8GS8k6eCK6MyhXweURCFmz++yMPhh5nFEDnnZOD
MFkq9MJrPdrX0Pv13Ru40BiYgELpHlX6UTkN1y1NVMPs0/fV2SzplbWOQfuz
tH+w9rwyBIUjV8JqOK2+q9R9vzYSZoX7o+GgcPU0NORE8emv+ZwOt7+ICAwt
2lRQS7zU1ZJfkm+cczZfIlSpP+RFqlnS8WKyAO7qgiWQF95eCrscZ00w3dRU
A5kTfDvcCXM+gA2lxzejOBMlp6gViouZ7nyWbHl+XocV7i09tAY/3Yax/GQT
7K2LMEOByGjYrWTJI53TCAUp7ZVw8uWNKuiLOWyFqU/Md+HRWk8ddA2N10PP
cmFfwMKSVsuFAahx2MfhW8clH0yd6pyHksAwdWfs2BLsiTZSF1zBsn3OI93/
HXGvNb+q53rE/qEycbw2+DC3mLo3L3DBwik5daNfNgH9c5epKTLVdygva6Fq
iDzezZlUpKR2if034bp+hnpf3OiC9363UQ8AbVRI6A==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "7400"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}, {3.6913375351756773`*^9, 
   3.691337536029726*^9}, {3.6913380016593585`*^9, 3.691338001718362*^9}, {
   3.6913385153667407`*^9, 3.6913385154457455`*^9}, {3.69133901730945*^9, 
   3.691339017845481*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "achieved", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}, {
  3.7099339553544993`*^9, 3.7099339571696033`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy2SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "vertical", " ", "offset"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", "0.58"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "simulated", "*)"}], 
   RowBox[{
    RowBox[{"slo", "=", 
     RowBox[{"-", "0.03"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lho", "=", "4.5"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SurvivalFunction", "[", 
           RowBox[{
           "EmpiricalDistribution", "[", 
            "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x",
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SurvivalFunction", "[", 
           RowBox[{
           "EmpiricalDistribution", "[", 
            "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SurvivalFunction", "[", 
           RowBox[{
           "EmpiricalDistribution", "[", 
            "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
          "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SurvivalFunction", "[", 
           RowBox[{
           "EmpiricalDistribution", "[", "Therapy2SurvivalDistribution", 
            "]"}], "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "4.3"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "11"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"ColorData", "[", 
               RowBox[{"3", ",", "4"}], "]"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ","}], 
           "*)"}], 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "6"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
       ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"100", "*", "i"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "1", ",", 
                RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "i", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
            ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
          ",", 
          RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"2", "/", "3"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
       RowBox[{"FillingStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotPoints", "\[Rule]", "500"}]}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SurvivalFunction", "[", 
          RowBox[{
          "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}],
           "]"}], "[", "x", "]"}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "4.9"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "11"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ","}], "*)"}], 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "4"}], "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "*)"}], 
         "}"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"100", "*", "i"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "1", ",", 
                RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "i", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
            ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
          ",", 
          RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"2", "/", "3"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", "None"}], ",", 
       RowBox[{"FillingStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotPoints", "\[Rule]", "500"}]}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SurvivalFunction", "[", 
          RowBox[{
          "EmpiricalDistribution", "[", "ComboSurvivalDistribution", "]"}], 
          "]"}], "[", "x", "]"}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "10.85"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "11"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"AbsoluteThickness", "[", "1.7", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ","}], 
          "*)"}], 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "6"}], "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "}"}]}], 
       ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"100", "*", "i"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "1", ",", 
                RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "i", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
            ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
          ",", 
          RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"2", "/", "3"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", "None"}], ",", 
       RowBox[{"FillingStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotPoints", "\[Rule]", "500"}]}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"11", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.12", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<1.5   \>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<   1.9\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<4.2\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<   2.0\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.9"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.9"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.9"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.18", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "0.9"}], ",", 
            RowBox[{"0.1", "-", "0.03", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.6"}], ",", 
            RowBox[{"0.1", "+", "0.03", "+", "lo", "+", "slo"}]}], "}"}]}], 
         "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.7", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "0.9"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lho", "+", "1.6"}], ",", 
             RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<5-Fluorouracil\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Oxaliplatin\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.18", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lho", "+", "1.8"}], ",", 
            RowBox[{"0.1", "+", "lo", "+", "slo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 4G.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7099097267360554`*^9, 3.7099100087581863`*^9}, {
   3.7099100459513135`*^9, 3.7099100467033567`*^9}, {3.709910144776966*^9, 
   3.709910145153988*^9}, {3.709934044229583*^9, 3.7099342938628607`*^9}, 
   3.71612949405724*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "4.3"}], 
   RowBox[{"(*", " ", 
    RowBox[{"months", " ", "-", " ", 
     RowBox[{
     "the", " ", "longest", " ", "reported", " ", "duration", " ", "of", " ", 
      "PFS", " ", "for", " ", "Oxaliplatin"}]}], " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "SubSampledBestOfMidCorrelatedMonoPairs", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "ComboSurvivalDistribution", ",", "PatientsPerArmOfSimulatedTrial"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}, {3.709934345738828*^9, 3.709934358546561*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probabilty at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
  3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
  3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
  3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
  3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"PancreaticCancerOXFUHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}, {3.7042090844199343`*^9, 3.704209087256097*^9}, {
  3.704209147499542*^9, 3.7042091489836273`*^9}, {3.7099306527225995`*^9, 
  3.7099306632101994`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 4I employs a different analysis due to the available clinical data \
for cetuximab and chemotherapy in metastatic colorectal cancer\n",
 StyleBox["Data was not available for first-line cetuximab monotherapy, but \
rather, Overall Survival (as compared to Progression Free Survival) for \
chemotherapy (FOLFIRI or FOLFOX4) with or without cetuximab as first-line \
treatment, and a comparison of Overall Survival with cetuximab monotherapy or \
with supportive care (in the absence of any chemotherapy) in the setting of \
chemotherapy-refractory disease.\nWe take the distribution of overall \
survival benefit from cetuximab monotherapy in the chemotherapy-refractory \
setting, and compare it to the overall survival benefit from combining \
cetuximab with chemotherapy as first-line treatment.\n\nNote that all other \
models that employ randomly sampling responses make use of Progression Free \
Survival data, not Overall Survival. We do not conduct any analysis that \
randomly samples from Overall Survival distributions because of concern that \
it is highly influenced by health factors that do not depend on a tumor\
\[CloseCurlyQuote]s drug sensitivity, and therefore overall survival may be \
highly correlated between drug treatments regardless of differences or \
similarities in drug mechanism.\nThis analysis of Overall Survival in \
metastatic colorectal cancer does not randomly sample these distributions, \
but keeps the distributions sorted from shortest to longest overall survival; \
this effectively assumes that overall survival is highly correlated: patients \
with the shortest (or longest) survival when treated with first-line \
chemotherapy are assumed to correspond to those with shortest (or longest) \
survival in the distribution of effects of cetuximab in the \
chemotherapy-refractory setting.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.685737663877813*^9, 3.6857377270234246`*^9}, {
  3.685737868528518*^9, 3.685737984592157*^9}, {3.685738113736543*^9, 
  3.6857382434969654`*^9}, {3.6857382773689027`*^9, 3.6857383409365387`*^9}, {
  3.6857384072873335`*^9, 3.6857384918481703`*^9}, {3.685738521935891*^9, 
  3.685738710832695*^9}, {3.6857390885452995`*^9, 3.6857391381131344`*^9}, {
  3.685739168361864*^9, 3.685739250424558*^9}, {3.685754422265338*^9, 
  3.6857544263515716`*^9}, {3.68575454556139*^9, 3.6857546601689453`*^9}, {
  3.691337724274493*^9, 3.691337724429502*^9}, {3.6913424851998024`*^9, 
  3.6913424857318325`*^9}, {3.7161289614637775`*^9, 3.716128961751794*^9}}],

Cell[CellGroupData[{

Cell["\<\
Importing survival data as tabulated in 'Table of survival \
distributions.xlsx' :\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857179675202293`*^9, 3.685717973349243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure4IRawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "10", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "tenth", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet", " ", "contains", " ", "overall", " ", "survival", " ", 
      "data", " ", "for", " ", "chemotherapy", " ", "and", " ", "cetuximab", 
      " ", "in", " ", "metastatic", " ", "colorectal", " ", "cancer"}], " ", 
     "*)"}], " ", "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.6857387685129943`*^9, 
  3.6857388219280496`*^9}, {3.7161289581845894`*^9, 3.716128958423603*^9}, {
  3.716128999479952*^9, 3.7161289997519674`*^9}, {3.716129029959695*^9, 
  3.71612903039172*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FirstLineChemotherapySurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4IRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
         "contains", " ", "OS", " ", "data", " ", "for", " ", "first"}], "-", 
        RowBox[{"line", " ", "chemotherapy"}]}], "*)"}], 
      "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FirstLineCombinationSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4IRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
         "contains", " ", "OS", " ", "data", " ", "for", " ", "first"}], "-", 
        RowBox[{
        "line", " ", "chemotherapy", " ", "plus", " ", "cetuximab"}]}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefractorySupportiveCareSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4IRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
         "contains", " ", "OS", " ", "data", " ", "for", " ", "supportive", 
         " ", "care", " ", "in", " ", "chemotherapy"}], "-", 
        RowBox[{"refrctory", " ", "disease"}]}], "*)"}], 
      "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefractoryCetuximabSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure4IRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "5"}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "column", " ", "5", " ", "of", " ", "this", " ", "spreadsheet", " ", 
         "contains", " ", "OS", " ", "data", " ", "for", " ", "cetuximab", 
         " ", "monotherapy", " ", "in", " ", "chemotherapy"}], "-", 
        RowBox[{"refrctory", " ", "disease"}]}], "*)"}], 
      "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6857390677541103`*^9, 
  3.6857390691531897`*^9}, {3.6857393170253677`*^9, 3.68573943053586*^9}, {
  3.716129013907777*^9, 3.7161290167459393`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Median", " ", "PFS", " ", "in", " ", "the", " ", "chemotherapy", " ", 
     "refractory", " ", "setting"}], ",", " ", 
    RowBox[{
    "with", " ", "cetuximab", " ", "or", " ", "supportive", " ", "care"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CetuxMedian", "=", 
    RowBox[{"Median", "[", "RefractoryCetuximabSurvivalDistribution", "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"SupportiveMedian", "=", 
    RowBox[{
    "Median", "[", "RefractorySupportiveCareSurvivalDistribution", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.685753235076434*^9, 3.685753264288105*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plotting the benefit of cetuximab observed in the chemotherapy refractory \
setting\
\>", "Subsubsection",
 CellChangeTimes->{{3.685753271156498*^9, 3.685753285480317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "vertical", " ", "offset", " ", "and", " ", "horizontal", " ", "offset", 
    " ", "parameters", " ", "to", " ", "adjust", " ", "position", " ", "of", 
    " ", "the", " ", "inset", " ", "plot", " ", "legend"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vo", "=", 
     RowBox[{"-", "0.13"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ho", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "RefractoryCetuximabSurvivalDistribution", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "RefractorySupportiveCareSurvivalDistribution", "]"}], "]"}], "[", 
        "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "a", " ", "truncated", " ", "version", " ", "is", " ", "included", 
         " ", "in", " ", "order", " ", "for", " ", "the", " ", "shading", " ",
          "to", " ", "appear", " ", "only", " ", "at", " ", "probability", 
         " ", "levels", " ", "reached", " ", "by", " ", "both", " ", 
         "distributions"}], " ", "*)"}], 
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{"0.19", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{
            "EmpiricalDistribution", "[", 
             "RefractorySupportiveCareSurvivalDistribution", "]"}], "]"}], 
           "[", "x", "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "14"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "33"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "0", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "0.1", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", "\"\<Overall survival (months)\>\"", "]"}], ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.9", ",", "0.65", ",", "0.8"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"5.5", "+", "ho"}], ",", 
             RowBox[{"0.94", "+", "vo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"6.7", "+", "ho"}], ",", 
             RowBox[{"0.94", "+", "vo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"5.5", "+", "ho"}], ",", 
             RowBox[{"1.03", "+", "vo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"6.7", "+", "ho"}], ",", 
             RowBox[{"1.03", "+", "vo"}]}], "}"}]}], "}"}], "]"}], ",", 
        "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Cetuximab monotherapy\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"7", "+", "ho"}], ",", 
            RowBox[{"0.94", "+", "vo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Supportive care\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"7", "+", "ho"}], ",", 
            RowBox[{"1.03", "+", "vo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Benefit of Cetuximab\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"7", "+", "ho"}], ",", 
            RowBox[{"0.85", "+", "vo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"SupportiveMedian", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"SupportiveMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.4"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"SupportiveMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"SupportiveMedian", ",", 
             RowBox[{"1.03", "+", "0.01"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", "0.1"}], 
         "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"CetuxMedian", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"CetuxMedian", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"CetuxMedian", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"CetuxMedian", ",", 
             RowBox[{"1.03", "+", "0.01"}]}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.9", ",", "0.65", ",", "0.8"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"5.5", "+", "ho"}], ",", 
            RowBox[{"0.88", "+", "vo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"6.7", "+", "ho"}], ",", 
            RowBox[{"0.825", "+", "vo"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"33", ",", "1.11"}], "}"}]}], "]"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 4I, chemotherapy refractory.pdf\>\""}], ",", "%", ",", 
      "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6857532040916624`*^9, 3.685753214285245*^9}, {
   3.685753288454488*^9, 3.685753344815711*^9}, {3.685753378206621*^9, 
   3.6857533882381945`*^9}, {3.6857540124979005`*^9, 
   3.6857540857990932`*^9}, {3.6857542900827775`*^9, 3.685754370463375*^9}, {
   3.691339212462612*^9, 3.69133922955659*^9}, 3.7161260449069595`*^9, 
   3.716129018483039*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the distribution of survival benefits of cetuximab monotherapy \
compared to supportive care\
\>", "Subsubsection",
 CellChangeTimes->{{3.685754107346326*^9, 3.685754138527109*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BenefitOfCetuximabDistribution", "=", 
   RowBox[{
    RowBox[{"Sort", "[", "RefractoryCetuximabSurvivalDistribution", "]"}], 
    "-", 
    RowBox[{
    "Sort", "[", "RefractorySupportiveCareSurvivalDistribution", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685739469458086*^9, 3.6857394895212336`*^9}, {
  3.6857540982238035`*^9, 3.685754106415272*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Survival", " ", "distribution", " ", "has", " ", "more", " ", "elements",
      " ", "in", " ", "the", " ", "chemotherapy", " ", "refractory", " ", 
     "dataset", " ", "than", " ", "the", " ", "first"}], "-", 
    RowBox[{"line", " ", "dataset"}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{"Length", "[", "BenefitOfCetuximabDistribution", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Length", "[", "FirstLineChemotherapySurvivalDistribution", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6857395579321465`*^9, 3.6857396741777954`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "need", " ", "to", " ", "select", " ", "a", " ", "subset", " ",
      "of", " ", "the", " ", "cetuximab", " ", "benefit", " ", "distribution",
      " ", "that", " ", "is", " ", "uniformly", " ", "spaced", " ", "and", 
     " ", "contains", " ", "exactly", " ", "as", " ", "many", " ", "entries", 
     " ", "as", " ", "the", " ", "first"}], "-", 
    RowBox[{"line", " ", "survival", " ", "distribution"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "IntegersUniformlyDistributedToLengthOfFirstLineDistribution", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Round", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "BenefitOfCetuximabDistribution", "]"}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "BenefitOfCetuximabDistribution", "]"}], "/", 
          RowBox[{
          "Length", "[", "FirstLineChemotherapySurvivalDistribution", 
           "]"}]}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "we", " ", "have", " ", "created", " ", "is", " ", "a", " ", 
     "list", " ", 
     RowBox[{"of", " ", "~", "3000"}], " ", "integers", " ", 
     RowBox[{"(", 
      RowBox[{
      "the", " ", "length", " ", "of", " ", "the", " ", "first", " ", "line", 
       " ", "chemotherapy", " ", "survival", " ", "distribution"}], ")"}], 
     " ", "which", " ", "are", " ", "uniformly", " ", "distributed", " ", 
     "over", " ", "the", " ", "range", " ", "from", " ", "1", " ", 
     RowBox[{"to", " ", "~", "3900"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "the", " ", "length", " ", "of", " ", "the", " ", "cetuximab", " ", 
        "monotherapy", " ", "survival", " ", "distribution"}], ")"}], "."}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
   "ListPlot", "[", 
    "IntegersUniformlyDistributedToLengthOfFirstLineDistribution", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685739676297917*^9, 3.6857397356333103`*^9}, {
  3.685752383095704*^9, 3.6857524964481874`*^9}, {3.6857525345273657`*^9, 
  3.685752620224267*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "above", " ", "list", " ", "of", " ", "integers", " ", "is", 
     " ", "used", " ", "to", " ", "select", " ", "a", " ", "uniformly", " ", 
     "distributed"}], ",", " ", 
    RowBox[{
     RowBox[{"representative", " ", "sub"}], "-", 
     RowBox[{
     "sampling", " ", "of", " ", "the", " ", "cetuximab", " ", "monotherapy", 
      " ", "distribution", " ", "that", " ", "is", " ", "matching", " ", "in",
       " ", "length", " ", "to", " ", "the", " ", "first"}], "-", 
     RowBox[{
     "line", " ", "chemotherapy", " ", "survival", " ", "distribution"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BenefitOfCetuximabDistributionLengthMatched", "=", 
    RowBox[{
    "BenefitOfCetuximabDistribution", "\[LeftDoubleBracket]", 
     "IntegersUniformlyDistributedToLengthOfFirstLineDistribution", 
     "\[RightDoubleBracket]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.685739754769405*^9, 3.685739760640741*^9}, {
  3.685752602024226*^9, 3.685752676085462*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Adding the survival benefits of cetuximab monotherapy (relative to supportive \
care) to the distribution of survival times observed with first-line \
chemotherapy\
\>", "Subsubsection",
 CellChangeTimes->{{3.685754147651631*^9, 3.6857541906070876`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Now", " ", "that", " ", "we", " ", "have", " ", "a", " ", 
      "distribution", " ", "of", " ", "the", " ", "survival", " ", "benefits",
       " ", "of", " ", "cetuximab", " ", "monotherapy", 
      RowBox[{"(", 
       RowBox[{"compared", " ", "to", " ", "supportive", " ", "care"}], ")"}],
       " ", "that", " ", "is", " ", "matching", " ", "in", " ", "length", " ",
       "to", " ", "the", " ", "distribution", " ", "of", " ", "survival", " ",
       "times", " ", "with", " ", "first"}], "-", 
     RowBox[{"line", " ", "chemotherapy"}]}], ",", " ", 
    RowBox[{
    "these", " ", "distributions", " ", "can", " ", "be", " ", "added", " ", 
     "together", " ", "to", " ", "produce", " ", 
     RowBox[{"a", " ", "'"}], 
     RowBox[{"simulated", "'"}], " ", "survival", " ", "distribution", " ", 
     "expected", " ", "in", " ", "the", " ", "absence", " ", "of", " ", "any",
      " ", "synergistic", " ", "drug", " ", "interaction"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ChemotherapyPlusCetuximabSimulatedCombination", "=", 
    RowBox[{
     RowBox[{"Sort", "[", "FirstLineChemotherapySurvivalDistribution", "]"}], 
     "+", "BenefitOfCetuximabDistributionLengthMatched"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6857397908094664`*^9, 3.6857397986969175`*^9}, {
  3.6857526788076177`*^9, 3.6857528213597713`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "calculating", " ", "median", " ", "overall", " ", "survival", " ", 
      "observed", " ", "with", " ", "first"}], "-", 
     RowBox[{
     "line", " ", "chemotherapy", " ", "or", " ", "cetuximab", " ", "plus", 
      " ", "chemotherapy"}]}], ",", " ", 
    RowBox[{
    "and", " ", "as", " ", "simulated", " ", "in", " ", "the", " ", "absence",
      " ", "of", " ", "drug", " ", "synergy"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ChemoMedian", "=", 
    RowBox[{
    "Median", "[", "FirstLineChemotherapySurvivalDistribution", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ComboMedian", "=", 
    RowBox[{
    "Median", "[", "FirstLineCombinationSurvivalDistribution", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"SimMedian", "=", 
    RowBox[{
    "Median", "[", "ChemotherapyPlusCetuximabSimulatedCombination", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6756485342014866`*^9, 3.67564855315357*^9}, {
  3.6756486114429045`*^9, 3.675648613441019*^9}, {3.685752845952178*^9, 
  3.6857528716796494`*^9}, {3.6857541999926243`*^9, 3.68575426111112*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", 
         "ChemotherapyPlusCetuximabSimulatedCombination", "]"}], "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", 
         "FirstLineChemotherapySurvivalDistribution", "]"}], "]"}], "[", "x", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", 
         "FirstLineCombinationSurvivalDistribution", "]"}], "]"}], "[", "x", 
       "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "35"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "33"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", "\"\<Overall survival (months)\>\"", "]"}], ",", 
       RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Gray", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"33", ",", "1.11"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "Black", ",", 
       RowBox[{"Text", "[", 
        RowBox[{"\"\<Median:\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "1.03"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"NumberForm", "[", 
           RowBox[{"ChemoMedian", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ChemoMedian", ",", "1.03"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"NumberForm", "[", 
           RowBox[{"ComboMedian", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ComboMedian", ",", "1.03"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"NumberForm", "[", 
           RowBox[{"SimMedian", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"SimMedian", ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ChemoMedian", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ChemoMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ComboMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
       "Black", ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"SimMedian", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"SimMedian", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", "\[Rule]", 
       RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
    RowBox[{"FillingStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.9", ",", "0.65", ",", "0.8"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Epilog", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
       "White", ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "4"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.0", ",", "0.38"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "0.38"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.0", ",", "0.28"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "0.28"}], "}"}]}], "}"}], "]"}], ",", "Black", 
       ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.0", ",", "0.18"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.5", ",", "0.18"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<FOLFIRI / FOLFOX4\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"3.0", ",", "0.38"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<FOLFIRI / FOLFOX4 and Cetuximab\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"3.0", ",", "0.28"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Simulated combination:\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"3.0", ",", "0.18"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<FOLFIRI / FOLFOX4 + Benefit of Cetuximab monotherapy\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"3.0", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], "]"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 4I, first line.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6857528994942403`*^9, 3.685753132262554*^9}, {
   3.6857593674561863`*^9, 3.6857593676481977`*^9}, 3.71612604491396*^9, 
   3.7161290219642377`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating the improvement in hazard ratio attributable to drug synergy.
This is the hazard ratio between the  observed combination trial results, and \
the combination trial results calculated on the assumption of ' no additivity \
or synergy'.\
\>", "Subsection",
 CellChangeTimes->{{3.7042067753908653`*^9, 3.70420686025772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CensoringTime", "=", "33"}], 
   RowBox[{"(*", " ", "months", " ", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatientsPerArmOfSimulatedTrial", "=", "1000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{
   "ChemotherapyPlusCetuximabSimulatedCombination", ",", 
    "PatientsPerArmOfSimulatedTrial"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedTrial", "[", "]"}], ":=", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{
    "FirstLineCombinationSurvivalDistribution", ",", 
     "PatientsPerArmOfSimulatedTrial"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{"PatientResponses_", ",", "CensoringTime_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResponsesShorterThanCensoringTime", ",", 
       "ResponsesLongerThanCensoringTime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ResponsesShorterThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "CensoringTime"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ResponsesLongerThanCensoringTime", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PatientResponses", ",", 
         RowBox[{
          RowBox[{"#", ">", "CensoringTime"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EventData", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
         "ResponsesShorterThanCensoringTime", ",", 
          "ResponsesLongerThanCensoringTime"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
             "Length", "[", "ResponsesShorterThanCensoringTime", "]"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "ResponsesLongerThanCensoringTime", "]"}],
              "}"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ":=", 
  RowBox[{"GenerateCensoredEventData", "[", 
   RowBox[{
    RowBox[{"IndependentActionSimulatedTrial", "[", "]"}], ",", 
    "CensoringTime"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationSimulatedEventData", "[", "]"}], ":=", 
   RowBox[{"GenerateCensoredEventData", "[", 
    RowBox[{
     RowBox[{"CombinationSimulatedTrial", "[", "]"}], ",", "CensoringTime"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "custom", " ", "function", " ", "to", " ", "join", " ", "two", " ", 
     "sets", " ", "of", " ", "event", " ", "data"}], " ", "-", " ", 
    RowBox[{
    "this", " ", "is", " ", "necessary", " ", "to", " ", "implement", " ", 
     "the", " ", "Cox", " ", "Proportional", " ", "Hazards", " ", "model"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JoinEventData", "[", 
    RowBox[{"EventData1_", ",", "EventData2_"}], "]"}], ":=", 
   RowBox[{"EventData", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"EventData1", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"EventData2", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergedEventData", "[", "]"}], ":=", 
   RowBox[{"JoinEventData", "[", 
    RowBox[{
     RowBox[{"IndependentActionSimulatedEventData", "[", "]"}], ",", 
     RowBox[{"CombinationSimulatedEventData", "[", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Independence\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"\"\<Observed\>\"", ",", 
       RowBox[{"{", "PatientsPerArmOfSimulatedTrial", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7041978194218073`*^9, 3.7041979657666993`*^9}, {
  3.7042068712633495`*^9, 3.7042068951617165`*^9}, {3.7042073510287905`*^9, 
  3.7042073724090133`*^9}, {3.7045573928324203`*^9, 3.704557409875395*^9}}],

Cell[CellGroupData[{

Cell["\<\
Note that the error range in the hazard ratio depends on the population size \
in a simulated trial of the combination, and the duration on trial, that is, \
the rate of censoring events.
Here we compute error ranges expected from 200 patients per trial arm, with \
any that are progression-free after a defined time being \
\[OpenCurlyQuote]censored\[CloseCurlyQuote]. This limits imprecision arising \
from the source PFS data having few patients \[OpenCurlyQuote]on-trial\
\[CloseCurlyQuote] at late times, which is cause of increasing error range in \
PFS probability at longer times.

The range in hazard ratio is robustly identified by taking the mean range \
over 100 simulations of such trials.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6912777530950856`*^9, 3.6912779104090834`*^9}, {
   3.6912784154099674`*^9, 3.6912784493539095`*^9}, {3.691281072137924*^9, 
   3.691281072209928*^9}, {3.6913642251615944`*^9, 3.6913642252495995`*^9}, {
   3.704206073279866*^9, 3.7042060986339016`*^9}, {3.7042066695028095`*^9, 
   3.7042067053808613`*^9}, {3.7042069152888675`*^9, 3.7042070253141603`*^9}, 
   3.7161255961402917`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfReplicateTrials", "=", "100"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "returns", " ", "the", " ", "relative", " ",
      "risk"}], ",", " ", 
    RowBox[{"and", " ", "confidence", " ", "interval"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", 
     RowBox[{"format", ":", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"95", "%", " ", "lower", " ", "confidence", " ", "interval"}],
         ",", " ", 
        RowBox[{"median", " ", "estimate"}], ",", " ", 
        RowBox[{
        "95", "%", " ", "upper", " ", "confidence", " ", "interval"}]}], " ", 
       ")"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskCalculation", "[", 
    RowBox[{"descriptors_", ",", "eventdata_", ",", "PrintTable_"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "set", " ", "to", " ", "1", " ", "to", " ", "print", " ", "to", " ", 
       "screen", " ", "the", " ", "statistical", " ", "table", " ", "of", " ",
        "Cox", " ", "Model", " ", "output"}], ";", " ", 
      RowBox[{
      "set", " ", "to", " ", "0", " ", "to", " ", "not", " ", "show", " ", 
       "output"}]}], " ", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "eventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PrintTable", "\[Equal]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RelativeRisk", "=", 
       RowBox[{
        RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskLowerConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RelativeRiskUpperConfidenceInterval", "=", 
       RowBox[{
        RowBox[{
        "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "RelativeRiskLowerConfidenceInterval", ",", "RelativeRisk", ",", 
        "RelativeRiskUpperConfidenceInterval"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "execution", " ", "of", " ", "the", " ", "simulated", " ", 
    "trial"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativeRiskCalculation", "[", 
  RowBox[{
   RowBox[{"Descriptors", "[", "]"}], ",", 
   RowBox[{"MergedEventData", "[", "]"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691281821013757*^9, 3.6912819145391064`*^9}, {
  3.6912823086516485`*^9, 3.691282371379236*^9}, {3.691282624283702*^9, 
  3.691282625147751*^9}, {3.6912827763553996`*^9, 3.69128284945158*^9}, {
  3.704206256918211*^9, 3.7042062945703645`*^9}, {3.7042070300174294`*^9, 
  3.7042070303334475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"many", " ", "replicate", " ", "trial", " ", "simulations"}], ",",
     " ", 
    RowBox[{
    "to", " ", "accurately", " ", "determine", " ", "the", " ", "range", " ", 
     "in", " ", "hazard", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ColorectalCetuximabHazardRatioRange", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRiskCalculation", "[", 
        RowBox[{
         RowBox[{"Descriptors", "[", "]"}], ",", 
         RowBox[{"MergedEventData", "[", "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", "NumberOfReplicateTrials", "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.704206383497451*^9, 3.7042064065097666`*^9}, {
  3.704206464697095*^9, 3.7042064675762596`*^9}, {3.704206714347374*^9, 
  3.704206761706083*^9}, {3.7042090844199343`*^9, 3.704209087256097*^9}, {
  3.704209147499542*^9, 3.7042091489836273`*^9}, {3.704557429617524*^9, 
  3.7045574319526577`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Hazard Ratio comparison across all trials\n",
 StyleBox["This compares the hazard ratio attributable to synergy (that is, \
the excess benefit over the model of independent action) for all combination \
trials analyzed.",
  FontSize->16]
}], "Section",
 CellChangeTimes->{{3.7045572272019463`*^9, 3.704557353809188*^9}, {
  3.709934432065766*^9, 3.7099344321297693`*^9}, {3.7161294634474893`*^9, 
  3.71612946381551*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"custom", " ", "logarithmic", " ", "tick", " ", "marks"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"label", " ", "rotation"}], " ", "*)"}], 
  RowBox[{
   RowBox[{"lr", "=", 
    RowBox[{"90", " ", "Degree"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "set", " ", "to", " ", "\"\<90 Degree\>\"", " ", "to", " ", "have", " ", 
    "hazard", " ", "ratio", " ", "labels", " ", "rotated", " ", "by", " ", 
    "90", " ", "degrees"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HazardRatioLogTicks", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "1"}], "]"}], ",", 
          RowBox[{"Rotate", "[", 
           RowBox[{"\"\<1.0\>\"", ",", "lr"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "2.0"}], "]"}], ",", 
          RowBox[{"Rotate", "[", 
           RowBox[{"\"\<2.0\>\"", ",", "lr"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "0.5"}], "]"}], ",", 
          RowBox[{"Rotate", "[", 
           RowBox[{"\"\<0.5\>\"", ",", "lr"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "0.2"}], "]"}], ",", 
          RowBox[{"Rotate", "[", 
           RowBox[{"\"\<0.2\>\"", ",", "lr"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "0.1"}], "]"}], ",", 
          RowBox[{"Rotate", "[", 
           RowBox[{"\"\<0.1\>\"", ",", "lr"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.1"}], "}"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "i"}], "]"}], ",", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1.1", ",", "1.9", ",", "0.1"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "i"}], "]"}], ",", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0.1", ",", "0.9", ",", "0.1"}], "}"}]}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"custom", " ", "function", " ", 
    RowBox[{"for", " ", "'"}], 
    RowBox[{"ErrorListPlot", "'"}], " ", "to", " ", "generate", " ", "data", 
    " ", "point", " ", "with", " ", "error", " ", "bars", " ", "on", " ", 
    "logarithmic", " ", "scale"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogErrorBar", "[", 
    RowBox[{"xcoordinate_", ",", "LowerMedianUpperDatum_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xcoordinate", ",", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", 
         RowBox[{
         "LowerMedianUpperDatum", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"ErrorBar", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{
           "LowerMedianUpperDatum", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}]}], "]"}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{
           "LowerMedianUpperDatum", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{
           "LowerMedianUpperDatum", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], "]"}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{
           "LowerMedianUpperDatum", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}]}], "]"}]}]}], "}"}], "]"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hazard1LineColor", "=", 
   RowBox[{"GrayLevel", "[", "0.5", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlignmentLineColor", "=", 
    RowBox[{"GrayLevel", "[", "0.8", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TrialLabels", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Melanoma, Nivolumab plus Ipilimumab\>\"", ",", 
      "\[IndentingNewLine]", 
      "\"\<Ovarian, Paclitaxel and Carboplatin plus Olaparib\>\"", ",", 
      "\[IndentingNewLine]", 
      "\"\<HER2+ breast, chemotherapy plus Trastuzumab\>\"", ",", 
      "\[IndentingNewLine]", "\"\<Pancreatic, Gemcitabine plus Erlotinib\>\"",
       ",", "\[IndentingNewLine]", 
      "\"\<BRAF-mut melanoma, Dabrafenib plus Trametinib\>\"", ",", 
      "\[IndentingNewLine]", 
      "\"\<Ovarian, Gemcitabine and Carboplatin plus Bevacizumab\>\"", ",", 
      "\[IndentingNewLine]", "\"\<Colorectal, FOLFOX4 plus Bevacizumab\>\"", 
      ",", "\[IndentingNewLine]", 
      "\"\<Pancreatic, 5-Fluorouracil plus Oxaliplatin\>\""}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"HazardRatioPlot", "=", 
  RowBox[{"ErrorListPlot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LogErrorBar", "[", 
        RowBox[{"1", ",", "MelanomaImmunotherapyHazardRatioRange"}], "]"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"LogErrorBar", "[", 
        RowBox[{"2", ",", "OvarianHazardRatioRange"}], "]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"LogErrorBar", "[", 
        RowBox[{"3", ",", "BreastCancerHazardRatioRange"}], "]"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"LogErrorBar", "[", 
        RowBox[{"4", ",", "PancreaticCancerHazardRatioRange"}], "]"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"LogErrorBar", "[", 
        RowBox[{"5", ",", "MelanomaKinaseHazardRatioRange"}], "]"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"LogErrorBar", "[", 
        RowBox[{"6", ",", "OvarianBevacizumabHazardRatioRange"}], "]"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"LogErrorBar", "[", 
        RowBox[{"7", ",", "ColorectalBevacizumabHazardRatioRange"}], "]"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"LogErrorBar", "[", 
        RowBox[{"8", ",", "PancreaticCancerOXFUHazardRatioRange"}], "]"}], 
       "}"}]}], " ", "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0", "+", "0.3"}], ",", 
         RowBox[{"9", "-", "0.3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "0.2"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "2"}], "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1.5"}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Hazard1LineColor", ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"8", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "AlignmentLineColor"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", "0.2"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", "2"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "8", ",", "1"}], "}"}]}], "]"}]}], 
      "]"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "560", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"80", ",", "30"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"340", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HazardRatioLogTicks", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Rotate", "[", 
              RowBox[{
               RowBox[{
               "TrialLabels", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "8", ",", "1"}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
           RowBox[{"AbsolutePointSize", "[", "6", "]"}]}], "]"}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
           RowBox[{"AbsolutePointSize", "[", "6", "]"}]}], "]"}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Hazard Ratio due to drug synergy\>\"", ",", "\"\<\>\""}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.704207192063698*^9, 3.704207327864465*^9}, {
  3.704207418732663*^9, 3.7042074201437435`*^9}, {3.704207457623887*^9, 
  3.7042074867545533`*^9}, {3.7042075236366625`*^9, 3.704207608062492*^9}, {
  3.7045574791733584`*^9, 3.704557551161476*^9}, {3.704557586685508*^9, 
  3.704557866141492*^9}, {3.7045580050304356`*^9, 3.7045580744184046`*^9}, {
  3.704558133598789*^9, 3.704558182638594*^9}, {3.704558255283749*^9, 
  3.70455825669383*^9}, {3.704558299499278*^9, 3.7045582996452866`*^9}, {
  3.7045620083194103`*^9, 3.7045620331558313`*^9}, {3.704562172667811*^9, 
  3.704562196318164*^9}, {3.7045626071786633`*^9, 3.704562618220295*^9}, {
  3.709934442179344*^9, 3.7099345234679937`*^9}, {3.7099352668765144`*^9, 
  3.7099352669715195`*^9}, {3.716129818684808*^9, 3.716129867017572*^9}}],

Cell[BoxData[
 RowBox[{"Rotate", "[", 
  RowBox[{"HazardRatioPlot", ",", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7042074360596538`*^9, 3.704207442510023*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Hazard ratio plot.pdf\>\""}], ",", 
    RowBox[{"Rotate", "[", 
     RowBox[{"HazardRatioPlot", ",", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7045583304120464`*^9, 3.704558333865244*^9}, {
   3.7045619605126762`*^9, 3.7045619753775263`*^9}, 3.7161294820555534`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 5D - Predictions of drug combination effect in ALK-rearranged \
non-small cell lung cancer, based on monotherapy trial data\n",
 StyleBox["Similar code as for Figure 4A is here employed to generate Figure \
5D.",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6913349412163115`*^9, 3.691334947328661*^9}, {
  3.6913350087441735`*^9, 3.69133509102588*^9}, {3.6913371794183292`*^9, 
  3.6913371948222103`*^9}, {3.691337767326956*^9, 3.6913377848789597`*^9}, {
  3.6913382689076443`*^9, 3.6913383289650793`*^9}, {3.6913387511922293`*^9, 
  3.691338775797637*^9}, {3.691341261103788*^9, 3.691341289742426*^9}, {
  3.6913414113073792`*^9, 3.691341412157428*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Figure5DRawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "11", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "eleventh", " ", "tab", " ", "of", " ", "this", " ", 
      "spreadsheet"}], "*)"}], " ", "\[RightDoubleBracket]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.691335120807583*^9, 
  3.691335121159603*^9}, {3.691335153027426*^9, 3.6913351618209295`*^9}, {
  3.6913373428176746`*^9, 3.6913373574995146`*^9}, {3.6913377883631587`*^9, 
  3.6913377939564786`*^9}, {3.691338332081258*^9, 3.6913383487372103`*^9}, {
  3.69133877882581*^9, 3.691338778983819*^9}, {3.691338957177011*^9, 
  3.6913389612082415`*^9}, {3.691341351297947*^9, 3.691341351817977*^9}, {
  3.691341388192057*^9, 3.6913413909412146`*^9}, {3.716129879288274*^9, 
  3.7161298829514832`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Therapy1SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure5DRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "crizotinib"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy2SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure5DRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "pemetrexed"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Therapy3SurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Figure5DRawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "4"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "4", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "docetaxel"}], 
       "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
  3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6913351250408254`*^9, 
  3.6913351370215106`*^9}, {3.691335177937851*^9, 3.691335183565173*^9}, {
  3.6913373331711235`*^9, 3.69133736336185*^9}, {3.6913377983627305`*^9, 
  3.691337808963337*^9}, {3.691338335527455*^9, 3.691338362775013*^9}, {
  3.69133878249802*^9, 3.691338795157744*^9}, {3.6913414075701656`*^9, 
  3.6913414464553895`*^9}}],

Cell[CellGroupData[{

Cell["\<\
First simulating the combination of Crizotinib plus Pemetrexed\
\>", "Subsection",
 CellChangeTimes->{{3.691341456329954*^9, 3.6913414815903993`*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy2SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
  3.6913353590842123`*^9}, {3.6913373740764627`*^9, 3.6913373806838408`*^9}, {
  3.691337831883648*^9, 3.6913378629224234`*^9}, {3.6913383787029243`*^9, 
  3.6913383875924325`*^9}, {3.6913388353150406`*^9, 3.6913388482777824`*^9}, {
  3.6913414885958*^9, 3.6913414993554153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "15000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyFtIk2EAh/FRDEdgatFcJoIxthZi4MUsBfG9qSmthmSOOVQs09i3g8ra
mDgNxQNIoBbiIG0XS3QHFAaOSKexSkZaSdIR7AA5+DJcjnA6m9//7eLhB09u
vbGi4RCPxxNzQZXtZlapgiW6B0Ip3AheVMCx1LNK2Lf/UwOTw6Va6GhOm4UF
ckkAXvOon8LA18U5+K4r+hJK5HtU+duyZbhl7qEyb0af3bnKEu+Fgeew+2Hx
P9h+uiwJJfOX+RZOa/gKNbGiTofKlJVjcFYSyYTM9QwR/RWfSuDfz1ICk+9t
5VBNAtRI42/ZD85VWzgPlqtCmnQVS+47l7RwtybeCIUpg03w0dApAywx9Fgg
76ioG+7wHf3wbtOR7QzOPNkJqklx7pK7miUx/2YlNLljtdAaX7sBs0UFBujt
SDXCHKme2W1hyb0ahx7mnB9sgUuPq1ph+PhhKywaMbZBQbu/A44/edEJ/et1
vqiZJQNm8QwsXP9zO8GZL9imCpXTXyY7WXJGS75Bn4X5BQWa5U0YehX8MMV5
cus7VedsELo5Y66u/y44q2Cm0UUVMbeGoH24l/paZf/o4TStTlAPAEFFJG0=

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "15000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4DoZWnWeZ+AdNyidQUgOuLxl8w/QHrXZwh9xvP9u5UN
rx2lnHM/gGiNmAnfQPTVvh9g+o2d/a1VQPrimTQwzabNI74aSHesMAbTEQHu
kSBa8rA3mGaWfTYbRAs8YJ8DovfLz7m1BkjvubcfTAMAbg29aA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}, 
   3.691337966153328*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "53000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617586751399307`*^9, 3.6617587767057395`*^9}, {
   3.6617590422109256`*^9, 3.6617590813141623`*^9}, {3.6617591912184486`*^9, 
   3.661759202018066*^9}, {3.6617599284826174`*^9, 3.6617599371941156`*^9}, {
   3.661759970771036*^9, 3.6617599820586815`*^9}, {3.6617600635473423`*^9, 
   3.66176006385036*^9}, {3.6617601063067884`*^9, 3.6617601082018967`*^9}, {
   3.665540628806692*^9, 3.6655406523820405`*^9}, {3.665541105862978*^9, 
   3.66554111428546*^9}, {3.6655411623982115`*^9, 3.6655411624622154`*^9}, {
   3.6655412507752666`*^9, 3.665541270438391*^9}, {3.665541311254726*^9, 
   3.6655413125417995`*^9}, {3.6655416228225465`*^9, 
   3.6655416412456007`*^9}, {3.6655417158388667`*^9, 
   3.6655417177579765`*^9}, {3.665762639450184*^9, 3.6657626623274927`*^9}, {
   3.665855190134801*^9, 3.665855206269724*^9}, {3.665855295792844*^9, 
   3.665855300532115*^9}, {3.6658553448616486`*^9, 3.6658554202009573`*^9}, {
   3.665855520751709*^9, 3.6658555648132286`*^9}, {3.665858456325257*^9, 
   3.665858456661276*^9}, {3.6719396414775925`*^9, 3.671939759428339*^9}, {
   3.6719398396459274`*^9, 3.6719398706867027`*^9}, {3.671939953565443*^9, 
   3.6719399604218354`*^9}, {3.684160355411025*^9, 3.6841603648240423`*^9}, {
   3.6841604045381002`*^9, 3.684160410739109*^9}, {3.6841604480961657`*^9, 
   3.6841604754872103`*^9}, {3.6841605096402626`*^9, 3.684160518210281*^9}, {
   3.6857153150273075`*^9, 3.685715337139349*^9}, {3.6857155081428614`*^9, 
   3.685715537642914*^9}, {3.685737295704755*^9, 3.6857372957057543`*^9}, {
   3.6913356594453917`*^9, 3.691335687618003*^9}, {3.691336984337171*^9, 
   3.6913369851182156`*^9}, {3.6913372705045385`*^9, 
   3.6913372706205454`*^9}, {3.691337438454145*^9, 3.6913374389391727`*^9}, {
   3.691337924547948*^9, 3.6913379257220154`*^9}, 3.691338490112296*^9, {
   3.6913389864226837`*^9, 3.6913389866826982`*^9}, {3.6913415358035*^9, 
   3.6913415371545773`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "53000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIT/my9BmIZrG/BqYn/Q5V
XA2klx3LBtNV16QSQPSlB4pgenWUyjwQ3XjaEEyvaHt3Zw2QzrXnvQuiATmj
yQg=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy2SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy2SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy2SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
   3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
   3.691337277744953*^9}, 3.6913379775659804`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "8700"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy2SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy2SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0F1IU3EcxvFDJVZg+UJzlY2M2FwJicRwFuL/Zm0jawzTaaJWikp7MWM5
FqblECtLnEk0qOlNRJuKMHBYWUm+MOxUagRFGEVlHApXVk6tdZ5fFw8feC6/
qcdtxspVHMcpxUGDs2JLrlZgJ7skCvj5oUYLb8XtyoOtfz4Vw2hnbgn0nNo4
CDNV8iDM95vuw+C7xw/gTHN4HMpVy6Tqhe4pnLe3kObnN0bOHBZYr7ptFLpu
7vsLG3boolA+fDCmXtQROkSu8KZ4mBfLJ8JB+VwyNBckSOk3vs6Bv94oGIy+
cuqhiQXJuapvyg+iU85QOtQbnhTHGwR2rWeiBC6VRqqgJLajGna7t1phjrWl
HnIbpC64GOO5CM9Xr/+RIJqu3ETWavcc8B0V2ELg6xFY61sog47IyxMwRZpp
hb2NcTYoU1jMS3UCu1rqsUBZVkcdnLhdeBqGklY7YPZ121m4tiHQCL1DY00w
MFveF7YLrM2+cwAa3a4x+Mi9NwSzJ7umoTJ8j1wcXfcW+hMt5Iw3UrMiuubO
f4d9X1rvNok9Un6T3DZJO7xSVEkuT8u8sHxSQ37vV49Dfmo/maXWf4Samsuk
kWm2+0QzKnRkdxp/DM6XPSMvpDV74bmf7eTI+82zftFL/G7yH1NjUpc=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "8700"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy2Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy2SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy2SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy2Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}, {3.6913375351756773`*^9, 
   3.691337536029726*^9}, {3.6913380016593585`*^9, 3.691338001718362*^9}, {
   3.6913385153667407`*^9, 3.6913385154457455`*^9}, {3.69133901730945*^9, 
   3.691339017845481*^9}, {3.6913415640521154`*^9, 3.6913415643301315`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy2SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "offset"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", 
     RowBox[{"-", "0.05"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ho", "=", 
     RowBox[{"-", "0"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy2SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "16"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "15.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "0", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "1.8", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.8", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "0", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "1.8", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"15", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.8", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median PFS:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.3", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<7.6\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.25"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<4.1\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<9.6\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.5", "+", "ho"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.6", "+", "ho"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.5", "+", "ho"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.6", "+", "ho"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.5", "+", "ho"}], ",", 
            RowBox[{"0.13", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.6", "+", "ho"}], ",", 
            RowBox[{"0.19", "+", "lo"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.8", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.5", "+", "ho"}], ",", 
             RowBox[{"0.16", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.6", "+", "ho"}], ",", 
             RowBox[{"0.16", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Crizotinib\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.8", "+", "ho"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Pemetrexed\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.8", "+", "ho"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.8", "+", "ho"}], ",", 
            RowBox[{"0.16", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 5D, crizotinib plus pemetrexed.pdf\>\""}], ",", "%", ",", 
      "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9, {
   3.6913370241064453`*^9, 3.6913371276353674`*^9}, {3.69133732349457*^9, 
   3.69133732367258*^9}, {3.6913376565896215`*^9, 3.6913376949968185`*^9}, {
   3.6913377625116796`*^9, 3.6913377626866903`*^9}, {3.691338104164222*^9, 
   3.6913381171199627`*^9}, {3.6913381542350855`*^9, 
   3.6913381648576927`*^9}, {3.6913381979015827`*^9, 
   3.6913382016737986`*^9}, {3.6913385941242456`*^9, 3.691338655953782*^9}, {
   3.6913387457729197`*^9, 3.6913387459679303`*^9}, {3.6913390895755835`*^9, 
   3.691339117371174*^9}, {3.691341656931428*^9, 3.691341726637415*^9}, 
   3.7161260449379616`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Second, simulating the combination of Crizotinib plus Docetaxel\
\>", "Subsection",
 CellChangeTimes->{{3.691341456329954*^9, 3.6913414815903993`*^9}, {
  3.6913417505067806`*^9, 3.6913417547060204`*^9}}],

Cell[CellGroupData[{

Cell["\[Rho] = 0.28", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, 3.691335213640893*^9}],

Cell[BoxData[{
 RowBox[{"Length", "[", "Therapy1SurvivalDistribution", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "Therapy3SurvivalDistribution", "]"}]}], "Input",
 CellChangeTimes->{{3.665855220599543*^9, 3.6658552300100813`*^9}, {
   3.671939600364241*^9, 3.67193960506851*^9}, {3.6857148946911507`*^9, 
   3.6857151573250337`*^9}, 3.6857372955597467`*^9, {3.6913352179531393`*^9, 
   3.6913352243855076`*^9}, {3.6913417572011633`*^9, 3.69134175731917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "repeats", " ", "of", " ", "the", " ", "complete",
     " ", "data", " ", "set", " ", "to", " ", "merge", " ", "together", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "purpose", " ", "of", " ", "minimizing", " ", "variance", 
      " ", "between", " ", "individual", " ", "repeats", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "rank", " ", 
      RowBox[{"randomization", "'"}], " ", "process"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReSampledTherapy3SurvivalDistribution", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"Therapy3SurvivalDistribution", ",", 
          RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
  3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
  3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
  3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
  3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
  3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
  3.685715252636197*^9}, {3.685737295569747*^9, 3.685737295574747*^9}, {
  3.6913352343710785`*^9, 3.691335294840537*^9}, {3.6913353421222415`*^9, 
  3.6913353590842123`*^9}, {3.6913373740764627`*^9, 3.6913373806838408`*^9}, {
  3.691337831883648*^9, 3.6913378629224234`*^9}, {3.6913383787029243`*^9, 
  3.6913383875924325`*^9}, {3.6913388353150406`*^9, 3.6913388482777824`*^9}, {
  3.6913414885958*^9, 3.6913414993554153`*^9}, {3.6913417666077013`*^9, 
  3.6913417673277426`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "15000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy3Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy3SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy3SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfMidCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlyH0o3HEAx/GL5FI2Jue2SdF2h0T547At+f7D0c4uebjOZWvm+efuRueu
Wx4WeSitMJMrD/cH4hB15VrbjAxdY4g8lo3a1A8xlxy22+/z3R/vXvUOfq5J
y3Pj8Xj3uaDc+OJOgpQlJe0CMfw1mSiF3d7hMtj456cSutoSVND08uYEjJaI
bDB9WPEB2r5PfYSrtadzUCS5okqWkxfgia6eyix1Tlc8YclIXPMXWNf18C+s
DEl2QdGnxx56ToM9lXq9qPCBMs/FW3BCdBAAmUxfIf1pW/HwfFtMoGvdmAIV
xEY9KDgO2+dcMdojYIp8RukjZ8lb87wKXuY4C6DAs6UQ9rbeVcN4db0e8m4I
6+CFh6kJvi70OvPljAjzp2qlUUmWbJY4rEcZUGtxPIUG51ouDBRGq+FItbcG
BolLmcsylrzJMZXCoNiWMjjfn1UO7X7uBvigQ/MK8iut1bDn/WwNtO4+Gz3V
saRZd28cxuz+LrrmjOSfUQWysZ3BGpaEqsgPOKpnDiFfuXAEZ75Obgxx3j7Z
o5aY8wQWTkdf7X8/m7NggKaPKmTyW2FVWwP1m7xqc5hTuzJALbZeXcB3RY+c
8B/jKy5j
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.28"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "15000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy3Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy3SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy3SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4DoZWnWeZ+AdNyidQUgOuLxl8w/QHrXZwh9xvP9u5UN
rx2lnHM/gGiNmAnfQPTVvh9g+o2d/a1VQPrimTQwzabNI74aSHesMAbTEQHu
kSBa8rA3mGaWfTYbRAs8YJ8DovfLz7m1BkjvubcfTM975PkTREusqwbTAJsZ
xxU=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfMidCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfMidCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.6857173594159336`*^9, 3.685717359575934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.08", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, 
   3.685715581220051*^9, 3.6913344335302734`*^9, {3.6913356388322124`*^9, 
   3.691335639033224*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy3SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy3SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy3SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.685737295690754*^9, 3.685737295696754*^9}, 
   3.6913356531390305`*^9, {3.691337280698122*^9, 3.6913372820541997`*^9}, 
   3.691337966153328*^9, {3.6913417733650875`*^9, 3.6913417742391376`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "53000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy3Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy3SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy3SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfLowCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617586751399307`*^9, 3.6617587767057395`*^9}, {
   3.6617590422109256`*^9, 3.6617590813141623`*^9}, {3.6617591912184486`*^9, 
   3.661759202018066*^9}, {3.6617599284826174`*^9, 3.6617599371941156`*^9}, {
   3.661759970771036*^9, 3.6617599820586815`*^9}, {3.6617600635473423`*^9, 
   3.66176006385036*^9}, {3.6617601063067884`*^9, 3.6617601082018967`*^9}, {
   3.665540628806692*^9, 3.6655406523820405`*^9}, {3.665541105862978*^9, 
   3.66554111428546*^9}, {3.6655411623982115`*^9, 3.6655411624622154`*^9}, {
   3.6655412507752666`*^9, 3.665541270438391*^9}, {3.665541311254726*^9, 
   3.6655413125417995`*^9}, {3.6655416228225465`*^9, 
   3.6655416412456007`*^9}, {3.6655417158388667`*^9, 
   3.6655417177579765`*^9}, {3.665762639450184*^9, 3.6657626623274927`*^9}, {
   3.665855190134801*^9, 3.665855206269724*^9}, {3.665855295792844*^9, 
   3.665855300532115*^9}, {3.6658553448616486`*^9, 3.6658554202009573`*^9}, {
   3.665855520751709*^9, 3.6658555648132286`*^9}, {3.665858456325257*^9, 
   3.665858456661276*^9}, {3.6719396414775925`*^9, 3.671939759428339*^9}, {
   3.6719398396459274`*^9, 3.6719398706867027`*^9}, {3.671939953565443*^9, 
   3.6719399604218354`*^9}, {3.684160355411025*^9, 3.6841603648240423`*^9}, {
   3.6841604045381002`*^9, 3.684160410739109*^9}, {3.6841604480961657`*^9, 
   3.6841604754872103`*^9}, {3.6841605096402626`*^9, 3.684160518210281*^9}, {
   3.6857153150273075`*^9, 3.685715337139349*^9}, {3.6857155081428614`*^9, 
   3.685715537642914*^9}, {3.685737295704755*^9, 3.6857372957057543`*^9}, {
   3.6913356594453917`*^9, 3.691335687618003*^9}, {3.691336984337171*^9, 
   3.6913369851182156`*^9}, {3.6913372705045385`*^9, 
   3.6913372706205454`*^9}, {3.691337438454145*^9, 3.6913374389391727`*^9}, {
   3.691337924547948*^9, 3.6913379257220154`*^9}, 3.691338490112296*^9, {
   3.6913389864226837`*^9, 3.6913389866826982`*^9}, {3.6913415358035*^9, 
   3.6913415371545773`*^9}, {3.6913417747791686`*^9, 3.6913417766692767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.08"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "53000"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy3Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy3SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy3SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQzZKptt/B47Wj3Df9AyB62Vu/EyD6kdD9syA6t9j7
eJn/a0e/8EIw3di1/T+IFpH9xFIOpFlkjgmC6AnqXOIgunZqlSOInvpwuROI
LrcQ9QbRHe/kfEC000QF7cdAmnGhii6IFtlUXyYQ8Nqx3ud8OYju0p3eDqIP
2P3vBNFT1GcwCwFpMd6FYLrpxd3U1dGvHb8KXcoB0TM+vq79VfTakUP2fSOI
/lMrsflj6WtHq6U7t4BoJRunoyA61iUMTBe4fjoDoh80fQHTB7Ret3wC0ut/
B7aCaBO2H5l/gPQ0MQid//jkv5UNrx3vTNzCtApIT/my9BmIZrG/BqYn/Q5V
XA2klx3LBtNV16QSQPSlB4pgenWUyjwQ3XjaEEyvaHt3Zw2QzrXnvQuiQ5ap
/ALRdwzqwDQAGXbSVQ==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfLowCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfLowCorrelatedMonoPairs", "]"}], "]"}], ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.685717355885929*^9, 
  3.685717356045929*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Rho] = 0.48", "Subsubsection",
 CellChangeTimes->{{3.683737272763629*^9, 3.6837373072476015`*^9}, {
   3.683740279895627*^9, 3.68374054045653*^9}, {3.685715296709272*^9, 
   3.685715304379286*^9}, {3.6857155155508757`*^9, 3.6857155178628793`*^9}, {
   3.685715581220051*^9, 3.68571560881317*^9}, 3.691334437650509*^9, 
   3.691335711487368*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resamplingfactor", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy1SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"Therapy1SurvivalDistribution", ",", 
          RowBox[{"Length", "[", "Therapy3SurvivalDistribution", "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReSampledTherapy3SurvivalDistribution", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"Therapy3SurvivalDistribution", ",", 
        RowBox[{"{", "resamplingfactor", "}"}]}], "]"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665855242294784*^9, 3.6658553354011073`*^9}, {
   3.6658553741023207`*^9, 3.6658553778835373`*^9}, {3.671939621725463*^9, 
   3.6719396349172173`*^9}, {3.671939665676977*^9, 3.671939672516368*^9}, {
   3.6841602681408863`*^9, 3.6841603451200094`*^9}, {3.6841604301111374`*^9, 
   3.684160440210154*^9}, {3.6857148946911507`*^9, 3.6857149071431737`*^9}, {
   3.6857151681420527`*^9, 3.685715210094123*^9}, {3.6857152481271906`*^9, 
   3.685715252636197*^9}, {3.6857372957897596`*^9, 3.6857372957917595`*^9}, {
   3.691335746123349*^9, 3.691335748970512*^9}, {3.6913372764268775`*^9, 
   3.691337277744953*^9}, 3.6913379775659804`*^9, {3.69134178126854*^9, 
   3.6913417832626543`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "rank", " ", 
    "randomization", " ", "that", " ", "produces", " ", "Spearman", " ", 
    "Rank", " ", "Correlation", " ", "of", " ", "approximately", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amountofrankrandomization", "=", "8700"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy1SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy1SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SlightlyRandomizedTherapy3Distribution", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "amountofrankrandomization"}], ",", 
               "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
           RowBox[{
           "ReSampledTherapy3SurvivalDistribution", "\[LeftDoubleBracket]", 
            "i", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
           "Length", "[", "ReSampledTherapy3SurvivalDistribution", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "<", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestOfHighCorrelatedMonoPairs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
         "Length", "[", "SlightlyRandomizedTherapy1Distribution", "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"SpearmanRho", "[", 
    RowBox[{
     RowBox[{"SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwl0FtIk3EcxvGXUszA0oVrlY2K2JwJicRwFuL/Zm0ja4wOy0StFCftYMZy
LEzLIVaWuJJoULObiDaLYODoYCV5YNhbHiJIwigq46VwZeWcud7n18XDB57L
78YjDlP1Eo7jcsRBo7tqbbFOYMe6pEr45YlWB2+k5ZTAtr+fS2HicnEZ9B1f
2Qvz1Yow3Bs0P4Lh988ew4mW6BBUqOOkelT/As44W0nrq2v9J/cIrEfTPgA9
17cvwsZN+gRU9O1KbhB1RXaTC7w5HZak8BLYq5heDa37M2T0m94Wwd+TSgYT
b9wGaGZhcrrmu+qj6Jg7kgsNxuel6UaBXbk5XAbny2M1UJrSaYHd3nV2WGRv
bYDcCpkHziX7zsEzluU/M0RzVZlknW7rzsAhgc2Gvu2DdYHZCuiKvT4Ks2T5
dtjTlOaAcqXNOl8vsEvlPhuUF3TWw+FbB07AyKqlLlh41XEKLmsMNUH/g8Fm
GJqqvBt1Cqzdufk+NHk9g/Cpd1sEFo50jUNV9CE5N5D6DgYlNnLCH6tdEE26
/d++wNe2O81ij6w/JLde2gEvHqwm4+NyP6wc0ZI/7mmGID+2gyzQGD5Bbe0F
0sS0GwKieVV6sjubPwxnKl6SZ7Nb/PD0rw6y/8OaqaDoeX4LKbEkxeHipJn8
B8gnW+0=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Repeating", " ", "the", " ", "randomization", " ", "procedure", " ", "20",
     " ", "times", " ", "to", " ", "show", " ", "that", " ", "response", " ", 
    "correlation", " ", "is", " ", "tightly", " ", "distributed", " ", 
    "around", " ", "the", " ", "targeted", " ", "value", " ", "of", " ", 
    "0.48"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableOfCorrelationsFromRepeats", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"amountofrankrandomization", "=", "8700"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy1Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy1SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy1SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SlightlyRandomizedTherapy3Distribution", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "amountofrankrandomization"}], ",", 
                   "amountofrankrandomization"}], "}"}], "]"}]}], ",", 
               RowBox[{
               "ReSampledTherapy3SurvivalDistribution", 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
               "Length", "[", "ReSampledTherapy3SurvivalDistribution", 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{
          "SlightlyRandomizedTherapy1Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "SlightlyRandomizedTherapy3Distribution", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", "20", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean response correlation = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "TableOfCorrelationsFromRepeats", "]"}], ",", 
        "0.001"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"TableOfCorrelationsFromRepeats", ",", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.0", ",", "0.01"}], "}"}], ",", 
     "\"\<Probability\>\"", ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Spearman Rank Correlation\>\"", ",", "\"\<Probability\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6617599932003193`*^9, 3.6617600014987936`*^9}, {
   3.66176006646651*^9, 3.661760110971055*^9}, {3.66554066635784*^9, 
   3.6655406675419073`*^9}, {3.665541117735657*^9, 3.6655411595660496`*^9}, {
   3.66554126219092*^9, 3.6655413043173294`*^9}, {3.665541643830748*^9, 
   3.665541653246287*^9}, {3.6655417206631427`*^9, 3.6655417289666176`*^9}, {
   3.6657626490177317`*^9, 3.665762665144654*^9}, {3.665855411990488*^9, 
   3.665855422478088*^9}, {3.665855548724309*^9, 3.66585556797641*^9}, {
   3.6658585887548313`*^9, 3.6658585890328474`*^9}, {3.6719398869346323`*^9, 
   3.671939942564814*^9}, {3.6841604953732414`*^9, 3.684160527472294*^9}, {
   3.685715352765379*^9, 3.6857153658014193`*^9}, {3.6857154980698404`*^9, 
   3.685715498695845*^9}, {3.6857155595709763`*^9, 3.685715559640976*^9}, {
   3.685715698794952*^9, 3.6857156991409717`*^9}, 3.685717048950018*^9, {
   3.6857170850601625`*^9, 3.6857170851401625`*^9}, {3.6857172866287875`*^9, 
   3.685717286969788*^9}, {3.6857372958557634`*^9, 3.6857372958587637`*^9}, {
   3.691336793287244*^9, 3.691336798968569*^9}, {3.6913375351756773`*^9, 
   3.691337536029726*^9}, {3.6913380016593585`*^9, 3.691338001718362*^9}, {
   3.6913385153667407`*^9, 3.6913385154457455`*^9}, {3.69133901730945*^9, 
   3.691339017845481*^9}, {3.6913415640521154`*^9, 3.6913415643301315`*^9}, {
   3.6913417876609054`*^9, 3.6913417897710257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "after", " ", "generating", " ", "the", " ", "distribution", " ", "of", 
     " ", "survival", " ", "times", " ", "predicted", " ", "by", " ", 
     "independent", " ", "drug", " ", "action"}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "remove", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"resampling", "'"}], " ", "to", " ", "plot", " ", "the", " ", 
     RowBox[{"results", ".", " ", "With"}], " ", "a", " ", "resampling", " ", 
     "factor", " ", "of", " ", "10"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "acheived", " ", "by", " ", "sorting", " ", "the",
      " ", "distribution", " ", "and", " ", "keeping", " ", "every", " ", 
     "10", "th", " ", "entry"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SubSampledBestOfHighCorrelatedMonoPairs", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "BestOfHighCorrelatedMonoPairs", "]"}], "]"}], 
      ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "1"}], ";;", "resamplingfactor"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.685715381649455*^9, 3.685715475502785*^9}, {
  3.685715527961895*^9, 3.6857155325629063`*^9}, {3.6857156163212013`*^9, 
  3.685715621911228*^9}, {3.6857173457259054`*^9, 3.685717350742916*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing median PFS for each condition: the observed individual therapies, \
the observed combination, and the simulated effects with high, medium, or low \
response correlation (respectively, \[Rho] = 0.48, 0.28, 0.08)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857171038432136`*^9, 3.6857171087922306`*^9}, {
  3.685717191224478*^9, 3.6857171915044785`*^9}, {3.6913368411049786`*^9, 
  3.69133684183502*^9}}],

Cell[BoxData[{
 RowBox[{"Mono1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy1SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Mono2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "Therapy3SurvivalDistribution", "]"}], ",", 
    "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComboMedian", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "ComboSurvivalDistribution", "]"}], ",", "0.01"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim1Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim2Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Sim3Median", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Median", "[", "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], 
    ",", "0.01"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685714894731151*^9, {3.685715722691878*^9, 3.6857157937762175`*^9}, {
   3.6857158928598895`*^9, 3.685715940986031*^9}, {3.685717113891242*^9, 
   3.685717114213244*^9}, 3.6857372958897653`*^9, {3.6913369103259377`*^9, 
   3.6913369122430477`*^9}, 3.6913417913381157`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the observed and simulated survival functions", "Subsubsection",
 CellChangeTimes->{{3.6857171213172607`*^9, 3.6857171358392925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"legend", " ", "offset"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lo", "=", 
     RowBox[{"-", "0.05"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"legend", " ", "horizontal", " ", "offset"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ho", "=", 
     RowBox[{"-", "0"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfLowCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfMidCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", 
          "SubSampledBestOfHighCorrelatedMonoPairs", "]"}], "]"}], "[", "x", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy1SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "Therapy3SurvivalDistribution", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "16"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "15.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.11"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "0", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "1.8", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1.8", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "0", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "1.8", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "60", ",", "3"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Style", "[", "\"\<Progression free survival (months)\>\"", "]"}], 
        ",", 
        RowBox[{"Style", "[", "\"\<Patients (%)\>\"", "]"}]}], "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Lighter", "[", 
         RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"15", ",", "1.11"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "1.8", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sim1Median", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sim3Median", ",", "1.03"}], "}"}]}], "]"}], ",", "Black", 
        ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Sim2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<Median:\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<7.6\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono1Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.25"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<2.5\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Mono2Median", ",", "1.03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<8.1\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Sim2Median", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
        RowBox[{"Darker", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono1Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Mono2Median", ",", "1.03"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
     RowBox[{"FillingStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}], ",", 
        "White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
        RowBox[{"AbsolutePointSize", "[", "8", "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.5", "+", "ho"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.6", "+", "ho"}], ",", 
             RowBox[{"0.34", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.5", "+", "ho"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.6", "+", "ho"}], ",", 
             RowBox[{"0.26", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.5", "+", "ho"}], ",", 
            RowBox[{"0.13", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.6", "+", "ho"}], ",", 
            RowBox[{"0.19", "+", "lo"}]}], "}"}]}], "]"}], ",", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "1.8", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0.5", "+", "ho"}], ",", 
             RowBox[{"0.16", "+", "lo"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.6", "+", "ho"}], ",", 
             RowBox[{"0.16", "+", "lo"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Crizotinib\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.8", "+", "ho"}], ",", 
            RowBox[{"0.34", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Docetaxel\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.8", "+", "ho"}], ",", 
            RowBox[{"0.26", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated combination\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.8", "+", "ho"}], ",", 
            RowBox[{"0.16", "+", "lo"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 5D, crizotinib plus docetaxel.pdf\>\""}], ",", "%", ",", 
      "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.682486332404942*^9, 3.682486401748908*^9}, {
   3.6841613121156344`*^9, 3.684161362363508*^9}, {3.684161453968748*^9, 
   3.68416147516296*^9}, {3.684161505811713*^9, 3.6841615109710083`*^9}, {
   3.6841615543364887`*^9, 3.6841615585707307`*^9}, {3.6841616032372856`*^9, 
   3.684161737044939*^9}, {3.684161772636975*^9, 3.6841617915950594`*^9}, {
   3.684161954364369*^9, 3.684161954499377*^9}, {3.68416206382963*^9, 
   3.6841620733411736`*^9}, 3.6857148947611513`*^9, {3.685715875438752*^9, 
   3.6857158810418563`*^9}, {3.6857159491710463`*^9, 3.685715992158187*^9}, {
   3.6857166605954494`*^9, 3.685716718003953*^9}, 3.685716809572198*^9, {
   3.685717206935519*^9, 3.685717264062751*^9}, 3.6857372960667753`*^9, {
   3.6913370241064453`*^9, 3.6913371276353674`*^9}, {3.69133732349457*^9, 
   3.69133732367258*^9}, {3.6913376565896215`*^9, 3.6913376949968185`*^9}, {
   3.6913377625116796`*^9, 3.6913377626866903`*^9}, {3.691338104164222*^9, 
   3.6913381171199627`*^9}, {3.6913381542350855`*^9, 
   3.6913381648576927`*^9}, {3.6913381979015827`*^9, 
   3.6913382016737986`*^9}, {3.6913385941242456`*^9, 3.691338655953782*^9}, {
   3.6913387457729197`*^9, 3.6913387459679303`*^9}, {3.6913390895755835`*^9, 
   3.691339117371174*^9}, {3.691341656931428*^9, 3.691341726637415*^9}, 
   3.6913417947423105`*^9, {3.691341917901355*^9, 3.6913419548424673`*^9}, 
   3.7161260449519625`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Supplementary Figure 1, fitting log-normal distribution to clinically \
observed distributions of Progression Free Survival\
\>", "Section",
 CellChangeTimes->{{3.685755238225008*^9, 3.6857552752621264`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Importing survival data as tabulated in 'Table of survival \
distributions.xlsx' :\
\>", "Subsubsection",
 CellChangeTimes->{{3.6857179675202293`*^9, 3.685717973349243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SupplementaryFigure1RawData", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Table of survival distributions.xlsx\>\""}], ",", 
      "\"\<XLSX\>\""}], "]"}], "\[LeftDoubleBracket]", "12", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "the", " ", "twelvth", " ", "tab", " ", "of", " ", "this", " ", 
        "spreadsheet", " ", "contains", " ", "progression", " ", "free", " ", 
        "survival", " ", "data", " ", "for", " ", "trastuzumab", " ", "in", 
        " ", "HER2"}], "-", 
       RowBox[{"amplified", " ", "breast", " ", "cancer"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "and", " ", "for", " ", "vemurafenib", " ", "in", " ", "BRAF"}], "-", 
       RowBox[{"mutant", " ", "melanoma"}]}]}], " ", "*)"}], " ", 
    "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685714643551118*^9, 3.685714669791164*^9}, {
  3.6857169251415467`*^9, 3.685716970048764*^9}, {3.6857387685129943`*^9, 
  3.6857388219280496`*^9}, {3.6857563218399873`*^9, 3.6857563801843243`*^9}, {
  3.691339340209919*^9, 3.6913393403079247`*^9}, {3.716129940183757*^9, 
  3.7161299477681904`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TrastuzumabSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"SupplementaryFigure1RawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "2"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "2", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "trastuzumab"}],
        "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VemurafenibSurvivalDistribution", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"SupplementaryFigure1RawData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"8", ";;"}], ",", "3"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "column", " ", "3", " ", "of", " ", "this", " ", "spreadsheet", " ", 
        "contains", " ", "PFS", " ", "data", " ", "for", " ", "vemurafenib"}],
        "*)"}], "\[RightDoubleBracket]"}], ",", "NumberQ"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6857146843153653`*^9, 3.6857147745748873`*^9}, {
   3.6857169770087967`*^9, 3.685717009998934*^9}, {3.6857390677541103`*^9, 
   3.6857390691531897`*^9}, {3.6857393170253677`*^9, 3.68573943053586*^9}, {
   3.685756366624549*^9, 3.6857564179034815`*^9}, 3.685756467688329*^9, {
   3.691339446991027*^9, 3.6913395089095683`*^9}, {3.6913395575863523`*^9, 
   3.6913395626226406`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"custom", " ", "frame", " ", "ticks", " ", "for", " ", "log"}], 
    "-", "scale"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"logframeticks", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"ToString", "[", 
           SuperscriptBox["10", "x"], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.025"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", 
            RowBox[{"{", 
             RowBox[{
             "0.1", ",", "0.3", ",", "1", ",", "3", ",", "10", ",", "30", ",",
               "100"}], "}"}]}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", "x"}], "]"}], ",", "\"\<\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "y"]}], ",", 
              RowBox[{"9", "*", 
               SuperscriptBox["10", "y"]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "y"]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "5"}], ",", "5", ",", "1"}], "}"}]}], "]"}], ",", 
        "1"}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.673797110310899*^9, 3.673797143941822*^9}, {
  3.6737971814519677`*^9, 3.673797218294075*^9}, {3.6857564863133945`*^9, 
  3.685756505081468*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["HER2-amplified breast cancer response to trastuzumab", "Subsubsection",
 CellChangeTimes->{{3.685756742385041*^9, 3.685756764463304*^9}, {
  3.685756873695552*^9, 3.685756874678608*^9}, {3.685757201919325*^9, 
  3.685757211398867*^9}}],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Coefficient of variation in Trastuzumab PFS = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "StandardDeviation", "[", "TrastuzumabSurvivalDistribution", "]"}], 
       "/", 
       RowBox[{"Mean", "[", "TrastuzumabSurvivalDistribution", "]"}]}], "*", 
      "100"}], "]"}], "]"}], "<>", "\"\<%\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.6857572211664257`*^9, 3.6857572313040056`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting a log - normal distribution", "Subsubsection",
 CellChangeTimes->{{3.6737974228947773`*^9, 3.673797431298258*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CenterOfDistribution", "=", "5.1"}], ";"}], 
  RowBox[{"(*", "months", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StDevOfDistribution", "=", "0.56"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "standard", " ", "deviation", " ", "on", " ", "log", " ", "scale"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lognormallydistributedtimes", "=", 
    RowBox[{"10", "^", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "CenterOfDistribution"}], "]"}], ",", 
         "StDevOfDistribution"}], "]"}], ",", "10000"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "TrastuzumabSurvivalDistribution", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "lognormallydistributedtimes", "]"}], 
        "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "36.5"}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "36.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "7"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1.5", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Orange", ",", 
         RowBox[{"AbsoluteThickness", "[", "1.5", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"2", "/", "10"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "36", ",", "5"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Probability of\\nprogression free survival (%)\>\""}], "}"}]}], 
    ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Survival Function\>\"", ",", "Black"}], "]"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"70", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure 1A, survival function.pdf\>\""}], ",", "%", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.673797536563279*^9, 3.6737975431306543`*^9}, {
   3.6737978902105064`*^9, 3.6737978937767105`*^9}, {3.6737979378542314`*^9, 
   3.67379794325354*^9}, {3.673797997320633*^9, 3.67379800006879*^9}, {
   3.673798051563735*^9, 3.6737980539458714`*^9}, {3.6737981234788485`*^9, 
   3.673798123876871*^9}, {3.6737985344303536`*^9, 3.6737985514283257`*^9}, {
   3.685757032675645*^9, 3.685757063499408*^9}, {3.6857571283121147`*^9, 
   3.685757144641049*^9}, {3.685757288083253*^9, 3.685757349986794*^9}, {
   3.691339353080655*^9, 3.6913393538727007`*^9}, 3.716126044962963*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"pre", "-", 
     RowBox[{"processing", ":", " ", 
      RowBox[{"values", " ", "smaller", " ", "than", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "0.5"}]], " ", 
       RowBox[{"(", 
        RowBox[{"<", 
         RowBox[{"10", " ", "days"}]}], ")"}], " ", "are", " ", "rounded", 
       " ", "up", " ", "to", " ", "10", " ", "days", " ", "so", " ", "as", 
       " ", "not", " ", "to", " ", "be", " ", "absent", " ", "from", " ", 
       "the", " ", "logarithmic", " ", "plot", " ", "range"}]}]}], ";", " ", 
    RowBox[{
    "and", " ", "the", " ", "portion", " ", "of", " ", "probability", " ", 
     "density", " ", "that", " ", "is", " ", 
     RowBox[{"still", " ", "'"}], "progression", " ", 
     RowBox[{"free", "'"}], " ", "at", " ", "the", " ", "end", " ", "of", " ",
      "the", " ", "data", " ", 
     RowBox[{"(", 
      RowBox[{">", 
       RowBox[{"36", " ", "months"}]}], ")"}], " ", "is", " ", "shifted", " ",
      "to", " ", "larger", " ", "value", " ", "in", " ", "order", " ", "to", 
     " ", "be", " ", "shown", " ", "in", " ", "a", " ", "separate", " ", 
     "column", " ", "labelled", " ", "as", " ", "\"\<>36 months\>\""}]}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotdata", "=", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.5"}], ",", "#"}], "}"}], "]"}], "&"}], ",", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "TrastuzumabSurvivalDistribution"}], "]"}]}], 
      "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", "37.", "]"}], "/", 
        RowBox[{"Log", "[", "10", "]"}]}], "\[Rule]", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "70"}], "]"}]}], "}"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6737989756925926`*^9, 3.6737990260504727`*^9}, {
  3.6737991223099785`*^9, 3.6737991226229963`*^9}, {3.673800116338834*^9, 
  3.6738003391835794`*^9}, {3.6743219783898134`*^9, 3.674321982024831*^9}, {
  3.6743221736927013`*^9, 3.674322188745758*^9}, {3.6743222998782563`*^9, 
  3.6743223000442576`*^9}, {3.6743224162577543`*^9, 3.6743224214357786`*^9}, {
  3.6743228996038656`*^9, 3.6743229116639194`*^9}, {3.6857574150255136`*^9, 
  3.685757437592805*^9}, {3.68575749117587*^9, 3.6857576694000635`*^9}, {
  3.685757805648856*^9, 3.685757858760894*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{"plotdata", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "3", ",", "0.2"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"20", "/", "100"}], "*", 
          RowBox[{"Length", "[", "TrastuzumabSurvivalDistribution", "]"}]}]}],
         "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}]}], 
      "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", 
              RowBox[{"i", "/", 
               RowBox[{
               "Length", "[", "TrastuzumabSurvivalDistribution", "]"}]}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "Length", "[", "TrastuzumabSurvivalDistribution", "]"}], "/", 
               "10"}], "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"logframeticks", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[LessEqual]", 
               RowBox[{"Log", "[", 
                RowBox[{"10", ",", "40"}], "]"}]}], "&"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1.9", ",", "\"\<  >36\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.8", ",", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2.0", ",", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}]}], "}"}]}], "]"}],
          ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Probability of\\nprogression free survival (%)\>\""}], "}"}]}], 
    ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Probability Density Function\>\"", ",", "Black"}], "]"}]}],
     ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"70", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure 1A, probability density function.pdf\>\""}], 
    ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6743221240844736`*^9, 3.6743221587696376`*^9}, {
   3.674322199435802*^9, 3.674322320299348*^9}, {3.6743224300348253`*^9, 
   3.674322450690915*^9}, {3.6743225254332404`*^9, 3.674322535712285*^9}, {
   3.6857574164515953`*^9, 3.6857574268961926`*^9}, {3.6857576761714506`*^9, 
   3.685757687505099*^9}, {3.6857593541444254`*^9, 3.6857593594937315`*^9}, 
   3.716126044971964*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["BRAF V600(E/K) melanoma response to vemurafenib", "Subsubsection",
 CellChangeTimes->{{3.685756742385041*^9, 3.685756764463304*^9}, {
  3.685756873695552*^9, 3.685756874678608*^9}}],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Coefficient of variation in Vemurafenib PFS = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "StandardDeviation", "[", "VemurafenibSurvivalDistribution", "]"}], 
       "/", 
       RowBox[{"Mean", "[", "VemurafenibSurvivalDistribution", "]"}]}], "*", 
      "100"}], "]"}], "]"}], "<>", "\"\<%\>\""}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting a log - normal distribution", "Subsubsection",
 CellChangeTimes->{{3.6737974228947773`*^9, 3.673797431298258*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CenterOfDistribution", "=", "6.6"}], ";"}], 
  RowBox[{"(*", "months", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StDevOfDistribution", "=", "0.4"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "standard", " ", "deviation", " ", "on", " ", "log", " ", "scale"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lognormallydistributedtimes", "=", 
    RowBox[{"10", "^", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "CenterOfDistribution"}], "]"}], ",", 
         "StDevOfDistribution"}], "]"}], ",", "10000"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "VemurafenibSurvivalDistribution", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "lognormallydistributedtimes", "]"}], 
        "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "15.8"}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "7"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "1.5", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Orange", ",", 
         RowBox[{"AbsoluteThickness", "[", "1.5", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"2", "/", "10"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "16", ",", "2"}], "}"}]}], "]"}], ",",
          "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Probability of\\nprogression free survival (%)\>\""}], "}"}]}], 
    ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Survival Function\>\"", ",", "Black"}], "]"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"70", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure 1B, survival function.pdf\>\""}], ",", "%", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.673797536563279*^9, 3.6737975431306543`*^9}, {
   3.6737978902105064`*^9, 3.6737978937767105`*^9}, {3.6737979378542314`*^9, 
   3.67379794325354*^9}, {3.673797997320633*^9, 3.67379800006879*^9}, {
   3.673798051563735*^9, 3.6737980539458714`*^9}, {3.6737981234788485`*^9, 
   3.673798123876871*^9}, {3.6737985344303536`*^9, 3.6737985514283257`*^9}, {
   3.685757032675645*^9, 3.685757063499408*^9}, {3.6857571283121147`*^9, 
   3.685757144641049*^9}, {3.691339587049038*^9, 3.6913395879380884`*^9}, 
   3.7161260449779634`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"10", ",", "VemurafenibSurvivalDistribution"}], "]"}], ",", 
      RowBox[{
       RowBox[{"#", ">", 
        RowBox[{"-", "1"}]}], "&"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "2", ",", "0.2"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "30"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"25", "/", "100"}], "*", 
          RowBox[{"Length", "[", "VemurafenibSurvivalDistribution", "]"}]}]}],
         "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], "]"}]}], 
      "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", 
              RowBox[{"i", "/", "702"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"702", "/", "10"}], "/", "2"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"logframeticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Probability of\\nprogression free survival (%)\>\""}], "}"}]}], 
    ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Probability Density Function\>\"", ",", "Black"}], "]"}]}],
     ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"70", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure 1B, probability density function.pdf\>\""}], 
    ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.67379668251143*^9, 3.6737968596125593`*^9}, {
   3.6737969800034456`*^9, 3.6737970865965424`*^9}, {3.6737971206784916`*^9, 
   3.6737971295950017`*^9}, {3.673798149535339*^9, 3.6737981518294697`*^9}, {
   3.673798498320288*^9, 3.673798501967497*^9}, {3.6738004101146364`*^9, 
   3.6738004230133743`*^9}, {3.6857565286198144`*^9, 
   3.6857565373603144`*^9}, {3.6857565946605916`*^9, 
   3.6857566000769014`*^9}, {3.685756768723548*^9, 3.6857567949360466`*^9}, {
   3.685759343496816*^9, 3.6857593493911533`*^9}, 3.7161260449859643`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1904, 998},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{841.98, 1191.},
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->36},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1386, 21, 186, "Section"],
Cell[CellGroupData[{
Cell[1991, 47, 183, 4, 39, "Subsubsection"],
Cell[2177, 53, 911, 22, 30, "Input"],
Cell[3091, 77, 1749, 42, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4877, 124, 854, 15, 186, "Subsubsection"],
Cell[5734, 141, 2511, 52, 126, "Input"],
Cell[8248, 195, 3007, 64, 107, "Input"],
Cell[11258, 261, 4263, 107, 164, "Input"],
Cell[15524, 370, 5135, 115, 202, "Input"],
Cell[20662, 487, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21959, 519, 452, 9, 74, "Subsubsection"],
Cell[22414, 530, 3005, 64, 107, "Input"],
Cell[25422, 596, 4271, 107, 164, "Input"],
Cell[29696, 705, 5238, 117, 202, "Input"],
Cell[34937, 824, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36283, 857, 474, 9, 74, "Subsubsection"],
Cell[36760, 868, 3009, 64, 107, "Input"],
Cell[39772, 934, 4291, 107, 164, "Input"],
Cell[44066, 1043, 5377, 118, 202, "Input"],
Cell[49446, 1163, 1368, 29, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50851, 1197, 403, 7, 67, "Subsubsection"],
Cell[51257, 1206, 1364, 34, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52658, 1245, 149, 1, 39, "Subsubsection"],
Cell[52810, 1248, 17632, 450, 620, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70479, 1703, 343, 6, 79, "Subsection"],
Cell[70825, 1711, 5073, 129, 392, "Input"],
Cell[CellGroupData[{
Cell[75923, 1844, 1141, 19, 151, "Subsubsection"],
Cell[77067, 1865, 3898, 90, 373, "Input"],
Cell[80968, 1957, 909, 23, 50, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81938, 1987, 240, 5, 70, "Section"],
Cell[82181, 1994, 1979, 46, 69, "Input"],
Cell[84163, 2042, 595, 13, 50, "Input"],
Cell[CellGroupData[{
Cell[84783, 2059, 908, 16, 207, "Subsubsection"],
Cell[85694, 2077, 990, 21, 30, "Input"],
Cell[86687, 2100, 2499, 58, 164, "Input"],
Cell[89189, 2160, 766, 17, 50, "Input"],
Cell[89958, 2179, 2039, 48, 164, "Input"],
Cell[92000, 2229, 1137, 28, 50, "Input"],
Cell[93140, 2259, 2033, 47, 164, "Input"],
Cell[95176, 2308, 1160, 28, 50, "Input"],
Cell[96339, 2338, 2778, 60, 183, "Input"],
Cell[99120, 2400, 711, 14, 50, "Input"],
Cell[99834, 2416, 7158, 163, 335, "Input"],
Cell[106995, 2581, 1463, 30, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108495, 2616, 111, 1, 49, "Subsection"],
Cell[108609, 2619, 416, 8, 30, "Input"],
Cell[109028, 2629, 5828, 155, 259, "Input"],
Cell[114859, 2786, 5901, 156, 259, "Input"],
Cell[120763, 2944, 6376, 168, 259, "Input"],
Cell[127142, 3114, 5242, 135, 202, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[132433, 3255, 206, 4, 70, "Section"],
Cell[132642, 3261, 6785, 140, 278, "Input"],
Cell[139430, 3403, 1103, 25, 52, "Input"],
Cell[140536, 3430, 2119, 51, 132, "Input"],
Cell[142658, 3483, 10529, 258, 278, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153224, 3746, 331, 7, 99, "Section"],
Cell[153558, 3755, 712, 17, 30, "Input"],
Cell[154273, 3774, 1776, 42, 69, "Input"],
Cell[CellGroupData[{
Cell[156074, 3820, 227, 3, 39, "Subsubsection"],
Cell[156304, 3825, 427, 7, 50, "Input"],
Cell[156734, 3834, 3048, 65, 107, "Input"],
Cell[159785, 3901, 4299, 106, 164, "Input"],
Cell[164087, 4009, 5268, 118, 202, "Input"],
Cell[169358, 4129, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170655, 4161, 357, 5, 39, "Subsubsection"],
Cell[171015, 4168, 1538, 32, 69, "Input"],
Cell[172556, 4202, 4319, 106, 164, "Input"],
Cell[176878, 4310, 4752, 113, 202, "Input"],
Cell[181633, 4425, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182979, 4458, 352, 5, 39, "Subsubsection"],
Cell[183334, 4465, 1560, 33, 69, "Input"],
Cell[184897, 4500, 4381, 107, 164, "Input"],
Cell[189281, 4609, 5457, 120, 202, "Input"],
Cell[194741, 4731, 1368, 29, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196146, 4765, 424, 7, 39, "Subsubsection"],
Cell[196573, 4774, 1414, 35, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198024, 4814, 149, 1, 39, "Subsubsection"],
Cell[198176, 4817, 16412, 419, 582, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214625, 5241, 343, 6, 79, "Subsection"],
Cell[214971, 5249, 5073, 129, 392, "Input"],
Cell[CellGroupData[{
Cell[220069, 5382, 1143, 19, 151, "Subsubsection"],
Cell[221215, 5403, 3898, 90, 373, "Input"],
Cell[225116, 5495, 964, 23, 50, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[226141, 5525, 240, 5, 70, "Section"],
Cell[226384, 5532, 2029, 47, 69, "Input"],
Cell[228416, 5581, 697, 15, 50, "Input"],
Cell[CellGroupData[{
Cell[229138, 5600, 908, 16, 207, "Subsubsection"],
Cell[230049, 5618, 988, 21, 30, "Input"],
Cell[231040, 5641, 2499, 58, 164, "Input"],
Cell[233542, 5701, 768, 17, 50, "Input"],
Cell[234313, 5720, 2062, 48, 164, "Input"],
Cell[236378, 5770, 1190, 29, 50, "Input"],
Cell[237571, 5801, 1982, 46, 164, "Input"],
Cell[239556, 5849, 1211, 29, 50, "Input"],
Cell[240770, 5880, 2828, 60, 183, "Input"],
Cell[243601, 5942, 665, 14, 50, "Input"],
Cell[244269, 5958, 7244, 163, 335, "Input"],
Cell[251516, 6123, 1542, 31, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253095, 6159, 111, 1, 49, "Subsection"],
Cell[253209, 6162, 416, 8, 30, "Input"],
Cell[253628, 6172, 5932, 157, 259, "Input"],
Cell[259563, 6331, 5976, 158, 259, "Input"],
Cell[265542, 6491, 6450, 170, 259, "Input"],
Cell[271995, 6663, 5263, 136, 202, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[277307, 6805, 383, 8, 99, "Section"],
Cell[277693, 6815, 764, 18, 30, "Input"],
Cell[278460, 6835, 1820, 43, 69, "Input"],
Cell[CellGroupData[{
Cell[280305, 6882, 227, 3, 39, "Subsubsection"],
Cell[280535, 6887, 427, 7, 50, "Input"],
Cell[280965, 6896, 3095, 65, 107, "Input"],
Cell[284063, 6963, 4311, 106, 164, "Input"],
Cell[288377, 7071, 4752, 113, 202, "Input"],
Cell[293132, 7186, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[294429, 7218, 357, 5, 39, "Subsubsection"],
Cell[294789, 7225, 1538, 32, 69, "Input"],
Cell[296330, 7259, 4357, 107, 164, "Input"],
Cell[300690, 7368, 4770, 114, 389, "Input"],
Cell[305463, 7484, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[306809, 7517, 352, 5, 39, "Subsubsection"],
Cell[307164, 7524, 1560, 33, 69, "Input"],
Cell[308727, 7559, 4394, 108, 164, "Input"],
Cell[313124, 7669, 5509, 121, 202, "Input"],
Cell[318636, 7792, 1368, 29, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320041, 7826, 424, 7, 39, "Subsubsection"],
Cell[320468, 7835, 1414, 35, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[321919, 7875, 149, 1, 39, "Subsubsection"],
Cell[322071, 7878, 16674, 426, 582, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[338782, 8309, 343, 6, 79, "Subsection"],
Cell[339128, 8317, 5073, 129, 392, "Input"],
Cell[CellGroupData[{
Cell[344226, 8450, 1143, 19, 151, "Subsubsection"],
Cell[345372, 8471, 3898, 90, 373, "Input"],
Cell[349273, 8563, 964, 23, 50, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[350298, 8593, 240, 5, 70, "Section"],
Cell[350541, 8600, 2030, 47, 69, "Input"],
Cell[352574, 8649, 646, 14, 50, "Input"],
Cell[CellGroupData[{
Cell[353245, 8667, 908, 16, 207, "Subsubsection"],
Cell[354156, 8685, 988, 21, 30, "Input"],
Cell[355147, 8708, 2499, 58, 164, "Input"],
Cell[357649, 8768, 768, 17, 50, "Input"],
Cell[358420, 8787, 2159, 49, 164, "Input"],
Cell[360582, 8838, 1137, 28, 50, "Input"],
Cell[361722, 8868, 2084, 48, 164, "Input"],
Cell[363809, 8918, 1060, 27, 50, "Input"],
Cell[364872, 8947, 2930, 62, 183, "Input"],
Cell[367805, 9011, 665, 14, 50, "Input"],
Cell[368473, 9027, 7272, 164, 335, "Input"],
Cell[375748, 9193, 1598, 32, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[377383, 9230, 111, 1, 49, "Subsection"],
Cell[377497, 9233, 416, 8, 30, "Input"],
Cell[377916, 9243, 5954, 157, 259, "Input"],
Cell[383873, 9402, 5999, 158, 259, "Input"],
Cell[389875, 9562, 6471, 170, 259, "Input"],
Cell[396349, 9734, 5284, 136, 202, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[401682, 9876, 436, 8, 99, "Section"],
Cell[402121, 9886, 817, 19, 30, "Input"],
Cell[402941, 9907, 1871, 44, 69, "Input"],
Cell[CellGroupData[{
Cell[404837, 9955, 227, 3, 39, "Subsubsection"],
Cell[405067, 9960, 427, 7, 50, "Input"],
Cell[405497, 9969, 3147, 66, 107, "Input"],
Cell[408647, 10037, 4348, 107, 164, "Input"],
Cell[412998, 10146, 4769, 114, 202, "Input"],
Cell[417770, 10262, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[419067, 10294, 357, 5, 39, "Subsubsection"],
Cell[419427, 10301, 1564, 33, 69, "Input"],
Cell[420994, 10336, 4368, 107, 164, "Input"],
Cell[425365, 10445, 4785, 114, 202, "Input"],
Cell[430153, 10561, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[431499, 10594, 352, 5, 39, "Subsubsection"],
Cell[431854, 10601, 1592, 33, 69, "Input"],
Cell[433449, 10636, 4402, 108, 164, "Input"],
Cell[437854, 10746, 5557, 121, 202, "Input"],
Cell[443414, 10869, 1368, 29, 96, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444819, 10903, 424, 7, 75, "Subsubsection"],
Cell[445246, 10912, 1414, 35, 243, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[446697, 10952, 149, 1, 39, "Subsubsection"],
Cell[446849, 10955, 16883, 429, 582, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[463769, 11389, 343, 6, 79, "Subsection"],
Cell[464115, 11397, 5073, 129, 392, "Input"],
Cell[CellGroupData[{
Cell[469213, 11530, 1143, 19, 151, "Subsubsection"],
Cell[470359, 11551, 3898, 90, 373, "Input"],
Cell[474260, 11643, 1012, 24, 96, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[475333, 11674, 240, 5, 135, "Section"],
Cell[475576, 11681, 2030, 47, 133, "Input"],
Cell[477609, 11730, 646, 14, 96, "Input"],
Cell[CellGroupData[{
Cell[478280, 11748, 908, 16, 399, "Subsubsection"],
Cell[479191, 11766, 990, 21, 57, "Input"],
Cell[480184, 11789, 2499, 58, 316, "Input"],
Cell[482686, 11849, 768, 17, 96, "Input"],
Cell[483457, 11868, 2212, 50, 316, "Input"],
Cell[485672, 11920, 1137, 28, 50, "Input"],
Cell[486812, 11950, 2134, 48, 164, "Input"],
Cell[488949, 12000, 1060, 27, 50, "Input"],
Cell[490012, 12029, 2978, 62, 183, "Input"],
Cell[492993, 12093, 665, 14, 50, "Input"],
Cell[493661, 12109, 7322, 164, 335, "Input"],
Cell[500986, 12275, 1648, 33, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[502671, 12313, 111, 1, 49, "Subsection"],
Cell[502785, 12316, 416, 8, 30, "Input"],
Cell[503204, 12326, 5973, 158, 259, "Input"],
Cell[509180, 12486, 6017, 159, 259, "Input"],
Cell[515200, 12647, 6488, 170, 259, "Input"],
Cell[521691, 12819, 5328, 137, 202, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[527068, 12962, 723, 14, 128, "Section"],
Cell[527794, 12978, 868, 19, 57, "Input"],
Cell[528665, 12999, 1920, 44, 133, "Input"],
Cell[CellGroupData[{
Cell[530610, 13047, 227, 3, 75, "Subsubsection"],
Cell[530840, 13052, 427, 7, 96, "Input"],
Cell[531270, 13061, 2321, 49, 107, "Input"],
Cell[533594, 13112, 4364, 107, 164, "Input"],
Cell[537961, 13221, 4789, 114, 202, "Input"],
Cell[542753, 13337, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[544050, 13369, 357, 5, 39, "Subsubsection"],
Cell[544410, 13376, 1564, 33, 69, "Input"],
Cell[545977, 13411, 4368, 107, 164, "Input"],
Cell[550348, 13520, 4785, 114, 389, "Input"],
Cell[555136, 13636, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[556482, 13669, 352, 5, 39, "Subsubsection"],
Cell[556837, 13676, 1592, 33, 69, "Input"],
Cell[558432, 13711, 4421, 108, 164, "Input"],
Cell[562856, 13821, 5608, 122, 202, "Input"],
Cell[568467, 13945, 1368, 29, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[569872, 13979, 424, 7, 39, "Subsubsection"],
Cell[570299, 13988, 1459, 35, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[571795, 14028, 149, 1, 39, "Subsubsection"],
Cell[571947, 14031, 17304, 438, 601, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[589288, 14474, 343, 6, 79, "Subsection"],
Cell[589634, 14482, 5121, 129, 392, "Input"],
Cell[CellGroupData[{
Cell[594780, 14615, 1143, 19, 151, "Subsubsection"],
Cell[595926, 14636, 3898, 90, 373, "Input"],
Cell[599827, 14728, 1022, 24, 50, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[600910, 14759, 240, 5, 70, "Section"],
Cell[601153, 14766, 2032, 47, 69, "Input"],
Cell[603188, 14815, 699, 15, 50, "Input"],
Cell[CellGroupData[{
Cell[603912, 14834, 908, 16, 207, "Subsubsection"],
Cell[604823, 14852, 988, 21, 30, "Input"],
Cell[605814, 14875, 2499, 58, 164, "Input"],
Cell[608316, 14935, 768, 17, 50, "Input"],
Cell[609087, 14954, 2265, 51, 164, "Input"],
Cell[611355, 15007, 1137, 28, 50, "Input"],
Cell[612495, 15037, 2182, 49, 164, "Input"],
Cell[614680, 15088, 1060, 27, 50, "Input"],
Cell[615743, 15117, 3031, 63, 183, "Input"],
Cell[618777, 15182, 665, 14, 50, "Input"],
Cell[619445, 15198, 7393, 165, 335, "Input"],
Cell[626841, 15365, 1722, 34, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[628600, 15404, 111, 1, 49, "Subsection"],
Cell[628714, 15407, 416, 8, 30, "Input"],
Cell[629133, 15417, 5994, 158, 259, "Input"],
Cell[635130, 15577, 6038, 159, 259, "Input"],
Cell[641171, 15738, 6517, 171, 499, "Input"],
Cell[647691, 15911, 5327, 137, 202, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[653067, 16054, 344, 6, 70, "Section"],
Cell[CellGroupData[{
Cell[653436, 16064, 648, 11, 179, "Subsubsection"],
Cell[654087, 16077, 117, 1, 30, "Input"],
Cell[654207, 16080, 124, 1, 30, "Input"],
Cell[654334, 16083, 126, 1, 30, "Input"],
Cell[654463, 16086, 131, 1, 30, "Input"],
Cell[654597, 16089, 124, 1, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[654758, 16095, 391, 7, 39, "Subsubsection"],
Cell[655152, 16104, 345, 7, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[655534, 16116, 322, 10, 95, "Subsubsection"],
Cell[655859, 16128, 142, 2, 30, "Input"],
Cell[656004, 16132, 3972, 93, 259, "Input"],
Cell[659979, 16227, 605, 15, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[660621, 16247, 400, 12, 42, "Subsubsection"],
Cell[661024, 16261, 1095, 27, 88, "Input"],
Cell[662122, 16290, 1056, 24, 88, "Input"]
}, Open  ]],
Cell[663193, 16317, 412, 7, 67, "Subsubsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[663642, 16329, 543, 10, 190, "Section"],
Cell[664188, 16341, 867, 19, 57, "Input"],
Cell[665058, 16362, 1969, 46, 133, "Input"],
Cell[CellGroupData[{
Cell[667052, 16412, 227, 3, 75, "Subsubsection"],
Cell[667282, 16417, 427, 7, 96, "Input"],
Cell[667712, 16426, 3231, 67, 126, "Input"],
Cell[670946, 16495, 4356, 107, 164, "Input"],
Cell[675305, 16604, 4785, 114, 202, "Input"],
Cell[680093, 16720, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[681390, 16752, 357, 5, 39, "Subsubsection"],
Cell[681750, 16759, 1564, 33, 69, "Input"],
Cell[683317, 16794, 5561, 120, 164, "Input"],
Cell[688881, 16916, 4797, 114, 389, "Input"],
Cell[693681, 17032, 1309, 28, 133, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[695027, 17065, 352, 5, 75, "Subsubsection"],
Cell[695382, 17072, 1592, 33, 133, "Input"],
Cell[696977, 17107, 4413, 108, 316, "Input"],
Cell[701393, 17217, 5610, 122, 389, "Input"],
Cell[707006, 17341, 1368, 29, 133, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[708411, 17375, 424, 7, 75, "Subsubsection"],
Cell[708838, 17384, 1414, 35, 243, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[710289, 17424, 149, 1, 39, "Subsubsection"],
Cell[710441, 17427, 16861, 427, 582, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[727339, 17859, 343, 6, 79, "Subsection"],
Cell[727685, 17867, 5073, 129, 392, "Input"],
Cell[CellGroupData[{
Cell[732783, 18000, 1143, 19, 151, "Subsubsection"],
Cell[733929, 18021, 3898, 90, 373, "Input"],
Cell[737830, 18113, 968, 23, 96, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[738859, 18143, 559, 10, 190, "Section"],
Cell[739421, 18155, 965, 21, 57, "Input"],
Cell[740389, 18178, 1996, 46, 69, "Input"],
Cell[CellGroupData[{
Cell[742410, 18228, 227, 3, 39, "Subsubsection"],
Cell[742640, 18233, 427, 7, 50, "Input"],
Cell[743070, 18242, 3266, 67, 107, "Input"],
Cell[746339, 18311, 4368, 107, 164, "Input"],
Cell[750710, 18420, 4797, 114, 202, "Input"],
Cell[755510, 18536, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[756807, 18568, 357, 5, 39, "Subsubsection"],
Cell[757167, 18575, 1564, 33, 133, "Input"],
Cell[758734, 18610, 5615, 121, 316, "Input"],
Cell[764352, 18733, 4813, 114, 389, "Input"],
Cell[769168, 18849, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[770514, 18882, 352, 5, 39, "Subsubsection"],
Cell[770869, 18889, 1592, 33, 69, "Input"],
Cell[772464, 18924, 4429, 108, 164, "Input"],
Cell[776896, 19034, 5659, 123, 202, "Input"],
Cell[782558, 19159, 1368, 29, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[783963, 19193, 424, 7, 39, "Subsubsection"],
Cell[784390, 19202, 1414, 35, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[785841, 19242, 149, 1, 39, "Subsubsection"],
Cell[785993, 19245, 16942, 428, 582, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[802972, 19678, 343, 6, 79, "Subsection"],
Cell[803318, 19686, 5073, 129, 392, "Input"],
Cell[CellGroupData[{
Cell[808416, 19819, 1141, 19, 151, "Subsubsection"],
Cell[809560, 19840, 3898, 90, 373, "Input"],
Cell[813461, 19932, 1022, 24, 50, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[814544, 19963, 618, 10, 99, "Section"],
Cell[815165, 19975, 1064, 22, 30, "Input"],
Cell[816232, 19999, 2101, 47, 69, "Input"],
Cell[CellGroupData[{
Cell[818358, 20050, 227, 3, 39, "Subsubsection"],
Cell[818588, 20055, 427, 7, 50, "Input"],
Cell[819018, 20064, 2409, 49, 88, "Input"],
Cell[821430, 20115, 4385, 108, 164, "Input"],
Cell[825818, 20225, 4817, 114, 202, "Input"],
Cell[830638, 20341, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[831935, 20373, 357, 5, 39, "Subsubsection"],
Cell[832295, 20380, 1588, 33, 69, "Input"],
Cell[833886, 20415, 5665, 122, 164, "Input"],
Cell[839554, 20539, 4834, 115, 202, "Input"],
Cell[844391, 20656, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[845737, 20689, 352, 5, 39, "Subsubsection"],
Cell[846092, 20696, 1616, 33, 69, "Input"],
Cell[847711, 20731, 4429, 108, 164, "Input"],
Cell[852143, 20841, 5659, 123, 202, "Input"],
Cell[857805, 20966, 1421, 30, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[859263, 21001, 424, 7, 39, "Subsubsection"],
Cell[859690, 21010, 1414, 35, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[861141, 21050, 149, 1, 39, "Subsubsection"],
Cell[861293, 21053, 25699, 656, 1038, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[887029, 21714, 343, 6, 79, "Subsection"],
Cell[887375, 21722, 5291, 133, 392, "Input"],
Cell[CellGroupData[{
Cell[892691, 21859, 1110, 18, 151, "Subsubsection"],
Cell[893804, 21879, 3898, 90, 373, "Input"],
Cell[897705, 21971, 1074, 25, 50, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[898840, 22003, 2554, 36, 331, "Section"],
Cell[CellGroupData[{
Cell[901419, 22043, 183, 4, 39, "Subsubsection"],
Cell[901605, 22049, 1027, 21, 30, "Input"],
Cell[902635, 22072, 2805, 66, 88, "Input"],
Cell[905443, 22140, 687, 18, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[906167, 22163, 182, 4, 39, "Subsubsection"],
Cell[906352, 22169, 12829, 329, 411, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[919218, 22503, 203, 4, 39, "Subsubsection"],
Cell[919424, 22509, 399, 10, 30, "Input"],
Cell[919826, 22521, 618, 15, 50, "Input"],
Cell[920447, 22538, 2241, 51, 169, "Input"],
Cell[922691, 22591, 1088, 24, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[923816, 22620, 264, 5, 39, "Subsubsection"],
Cell[924083, 22627, 1453, 29, 69, "Input"],
Cell[925539, 22658, 1184, 30, 88, "Input"],
Cell[926726, 22690, 11759, 314, 354, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[938522, 23009, 343, 6, 79, "Subsection"],
Cell[938868, 23017, 5147, 130, 392, "Input"],
Cell[CellGroupData[{
Cell[944040, 23151, 1143, 19, 151, "Subsubsection"],
Cell[945186, 23172, 3898, 90, 373, "Input"],
Cell[949087, 23264, 1071, 25, 50, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[950219, 23296, 439, 9, 95, "Section"],
Cell[950661, 23307, 12723, 328, 734, "Input"],
Cell[963387, 23637, 212, 5, 30, "Input"],
Cell[963602, 23644, 502, 13, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[964141, 23662, 688, 12, 99, "Section"],
Cell[964832, 23676, 1116, 23, 30, "Input"],
Cell[965951, 23701, 2004, 46, 69, "Input"],
Cell[CellGroupData[{
Cell[967980, 23751, 160, 3, 49, "Subsection"],
Cell[CellGroupData[{
Cell[968165, 23758, 227, 3, 39, "Subsubsection"],
Cell[968395, 23763, 427, 7, 50, "Input"],
Cell[968825, 23772, 2248, 45, 88, "Input"],
Cell[971076, 23819, 4385, 108, 164, "Input"],
Cell[975464, 23929, 4817, 114, 202, "Input"],
Cell[980284, 24045, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[981581, 24077, 357, 5, 39, "Subsubsection"],
Cell[981941, 24084, 1564, 33, 69, "Input"],
Cell[983508, 24119, 5665, 122, 164, "Input"],
Cell[989176, 24243, 4830, 115, 202, "Input"],
Cell[994009, 24360, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[995355, 24393, 352, 5, 39, "Subsubsection"],
Cell[995710, 24400, 1592, 33, 69, "Input"],
Cell[997305, 24435, 4441, 108, 164, "Input"],
Cell[1001749, 24545, 5709, 123, 202, "Input"],
Cell[1007461, 24670, 1368, 29, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1008866, 24704, 424, 7, 39, "Subsubsection"],
Cell[1009293, 24713, 1414, 35, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1010744, 24753, 149, 1, 39, "Subsubsection"],
Cell[1010896, 24756, 15179, 380, 544, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1026124, 25142, 214, 4, 49, "Subsection"],
Cell[CellGroupData[{
Cell[1026363, 25150, 227, 3, 39, "Subsubsection"],
Cell[1026593, 25155, 474, 7, 50, "Input"],
Cell[1027070, 25164, 2301, 46, 88, "Input"],
Cell[1029374, 25212, 4393, 108, 164, "Input"],
Cell[1033770, 25322, 4830, 115, 202, "Input"],
Cell[1038603, 25439, 1260, 27, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1039900, 25471, 357, 5, 39, "Subsubsection"],
Cell[1040260, 25478, 1614, 33, 69, "Input"],
Cell[1041877, 25513, 5715, 122, 164, "Input"],
Cell[1047595, 25637, 4846, 115, 202, "Input"],
Cell[1052444, 25754, 1309, 28, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1053790, 25787, 352, 5, 39, "Subsubsection"],
Cell[1054145, 25794, 1643, 34, 69, "Input"],
Cell[1055791, 25830, 4454, 109, 164, "Input"],
Cell[1060248, 25941, 5763, 124, 202, "Input"],
Cell[1066014, 26067, 1368, 29, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1067419, 26101, 424, 7, 39, "Subsubsection"],
Cell[1067846, 26110, 1438, 35, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1069321, 26150, 149, 1, 39, "Subsubsection"],
Cell[1069473, 26153, 15249, 381, 544, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1084783, 26541, 218, 4, 70, "Section"],
Cell[CellGroupData[{
Cell[1085026, 26549, 183, 4, 39, "Subsubsection"],
Cell[1085212, 26555, 1266, 28, 50, "Input"],
Cell[1086481, 26585, 1460, 32, 50, "Input"],
Cell[1087944, 26619, 1919, 52, 52, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1089900, 26676, 241, 3, 39, "Subsubsection"],
Cell[1090144, 26681, 517, 12, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1090698, 26698, 128, 1, 39, "Subsubsection"],
Cell[1090829, 26701, 5564, 147, 259, "Input"],
Cell[1096396, 26850, 2485, 55, 69, "Input"],
Cell[1098884, 26907, 5041, 136, 145, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1103962, 27048, 187, 2, 39, "Subsubsection"],
Cell[1104152, 27052, 447, 11, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1104636, 27068, 128, 1, 39, "Subsubsection"],
Cell[1104767, 27071, 5517, 147, 259, "Input"],
Cell[1110287, 27220, 4309, 115, 126, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

