(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    664581,      15996]
NotebookOptionsPosition[    655127,      15710]
NotebookOutlinePosition[    655748,      15734]
CellTagsIndexPosition[    655705,      15731]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tumor growth characteristics", "Section",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.6809117157989445`*^9, 3.6809117166209917`*^9}}],

Cell[TextData[{
 StyleBox["Tumor growth rates are chosen to produce median \
\[OpenCurlyQuote]potential tumor doubling time\[CloseCurlyQuote] ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["DT", "pot"]}], TraditionalForm]],
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[") of 10 days (that is, cell doubling rate when not accounting for \
cell loss),  with a cell loss factor (\[Phi]) of 80% so as to produces tumor \
volume doubling times (DT) of median 50 days, with 10% and 90% quantiles of \
~36 days and ~83 days. This is achieved with each tumor\[CloseCurlyQuote]s \
growth rate parameter drawn from a normal distribution with mean 0.069 ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["days", 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[", ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["standard deviation 0.021 ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["days", 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" (and an enforced minimum of 0.01 to prevent negative growth \
rates).",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\n\nThese parameters (potential tumor volume doubling time, actual \
tumor volume doubling time, cell loss factor) are chosen as being \
approximately representative of human carcinoma according to the following \
references:\n\tSteel GG. Cell loss as a factor in the growth rate of human \
tumours. European journal of cancer 1967;3:381-7\n\tSteel GG. Growth kinetics \
of tumours : cell population kinetics in relation to the growth and treatment \
of cancer. Oxford Eng.: Clarendon Press; 1977\n\tRefsum SB, Berdal P. Cell \
loss in malignant tumours in man. European journal of cancer 1967;3:235-6.\n\t\
Frindel E, Malaise E, Tubiana M. Cell proliferation kinetics in five human \
solid tumors. Cancer 1968;22:611-20.\n\tMalaise EP, Chavaudra N, Tubiana M. \
The relationship between growth rate, labelling index and histological type \
of human solid tumours. European journal of cancer 1973;9:305-12.\n\t\
Silvestrini R, Sanfilippo O, Tedesco G. Kinetics of human mammary carcinomas \
and their correlation with the cancer and the host characteristics. Cancer \
1974;34:1252-8.\n\tKerr KM, Lamb D. Actual growth rate and tumour cell \
proliferation in human pulmonary neoplasms. British journal of cancer \
1984;50:343-9.\n\tTubiana M. Tumor cell proliferation kinetics and tumor \
growth rate. Acta oncologica 1989;28:113-21.\n\tCharbit A, Malaise EP, \
Tubiana, M. Relation between the pathological nature and the growth rate of \
human tumors. European journal of cancer 1971;7:307-15",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\n\n",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["For example:",
  FontSize->16,
  FontWeight->"Bold",
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\nRefsum & Berdal (1967) report epidermoid and salivary gland \
carcinomas with mean DT of 60 days, ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["DT", "pot"], TraditionalForm]],
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" of 2.4 days, and \[Phi]=96%\n\n",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Silvestrini, Sanfilippo, and Tedesco (1974) report mammary \
carcinomas as having median DT from 85 to 105 days (depending on source \
study) in primary tumors, and 40 days in recurrent tumors. ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["DT", "pot"], TraditionalForm]],
  FontVariations->{"Underline"->False},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" is reported as ranging from ~8 to ~28 days, with slower rates in \
older patients.\n\nKerr & Lamb (1984) report pulmonary tumors having mean \
\[Phi] = 90% (ranging from 71% to 99%; excluding lower values of \[Phi] in \
secondary renal tumors), mean DT = 73 days (ranging from 20 days to 154 \
days), and mean ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["DT", "pot"], TraditionalForm]],
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" = 4.8 days (ranging from 2.2 days to 7.1 days).\n\nCharbit, \
Malaise, and Tubiana (1971) report the following doubling times:\n",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Pathology\t\t\t\t\tMedian DT (days)",
  FontSize->16,
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\nLung metastasis of embryonal tumors\t\t25\nLymphomas\t\t\t\t\t32\
\nMalignant mesenchymal tumors\t\t37\nLung metastasis of squamous cell \
carcinoma\t56\nPrimary squamous cell carcinoma\t\t80\nLung metastasis of \
adenocarcinoma\t\t89\nPrimary adenocarcinoma\t\t\t207\n\n",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Malaise, Chavaudra, and Tubiana",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" (1973) and Tubiana (1989) reports the following mean tumor \
kinetic parameters:\n",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Histological type\t\tDT (days)\t\[Phi] (%)\t\t",
  FontSize->16,
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["DT", "pot"], TraditionalForm]],
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" (days)",
  FontSize->16,
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\nEmbryonal tumors\t\t27\t\t93\t\t2\nHematosarcoma\t\t29\t\t94\t\t\
2\nMalignant lymphomas\t\t29\t\t93\t\t2\nMesenchymal sarcomas\t41\t\t68\t\t13\
\nSquamous cell carcinomas\t58\t\t89\t\t6\nAdenocarcinomas\t\t83\t\t71\t\t24\n\
\nSteel (1967) reports potential tumor doubling times:\n",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Site of tumor\t\t",
  FontSize->16,
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["DT", "pot"], TraditionalForm]],
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" (days)",
  FontSize->16,
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\nBreast  \t\t43\nColon \t\t\t10.4\nStomach  \t\t6.8\nCNS  \t\t\t\
23.4\nMelanoma  \t\t14.2\nLung and Larynx  \t3.1\nTongue \t\t6.5\nUterus and \
Cervix \t9.8\nLymphosarcoma, \t1.5\n   Burkitt Tumor\nMiscellaneous sites \t\
33\n",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}}],

Cell[CellGroupData[{

Cell["Distribution of growth rates", "Subsubsection",
 CellChangeTimes->{{3.6833715479259796`*^9, 3.683371551935985*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CellLossRate", "=", 
   RowBox[{"80", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributionOfGrowthRates", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "100"}], ",", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{
            RowBox[{"6.9", "/", "100"}], ",", 
            RowBox[{"2.1", "/", "100"}]}], "]"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       SuperscriptBox["10", "4"], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"DistributionOfGrowthRates", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.2", ",", "0.005"}], "}"}], ",", 
   "\"\<Probability\>\"", ",", 
   RowBox[{"ChartStyle", "\[Rule]", 
    RowBox[{"EdgeForm", "[", "None", "]"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Growth rate (\!\(\*SuperscriptBox[\(day\), \(-1\)]\))\>\"", ",", 
      "\"\<Probability\>\""}], "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", "\"\<Tumor cell growth rate distribution\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6614385439332*^9, 3.661438571460774*^9}, {
  3.6628121941687393`*^9, 3.6628121943247485`*^9}, {3.6628124700845213`*^9, 
  3.662812480357109*^9}, {3.662812521976489*^9, 3.6628125697242203`*^9}, {
  3.6670564759792514`*^9, 3.6670565159505377`*^9}, {3.667056630040063*^9, 
  3.6670567435895576`*^9}, {3.667056785301944*^9, 3.667056797800658*^9}, {
  3.6670577741465025`*^9, 3.667057819673106*^9}, {3.680882759859107*^9, 
  3.68088276012611*^9}, {3.68091174019034*^9, 3.6809117404963574`*^9}, {
  3.6833714585248528`*^9, 3.683371465125862*^9}, {3.683376504584926*^9, 
  3.683376527314226*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Median DTpot and DT", "Subsubsection",
 CellChangeTimes->{{3.683371503047916*^9, 3.6833715358429623`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Solve", "::", "ifun"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "solving", " ", "for", " ", "median", " ", "potential", " ", "tumor", " ",
      "doubling", " ", "time"}], ",", " ", 
    SubscriptBox["DT", "pot"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MedianCellDoublingTime", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"Median", "[", "DistributionOfGrowthRates", "]"}], "*", 
       RowBox[{"(", "1", ")"}], "*", "t"}], "]"}], "\[Equal]", "2"}], "]"}]}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "solving", " ", "for", " ", "median", " ", "actual", " ", "tumor", " ", 
     "doubling", " ", "time"}], ",", " ", "DT"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MedianTumorDoublingTime", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"Median", "[", "DistributionOfGrowthRates", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", "CellLossRate"}], ")"}], "*", "t"}], "]"}], 
    "\[Equal]", "2"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6628123668646173`*^9, 3.6628124511734395`*^9}, {
  3.667056463403532*^9, 3.667056464358587*^9}, {3.667057725935745*^9, 
  3.667057725991748*^9}, {3.6808827203528805`*^9, 3.680882809691385*^9}, {
  3.6833714731968746`*^9, 3.6833714731968746`*^9}, {3.683371575558018*^9, 
  3.68337158384903*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["10 % and 90 % quantiles of DTpot and DT", "Subsubsection",
 CellChangeTimes->{{3.6833715224309435`*^9, 3.683371532862958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "10", "%", " ", "and", " ", "90", "%", " ", "quantile", " ", "values", " ",
     "for", " ", 
    SubscriptBox["DT", "pot"]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Quantile10CellDoublingTime", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"Quantile", "[", 
         RowBox[{"DistributionOfGrowthRates", ",", "0.1"}], "]"}], "*", 
        RowBox[{"(", "1", ")"}], "*", "t"}], "]"}], "\[Equal]", "2"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Quantile90CellDoublingTime", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"Quantile", "[", 
         RowBox[{"DistributionOfGrowthRates", ",", "0.9"}], "]"}], "*", 
        RowBox[{"(", "1", ")"}], "*", "t"}], "]"}], "\[Equal]", "2"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "10", "%", " ", "and", " ", "90", "%", " ", "quantile", " ", "values", 
     " ", "for", " ", "DT"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Quantile10TumorDoublingTime", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"Quantile", "[", 
         RowBox[{"DistributionOfGrowthRates", ",", "0.1"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "CellLossRate"}], ")"}], "*", "t"}], "]"}], 
      "\[Equal]", "2"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Quantile90TumorDoublingTime", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"Quantile", "[", 
         RowBox[{"DistributionOfGrowthRates", ",", "0.9"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "CellLossRate"}], ")"}], "*", "t"}], "]"}], 
      "\[Equal]", "2"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6628189076647296`*^9, 3.662818916883257*^9}, {
  3.680882812817408*^9, 3.6808828570676365`*^9}, {3.6833714732068744`*^9, 
  3.6833714732068744`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Note that the model output is time taken for tumor volume to double (\
\[OpenCurlyQuote]progression\[CloseCurlyQuote]), and over a 2-fold growth \
rate, there is little difference in the growth trajectories of exponential, \
logistic, gompertz, or even linear growth models (when calibrated to have \
same net doubling rate)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6854610574777174`*^9, 3.6854611677070227`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Exponential", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"k", "*", "t"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"k", "\[Rule]", "1"}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Linear", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"k", "*", "t"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"k", "\[Rule]", "1.45"}], "}"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"here", ",", " ", 
    RowBox[{
    "logistic", " ", "and", " ", "Gompertz", " ", "growth", " ", "models", 
     " ", "are", " ", "calibrated", " ", "to", " ", "have", " ", "a", " ", 
     "maximum", " ", "population", " ", "that", " ", "is", " ", "twice", " ", 
     "as", " ", "large", " ", "as", " ", "the", " ", "threshold", " ", "for", 
     " ", "progression"}], ",", " ", 
    RowBox[{
    "itself", " ", "being", " ", "twice", " ", "the", " ", "initial", " ", 
     "population", " ", 
     RowBox[{"size", ".", " ", "When"}], " ", "calibrated", " ", "to", " ", 
     "have", " ", "a", " ", "larger", " ", "maximum", " ", "population"}], 
    ",", " ", 
    RowBox[{
    "their", " ", "difference", " ", "from", " ", "exponential", " ", 
     "growth", " ", "model", " ", "is", " ", "yet", " ", "smaller"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Logistic", "[", "t_", "]"}], ":=", 
   RowBox[{
    FractionBox["L", 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "k"}], "*", 
        RowBox[{"(", 
         RowBox[{"t", "-", "t0"}], ")"}]}], "]"}]}]], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"L", "\[Rule]", "4"}], ",", 
      RowBox[{"k", "\[Rule]", "1.6"}], ",", 
      RowBox[{"t0", "\[Rule]", "0.7"}]}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gompertz", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "b"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "c"}], "*", "t"}], "]"}]}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", "4"}], ",", 
      RowBox[{"b", "\[Rule]", "1.4"}], ",", 
      RowBox[{"c", "\[Rule]", "1"}]}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Linear", "[", "t", "]"}], ",", 
     RowBox[{"Exponential", "[", "t", "]"}], ",", 
     RowBox[{"Logistic", "[", "t", "]"}], ",", 
     RowBox[{"Gompertz", "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "0.75"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Linear\>\"", ",", "\"\<Exponential\>\"", ",", "\"\<Logistic\>\"", 
      ",", "\"\<Gompertz\>\""}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Time\>\"", ",", "\"\<Tumor volume\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.681580040112424*^9, 3.681580096485648*^9}, {
  3.681580198779499*^9, 3.6815802120712595`*^9}, {3.6818349231255665`*^9, 
  3.6818349800860157`*^9}, {3.6838932960722823`*^9, 3.6838933127313075`*^9}, {
  3.6854611279457483`*^9, 3.685461134170104*^9}, {3.68546117657853*^9, 
  3.6854612066152477`*^9}, {3.6854612713309493`*^9, 3.685461359404987*^9}, {
  3.685461542280447*^9, 3.6854615428614798`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
There is greater divergence between growth models in the case of substantial \
tumor shrinkage:\
\>", "Subsubsection",
 CellChangeTimes->{{3.6854610574777174`*^9, 3.6854611677070227`*^9}, {
   3.6854612299625835`*^9, 3.685461251974842*^9}, 3.6854613883916445`*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", 
       RowBox[{"Linear", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", 
       RowBox[{"Exponential", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", 
       RowBox[{"Logistic", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", 
       RowBox[{"Gompertz", "[", "t", "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", 
     RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "3"}], ",", 
      RowBox[{"Log", "[", 
       RowBox[{"10", ",", "4"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Linear\>\"", ",", "\"\<Exponential\>\"", ",", "\"\<Logistic\>\"", 
      ",", "\"\<Gompertz\>\"", ",", 
      "\"\<Fastest feasible cell division rate\>\""}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Time (t=0 is centered on time when tumor volume = 1)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(Log\), \(10\)]\) (tumor volume)\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6818353811755705`*^9, 3.6818354373454027`*^9}, {
  3.6838933636493864`*^9, 3.6838935795987206`*^9}, {3.685461393966964*^9, 
  3.6854615385502334`*^9}, {3.7160752470201926`*^9, 3.7160752622060614`*^9}}]
}, Open  ]],

Cell["\<\
The effect of implementing 'Gompertzian' growth kinetics are explored at the \
very end of this document.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6854615558882256`*^9, 3.6854615778824835`*^9}, {
  3.6855946569448457`*^9, 3.685594685377472*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modeling drug action", "Section",
 CellChangeTimes->{{3.68337159832105*^9, 3.68337162647209*^9}, {
  3.683371658666135*^9, 3.6833716689681497`*^9}, {3.683372334992571*^9, 
  3.6833723353545914`*^9}, {3.683372371038621*^9, 3.6833723716166544`*^9}}],

Cell[TextData[{
 StyleBox["Drug inhibition of tumor growth is modeled as a simple \
ligand-receptor interaction, with relative growth rate of cells decreasing in \
proportion to target occupancy by drug.\n\nThus, relative growth = ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"[", "drug", "]"}], "/", 
      SubscriptBox["K", 
       StyleBox["I",
        FontSlant->"Plain"]]}]}]], TraditionalForm]],
  FontSize->24,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[", where [drug] = drug concentration, and ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["= inhibitory constant, being the drug concentration that produces \
50% inhibition.\n\nA Hill coefficient greater than 1 could also be modeled ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["(",
  FontSize->24,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   FractionBox["1", 
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"[", "drug", "]"}], "/", 
        SubscriptBox["K", 
         StyleBox["I",
          FontSlant->"Plain"]]}], ")"}], 
      RowBox[{"Hill", " ", "coefficient"}]]}]], TraditionalForm]],
  FontSize->24,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[")",
  FontSize->24,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[", but here we take Hill coefficient = 1.\n\nNote that in this drug \
inhibition model, [drug] and ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" only appear as their dimensionless ratio ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"[", "drug", "]"}], "/", 
    SubscriptBox["K", 
     StyleBox["I",
      FontSlant->"Plain"]]}], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[".",
  FontSize->16],
 StyleBox[" Both [drug] and ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["  have dimensions of concentration, and thus their units cancel \
out in the ratio. Therefore, any specific choice of units is not relevant to \
the model; only the ratio of drug concentration to inhibitory constant \
matters.\n\nMost simply, drug treatment can be modeled as continuous, but \
this model can also be adjusted to describe time-dependent therapy (e.g. \
periodic cycles of a cytotoxic therapy).\nTime-dependent treatment can be \
implementing using the \[OpenCurlyQuote]DrugTreatmentOverTime\
\[CloseCurlyQuote] function  - but in the present instance therapy is modeled \
as continuous.",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.683372374526821*^9, 3.683372747469118*^9}, {3.683372998850494*^9, 
   3.6833729992485166`*^9}, {3.683373278394402*^9, 3.6833734588437214`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "function", " ", "describing", " ", "drug", " ", "response", " ", "over", 
     " ", 
     RowBox[{"time", ".", " ", "Most"}], " ", "simply"}], ",", " ", 
    RowBox[{"therapy", " ", "is", " ", "continuous"}], ",", " ", 
    RowBox[{
     RowBox[{
     "but", " ", "this", " ", "function", " ", "can", " ", "be", " ", "used", 
      " ", "to", " ", "describe", " ", "time"}], "-", 
     RowBox[{"dependent", " ", "therapy", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", ".", "g", ".", " ", "periodic"}], " ", "cycles", " ", 
        "of", " ", "treatment"}], ")"}]}]}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DrugTreatmentOverTime", "[", 
     RowBox[{"t_", ",", "RelativeGrowthDuringTreatment_"}], "]"}], ":=", 
    "RelativeGrowthDuringTreatment"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"continuous", " ", "therapy"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "response", " ", "of", " ", "growth", " ", "to", " ", "drug", " ", 
       "treatment"}], " ", "-", " ", 
      RowBox[{"a", " ", "simple", " ", "Hill", " ", "function"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "hyperbolic", " ", "in", " ", "the", " ", "case", " ", "of", " ", 
       "Hill", " ", "Coefficient", " ", "NH"}], "=", 
      RowBox[{
       RowBox[{"1.", " ", "d"}], " ", "=", " ", 
       RowBox[{"drug", " ", "dose"}]}]}], ",", " ", 
     RowBox[{"KI", " ", "=", " ", 
      RowBox[{"drug", " ", "sensitivity", " ", 
       RowBox[{"(", "IC50", ")"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DrugInhibitionModel", "=", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"drug", "/", "KI"}], ")"}], "NH"]}]]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"same", " ", "model", " ", "as", " ", "above"}], ",", " ", 
     RowBox[{
      RowBox[{
      "but", " ", "expressing", " ", "drug", " ", "concentration", " ", "and",
        " ", "KI", " ", "as", " ", "their", " ", 
       RowBox[{"logarithms", ".", " ", "This"}], " ", "makes", " ", "for", 
       " ", "easier", " ", "plotting", " ", "on", " ", "a", " ", "log"}], "-", 
      RowBox[{"scale", " ", "of", " ", "drug", " ", "concentration"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogDrugInhibitionModel", "=", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["10", "LogDrug"], "/", 
          SuperscriptBox["10", "LogKI"]}], ")"}], "NH"]}]]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.66272799196655*^9, 3.6627279981789055`*^9}, {
   3.662728043156478*^9, 3.6627280454116073`*^9}, {3.6808828763317394`*^9, 
   3.6808828808087635`*^9}, {3.680882913723975*^9, 3.680882928015061*^9}, {
   3.6809117513029757`*^9, 3.6809118177987785`*^9}, {3.6809120519831734`*^9, 
   3.680912070871254*^9}, {3.6809121254403753`*^9, 3.6809121460065513`*^9}, {
   3.6809122798862085`*^9, 3.680912335542392*^9}, {3.6809123673662124`*^9, 
   3.6809124877981005`*^9}, {3.6809125265753183`*^9, 3.6809125294704843`*^9}, 
   3.6833717368812447`*^9, 3.68337176940429*^9, {3.683371799725333*^9, 
   3.683371808376345*^9}, {3.683372182627*^9, 3.683372182905011*^9}, {
   3.6833737759728584`*^9, 3.683373792412799*^9}, {3.68337382810084*^9, 
   3.6833738684991508`*^9}, {3.6833739150348125`*^9, 3.6833739290836163`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "custom", " ", "axis", " ", "ticks", " ", "for", " ", "log", " ", 
    "scale"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"logframeticks", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           SuperscriptBox["\"\<10\>\"", 
            RowBox[{"ToString", "[", "x", "]"}]], ",", 
           RowBox[{"{", 
            RowBox[{"0.03", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{"10", ",", "x"}], "]"}], ",", "\"\<\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"1", "*", 
                SuperscriptBox["10", "y"]}], ",", 
               RowBox[{"9", "*", 
                SuperscriptBox["10", "y"]}], ",", 
               RowBox[{"1", "*", 
                SuperscriptBox["10", "y"]}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "10"}], ",", "10", ",", "1"}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"LogDrugInhibitionModel", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LogKI", "\[Rule]", "0"}], ",", 
         RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"LogDrug", ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Drug concentration (as multiples of \!\(\*SubscriptBox[\(K\), \(I\
\)]\))\>\"", ",", "\"\<Relative growth rate\>\""}], "}"}]}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", "\"\<Growth rate response to drug dose\>\""}], 
     ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"logframeticks", ",", "Automatic"}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.680912166166704*^9, 3.680912215098503*^9}, {
  3.6809122503205175`*^9, 3.6809122727117987`*^9}, {3.6833721932415733`*^9, 
  3.683372223077237*^9}, {3.683373894990666*^9, 3.683373906193307*^9}, {
  3.685590959220348*^9, 3.6855909785564537`*^9}}],

Cell[CellGroupData[{

Cell["Modeling variation in drug sensitivity", "Subsubsection",
 CellChangeTimes->{{3.683372980791461*^9, 3.6833729861537676`*^9}}],

Cell[TextData[{
 StyleBox["Patient-to-patient variability in drug sensitivity is introduced \
in this model through variation in ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[".",
  FontSize->16],
 StyleBox[" Note that although ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" takes the form of a binding affinity,  this is not to suggest \
that variation in target binding affinity is the cause of patient-to-patient \
variability; rather, ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" serves as a convenient device to introduce the phenomenon of \
patient variability in drug response. We take this variability to be an \
initial assumption (based on observable facts) and explore its therapeutic \
consequences.\n\nBased on analysis of human clinical trials (see \
Supplementary Figure S1), we take ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" to be log-normally distributed with standard deviation of \
approximately 0.5 on log-scale (that is, a half-decade).\n\nRecalling that \
particular units are not relevant, for simplicity we take ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" to be distributed around a median of 1 (or ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", "0"], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[")",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.683372374526821*^9, 3.683372747469118*^9}, {3.683373005570878*^9, 
   3.683373052314551*^9}, {3.6833731206014566`*^9, 3.6833732696209035`*^9}, {
   3.683373472003474*^9, 3.6833735330789657`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"StandardDeviationInDrugSensitivity", "=", "0.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MedianLogDrugSensitivity", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomVariate", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
       "MedianLogDrugSensitivity", ",", 
        "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
     RowBox[{"{", "100000", "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "2", ",", "0.1"}], "}"}], ",", 
   RowBox[{"ChartStyle", "\[Rule]", 
    RowBox[{"EdgeForm", "[", "None", "]"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"None", ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"logframeticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\)\>\"", ",", 
      "\"\<Probability\>\""}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"3", "/", "4"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "250", "}"}], ",", 
      RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"50", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6670578544850974`*^9, 3.667057858982355*^9}, {
   3.6670584559905014`*^9, 3.667058456448528*^9}, {3.6670586112533817`*^9, 
   3.667058611330386*^9}, {3.6670587151453247`*^9, 3.6670587152033277`*^9}, 
   3.6833731155091653`*^9, {3.6833760468107433`*^9, 3.683376077759513*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Drug concentration in a simulation can be chosen to \
be so high that all patients respond strongly, or so low that no patients \
respond. Here we choose a dose for which approximately half of tumors shrink, \
and half of tumors continue to grow, representing a clinically typical \
scenario wherein a fraction of patients\[CloseCurlyQuote] tumors respond to \
treatment.",
 FontSize->16,
 FontWeight->"Plain",
 FontColor->RGBColor[
  0.7607843137254902, 0.29411764705882354`, 
   0.08235294117647059]]], "Subsection",
 CellChangeTimes->{{3.6833747586020613`*^9, 3.683374784337534*^9}, {
  3.6833748995371227`*^9, 3.6833749610946436`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DrugDose", "=", "0.2"}], ";"}]], "Input",
 CellChangeTimes->{{3.6833738027773914`*^9, 3.683373805628555*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Illustrating the effect of different KI values on \
drug response. Low KI indicates high drug sensitivity (strong growth \
inhibition), and high KI indicates low drug sensitivity (little to no \
inhibitory effect).",
 FontSize->16,
 FontWeight->"Plain",
 FontColor->RGBColor[
  0.7607843137254902, 0.29411764705882354`, 
   0.08235294117647059]]], "Subsection",
 CellChangeTimes->{{3.6833747586020613`*^9, 3.683374784337534*^9}, {
  3.6833748995371227`*^9, 3.6833749610946436`*^9}, {3.6833750852717457`*^9, 
  3.6833752726604643`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"LogDrugInhibitionModel", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LogDrug", "\[Rule]", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "DrugDose"}], "]"}]}], ",", 
      RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"LogKI", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Axes", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}]}], ",", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "i", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
        "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"logframeticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1.02"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\)\>\"", ",", 
      "\"\<Relative growth rate\>\""}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"3", "/", "4"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "250", "}"}], ",", 
      RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"50", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Red", ",", 
      RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6833750442383995`*^9, 3.6833750637905173`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["In the context of high rates of innate cell loss, a partial \
inhibition of tumor cell growth is sufficient for production to be balanced \
by loss, resulting in net tumor growth arrest. Here we plot the overall \
therapeutic response using the \[OpenCurlyQuote]GR\[CloseCurlyQuote] (Growth \
Rate) metric, which converts relative growth rate to a normalized scale.\n\
\[OpenCurlyQuote]RelativeGrowthRate\[CloseCurlyQuote] is the normalized \
change in cell number per cell division time; thus RelativeGrowthRate = 1 \
represents uninhibited growth, 0 represents growth arrest, and -1 describes a \
halving of the population per cell division time.\n\nGR is then a metric that \
ranges from full, unhibited growth to complete tumor cell killing, on a scale \
that is normalized from 1 to -1, (1 = full growth, 0 = growth arrest, -1 =  \
death of all cells). This scale is produced by the equation\nGR = ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["2", "RelativeGrowthRate"], TraditionalForm]]],
 " - 1\n",
 StyleBox["\nReference:\nHafner ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["et al",
  FontSize->16,
  FontWeight->"Plain",
  FontSlant->"Italic",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[". Growth rate inhibition metrics correct for confounders in \
measuring sensitivity to cancer drugs. Nature Methods. 2016, ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["v13",
  FontSize->16,
  FontWeight->"Bold",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[":521-527",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Subsection",
 CellChangeTimes->{{3.6833747586020613`*^9, 3.683374784337534*^9}, {
  3.6833748995371227`*^9, 3.6833749610946436`*^9}, {3.6833750852717457`*^9, 
  3.6833759064097123`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"logframeticksDownward", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["\"\<10\>\"", 
           RowBox[{"ToString", "[", "x", "]"}]], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", "x"}], "]"}], ",", "\"\<\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "y"]}], ",", 
              RowBox[{"9", "*", 
               SuperscriptBox["10", "y"]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "y"]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "10"}], ",", "10", ",", "1"}], "}"}]}], "]"}], ",", 
        "1"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogNormallyDistributedKIvalues", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
        "MedianLogDrugSensitivity", ",", 
         "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
      RowBox[{"{", "100000", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CustomHistogramPlot", "[", 
    RowBox[{"data_", ",", "bins_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"countBorder", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"#1", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Riffle", "[", 
              RowBox[{"#2", ",", "#2"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
         "&"}], "@@", 
        RowBox[{"HistogramList", "[", 
         RowBox[{"data", ",", "bins", ",", "\"\<Count\>\""}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"countBorder", ",", 
       RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
       RowBox[{"FillingStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.75", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "1", "]"}], ",", "Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "True"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"False", ",", "False"}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"i", "*", "2000"}], "+", "2000"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", "i", "]"}], ",", "Red"}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0.05"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "\"\<0\>\"", "\[Rule]", "\"\<growth\\narrest (0)\>\""}], ",", 
                RowBox[{"\"\<1\>\"", "\[Rule]", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<uninhibited\\ngrowth (1)\>\"", ",", 
                   RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}]}], "]"}]}], ",", 
                RowBox[{
                "\"\<-1\>\"", "\[Rule]", 
                 "\"\<complete\\nkilling (-1)\>\""}]}], "}"}]}], ")"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"logframeticksDownward", ",", "None"}], "}"}]}], "}"}]}], 
       ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.0", "]"}], ",", 
              RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Red", ",", 
              RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Probability\>\"", ",", 
              RowBox[{"GrayLevel", "[", "0.", "]"}]}], "]"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Drug effect (GR value)\>\"", ",", "Red"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Drug sensitivity (\!\(\*SubscriptBox[\(K\), \(I\)]\))\>\"", 
            ","}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"5", "/", "6"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "110"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", ",", "0.02"}], "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"10", ",", "50"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "4200"}], "}"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityDistributionAndDrugResponsePlot", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CustomHistogramPlot", "[", 
      RowBox[{"LogNormallyDistributedKIvalues", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.7"}], ",", "1.7", ",", "0.05"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "DrugDose"}], "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}], ")"}], "-", 
                "CellLossRate"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", "CellLossRate"}], ")"}]}], ")"}]}], "-", 
           "1"}], ")"}], "*", "2000"}], "+", "2000"}], ",", 
       RowBox[{"{", 
        RowBox[{"LogKI", ",", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "0.02"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "50"}], "]"}]}], "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], ",", 
       RowBox[{"AxesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "i", "]"}], ",", "Black"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"logframeticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Drug sensitivity (\!\(\*SubscriptBox[\(K\), \(I\)]\))\>\"", 
            ","}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Probability\>\"", ",", "\"\<GR\>\""}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"3", "/", "4"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "250", "}"}], ",", 
          RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Red", ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6B - KI distribution and therapeutic response.pdf\>\""}], 
    ",", "SensitivityDistributionAndDrugResponsePlot", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.68242002507838*^9, 3.6824201241120443`*^9}, {
   3.682420182536386*^9, 3.6824202045326443`*^9}, {3.6824202788428946`*^9, 
   3.6824203013211803`*^9}, {3.682420343696604*^9, 3.682420354540224*^9}, {
   3.682420398849758*^9, 3.682420413531598*^9}, {3.683376009722622*^9, 
   3.683376037071186*^9}, {3.683376091915323*^9, 3.6833761187818594`*^9}, {
   3.6833897962651668`*^9, 3.683389815543269*^9}, {3.684078803406971*^9, 
   3.6840790965507383`*^9}, {3.684079663882188*^9, 3.6840797615957766`*^9}, {
   3.684079862411543*^9, 3.6840798919862347`*^9}, {3.684079949795541*^9, 
   3.6840799799472656`*^9}, {3.684197378888795*^9, 3.6841973913275065`*^9}, {
   3.684197991281822*^9, 3.6841980061306715`*^9}, {3.6841980478690586`*^9, 
   3.6841980828780613`*^9}, {3.6854616105483513`*^9, 3.685461633681675*^9}, {
   3.6856028515725517`*^9, 3.685602851786564*^9}, 3.7160751744490414`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Generating", " ", "joint", " ", "KI", " ", "distributions", " ", "for", 
     " ", "drug", " ", "1", " ", "and", " ", "drug", " ", "2"}], ",", " ", 
    RowBox[{"with", " ", "variable", " ", "level", " ", "of", " ", 
     RowBox[{"correlation", ".", " ", "We"}], " ", "subsequently", " ", 
     "explore", " ", "the", " ", "importance", " ", "of", " ", "correlation", 
     " ", "in", " ", "drug", " ", 
     RowBox[{"sensitivity", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KIdistributionForDrug1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
         "MedianLogDrugSensitivity", ",", 
          "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
       RowBox[{"{", "5000", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KIdistributionForDrug2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomVariate", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
         "MedianLogDrugSensitivity", ",", 
          "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
       RowBox[{"{", "5000", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "generating", " ", "a", " ", "correlated", " ", "list", " ", "with", " ", 
     "correlation", " ", "specified", " ", "by", " ", "input", " ", 
     "variable", " ", "\[Rho]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CorrelatedKIs", "[", "\[Rho]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"KIdistributionForDrug1", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]", "*", "KIdistributionForDrug1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}], 
           "KIdistributionForDrug2"}]}], ")"}]}], "}"}], "\[Transpose]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Illustrating", " ", "uncorrelated", " ", "drug", " ", "sensitivity"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UncorrelatedSensitivityPlot", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"CorrelatedKIs", "[", "0.", "]"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\), compound 1\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\), compound 2\>\""}], "}"}]}],
        ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"3", "/", "4"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "500", "}"}], ",", 
          RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"logframeticks", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"logframeticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
          RowBox[{"AbsolutePointSize", "[", "1.5", "]"}]}], "]"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Uncorrelated\\ndrug sensitivity\>\""}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Illustrating", " ", "partially", " ", "correlated", " ", "drug", " ", 
     "sensitivity"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PartiallyCorrelatedSensitivityPlot", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"CorrelatedKIs", "[", "0.6", "]"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\), compound 1\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\), compound 2\>\""}], "}"}]}],
        ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"3", "/", "4"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "500", "}"}], ",", 
          RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"logframeticks", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"logframeticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
          RowBox[{"AbsolutePointSize", "[", "1.5", "]"}]}], "]"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\<Partially correlated\\ndrug sensitivity\>\""}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Illustrating", " ", "perfectly", " ", "correlated", " ", "drug", " ", 
     "sensitivity"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerfectlyCorrelatedSensitivityPlot", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"CorrelatedKIs", "[", "1.0", "]"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\), compound 1\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(K\), \(I\)]\), compound 2\>\""}], "}"}]}],
        ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"3", "/", "4"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "500", "}"}], ",", 
          RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"logframeticks", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"logframeticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
          RowBox[{"AbsolutePointSize", "[", "1.5", "]"}]}], "]"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\<Perfectly correlated\\ndrug sensitivity\>\""}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", 
     RowBox[{
     "UncorrelatedSensitivityPlot", ",", "PartiallyCorrelatedSensitivityPlot",
       ",", "PerfectlyCorrelatedSensitivityPlot"}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQzbLVc9oG99eOTzrE54JopW+CR0D005cy10B0iXbt
LRCd4sl8F0R/9rryGURf7JrJvhFIpz3eWNfk+drx9vrcJhAt4HSxV9LrtePU
s46TQLS/otfHHCDtvCPgM4iue+p2KRdI+5mIXQbRC/bvMYwOeu3YIvIHTL+6
8ckWRN9JT7ID0Xu7W0NAtGzXIjCt++zlPBD98JnkfBD9zuwlV1/oa8eqxFBu
EO1lt/YeiG5lXPcIRBt9bHkGoovyHr0E0QsSC9mrCl87pjZB6DNnnapA9N3u
zWB6Dv/LHhDd1SS9DERn9LHtANHFbWJgmq9yxyEQvemQ8FkQfW0N77XSUqB/
TjmDaQByCq22
  "]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modeling tumor growth and drug inhibition", "Section",
 CellChangeTimes->{{3.68337159832105*^9, 3.68337162647209*^9}, {
  3.683371658666135*^9, 3.6833716689681497`*^9}, {3.683372334992571*^9, 
  3.683372362830163*^9}, {3.6833727674172564`*^9, 3.683372767579266*^9}}],

Cell[TextData[{
 StyleBox["This model describes the growth and drug responses of four \
populations of tumor cells:\n(S) the majority of tumor cells with \
\[OpenCurlyQuote]baseline\[CloseCurlyQuote] drug sensitivity.\n(R1) a \
sub-population with greater resistance to the first of two drugs\n(R2) a \
sub-population with greater resistance to the second of two drugs\n(RR) a \
sub-population with greater resistance to both drugs\n\nWe first take \
resistance and cross-resistance frequencies from lineage-tracing experiments \
in a lung adenocarcinoma cell line, which measured pre-existing erlotinib \
resistance at a frequency of 500 cells per million, and pre-existing \
double-drug resistance (erlotinib and crizotinib) at 5 cells per million.\n\n\
We are interested in describing the duration of progression free survival, in \
other words, time taken for tumor volume (cell count) to double.\nBecause the \
model is \[OpenCurlyQuote]continuous\[CloseCurlyQuote] rather than discrete \
and stochastic, the initial tumor cell count has no effect in this model on \
the time taken to double. We take initial tumor cell count to be ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", "10"], TraditionalForm]]],
 StyleBox["; in clinical reality different tumors will be different sizes at \
the start of of treatment, but in this model changing this parameter is \
inconsequential.\n\nWe use a numerical differential equation solver \
(NDSolve), applied to the following equation:\n\n",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox[
     FractionBox["dp", "dt"],
     FontSize->18], 
    RowBox[{"(", "t", ")"}]}], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["= g.p(t).",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   StyleBox[
    FractionBox["1", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"[", "drug", "]"}], "/", 
       SubscriptBox["K", 
        StyleBox["I",
         FontSlant->"Plain"]]}]}]],
    FontSize->18], TraditionalForm]],
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" - ",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" g.\[Phi].p(t),\n\ng = growth rate\np(t) = tumor population at \
time \[OpenCurlyQuote]t\[CloseCurlyQuote]\n[drug] = drug concentration\n\
\[Phi] = cell loss factor\nKI is the smaller (most sensitive) of ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["1 and ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["2, being the inhibitory constants of drug 1 and drug 2. This is \
the assumption of \[OpenCurlyQuote]independent drug action\[CloseCurlyQuote] \
- each tumor cell\[CloseCurlyQuote]s response is determined only by the one \
drug that is most effective against that cell.\n\nDrug resistant \
sub-populations have their ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[" values for the appropriate drug(s) increased by a factor of 10 \
(parameter \[OpenCurlyQuote]rl\[CloseCurlyQuote] = resistance level)\n\n\
Supplementary Figure S7A shows that different values of ",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", 
    StyleBox["I",
     FontSlant->"Plain"]], TraditionalForm]]],
 StyleBox[", the magnitude of resistance (parameter \[OpenCurlyQuote]rl\
\[CloseCurlyQuote]), and frequencies of resistance alter the shape of \
progression-free-survival curves but do not alter the key results that \
independent drug action provides a significant benefit in a drug combination.",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.6833727718175087`*^9, 3.6833729354508677`*^9}, {3.6833761403000903`*^9, 
   3.6833764146477823`*^9}, {3.683377379249954*^9, 3.6833774898352795`*^9}, {
   3.683377877317442*^9, 3.683377894186407*^9}, {3.683377965663495*^9, 
   3.683378043626954*^9}, {3.6833780747307334`*^9, 3.683378134389146*^9}, {
   3.683378168406091*^9, 3.6833782242992883`*^9}, {3.6833782544580135`*^9, 
   3.683378484433167*^9}, {3.683380994658744*^9, 3.6833810526790624`*^9}, {
   3.7160750509079757`*^9, 3.716075056254281*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "as", " ", "its", " ", 
     "inputs", " ", "\[IndentingNewLine]", "KI", " ", "for", " ", "drug", " ",
      "1", " ", 
     RowBox[{"(", "KI1", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"KI", " ", "for", " ", "drug", " ", "2", " ", 
     RowBox[{"(", "KI2", ")"}]}], ",", "\[IndentingNewLine]", 
    "ProgressionThreshold", ",", " ", 
    RowBox[{
    "being", " ", "how", " ", "large", " ", "an", " ", "increase", " ", "in", 
     " ", "tumor", " ", "volume", " ", "is", " ", "our", " ", "output", " ", 
     RowBox[{"(", "2", ")"}]}], ",", " ", "and", ",", "\[IndentingNewLine]", 
    "growthratenumber", ",", " ", 
    RowBox[{
    "which", " ", "indicates", " ", "which", " ", "value", " ", "from", " ", 
     "the", " ", "list", " ", "of", " ", "randomly", " ", "generated", " ", 
     "growth", " ", "rates", " ", "is", " ", "being", " ", "taken", " ", "in",
      " ", "this", " ", "particular", " ", "instance", " ", "of", " ", "the", 
     " ", 
     RowBox[{"simulation", ".", " ", "This"}], " ", "takes", " ", "integer", 
     " ", "values", " ", "indicating", " ", "a", " ", "position", " ", "in", 
     " ", "the", " ", "previously", " ", "generated", " ", 
     RowBox[{"list", " ", "'"}], 
     RowBox[{
      RowBox[{"DistributionOfGrowthRates", "'"}], "."}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProgressionTime", "[", 
    RowBox[{
    "KI1_", ",", "KI2_", ",", "growthrate_", ",", "ProgressionThreshold_", 
     ",", "Correlation_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KI1internal", "=", "KI1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"KI2internal", "=", "KI2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"cell", " ", "division", " ", "rate"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gr", "=", "growthrate"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"spontaneous", " ", "cell", " ", "death", " ", "rate"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"celllossrate", "=", "CellLossRate"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"previously", " ", "defined", " ", "as", " ", "80", "%"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "rate"}], " ", "=", " ", 
        RowBox[{
        "growth", " ", "rate", " ", "\[Times]", " ", "cell", " ", "loss", " ",
          "factor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dr", "=", 
       RowBox[{"gr", "*", "celllossrate"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"rl", " ", "=", " ", 
         RowBox[{"'", "resistance", " ", 
          RowBox[{"level", "'"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"being", " ", "the", " ", "fold"}], "-", 
         RowBox[{
         "change", " ", "in", " ", "KI", " ", "in", " ", "drug", " ", 
          "resistant", " ", "sub"}], "-", "populations"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rl", "=", "10"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"pre", "-", 
        RowBox[{"existing", " ", "resistance", " ", "frequencies"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "drug", " ", "1"}], " ", "*)"}], 
      " ", 
      RowBox[{"rf1", "=", 
       RowBox[{"500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "Correlation"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "drug", " ", "2"}], " ", "*)"}], 
      " ", 
      RowBox[{"rf2", "=", 
       RowBox[{"500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "Correlation"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "both", " ", "drugs"}], " ", 
       "*)"}], " ", 
      RowBox[{"rfCross", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "6"}]]}], ",", 
          RowBox[{"500", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "6"}]], "*", "Correlation"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"initial", " ", "population", " ", "size"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"p0", "=", 
       SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"drug", " ", "dose"}], ",", " ", 
        RowBox[{"previously", " ", "defined"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", "DrugDose"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"duration", " ", "of", " ", "numerical", " ", "simulation"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SimulationDuration", "=", "6"}], ";", " ", 
      RowBox[{"(*", "years", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"simulating", " ", "an", " ", "untreated", " ", "tumor"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresultUntreated", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
          "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "simulating", " ", "growth", " ", "of", " ", "tumor", " ", "cells", 
        " ", "with", " ", "baseline", " ", "drug", " ", "sensitivity"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresultS", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
          "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
        "with", " ", "resistance", " ", "to", " ", "drug", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresultR1", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rf1"}]}]}], "}"}], ",", "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
        "with", " ", "resistance", " ", "to", " ", "drug", " ", "2"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresultR2", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rf2"}]}]}], "}"}], ",", "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
        "with", " ", "resistance", " ", "to", " ", "both", " ", "drugs"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresultRR", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rfCross"}]}]}], "}"}], ",", "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Summing", " ", "up", " ", "the", " ", "total", " ", "population", 
          " ", "size", " ", "at", " ", "each", " ", "time"}], ";", " ", 
         RowBox[{"sum", " ", "of", " ", "populations", " ", "S"}]}], ",", " ",
         "R1", ",", " ", "R2", ",", " ", 
        RowBox[{
         RowBox[{"RR", ".", " ", "Table"}], " ", "has", " ", "an", " ", 
         "entry", " ", "at", " ", "every", " ", "2", " ", 
         RowBox[{"days", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PopulationOverTimeTable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
            "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
            "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
            "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], 
             ")"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SimulationDuration", "-", "0.1"}], ")"}], "*", "365"}], 
           ",", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "progression", " ", "threshold", " ", "is", " ", "not", 
         " ", "reached", " ", "within", " ", "the", " ", "duration", " ", 
         "of", " ", "the", " ", "simulation"}], ",", " ", 
        RowBox[{
        "return", " ", "a", " ", "number", " ", "larger", " ", "than", " ", 
         "the", " ", "duration", " ", "of", " ", "simulation", " ", 
         RowBox[{"(", 
          RowBox[{
          "this", " ", "can", " ", "be", " ", "used", " ", "to", " ", 
           "identify", " ", "such", " ", "events"}], ")"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PopulationOverTimeTable", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "<", 
         "ProgressionThreshold"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "+", "1"}], ")"}], "*", "365"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"final", " ", 
         RowBox[{"output", ":", " ", 
          RowBox[{
          "the", " ", "earliest", " ", "time", " ", "at", " ", "which", " ", 
           "the", " ", "total", " ", "population", " ", "size", " ", 
           "surpasses", " ", 
           RowBox[{"the", " ", "'"}], "progression", " ", 
           RowBox[{"threshold", "'"}]}]}]}], ",", " ", 
        RowBox[{
        "taken", " ", "in", " ", "this", " ", "file", " ", "to", " ", "be", 
         " ", "twice", " ", "the", " ", "initial", " ", "population"}], ",", 
        " ", 
        RowBox[{
        "though", " ", "it", " ", "could", " ", "be", " ", "varied"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PopulationOverTimeTable", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
           "ProgressionThreshold"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6613624139911203`*^9, 3.6613624142151327`*^9}, {
   3.661362651344696*^9, 3.6613626515187054`*^9}, {3.661362741354844*^9, 
   3.6613627415148535`*^9}, {3.661362798060087*^9, 3.6613627981300917`*^9}, {
   3.6614336684773397`*^9, 3.6614336707844715`*^9}, {3.6614339076940217`*^9, 
   3.6614339079890385`*^9}, {3.661433953224626*^9, 3.6614339894016953`*^9}, {
   3.6614346259381027`*^9, 3.6614346261851172`*^9}, {3.661434758042659*^9, 
   3.661434763921995*^9}, {3.661436281480795*^9, 3.6614362820188255`*^9}, {
   3.661436812322157*^9, 3.6614368360745153`*^9}, {3.661438022898398*^9, 
   3.661438023144412*^9}, {3.661438116870773*^9, 3.6614381171697903`*^9}, {
   3.661438410730581*^9, 3.661438437767127*^9}, {3.6614385780331497`*^9, 
   3.6614385975632668`*^9}, {3.6627284035780935`*^9, 
   3.6627284036740985`*^9}, {3.6627284437993937`*^9, 
   3.6627284443304243`*^9}, {3.662728477685332*^9, 3.662728477862342*^9}, {
   3.662728536438692*^9, 3.6627285364926953`*^9}, {3.662728630230057*^9, 
   3.662728630326062*^9}, {3.6627388991014028`*^9, 3.662738899455423*^9}, {
   3.6627445672096*^9, 3.6627445672496023`*^9}, {3.662744606008819*^9, 
   3.662744606041821*^9}, {3.6628115295967283`*^9, 3.6628115296477313`*^9}, {
   3.6628115986546783`*^9, 3.66281159886769*^9}, {3.6628120938450017`*^9, 
   3.662812093890004*^9}, 3.662812423763872*^9, {3.662812636789056*^9, 
   3.6628126396842213`*^9}, {3.6628127097392282`*^9, 3.66281270993424*^9}, {
   3.6628138076690264`*^9, 3.66281380790104*^9}, {3.6628139290019665`*^9, 
   3.662813929278982*^9}, {3.662814041223385*^9, 3.6628140444985723`*^9}, {
   3.6628143892422905`*^9, 3.662814389312295*^9}, {3.6670569383126955`*^9, 
   3.667056938379699*^9}, {3.6670570678151026`*^9, 3.6670570690631742`*^9}, {
   3.667057165447687*^9, 3.667057194073324*^9}, {3.667057895996472*^9, 
   3.667057896067476*^9}, {3.667058088182464*^9, 3.66705808828547*^9}, 
   3.6670581305398865`*^9, {3.6670582892309637`*^9, 3.6670582896839895`*^9}, {
   3.6670583953220315`*^9, 3.6670584158712068`*^9}, {3.6670586395289993`*^9, 
   3.667058639644006*^9}, 3.6670587792949934`*^9, {3.674745891876693*^9, 
   3.674745897956702*^9}, {3.6809125538758802`*^9, 3.6809126138623114`*^9}, {
   3.680912655366685*^9, 3.6809127360452995`*^9}, 3.6833714732368746`*^9, {
   3.6833717694142904`*^9, 3.6833717694342904`*^9}, {3.6833764194670577`*^9, 
   3.6833764762203035`*^9}, {3.683377512263562*^9, 3.6833778209772196`*^9}, {
   3.6833778544511337`*^9, 3.683377871133088*^9}, {3.6833779105413427`*^9, 
   3.6833779521197205`*^9}, {3.6833785017161555`*^9, 
   3.6833786725369263`*^9}, {3.6833787372026243`*^9, 3.683378761305003*^9}, {
   3.6833803518099747`*^9, 3.683380368669939*^9}, {3.68338041064734*^9, 
   3.683380416742689*^9}, {3.683380748981692*^9, 3.683380749336712*^9}, {
   3.683380913894124*^9, 3.6833809157042274`*^9}, {3.683380952791349*^9, 
   3.683380977063737*^9}, {3.6833811159726825`*^9, 3.683381500865697*^9}, 
   3.6833822574079685`*^9, {3.6833823130831532`*^9, 3.6833823485931845`*^9}, {
   3.6833847362677517`*^9, 3.6833847530477114`*^9}, {3.7037167133250113`*^9, 
   3.7037167154521327`*^9}, {3.7037168143287888`*^9, 3.7037168191660647`*^9}}],

Cell[TextData[StyleBox["\[LineSeparator]\[OpenCurlyQuote]SimulatePopulation\
\[CloseCurlyQuote] executes the above simulation (ProgressionTime) for each \
individual in a population of 200.\nIt takes a single input parameter, being \
the correlation between KI for drug 1 and KI for drug 2",
 FontSize->16,
 FontWeight->"Plain",
 FontColor->RGBColor[
  0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.6833727718175087`*^9, 3.6833729354508677`*^9}, {3.6833761403000903`*^9, 
   3.6833764146477823`*^9}, {3.683377379249954*^9, 3.6833774898352795`*^9}, {
   3.683377877317442*^9, 3.683377894186407*^9}, {3.683377965663495*^9, 
   3.683378043626954*^9}, {3.6833780747307334`*^9, 3.683378134389146*^9}, {
   3.683378168406091*^9, 3.6833782242992883`*^9}, {3.6833782544580135`*^9, 
   3.683378484433167*^9}, {3.6833795989259124`*^9, 3.683379628567608*^9}, {
   3.6833806214523973`*^9, 3.683380638522374*^9}, {3.6833815103122377`*^9, 
   3.683381514820495*^9}, {3.683384804343645*^9, 3.6833848049566803`*^9}, {
   3.7037166520855083`*^9, 3.7037166529805593`*^9}, 3.7160753040754557`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulatePopulation", "[", "Correlation_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"KIJointDistribution", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KI1table", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Correlation", "*", "KI1table"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["Correlation", "2"]}], ")"}], "KI2table"}]}], 
          ")"}]}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI1", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI2", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"NumberOfTumorsSimulated", "=", "200"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgressionThreshold", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "no", " ", 
        RowBox[{"treatment", ".", " ", "No"}], " ", "treatment", " ", "is", 
        " ", "implemented", " ", "by", " ", "setting", " ", "KI1", " ", "and",
         " ", "KI2", " ", "to", " ", "equal", " ", "1000"}], ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "neither", " ", "drug", " ", 
        "has", " ", "any", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"UntreatedProgressionTimes", "[", "Correlation", "]"}], "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTime", "[", 
          RowBox[{"1000", ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold", ",", 
           "Correlation"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "treatment", " ", "by", " ", "monotherapy", 
        " ", 
        RowBox[{"#1", ".", " ", "The"}], " ", "absence", " ", "of", " ", 
        "monotherapy", " ", "#2", " ", "is", " ", "implemented", " ", "by", 
        " ", "setting", " ", "KI2", " ", "to", " ", "equal", " ", "1000"}], 
       ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "drug", " ", "2", " ", "has",
         " ", "no", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monotherapy1ProgressionTimes", "[", "Correlation", "]"}], "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTime", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold", ",", 
           "Correlation"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "treatment", " ", "by", " ", "monotherapy", 
        " ", 
        RowBox[{"#2", ".", " ", "The"}], " ", "absence", " ", "of", " ", 
        "monotherapy", " ", "#1", " ", "is", " ", "implemented", " ", "by", 
        " ", "setting", " ", "KI1", " ", "to", " ", "equal", " ", "1000"}], 
       ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "drug", " ", "2", " ", "has",
         " ", "no", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monotherapy2ProgressionTimes", "[", "Correlation", "]"}], "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTime", "[", 
          RowBox[{"1000", ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold", ",", 
           "Correlation"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
       "time", " ", "for", " ", "treatment", " ", "by", " ", "a", " ", 
       "combination", " ", "of", " ", "monotherapy", " ", "#1", " ", "and", 
       " ", "#2"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CombinationProgressionTimes", "[", "Correlation", "]"}], "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTime", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold", ",", 
           "Correlation"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plotting", " ", "survival", " ", "functions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"SurvivalPlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{
                 "UntreatedProgressionTimes", "[", "Correlation", "]"}], 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{
                 "Monotherapy2ProgressionTimes", "[", "Correlation", "]"}], 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{
                 "Monotherapy1ProgressionTimes", "[", "Correlation", "]"}], 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{
                 "CombinationProgressionTimes", "[", "Correlation", "]"}], 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "*", 
                RowBox[{"2", "/", "61"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "2000", ",", 
               RowBox[{
                RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"36", "*", "30.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"3", "/", "4"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Progression free survival (months)\>\"", ",", 
           "\"\<Patients (%)\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "250", "}"}], ",", 
           RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}],
         ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Untreated\>\"", ",", "\"\<Monotherapy B\>\"", ",", 
           "\"\<Monotherapy A\>\"", ",", 
           "\"\<Combination,\\nindependent drug action\>\""}], "}"}]}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.661360802030921*^9, 3.66136103279212*^9}, {
   3.661361351225333*^9, 3.661361365826168*^9}, {3.6613614571693926`*^9, 
   3.661361463497755*^9}, {3.661361520962042*^9, 3.661361609435102*^9}, {
   3.6613621448187237`*^9, 3.6613621450417366`*^9}, {3.661362678256235*^9, 
   3.6613626831595154`*^9}, {3.661433740448456*^9, 3.6614337660409193`*^9}, {
   3.661433883657647*^9, 3.661433894709279*^9}, {3.661433927721167*^9, 
   3.6614339306653357`*^9}, {3.6614374038249893`*^9, 3.661437406496142*^9}, {
   3.661437602874374*^9, 3.661437605448521*^9}, {3.661437639986497*^9, 
   3.661437702442069*^9}, {3.6614384044652224`*^9, 3.6614384168589315`*^9}, {
   3.661438625552868*^9, 3.6614386279930077`*^9}, 3.661438691977667*^9, {
   3.6624189972916536`*^9, 3.6624190236521616`*^9}, {3.662430189432808*^9, 
   3.662430189527813*^9}, {3.662430332119969*^9, 3.6624303356311693`*^9}, {
   3.662813869868584*^9, 3.662813871788694*^9}, {3.6628143046894546`*^9, 
   3.662814306795575*^9}, {3.6629079586422625`*^9, 3.662907959788328*^9}, {
   3.6670570467528977`*^9, 3.6670570485099983`*^9}, {3.667057145677556*^9, 
   3.6670571474016542`*^9}, {3.6670573374205227`*^9, 
   3.6670573386675944`*^9}, {3.6670579193258057`*^9, 3.667057920598879*^9}, {
   3.683373115559168*^9, 3.6833731155631685`*^9}, {3.683378699625475*^9, 
   3.6833787170064697`*^9}, 3.683379564839963*^9, {3.6833806412235284`*^9, 
   3.683380674099409*^9}, {3.683381500898699*^9, 3.683381501005705*^9}, {
   3.68338168396017*^9, 3.683381686643323*^9}, {3.683381721651325*^9, 
   3.6833817371342106`*^9}, {3.6833817842359047`*^9, 
   3.6833818437373085`*^9}, {3.683381903858747*^9, 3.6833821191210594`*^9}, {
   3.6833822470963793`*^9, 3.683382270734731*^9}, {3.68338239135463*^9, 
   3.6833824438236313`*^9}, {3.68338247387335*^9, 3.6833824863120613`*^9}, {
   3.6833847679495635`*^9, 3.68338479202194*^9}, {3.683388708584955*^9, 
   3.683388785743368*^9}, {3.703715557884924*^9, 3.703715592563907*^9}, {
   3.703715630846097*^9, 3.7037156743875875`*^9}, 3.7037157916532946`*^9, {
   3.703716206493022*^9, 3.703716207523081*^9}, {3.7037164609415755`*^9, 
   3.7037164811977344`*^9}, {3.703716835972026*^9, 3.703716853396023*^9}}],

Cell[CellGroupData[{

Cell["Executing", "Subsubsection",
 CellChangeTimes->{{3.68338482663492*^9, 3.683384830269128*^9}, {
  3.683388765987238*^9, 3.68338876689729*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "command", " ", "allows", " ", "legends", " ", "to", " ", 
    "be", " ", "included", " ", "in", " ", "exported", " ", "images", " ", 
    "without", " ", "interfering", " ", "with", " ", "the", " ", "proper", 
    " ", "size", " ", "of", " ", "the", " ", 
    RowBox[{"plot", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"$FrontEndSession", ",", 
     RowBox[{"PrintingStyleEnvironment", "\[Rule]", "\"\<Working\>\""}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"SimulatePopulation", "[", "0", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.662429115532384*^9, 3.6624291158194003`*^9}, 
   3.683378699640476*^9, {3.683382121252181*^9, 3.6833821277785544`*^9}, {
   3.683388668273649*^9, 3.6833887055327806`*^9}, 3.703715679805897*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Progression free survival, combination with independent drug \
action.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6833861270663004`*^9, 3.6833861565539875`*^9}, 
   3.7160751756811123`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spider plots, for monotherapy", "Section",
 CellChangeTimes->{{3.6628101118266363`*^9, 3.6628101159888744`*^9}, {
  3.663199370979868*^9, 3.6631993750230994`*^9}, {3.6833824936374807`*^9, 
  3.6833824949335546`*^9}, {3.683382843706503*^9, 3.6833828461066403`*^9}, {
  3.6833854797402754`*^9, 3.683385480743333*^9}}],

Cell[TextData[{
 StyleBox["Because growth rates and drug sensitivities (KI) are randomly \
drawn from distributions, reproducible example trajectories can only be \
generated here by \[OpenCurlyQuote]hard-coding\[CloseCurlyQuote] some sample \
values.\n\nA small set of growth rates was generated by\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Table[Max[{1/100,RandomVariate[NormalDistribution[6.9/100,2.1/100]]\
}],{50}];",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->GrayLevel[0]],
 StyleBox["\n\nA small  set of KI values was generated by\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["10^Table[RandomVariate[NormalDistribution[MedianLogDrugSensitivity,\
StandardDeviationInDrugSensitivity]],{50}]\n\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->GrayLevel[0]],
 StyleBox["These parameters generate 50 different tumor kinetic trajectories. \
A few of these trajectories have been selected here, non-randomly, to \
illustrate the variety of different kinetic trajectories.",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.6833727718175087`*^9, 3.6833729354508677`*^9}, {3.6833761403000903`*^9, 
   3.6833764146477823`*^9}, {3.683377379249954*^9, 3.6833774898352795`*^9}, {
   3.683377877317442*^9, 3.683377894186407*^9}, {3.683377965663495*^9, 
   3.683378043626954*^9}, {3.6833780747307334`*^9, 3.683378134389146*^9}, {
   3.683378168406091*^9, 3.6833782242992883`*^9}, {3.6833782544580135`*^9, 
   3.683378484433167*^9}, {3.6833795989259124`*^9, 3.683379628567608*^9}, {
   3.6833806214523973`*^9, 3.683380638522374*^9}, {3.6833815103122377`*^9, 
   3.683381514820495*^9}, {3.683384804343645*^9, 3.6833848049566803`*^9}, {
   3.683385488416772*^9, 3.6833855707574816`*^9}, {3.684196334948473*^9, 
   3.684196494467812*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ASmallSetOfGrowthRates", "=", 
    RowBox[{"{", 
     RowBox[{
     "0.052`", ",", "0.06`", ",", "0.057`", ",", "0.086`", ",", "0.068`", ",",
       "0.095`", ",", "0.057`", ",", "0.053`", ",", "0.045`", ",", "0.033`", 
      ",", "0.083`", ",", "0.084`", ",", "0.061`", ",", "0.094`", ",", 
      "0.092`", ",", "0.077`", ",", "0.088`", ",", "0.1`", ",", "0.098`", ",",
       "0.055`", ",", "0.059`", ",", "0.098`", ",", "0.048`", ",", "0.043`", 
      ",", "0.028`", ",", "0.108`", ",", "0.1`", ",", "0.029`", ",", "0.062`",
       ",", "0.058`", ",", "0.045`", ",", "0.063`", ",", "0.088`", ",", 
      "0.079`", ",", "0.038`", ",", "0.057`", ",", "0.121`", ",", "0.075`", 
      ",", "0.054`", ",", "0.101`", ",", "0.063`", ",", "0.069`", ",", 
      "0.069`", ",", "0.046`", ",", "0.047`", ",", "0.113`", ",", "0.058`", 
      ",", "0.094`", ",", "0.09`", ",", "0.067`"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ASmallSetOfKIvalues", "=", 
    RowBox[{"{", 
     RowBox[{
     "5.41`", ",", "3.84`", ",", "0.62`", ",", "0.95`", ",", "1.83`", ",", 
      "3.46`", ",", "0.79`", ",", "1.06`", ",", "0.38`", ",", "4.06`", ",", 
      "4.1`", ",", "3.54`", ",", "0.61`", ",", "2.85`", ",", "3.2`", ",", 
      "3.82`", ",", "1.45`", ",", "1.3`", ",", "1.25`", ",", "0.96`", ",", 
      "3.63`", ",", "0.43`", ",", "0.68`", ",", "2.53`", ",", "3.96`", ",", 
      "1.14`", ",", "1.69`", ",", "0.32`", ",", "1.38`", ",", "0.4`", ",", 
      "0.96`", ",", "1.68`", ",", "0.63`", ",", "2.1`", ",", "0.34`", ",", 
      "1.79`", ",", "0.15`", ",", "15.78`", ",", "0.2`", ",", "0.12`", ",", 
      "0.42`", ",", "1.90`", ",", "26.7`", ",", "0.24`", ",", "0.89`", ",", 
      "1.25`", ",", "4.62`", ",", "0.93`", ",", "0.8`", ",", "2.62`"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProgressionTime", "[", 
      RowBox[{
       RowBox[{
       "ASmallSetOfKIvalues", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
        "\[RightDoubleBracket]"}], ",", "1000", ",", 
       RowBox[{
       "ASmallSetOfGrowthRates", "\[LeftDoubleBracket]", 
        "SimulatedTumorNumber", "\[RightDoubleBracket]"}], ",", 
       "ProgressionThreshold", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TotalPopulationOverTime", "[", "SimulatedTumorNumber", "]"}], 
      "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
              "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
              "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
              "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], 
               ")"}]}], ")"}], "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SPopulationOverTime", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R1PopulationOverTime", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R2PopulationOverTime", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RRPopulationOverTime", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"SimulatedTumorNumber", ",", "1", ",", "50"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"a", " ", "subset", " ", "was", " ", "selected", " ", 
    RowBox[{"(", 
     RowBox[{"non", "-", "randomly"}], ")"}], " ", "to", " ", "illustrate", 
    " ", "the", " ", "diversity", " ", "of", " ", "different", " ", 
    "treatment", " ", "outcomes"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"TotalPopulationOverTime", "[", "stn", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"stn", ",", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "3", ",", "4", ",", "7", ",", "9", ",", "10", ",", "20", 
          ",", "22", ",", "23"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"30", "*", "30.5"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"16", ",", "i"}], "]"}], ",", 
             RowBox[{"ColorConvert", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"16", ",", "i"}], "]"}], ",", "\"\<Grayscale\>\""}], 
              "]"}]}], "}"}], ",", "0.7"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8", 
           ",", "9", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.0", ",", "0"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"AxesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"6", "/", "4"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Change from baseline\\n tumor volume(%)\>\""}], "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       "*)"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6D, Monotherapy spider plot.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6833850659216065`*^9, 3.6833851193996654`*^9}, {
   3.683385151007473*^9, 3.683385169231516*^9}, {3.6833852033544674`*^9, 
   3.6833853227862988`*^9}, {3.6833855432879105`*^9, 3.683385647166852*^9}, {
   3.683385696153654*^9, 3.6833857179549007`*^9}, {3.683389739010892*^9, 
   3.6833897553018236`*^9}, {3.6833898398636603`*^9, 
   3.6833898478211155`*^9}, {3.684195578265291*^9, 3.684195579095293*^9}, {
   3.6841956334564095`*^9, 3.684195702647558*^9}, 3.6841963117174263`*^9, {
   3.703717435470316*^9, 3.703717436687385*^9}, 3.716075176414154*^9}],

Cell[CellGroupData[{

Cell["A larger batch produced by randomly drawn parameters", "Subsubsection",
 CellChangeTimes->{{3.683385797600456*^9, 3.683385804538853*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ProgressionTime", "[", 
     RowBox[{
      RowBox[{
      "logKI1", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
       "\[RightDoubleBracket]"}], ",", "1000", ",", 
      RowBox[{
      "DistributionOfGrowthRates", "\[LeftDoubleBracket]", 
       "SimulatedTumorNumber", "\[RightDoubleBracket]"}], ",", 
      "ProgressionThreshold", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TotalPopulationOverTime", "[", "SimulatedTumorNumber", "]"}], 
     "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}]}],
             ")"}], "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SPopulationOverTime", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"R1PopulationOverTime", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"R2PopulationOverTime", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RRPopulationOverTime", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"SimulatedTumorNumber", ",", "1", ",", "200"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6628101235253057`*^9, 3.6628101789304743`*^9}, {
   3.6628102536167464`*^9, 3.662810291503914*^9}, {3.6628105464424953`*^9, 
   3.6628105786153355`*^9}, {3.6628127413220353`*^9, 
   3.6628127414000397`*^9}, {3.663191791647355*^9, 3.6631919060098963`*^9}, {
   3.6631920412896338`*^9, 3.663192089168372*^9}, {3.66319431827287*^9, 
   3.6631943993045044`*^9}, 3.683381501024706*^9, {3.6833825476395693`*^9, 
   3.683382555050993*^9}, {3.683382757158553*^9, 3.683382822166271*^9}, {
   3.6833845504121213`*^9, 3.6833845751455355`*^9}, {3.6833848451039762`*^9, 
   3.6833848558405905`*^9}, {3.683384891684641*^9, 3.683384947862854*^9}, 
   3.6833856628927517`*^9, 3.6833857529919047`*^9, {3.70371744376679*^9, 
   3.7037174438787966`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"TotalPopulationOverTime", "[", "SimulatedTumorNumber", "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"SimulatedTumorNumber", ",", "50", ",", "100"}], "}"}]}], 
     "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"3", "*", "366"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "0.7", ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0.3", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
       RowBox[{"{", "200", "}"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"AxesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "400", "}"}], ",", 
       RowBox[{"{", "500", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Change from baseline\\n tumor volume(%)\>\""}], "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6628101235253057`*^9, 3.6628101789304743`*^9}, {
   3.6628102536167464`*^9, 3.662810291503914*^9}, {3.6628105464424953`*^9, 
   3.6628105786153355`*^9}, {3.6628127413220353`*^9, 
   3.6628127414000397`*^9}, {3.663191791647355*^9, 3.6631919060098963`*^9}, {
   3.6631920412896338`*^9, 3.663192249128522*^9}, {3.6631922916989565`*^9, 
   3.6631924710992174`*^9}, {3.66319252289218*^9, 3.663192547996616*^9}, {
   3.6631926297242904`*^9, 3.6631926661393733`*^9}, {3.66319272027547*^9, 
   3.6631927252037516`*^9}, {3.6631927569085646`*^9, 3.663192776835705*^9}, {
   3.663192819076121*^9, 3.6631928804916334`*^9}, {3.6631944056908703`*^9, 
   3.663194410082121*^9}, {3.6631989610504217`*^9, 3.6631989617684627`*^9}, {
   3.6631990004986777`*^9, 3.663199009890215*^9}, {3.6670573731865687`*^9, 
   3.6670573825651054`*^9}, {3.6680844419722176`*^9, 3.668084451180744*^9}, {
   3.6708541284251394`*^9, 3.670854134036461*^9}, {3.683382524137225*^9, 
   3.6833825394350996`*^9}, 3.683382921117931*^9, {3.683384954589239*^9, 
   3.6833849553762836`*^9}, {3.6833857765682535`*^9, 3.683385776647258*^9}, {
   3.68338621499533*^9, 3.6833862151913414`*^9}, {3.683389702870825*^9, 
   3.683389725350111*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This interface allows the user to scroll through different individual tumors \
and inspect the growth (or inhibition) of its sub - populations over time.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6833829800623026`*^9, 3.683383022278717*^9}, 
   3.6833859881373544`*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TotalPopulationOverTime", "[", "sample", "]"}], ",", 
       RowBox[{"SPopulationOverTime", "[", "sample", "]"}], ",", 
       RowBox[{"R1PopulationOverTime", "[", "sample", "]"}], ",", 
       RowBox[{"R2PopulationOverTime", "[", "sample", "]"}], ",", 
       RowBox[{"RRPopulationOverTime", "[", "sample", "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"30", "*", "30.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Opacity", "[", "1", "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"col", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"col", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{"Green", ",", "0.3"}], "]"}], ",", "Red", ",", "Blue", 
              ",", "Purple"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.0", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"AxesStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "1"}], ",", "1", ",", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", 
               RowBox[{"2", "/", "61"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "2000", ",", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
          "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Time (months)\>\"", ",", "\"\<Change from baseline (%)\>\""}], 
       "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Total population\>\"", ",", "\"\<Most sensitive (S)\>\"", ",", 
        "\"\<Resistant to drug 1 (R1)\>\"", ",", 
        "\"\<Resistant to drug 2 (R2)\>\"", ",", 
        "\"\<Cross-resistant (RR)\>\""}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"sample", ",", "1", ",", "200", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.668084848788486*^9, 3.6680848666845093`*^9}, {
  3.6833826879475946`*^9, 3.683382740268587*^9}, {3.6833828871959906`*^9, 
  3.683382942596159*^9}, {3.683382973099904*^9, 3.6833829787042246`*^9}, {
  3.6833858325204535`*^9, 3.6833859230686326`*^9}, {3.683385956636553*^9, 
  3.683385967155154*^9}, {3.6833868445173364`*^9, 3.6833869231548347`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Waterfall plots, for monotherapy", "Section",
 CellChangeTimes->{{3.6631993872447987`*^9, 3.6631993915770464`*^9}, {
  3.667057673067721*^9, 3.66705767409978*^9}, {3.683383052361438*^9, 
  3.683383052557449*^9}, {3.6833858179776216`*^9, 3.68338581987373*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VolumeChangeAfterMonotherapy", "[", "SimulatedTumorNumber_", "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"which", " ", "time"}], ",", " ", 
      RowBox[{"in", " ", "weeks"}], ",", " ", 
      RowBox[{
      "will", " ", "we", " ", "evaluate", " ", "the", " ", "change", " ", 
       "in", " ", "tumor", " ", 
       RowBox[{"volume", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FollowupTimeInWeeks", "=", "8"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "executing", " ", "a", " ", "simulation", " ", "for", " ", "a", " ", 
       "single", " ", "tumor"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ProgressionTime", "[", 
      RowBox[{
       RowBox[{
       "logKI1", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
        "\[RightDoubleBracket]"}], ",", "1000", ",", 
       RowBox[{
       "DistributionOfGrowthRates", "\[LeftDoubleBracket]", 
        "SimulatedTumorNumber", "\[RightDoubleBracket]"}], ",", 
       "ProgressionThreshold", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "selecting", " ", "the", " ", "first", " ", "entry", " ", "in", " ", 
       RowBox[{"the", " ", "'"}], 
       RowBox[{"PopulationOverTimeTable", "'"}], " ", "that", " ", "is", " ", 
       "after", " ", "the", " ", "follow", " ", "up", " ", "time"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PopulationAtFollowUp", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PopulationOverTimeTable", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<=", 
           " ", 
           RowBox[{"FollowupTimeInWeeks", "*", "7"}]}], "&"}]}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InitialPopulation", "=", 
      SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "calculating", " ", "the", " ", "relative", " ", "change", " ", "in", 
       " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"BestFractionalChangeWithinFollowUpTime", "=", 
      RowBox[{"PopulationAtFollowUp", "/", "InitialPopulation"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.662810866713814*^9, 3.6628109579180303`*^9}, {
   3.6628116323536053`*^9, 3.6628116323976083`*^9}, {3.662812760411127*^9, 
   3.662812782353382*^9}, {3.6628136498840017`*^9, 3.6628136793746886`*^9}, {
   3.662814085520919*^9, 3.6628140943264227`*^9}, {3.6628188173565645`*^9, 
   3.662818817474571*^9}, {3.667057481346755*^9, 3.6670574815547667`*^9}, {
   3.6670582268793974`*^9, 3.667058227138412*^9}, {3.667058261561381*^9, 
   3.667058271576954*^9}, {3.667058338635789*^9, 3.6670583389098053`*^9}, {
   3.6670586856166353`*^9, 3.6670586857686443`*^9}, {3.66705883378911*^9, 
   3.667058834005123*^9}, {3.668086421940465*^9, 3.6680864348292027`*^9}, 
   3.683381501040707*^9, {3.683384541617618*^9, 3.68338454567885*^9}, {
   3.6833860037562475`*^9, 3.68338605589923*^9}, {3.683386255837666*^9, 
   3.683386257760776*^9}, {3.6833863258706713`*^9, 3.6833864393931646`*^9}, {
   3.6833864782703886`*^9, 3.683386544701188*^9}, {3.7037174651420126`*^9, 
   3.70371746527002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WaterFallDistribution", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"VolumeChangeAfterMonotherapy", "[", "stn", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"stn", ",", "1", ",", "200"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.662810725821755*^9, 3.662810759398676*^9}, 
   3.6628140799025974`*^9, 3.6833864074273367`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfPatients", "=", "100"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "creating", " ", "a", " ", "line", " ", "to", " ", "track", " ", "the", 
    " ", "waterfall", " ", "plot"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StartBarPositions", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Range", "[", "NumberOfPatients", "]"}], "-", "0.5"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"#", ",", "1.0"}], "}"}], "]"}], "&"}], ",", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"WaterFallDistribution", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", 
             RowBox[{"0", "+", "NumberOfPatients"}]}], 
            "\[RightDoubleBracket]"}], "-", "1"}], "]"}], "]"}]}], "]"}]}], 
     "}"}], "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndBarPositions", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Range", "[", "NumberOfPatients", "]"}], "+", "0.5"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"#", ",", "1.0"}], "}"}], "]"}], "&"}], ",", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"WaterFallDistribution", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", 
             RowBox[{"0", "+", "NumberOfPatients"}]}], 
            "\[RightDoubleBracket]"}], "-", "1"}], "]"}], "]"}]}], "]"}]}], 
     "}"}], "\[Transpose]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672530070240548*^9, 3.672530108751751*^9}, {
  3.672530211767643*^9, 3.6725302725761213`*^9}, {3.672530966696822*^9, 
  3.672530973872233*^9}, {3.683386561266135*^9, 3.6833865765660105`*^9}, {
  3.683456002039871*^9, 3.683456005320059*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BarChart", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"#", ",", "1.0"}], "}"}], "]"}], "&"}], ",", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"WaterFallDistribution", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", 
             RowBox[{"0", "+", "NumberOfPatients"}]}], 
            "\[RightDoubleBracket]"}], "-", "1"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"NumberOfPatients", "+", 
            RowBox[{"1", "/", "2"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "False"}], "}"}]}], ",", 
      RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ChartLabels", "\[Rule]", "None"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"AxesStyle", "->", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", 
               RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"31", ",", "8"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "0.5", "]"}], ",", 
            RowBox[{"Opacity", "[", "0.15", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"BarSpacing", "\[Rule]", "None"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"2", "/", "3"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"100", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Patients\>\"", ",", 
         "\"\<Change from baseline\\ntumor volume(%)\>\""}], "}"}]}], ",", 
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "1", "]"}], ",", "Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", "2"}], "+", "NumberOfPatients"}], ",", "0"}],
              "}"}]}], "}"}], "]"}]}], 
        RowBox[{"(*", 
         RowBox[{",", "Gray", ",", 
          RowBox[{"Dashing", "[", 
           RowBox[{"{", 
            RowBox[{"0.02", ",", "0.015"}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", "2"}], "+", "NumberOfPatients"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "2"}], ",", 
               RowBox[{"1", "/", "3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", "2"}], "+", "NumberOfPatients"}], ",", 
               RowBox[{"1", "/", "3"}]}], "}"}]}], "}"}], "]"}]}], "*)"}], 
        "}"}]}]}], "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Riffle", "[", 
       RowBox[{"StartBarPositions", ",", "EndBarPositions"}], "]"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6C, Monotherapy waterfall plot.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.672516929046915*^9, 3.6725169997529593`*^9}, {
   3.6725170431774426`*^9, 3.6725171175116944`*^9}, {3.672517194778114*^9, 
   3.6725172061847663`*^9}, {3.6725298641877623`*^9, 3.6725298785545845`*^9}, 
   3.672530319882827*^9, {3.6725309446915636`*^9, 3.67253094515359*^9}, {
   3.6725309947634277`*^9, 3.6725310188868074`*^9}, {3.672531068323635*^9, 
   3.672531070577764*^9}, {3.6726697222037973`*^9, 3.6726697223578057`*^9}, {
   3.6833862992561493`*^9, 3.68338631465003*^9}, {3.6833865538787127`*^9, 
   3.683386554054723*^9}, {3.683386599359314*^9, 3.6833866046996193`*^9}, {
   3.683389828929035*^9, 3.6833898311871643`*^9}, {3.684196538012904*^9, 
   3.6841965387429056`*^9}, 3.7160751771991987`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spider plots, for combination therapy", "Section",
 CellChangeTimes->{{3.6628101118266363`*^9, 3.6628101159888744`*^9}, {
  3.663199370979868*^9, 3.6631993750230994`*^9}, {3.6833824936374807`*^9, 
  3.6833824949335546`*^9}, {3.683382843706503*^9, 3.6833828461066403`*^9}, {
  3.6833854797402754`*^9, 3.683385480743333*^9}, {3.683386670153363*^9, 
  3.6833866756356773`*^9}}],

Cell[CellGroupData[{

Cell["A large batch produced by randomly drawn parameters", "Subsubsection",
 CellChangeTimes->{{3.683385797600456*^9, 3.683385804538853*^9}, 
   3.683386686787315*^9}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ProgressionTime", "[", 
     RowBox[{
      RowBox[{
      "logKI1", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "logKI2", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "DistributionOfGrowthRates", "\[LeftDoubleBracket]", 
       "SimulatedTumorNumber", "\[RightDoubleBracket]"}], ",", 
      "ProgressionThreshold", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "TotalPopulationOverTimeCombination", "[", "SimulatedTumorNumber", "]"}],
      "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}]}],
             ")"}], "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "SPopulationOverTimeCombination", "[", "SimulatedTumorNumber", "]"}], 
     "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "R1PopulationOverTimeCombination", "[", "SimulatedTumorNumber", "]"}], 
     "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "R2PopulationOverTimeCombination", "[", "SimulatedTumorNumber", "]"}], 
     "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "RRPopulationOverTimeCombination", "[", "SimulatedTumorNumber", "]"}], 
     "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"SimulatedTumorNumber", ",", "1", ",", "200"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6628101235253057`*^9, 3.6628101789304743`*^9}, {
   3.6628102536167464`*^9, 3.662810291503914*^9}, {3.6628105464424953`*^9, 
   3.6628105786153355`*^9}, {3.6628127413220353`*^9, 
   3.6628127414000397`*^9}, {3.663191791647355*^9, 3.6631919060098963`*^9}, {
   3.6631920412896338`*^9, 3.663192089168372*^9}, {3.66319431827287*^9, 
   3.6631943993045044`*^9}, 3.683381501024706*^9, {3.6833825476395693`*^9, 
   3.683382555050993*^9}, {3.683382757158553*^9, 3.683382822166271*^9}, {
   3.6833845504121213`*^9, 3.6833845751455355`*^9}, {3.6833848451039762`*^9, 
   3.6833848558405905`*^9}, {3.683384891684641*^9, 3.683384947862854*^9}, 
   3.6833856628927517`*^9, 3.6833857529919047`*^9, {3.683386690433523*^9, 
   3.6833866922416267`*^9}, {3.6833867461427097`*^9, 3.683386759510474*^9}, {
   3.7037175476927347`*^9, 3.7037175478227415`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"TotalPopulationOverTimeCombination", "[", "stn", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"stn", ",", "1", ",", "50"}], "}"}]}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"3", "*", "366"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "0.7", ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0.3", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
       RowBox[{"{", "200", "}"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"AxesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "400", "}"}], ",", 
       RowBox[{"{", "500", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Change from baseline\\n tumor volume(%)\>\""}], "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6628101235253057`*^9, 3.6628101789304743`*^9}, {
   3.6628102536167464`*^9, 3.662810291503914*^9}, {3.6628105464424953`*^9, 
   3.6628105786153355`*^9}, {3.6628127413220353`*^9, 
   3.6628127414000397`*^9}, {3.663191791647355*^9, 3.6631919060098963`*^9}, {
   3.6631920412896338`*^9, 3.663192249128522*^9}, {3.6631922916989565`*^9, 
   3.6631924710992174`*^9}, {3.66319252289218*^9, 3.663192547996616*^9}, {
   3.6631926297242904`*^9, 3.6631926661393733`*^9}, {3.66319272027547*^9, 
   3.6631927252037516`*^9}, {3.6631927569085646`*^9, 3.663192776835705*^9}, {
   3.663192819076121*^9, 3.6631928804916334`*^9}, {3.6631944056908703`*^9, 
   3.663194410082121*^9}, {3.6631989610504217`*^9, 3.6631989617684627`*^9}, {
   3.6631990004986777`*^9, 3.663199009890215*^9}, {3.6670573731865687`*^9, 
   3.6670573825651054`*^9}, {3.6680844419722176`*^9, 3.668084451180744*^9}, {
   3.6708541284251394`*^9, 3.670854134036461*^9}, {3.683382524137225*^9, 
   3.6833825394350996`*^9}, 3.683382921117931*^9, {3.683384954589239*^9, 
   3.6833849553762836`*^9}, {3.6833857765682535`*^9, 3.683385776647258*^9}, {
   3.68338621499533*^9, 3.6833862151913414`*^9}, {3.6833867668718953`*^9, 
   3.683386778420556*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This interface allows the user to scroll through different individual tumors \
and inspect the growth (or inhibition) of its sub - populations over time.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6833829800623026`*^9, 3.683383022278717*^9}, 
   3.6833859881373544`*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TotalPopulationOverTimeCombination", "[", "sample", "]"}], 
       ",", 
       RowBox[{"SPopulationOverTimeCombination", "[", "sample", "]"}], ",", 
       RowBox[{"R1PopulationOverTimeCombination", "[", "sample", "]"}], ",", 
       RowBox[{"R2PopulationOverTimeCombination", "[", "sample", "]"}], ",", 
       RowBox[{"RRPopulationOverTimeCombination", "[", "sample", "]"}]}], 
      "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"30", "*", "30.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Opacity", "[", "1", "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"col", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"col", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{"Green", ",", "0.3"}], "]"}], ",", "Red", ",", "Blue", 
              ",", "Purple"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.0", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"AxesStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "1"}], ",", "1", ",", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", 
               RowBox[{"2", "/", "61"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "2000", ",", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
          "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Time (months)\>\"", ",", "\"\<Change from baseline (%)\>\""}], 
       "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Total population\>\"", ",", "\"\<Most sensitive (S)\>\"", ",", 
        "\"\<Resistant to drug 1 (R1)\>\"", ",", 
        "\"\<Resistant to drug 2 (R2)\>\"", ",", 
        "\"\<Cross-resistant (RR)\>\""}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"sample", ",", "1", ",", "200", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.668084848788486*^9, 3.6680848666845093`*^9}, {
  3.6833826879475946`*^9, 3.683382740268587*^9}, {3.6833828871959906`*^9, 
  3.683382942596159*^9}, {3.683382973099904*^9, 3.6833829787042246`*^9}, {
  3.6833858325204535`*^9, 3.6833859230686326`*^9}, {3.683385956636553*^9, 
  3.683385967155154*^9}, {3.6833867853729534`*^9, 3.683386799346753*^9}, {
  3.683386941297872*^9, 3.6833869552916727`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Modeling consequence of different levels of correlation in drug response\
\>", "Section",
 CellChangeTimes->{{3.7037160131479635`*^9, 3.703716036228284*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "simulation", " ", "of", " ", "independent", " ", "action", " ", "with", 
     " ", "response", " ", "correlation"}], " ", "=", " ", "0.0"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulation", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.7160756340433292`*^9, 3.716075662314946*^9}, {
  3.716075698588021*^9, 3.716075700475129*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "simulation", " ", "of", " ", "independent", " ", "action", " ", "with", 
     " ", "response", " ", "correlation"}], " ", "=", " ", "0.3"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulation", "[", "0.3", "]"}]}]], "Input",
 CellChangeTimes->{{3.703716054283316*^9, 3.703716054740342*^9}, {
   3.7037162870696306`*^9, 3.7037162879006786`*^9}, {3.7037163573816524`*^9, 
   3.703716357571663*^9}, {3.7037169206528697`*^9, 3.7037169213089075`*^9}, {
   3.7160756562836013`*^9, 3.7160756593237753`*^9}, 3.716075704236344*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "simulation", " ", "of", " ", "independent", " ", "action", " ", "with", 
     " ", "response", " ", "correlation"}], " ", "=", " ", "0.6"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulation", "[", "0.6", "]"}]}]], "Input",
 CellChangeTimes->{{3.7037160592926025`*^9, 3.7037160594446115`*^9}, {
   3.703716284805501*^9, 3.7037162851415205`*^9}, {3.7037163600138025`*^9, 
   3.703716360083807*^9}, {3.7037168956124372`*^9, 3.7037169089001975`*^9}, {
   3.716075665804146*^9, 3.7160756683632917`*^9}, 3.7160757065234747`*^9}],

Cell[BoxData[
 RowBox[{"IndependenceGradientPlot", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"UntreatedProgressionTimes", "[", "0", "]"}], "]"}], 
            "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"SurvivalFunction", "[", 
              RowBox[{"EmpiricalDistribution", "[", 
               RowBox[{"Monotherapy2ProgressionTimes", "[", "0", "]"}], "]"}],
               "]"}], "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", 
            RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ","}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"Monotherapy1ProgressionTimes", "[", "0", "]"}], "]"}], 
            "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"CombinationProgressionTimes", "[", "0", "]"}], "]"}], 
            "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"CombinationProgressionTimes", "[", "0.3", "]"}], "]"}], 
            "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"CombinationProgressionTimes", "[", "0.6", "]"}], "]"}], 
            "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "*", "i"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"61", "*", "18"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2.9", "/", "4"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Progression free survival (months)\>\"", ",", 
       RowBox[{"Rotate", "[", 
        RowBox[{"\"\<Patients (%)\>\"", ",", "0"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"RGBColor", "[", 
            RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ","}], 
        "*)"}], 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", "None", 
       ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0", ",", "0", ",", "0.7"}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.67", ",", "0.1", ",", "0.67"}], "]"}], "*)"}], ",", 
         RowBox[{"Dashing", "[", "None", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0", ",", "0.5", ",", "0.9"}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.67", ",", "0.1", ",", "0.67"}], "]"}], "*)"}], ",", 
         RowBox[{"Dashing", "[", "None", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0", ",", "0.85", ",", "1"}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.67", ",", "0.1", ",", "0.67"}], "]"}], "*)"}], ",", 
         RowBox[{"Dashing", "[", "None", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Untreated\>\"", ",", 
         RowBox[{"(*", 
          RowBox[{"\"\<Monotherapy B\>\"", ","}], "*)"}], 
         "\"\<Monotherapy\>\"", 
         RowBox[{"(*", 
          RowBox[{"<>", "\"\< A\>\""}], "*)"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Combination,\\nIndependent drug action:\>\"", ",", 
           RowBox[{"LineSpacing", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", 
         "\"\<Correlation 0.0\>\"", ",", "\"\<Correlation 0.3\>\"", ",", 
         "\"\<Correlation 0.6\>\""}], "}"}], ",", "Right"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.70371644178548*^9, 3.7037164439836054`*^9}, {
  3.703717002586556*^9, 3.7037170236267595`*^9}, {3.703717634073675*^9, 
  3.703717634177681*^9}, {3.7037176678606076`*^9, 3.703717717746461*^9}, {
  3.703717921995143*^9, 3.703717968337794*^9}, {3.7037179984835176`*^9, 
  3.703718195605793*^9}, {3.7037183602822113`*^9, 3.703718402138606*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6E, independent, PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.703718713180396*^9, 3.703718715429525*^9}, 
   3.716075178477272*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modeling \[OpenCurlyQuote]additive\[CloseCurlyQuote] or \
\[OpenCurlyQuote]synergistic\[CloseCurlyQuote] drug combinations", "Section",
 CellChangeTimes->{{3.6626497380790763`*^9, 3.6626497520508757`*^9}, {
  3.6626503487460046`*^9, 3.6626503517141743`*^9}, {3.6833866348363433`*^9, 
  3.683386642203765*^9}, {3.683389516396159*^9, 3.683389519316326*^9}}],

Cell[TextData[{
 StyleBox["Experiments in cell culture commonly quantify the degree of \
\[OpenCurlyQuote]synergy\[CloseCurlyQuote] in a combination according to the \
models of Chou & Talalay or of Loewe which, by measuring the dose response to \
a fixed ratio combination or by isolobogram analysis (respectively), quantify \
the efficacy of a combination in comparison to higher or lower concentrations \
of monotherapy. A drug combination is additive if their combined effect \
equals the effect expected by summing their potency-normalized doses (for \
example, [A] / ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["IC50", "A"], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[", and [B] / ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["IC50", "B"], TraditionalForm]],
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[") on a common dose-response curve. A drug combination is \
synergistic if their combined effect is greater than expected by the same \
measure.",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\n\nHere we simulate a drug combination which behaves according to \
this understanding of drug additivity / synergism, by treated the combination \
as simply a higher dose of a monotherapy. This describes the scenario of \
perfect correlation in response (full cross-resistance) between the two \
drugs.\n\nWith two drugs acting as one, we only track two sub-populations: \
baseline level of drug sensitivity (S) and drug-resistant (R1).",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\n\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["References",
  FontSize->16,
  FontWeight->"Plain",
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[":\nChou & Talalay. Quantitative analysis of dose-effect \
relationships: the combined effects of multiple drugs or enzyme inhibitors. \
Adv. Enzyme Regul. 1984, ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["v22",
  FontSize->16,
  FontWeight->"Bold",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[":25-55",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["\n",
  FontSize->16,
  FontWeight->"Bold",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Loewe S. The problem of synergism and antagonism of combined \
drugs. Arzneimittelforschung. 1953, ",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["v3",
  FontSize->16,
  FontWeight->"Bold",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox[":285-90",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.6833727718175087`*^9, 3.6833729354508677`*^9}, {3.6833761403000903`*^9, 
   3.6833764146477823`*^9}, {3.683377379249954*^9, 3.6833774898352795`*^9}, {
   3.683377877317442*^9, 3.683377894186407*^9}, {3.683377965663495*^9, 
   3.683378043626954*^9}, {3.6833780747307334`*^9, 3.683378134389146*^9}, {
   3.683378168406091*^9, 3.6833782242992883`*^9}, {3.6833782544580135`*^9, 
   3.683378484433167*^9}, {3.683380994658744*^9, 3.6833810526790624`*^9}, {
   3.6833869784889994`*^9, 3.6833870610797234`*^9}, {3.683387105237249*^9, 
   3.683387164558642*^9}, {3.6833872306344213`*^9, 3.6833876563437705`*^9}, {
   3.68338788536687*^9, 3.683387922471992*^9}, {3.6833895301829476`*^9, 
   3.6833896574052243`*^9}, {3.7037184576357803`*^9, 3.703718483884281*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProgressionTimeSynergy", "[", 
   RowBox[{
   "KI1_", ",", "DoseChange_", ",", "growthrate_", ",", 
    "ProgressionThreshold_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1internal", "=", "KI1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"cell", " ", "division", " ", "rate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"gr", "=", "growthrate"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"spontaneous", " ", "cell", " ", "death", " ", "rate"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"celllossrate", "=", "CellLossRate"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"previously", " ", "defined", " ", "as", " ", "80", "%"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"death", " ", "rate"}], " ", "=", " ", 
       RowBox[{
       "growth", " ", "rate", " ", "\[Times]", " ", "cell", " ", "loss", " ", 
        "factor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dr", "=", 
      RowBox[{"gr", "*", "celllossrate"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"rl", " ", "=", " ", 
        RowBox[{"'", "resistance", " ", 
         RowBox[{"level", "'"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"being", " ", "the", " ", "fold"}], "-", 
        RowBox[{
        "change", " ", "in", " ", "KI", " ", "in", " ", "drug", " ", 
         "resistant", " ", "sub"}], "-", "populations"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rl", "=", "10"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"pre", "-", 
       RowBox[{"existing", " ", "resistance", " ", "frequencies"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resistance", " ", "to", " ", "drug", " ", "1"}], " ", "*)"}], 
     " ", 
     RowBox[{"rf1", "=", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initial", " ", "population", " ", "size"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"p0", "=", 
      SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Previously", " ", "defined", " ", "drug", " ", "dose", " ", "is", " ", 
       "multiplied", " ", "by", " ", "new", " ", 
       RowBox[{"parameter", " ", "'"}], 
       RowBox[{"DoseChange", "'"}], " ", "which", " ", "describes", " ", 
       "how", " ", "much", " ", "more", " ", "potent", " ", "are", " ", "two",
        " ", "drugs", " ", "in", " ", "combination"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"DrugDose", "*", "DoseChange"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"duration", " ", "of", " ", "numerical", " ", "simulation"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SimulationDuration", "=", "6"}], ";", " ", 
     RowBox[{"(*", "years", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"simulating", " ", "an", " ", "untreated", " ", "tumor"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultUntreated", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
         "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "tumor", " ", "cells", " ",
        "with", " ", "baseline", " ", "drug", " ", "sensitivity"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultS", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
         "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "tumor", " ", "cells", " ",
        "with", " ", "drug", " ", "resistance"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mysimresultR1", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rf1"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Summing", " ", "up", " ", "the", " ", "total", " ", "population", 
         " ", "size", " ", "at", " ", "each", " ", "time"}], ";", " ", 
        RowBox[{"sum", " ", "of", " ", "populations", " ", "S"}]}], ",", " ", 
       RowBox[{
        RowBox[{"R1", ".", " ", "Table"}], " ", "has", " ", "an", " ", 
        "entry", " ", "at", " ", "every", " ", "2", " ", 
        RowBox[{"days", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PopulationOverTimeTable", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}]}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "If", " ", "progression", " ", "threshold", " ", "is", " ", "not", " ",
         "reached", " ", "within", " ", "the", " ", "duration", " ", "of", 
        " ", "the", " ", "simulation"}], ",", " ", 
       RowBox[{
       "return", " ", "a", " ", "number", " ", "larger", " ", "than", " ", 
        "the", " ", "duration", " ", "of", " ", "simulation", " ", 
        RowBox[{"(", 
         RowBox[{
         "this", " ", "can", " ", "be", " ", "used", " ", "to", " ", 
          "identify", " ", "such", " ", "events"}], ")"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PopulationOverTimeTable", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "<", 
        "ProgressionThreshold"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"SimulationDuration", "+", "1"}], ")"}], "*", "365"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"final", " ", 
        RowBox[{"output", ":", " ", 
         RowBox[{
         "the", " ", "earliest", " ", "time", " ", "at", " ", "which", " ", 
          "the", " ", "total", " ", "population", " ", "size", " ", 
          "surpasses", " ", 
          RowBox[{"the", " ", "'"}], "progression", " ", 
          RowBox[{"threshold", "'"}]}]}]}], ",", " ", 
       RowBox[{
       "taken", " ", "in", " ", "this", " ", "file", " ", "to", " ", "be", 
        " ", "twice", " ", "the", " ", "initial", " ", "population"}], ",", 
       " ", 
       RowBox[{
       "though", " ", "it", " ", "could", " ", "be", " ", "varied"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PopulationOverTimeTable", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ">", "ProgressionThreshold"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6626497602193427`*^9, 3.6626498606770887`*^9}, {
   3.6626502986451387`*^9, 3.662650341987618*^9}, {3.662651630315306*^9, 
   3.662651640227873*^9}, {3.662728775435362*^9, 3.6627287762224073`*^9}, {
   3.6627389789749713`*^9, 3.662738979255987*^9}, {3.6628146979829493`*^9, 
   3.662814698037953*^9}, {3.667057538973051*^9, 3.6670575623883905`*^9}, {
   3.6670580374725637`*^9, 3.667058044528967*^9}, {3.667058996461415*^9, 
   3.6670589982515173`*^9}, {3.6747460249770412`*^9, 3.674746025208042*^9}, 
   3.683371473916875*^9, {3.6833717694542904`*^9, 3.6833717694642906`*^9}, {
   3.683378672554927*^9, 3.6833786725629272`*^9}, 3.6833815011177115`*^9, {
   3.683387666285339*^9, 3.6833878826837163`*^9}, {3.6833879398579865`*^9, 
   3.6833879953981633`*^9}, {3.7037184313782783`*^9, 3.7037184491702957`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Executing the above simulation for a population of 200 patients\
\>", "Subsubsection",
 CellChangeTimes->{{3.683388208015324*^9, 3.6833882187909403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulatePopulationSynergy", "[", "DoseChange_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "StandardDeviationInDrugSensitivity"}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI1", "=", 
      RowBox[{"10", "^", "KI1Table"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"NumberOfTumorsSimulated", "=", "200"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgressionThreshold", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"UntreatedProgressionTimesSynergy", "[", "DoseChange", "]"}], 
      "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeSynergy", "[", 
          RowBox[{"1000", ",", "1", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MonotherapyProgressionTimesSynergy", "[", "DoseChange", "]"}], 
      "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeSynergy", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "1", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CombinationProgressionTimesSynergy", "[", "DoseChange", "]"}], 
      "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeSynergy", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "DoseChange", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalPlotSynergy", "[", "DoseChange", "]"}], "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{
                 "UntreatedProgressionTimesSynergy", "[", "DoseChange", "]"}],
                  "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{
                 "MonotherapyProgressionTimesSynergy", "[", "DoseChange", 
                  "]"}], "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{
                 "CombinationProgressionTimesSynergy", "[", "DoseChange", 
                  "]"}], "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "*", 
                RowBox[{"2", "/", "61"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "2000", ",", 
               RowBox[{
                RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"36", "*", "30.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"3", "/", "4"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Progression free survival (months)\>\"", ",", 
           "\"\<Patients (%)\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "250", "}"}], ",", 
           RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}]}], "}"}]}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6626499140531416`*^9, 3.66265007872556*^9}, {
   3.662650133759708*^9, 3.6626501729649506`*^9}, {3.6626503631328278`*^9, 
   3.662650431474736*^9}, {3.6626509045317936`*^9, 3.6626509207967243`*^9}, {
   3.6626509646432323`*^9, 3.6626509647152357`*^9}, {3.6626516479313135`*^9, 
   3.662651665501319*^9}, {3.662814214239281*^9, 3.662814216383404*^9}, {
   3.6628145038088436`*^9, 3.6628145043218727`*^9}, {3.6670575695137978`*^9, 
   3.667057569581802*^9}, {3.667059004477873*^9, 3.667059005622939*^9}, 
   3.6833731155871696`*^9, 3.6833786996724777`*^9, {3.683381501124712*^9, 
   3.6833815012117167`*^9}, {3.6833880166503787`*^9, 3.6833881468988285`*^9}, 
   3.6833881821418443`*^9, 3.683388221300084*^9, {3.6833882577471685`*^9, 
   3.6833883137773733`*^9}, {3.6834559481097865`*^9, 3.6834559641177025`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"simulation", " ", 
    RowBox[{"of", " ", "'"}], 
    RowBox[{"synergy", "'"}], " ", "equivalent", " ", "to", " ", "1.5", 
    "\[Times]", " ", "monotherapy", " ", "dose"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulationSynergy", "[", "1.5", "]"}]}]], "Input",
 CellChangeTimes->{{3.703714241188613*^9, 3.7037142505971513`*^9}, {
  3.716075682955127*^9, 3.7160757249235272`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"simulation", " ", 
    RowBox[{"of", " ", "'"}], 
    RowBox[{"synergy", "'"}], " ", "equivalent", " ", "to", " ", "2", 
    "\[Times]", " ", "monotherapy", " ", "dose"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulationSynergy", "[", "2", "]"}]}]], "Input",
 CellChangeTimes->{{3.703714245571864*^9, 3.703714245667869*^9}, {
  3.716075728250717*^9, 3.7160757312748904`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"simulation", " ", 
    RowBox[{"of", " ", "'"}], 
    RowBox[{"synergy", "'"}], " ", "equivalent", " ", "to", " ", "3", 
    "\[Times]", " ", "monotherapy", " ", "dose"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulationSynergy", "[", "3", "]"}]}]], "Input",
 CellChangeTimes->{{3.6708518524016027`*^9, 3.6708518552716064`*^9}, {
   3.6712409961719666`*^9, 3.6712409969240093`*^9}, 3.6833786997024794`*^9, 
   3.6833882338768034`*^9, {3.716075734907098*^9, 3.716075738379297*^9}}],

Cell[BoxData[
 RowBox[{"SynergyGradientPlot", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"UntreatedProgressionTimes", "[", "0", "]"}], "]"}], 
            "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"SurvivalFunction", "[", 
              RowBox[{"EmpiricalDistribution", "[", 
               RowBox[{"Monotherapy2ProgressionTimes", "[", "0", "]"}], "]"}],
               "]"}], "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", 
            RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ","}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"Monotherapy1ProgressionTimes", "[", "0", "]"}], "]"}], 
            "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"CombinationProgressionTimesSynergy", "[", "1.5", "]"}], 
             "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"CombinationProgressionTimesSynergy", "[", "2", "]"}], 
             "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"SurvivalFunction", "[", 
            RowBox[{"EmpiricalDistribution", "[", 
             RowBox[{"CombinationProgressionTimesSynergy", "[", "3", "]"}], 
             "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"4", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"100", "*", "i"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"61", "*", "18"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2.9", "/", "4"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Progression free survival (months)\>\"", ",", 
       RowBox[{"Rotate", "[", 
        RowBox[{"\"\<Patients (%)\>\"", ",", "0"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"RGBColor", "[", 
            RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ","}], 
        "*)"}], 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", "None", 
       ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"1", ",", "0.6", ",", "0"}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.67", ",", "0.1", ",", "0.67"}], "]"}], "*)"}], ",", 
         RowBox[{"Dashing", "[", "None", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"1", ",", "0.2", ",", "0"}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.67", ",", "0.1", ",", "0.67"}], "]"}], "*)"}], ",", 
         RowBox[{"Dashing", "[", "None", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.55", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.67", ",", "0.1", ",", "0.67"}], "]"}], "*)"}], ",", 
         RowBox[{"Dashing", "[", "None", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Untreated\>\"", ",", 
         RowBox[{"(*", 
          RowBox[{"\"\<Monotherapy B\>\"", ","}], "*)"}], 
         "\"\<Monotherapy\>\"", 
         RowBox[{"(*", 
          RowBox[{"<>", "\"\< A\>\""}], "*)"}], ",", 
         "\"\<Combination, Synergy:\>\"", ",", 
         "\"\<1.5\[Times] higher dose\>\"", ",", 
         "\"\<  2\[Times] higher dose\>\"", ",", 
         "\"\<  3\[Times] higher dose\>\""}], "}"}], ",", "Right"}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7037143095855255`*^9, 3.7037143308417406`*^9}, {
  3.703714423514042*^9, 3.7037144455383015`*^9}, {3.7037144799382687`*^9, 
  3.70371451667437*^9}, {3.703714613674918*^9, 3.703714719937996*^9}, {
  3.703715026067506*^9, 3.7037151278023243`*^9}, {3.7037185343311667`*^9, 
  3.7037185798827724`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6E, synergy, PFS.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.703714997908895*^9, 3.7037150016051064`*^9}, 
   3.7160751792473164`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Independent drug action and additive-or-synergistic drug interactions are not \
mutually exclusive - they can act simultaneously\
\>", "Section",
 CellChangeTimes->{{3.6731888831404943`*^9, 3.6731888905479174`*^9}, {
  3.683389458783864*^9, 3.6833895069996214`*^9}}],

Cell[CellGroupData[{

Cell["\<\
First, we examine the effect of a two drug combination that are partially \
correlated in response, and have a small increase in effective dose when \
co-administered (1.4\[Times]; in effect sub-additive)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6833907536049232`*^9, 3.6833907979114575`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugDose", "=", "0.2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProgressionTimeMixedEffects", "[", 
    RowBox[{
    "KI1_", ",", "KI2_", ",", "growthrate_", ",", "DoseChange_", ",", 
     "ProgressionThreshold_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KI1internal", "=", "KI1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"KI2internal", "=", "KI2"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"gr", "=", "growthrate"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"celllossrate", "=", "CellLossRate"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"80", "%", " ", "cell", " ", "loss", " ", "rate"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dr", "=", 
       RowBox[{"gr", "*", "celllossrate"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rl", "=", "10"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rf1", "=", 
       RowBox[{"500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rf2", "=", 
       RowBox[{"500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rfCross", "=", 
       RowBox[{"5", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p0", "=", 
       SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"DrugDose", "*", "DoseChange"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SimulationDuration", "=", "6"}], ";", " ", 
      RowBox[{"(*", "years", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresultUntreated", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
          "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mysimresultS", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
          "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mysimresultR1", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rf1"}]}]}], "}"}], ",", "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mysimresultR2", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rf2"}]}]}], "}"}], ",", "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mysimresultRR", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rfCross"}]}]}], "}"}], ",", "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PopulationOverTimeTable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
            "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
            "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
            "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], 
             ")"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
           ",", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PopulationOverTimeTable", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "<", 
         "ProgressionThreshold"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "+", "1"}], ")"}], "*", "365"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PopulationOverTimeTable", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
           "ProgressionThreshold"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "simulation", " ", "takes", " ", "two", " ", 
     RowBox[{"parameters", ":", " ", 
      RowBox[{
      "response", " ", "correlation", " ", "between", " ", "drugs", " ", 
       RowBox[{"(", 
        RowBox[{"\"\<Correlation\>\"", " ", "parameter"}], ")"}]}]}]}], " ", 
    ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "an", " ", "additive"}], "-", "or", "-", 
     RowBox[{
     "synergistic", " ", "effect", " ", "that", " ", "manifests", " ", "as", 
      " ", "the", " ", "drugs", " ", "having", " ", "greater", " ", "potency",
       " ", "than", " ", "monotherapy", " ", 
      RowBox[{"(", 
       RowBox[{"\"\<DoseChange\>\"", " ", "parameter"}], ")"}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimulatePopulationMixed", "[", 
   RowBox[{"Correlation_", ",", "DoseChange_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"KIJointDistribution", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KI1Table", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Correlation", "*", "KI1Table"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["Correlation", "2"]}], ")"}], "KI2Table"}]}], 
          ")"}]}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI1", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI2", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"NumberOfTumorsSimulated", "=", "200"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgressionThreshold", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"UntreatedProgressionTimesMixed", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeMixedEffects", "[", 
          RowBox[{"1000", ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "1", ",", 
           "ProgressionThreshold"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MonotherapyProgressionTimesMixed", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeMixedEffects", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "1", ",", 
           "ProgressionThreshold"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CombinationProgressionTimesMixed", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeMixedEffects", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "DoseChange", ",", 
           "ProgressionThreshold"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SurvivalPlotMixed", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "UntreatedProgressionTimesMixed", "]"}], "]"}], "[", "x", 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "MonotherapyProgressionTimesMixed", "]"}], "]"}], "[", "x", 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "CombinationProgressionTimesMixed", "]"}], "]"}], "[", "x", 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "*", 
                RowBox[{"2", "/", "61"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "2000", ",", 
               RowBox[{
                RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"36", "*", "30.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"3", "/", "4"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Progression free survival (months)\>\"", ",", 
           "\"\<Patients (%)\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "250", "}"}], ",", 
           RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}]}], "}"}]}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6613624139911203`*^9, 3.6613624142151327`*^9}, {
   3.661362651344696*^9, 3.6613626515187054`*^9}, {3.661362741354844*^9, 
   3.6613627415148535`*^9}, {3.661362798060087*^9, 3.6613627981300917`*^9}, {
   3.6614336684773397`*^9, 3.6614336707844715`*^9}, {3.6614339076940217`*^9, 
   3.6614339079890385`*^9}, {3.661433953224626*^9, 3.6614339894016953`*^9}, {
   3.6614346259381027`*^9, 3.6614346261851172`*^9}, {3.661434758042659*^9, 
   3.661434763921995*^9}, {3.661436281480795*^9, 3.6614362820188255`*^9}, {
   3.661436812322157*^9, 3.6614368360745153`*^9}, {3.661438022898398*^9, 
   3.661438023144412*^9}, {3.661438116870773*^9, 3.6614381171697903`*^9}, {
   3.661438410730581*^9, 3.661438437767127*^9}, {3.6614385780331497`*^9, 
   3.6614385975632668`*^9}, {3.6627284035780935`*^9, 
   3.6627284036740985`*^9}, {3.6627284437993937`*^9, 
   3.6627284443304243`*^9}, {3.662728477685332*^9, 3.662728477862342*^9}, {
   3.662728536438692*^9, 3.6627285364926953`*^9}, {3.662728630230057*^9, 
   3.662728630326062*^9}, {3.6627388991014028`*^9, 3.662738899455423*^9}, {
   3.6627445672096*^9, 3.6627445672496023`*^9}, {3.662744606008819*^9, 
   3.662744606041821*^9}, {3.6628115295967283`*^9, 3.6628115296477313`*^9}, {
   3.6628115986546783`*^9, 3.66281159886769*^9}, {3.6628120938450017`*^9, 
   3.662812093890004*^9}, 3.662812423763872*^9, {3.662812636789056*^9, 
   3.6628126396842213`*^9}, {3.6628127097392282`*^9, 3.66281270993424*^9}, {
   3.6628138076690264`*^9, 3.66281380790104*^9}, {3.6628139290019665`*^9, 
   3.662813929278982*^9}, {3.662814041223385*^9, 3.6628140444985723`*^9}, {
   3.6628143892422905`*^9, 3.662814389312295*^9}, {3.6670569383126955`*^9, 
   3.667056938379699*^9}, {3.6670570678151026`*^9, 3.6670570690631742`*^9}, {
   3.667057165447687*^9, 3.667057194073324*^9}, {3.667057895996472*^9, 
   3.667057896067476*^9}, {3.667058088182464*^9, 3.66705808828547*^9}, 
   3.6670581305398865`*^9, {3.6670582892309637`*^9, 3.6670582896839895`*^9}, {
   3.6670583953220315`*^9, 3.6670584158712068`*^9}, {3.6670586395289993`*^9, 
   3.667058639644006*^9}, 3.6670587792949934`*^9, {3.6731888723418765`*^9, 
   3.6731888728009024`*^9}, {3.673188909156982*^9, 3.6731890946485915`*^9}, {
   3.6731891522028837`*^9, 3.6731891542700014`*^9}, {3.6747461783520756`*^9, 
   3.674746178612076*^9}, 3.6833714741068754`*^9, {3.683371769474291*^9, 
   3.6833717694942904`*^9}, {3.6833731156011705`*^9, 
   3.6833731156051707`*^9}, {3.6833786725889287`*^9, 
   3.6833786997264814`*^9}, {3.683381501302722*^9, 3.683381501402728*^9}, {
   3.6833891237236996`*^9, 3.6833891364694285`*^9}, {3.683389906407467*^9, 
   3.6833901732527294`*^9}, {3.6833902094858017`*^9, 
   3.6833902637179036`*^9}, {3.6833904072261114`*^9, 3.683390414240513*^9}, 
   3.6833910413623824`*^9, {3.683391318102211*^9, 3.683391319501291*^9}, {
   3.7160758294865074`*^9, 3.7160758824445367`*^9}, {3.7160759185085993`*^9, 
   3.7160759687344723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"simulation", " ", "with", " ", "response", " ", "correlation"}],
      " ", "=", " ", "0.0"}], ",", " ", 
    RowBox[{
    "and", " ", "no", " ", "synergy", " ", "or", " ", "additivity"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulationMixed", "[", 
   RowBox[{"0", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6731890970927315`*^9, 3.6731891252273407`*^9}, {
   3.6731891642325716`*^9, 3.6731891644315825`*^9}, {3.673189210525219*^9, 
   3.6731892254090705`*^9}, 3.683378699729481*^9, {3.6833901796710963`*^9, 
   3.6833901817972183`*^9}, {3.7160758032910094`*^9, 3.7160758198189545`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "simulation", " ", "with", " ", "strong", " ", "response", " ", 
     "correlation", " ", 
     RowBox[{"(", 
      RowBox[{"\[Rho]", "=", "0.7"}], ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "small", " ", "benefit", " ", "of", " ", 
      RowBox[{"the", " ", "'"}], "additivity"}], "-", "or", "-", 
     RowBox[{
      RowBox[{"synergy", "'"}], " ", "type", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.4", "\[Times]", " ", "dose", " ", "potency"}], " ", "-", 
        " ", 
        RowBox[{
         RowBox[{"technically", " ", "'"}], "sub"}], "-", 
        RowBox[{
         RowBox[{"additive", "'"}], " ", "but", " ", "nonetheless", " ", 
         "stronger", " ", "than", " ", "monotherapy"}]}], ")"}]}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulationMixed", "[", 
   RowBox[{"0.7", ",", "1.4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6731892419130144`*^9, 3.6731893233216705`*^9}, {
   3.6731894597214727`*^9, 3.673189461115552*^9}, {3.673189577892232*^9, 
   3.673189578984294*^9}, {3.6738829276176653`*^9, 3.6738829366731834`*^9}, 
   3.6833786997524824`*^9, 3.6833904490935063`*^9, {3.7160759771159515`*^9, 
   3.716076076827655*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SynergyVSHeterogeneityComparisonPlot", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", 
              RowBox[{"UntreatedProgressionTimes", "[", "0", "]"}], "]"}], 
             "]"}], "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", 
              RowBox[{"Monotherapy1ProgressionTimes", "[", "0", "]"}], "]"}], 
             "]"}], "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", 
              RowBox[{"(*", " ", 
               RowBox[{
               "combination", " ", "with", " ", "3", "\[Times]", " ", 
                "synergy"}], " ", "*)"}], 
              RowBox[{"CombinationProgressionTimesSynergy", "[", "3", "]"}], 
              "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", 
              RowBox[{"(*", " ", 
               RowBox[{
               "combination", " ", "with", " ", "independent", " ", "action", 
                " ", "and", " ", "no", " ", "correlation"}], " ", "*)"}], 
              RowBox[{"CombinationProgressionTimes", "[", "0", "]"}], "]"}], 
             "]"}], "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"combination", " ", "with", " ", "mixed", " ", 
                RowBox[{"effects", ":", " ", 
                 RowBox[{
                 "1.4", "\[Times]", " ", "synergy", " ", "and", " ", 
                  "correlation", " ", "0.7"}]}]}], " ", "*)"}], 
              "CombinationProgressionTimesMixed", "]"}], "]"}], "[", "x", 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"100", "*", "i"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", 
               RowBox[{"2", "/", "61"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "2000", ",", 
              RowBox[{
               RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
          "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"60", "*", "30.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Progression free survival (months)\>\"", ",", 
        RowBox[{"Rotate", "[", 
         RowBox[{"\"\<Patients (%)\>\"", ",", "0"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "220", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"115", ",", "30"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Red", 
          RowBox[{"(*", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"0.67", ",", "0.1", ",", "0.67"}], "]"}], "*)"}], ",", 
          RowBox[{"Dashing", "[", "None", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Dashing", "[", "None", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "1"}], "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Dashing", "[", "None", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<Untreated\>\"", ",", "\"\<Monotherapy\>\"", ",", 
          "\"\<Combination,\\nSynergy: 3\[Times] higher dose\>\"", ",", 
          "\"\<Combination,\\nIndependent drug action (\[Rho]=0.0)\>\"", ",", 
          "\"\<Combination, mixed effects:\\nhighly correlated responses (\
\[Rho]=0.7),\\nsub-additive (1.4\[Times] higher dose)\>\""}], "}"}], ",", 
        "Right"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S7C, progression free survival, mixture of \
additivity and partially correlated sensitivity.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6731893447268953`*^9, 3.6731894535521193`*^9}, {
   3.6731894980166626`*^9, 3.673189565120501*^9}, {3.673189636998612*^9, 
   3.6731896490453014`*^9}, {3.673189714707057*^9, 3.673189728412841*^9}, {
   3.6747461998741074`*^9, 3.6747462174341364`*^9}, {3.683381501406728*^9, 
   3.6833815014227285`*^9}, {3.6833905070688224`*^9, 
   3.6833906674909983`*^9}, {3.7160750741233034`*^9, 3.716075076380432*^9}, 
   3.7160751808864098`*^9, {3.7160760969428053`*^9, 3.7160761092445087`*^9}, {
   3.7160761425264125`*^9, 3.716076204461955*^9}, {3.716076350944333*^9, 
   3.716076359436819*^9}, {3.7160763922056932`*^9, 3.71607639476484*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Next we consider a three-drug combination, consisting of two drugs that are \
\[OpenCurlyQuote]synergistic\[CloseCurlyQuote] according to Loewe / \
Chou-Talalay (behaving together as a 3\[Times] dose of one drug), and a third \
drug that is independent (fully uncorrelated responsiveness):\
\>", "Subsubsection",
 CellChangeTimes->{{3.683390808882085*^9, 3.6833908711986494`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugDose", "=", "0.2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgressionTimeThreeDrugs", "[", 
   RowBox[{
   "KI1_", ",", "KI2_", ",", "growthrate_", ",", "ProgressionThreshold_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1internal", "=", "KI1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2internal", "=", "KI2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"gr", "=", "growthrate"}], ";", "\[IndentingNewLine]", 
     RowBox[{"celllossrate", "=", "CellLossRate"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"80", "%", " ", "cell", " ", "loss", " ", "rate"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"dr", "=", 
      RowBox[{"gr", "*", "celllossrate"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rl", "=", "10"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rf1", "=", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rf2", "=", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rfCross", "=", 
      RowBox[{"5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p0", "=", 
      SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", "DrugDose"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"synergy", ",", " ", 
       RowBox[{
        RowBox[{"applied", " ", "ONLY", " ", "to", " ", "drug", " ", "#1"}], 
        " ", "-", " ", 
        RowBox[{
        "we", " ", "are", " ", "saying", " ", "that", " ", "\"\<drug 1\>\"", 
         " ", "in", " ", "the", " ", "model", " ", "is", " ", "the", " ", 
         "sum", " ", "effect", " ", "of", " ", "two", " ", "coadministered", 
         " ", "therapies", " ", "that", " ", "act", " ", "together", " ", 
         "as", " ", "one", " ", "drug", " ", "at", " ", "enhanced", " ", 
         "dose"}]}], ",", " ", 
       RowBox[{"according", " ", "to", " ", 
        RowBox[{"the", " ", "'"}], 
        RowBox[{"synergy", "'"}], " ", "parameter"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"synergy", "=", "3"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"SimulationDuration", "=", "6"}], ";", " ", 
     RowBox[{"(*", "years", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"mysimresultUntreated", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
         "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mysimresultS", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "/", "synergy"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
         "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mysimresultR1", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", 
                    RowBox[{"rl", "/", "synergy"}]}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rf1"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mysimresultR2", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "/", "synergy"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rf2"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mysimresultRR", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", 
                    RowBox[{"rl", "/", "synergy"}]}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rfCross"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PopulationOverTimeTable", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}]}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PopulationOverTimeTable", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "<", 
        "ProgressionThreshold"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"SimulationDuration", "+", "1"}], ")"}], "*", "365"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PopulationOverTimeTable", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ">", "ProgressionThreshold"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6613624139911203`*^9, 3.6613624142151327`*^9}, {
   3.661362651344696*^9, 3.6613626515187054`*^9}, {3.661362741354844*^9, 
   3.6613627415148535`*^9}, {3.661362798060087*^9, 3.6613627981300917`*^9}, {
   3.6614336684773397`*^9, 3.6614336707844715`*^9}, {3.6614339076940217`*^9, 
   3.6614339079890385`*^9}, {3.661433953224626*^9, 3.6614339894016953`*^9}, {
   3.6614346259381027`*^9, 3.6614346261851172`*^9}, {3.661434758042659*^9, 
   3.661434763921995*^9}, {3.661436281480795*^9, 3.6614362820188255`*^9}, {
   3.661436812322157*^9, 3.6614368360745153`*^9}, {3.661438022898398*^9, 
   3.661438023144412*^9}, {3.661438116870773*^9, 3.6614381171697903`*^9}, {
   3.661438410730581*^9, 3.661438437767127*^9}, {3.6614385780331497`*^9, 
   3.6614385975632668`*^9}, {3.6627284035780935`*^9, 
   3.6627284036740985`*^9}, {3.6627284437993937`*^9, 
   3.6627284443304243`*^9}, {3.662728477685332*^9, 3.662728477862342*^9}, {
   3.662728536438692*^9, 3.6627285364926953`*^9}, {3.662728630230057*^9, 
   3.662728630326062*^9}, {3.6627388991014028`*^9, 3.662738899455423*^9}, {
   3.6627445672096*^9, 3.6627445672496023`*^9}, {3.662744606008819*^9, 
   3.662744606041821*^9}, {3.6628115295967283`*^9, 3.6628115296477313`*^9}, {
   3.6628115986546783`*^9, 3.66281159886769*^9}, {3.6628120938450017`*^9, 
   3.662812093890004*^9}, 3.662812423763872*^9, {3.662812636789056*^9, 
   3.6628126396842213`*^9}, {3.6628127097392282`*^9, 3.66281270993424*^9}, {
   3.6628138076690264`*^9, 3.66281380790104*^9}, {3.6628139290019665`*^9, 
   3.662813929278982*^9}, {3.662814041223385*^9, 3.6628140444985723`*^9}, {
   3.6628143892422905`*^9, 3.662814389312295*^9}, {3.6670569383126955`*^9, 
   3.667056938379699*^9}, {3.6670570678151026`*^9, 3.6670570690631742`*^9}, {
   3.667057165447687*^9, 3.667057194073324*^9}, {3.667057895996472*^9, 
   3.667057896067476*^9}, {3.667058088182464*^9, 3.66705808828547*^9}, 
   3.6670581305398865`*^9, {3.6670582892309637`*^9, 3.6670582896839895`*^9}, {
   3.6670583953220315`*^9, 3.6670584158712068`*^9}, {3.6670586395289993`*^9, 
   3.667058639644006*^9}, 3.6670587792949934`*^9, {3.6725390282379165`*^9, 
   3.6725391139738197`*^9}, {3.6725391514379625`*^9, 
   3.6725391723731604`*^9}, {3.67253928933685*^9, 3.6725393310952387`*^9}, {
   3.6738822900281973`*^9, 3.6738822915742855`*^9}, 3.6833714742368755`*^9, {
   3.6833717695042906`*^9, 3.6833717695242906`*^9}, {3.68337867261093*^9, 
   3.683378672618931*^9}, 3.683381501428729*^9, {3.6833908766209593`*^9, 
   3.6833910005380473`*^9}, {3.6833910471657143`*^9, 
   3.6833910582573485`*^9}, {3.6833911868317027`*^9, 
   3.6833912107980733`*^9}, {3.6833913782936535`*^9, 3.68339140725031*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulatePopulationThreeDrugs", "[", "Correlation_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"KIJointDistribution", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KI1Table", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Correlation", "*", "KI1Table"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["Correlation", "2"]}], ")"}], "KI2Table"}]}], 
          ")"}]}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI1", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI2", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"NumberOfTumorsSimulated", "=", "200"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgressionThreshold", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"UntreatedProgressionTimesThreeDrugs", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeThreeDrugs", "[", 
          RowBox[{"1000", ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TwoDrugCombinationProgressionTimesThreeDrugs", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeThreeDrugs", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"IndependentDrugProgressionTimesThreeDrugs", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeThreeDrugs", "[", 
          RowBox[{"1000", ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CombinationProgressionTimesThreeDrugs", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeThreeDrugs", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SurvivalPlotThreeDrugs", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "UntreatedProgressionTimesThreeDrugs", "]"}], "]"}], "[", 
               "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "TwoDrugCombinationProgressionTimesThreeDrugs", "]"}], "]"}],
                "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "IndependentDrugProgressionTimesThreeDrugs", "]"}], "]"}], 
               "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "CombinationProgressionTimesThreeDrugs", "]"}], "]"}], "[", 
               "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "*", 
                RowBox[{"2", "/", "61"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "2000", ",", 
               RowBox[{
                RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"60", "*", "30.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"3", "/", "4"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Progression free survival (months)\>\"", ",", 
           "\"\<Patients (%)\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "250", "}"}], ",", 
           RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}],
         ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Untreated\>\"", ",", 
           "\"\<Two-drug combination\\n(with 3\[Times] synergy)\>\"", ",", 
           "\"\<Monotherapy\\n(independent)\>\"", ",", 
           "\"\<Three-drug combination\>\""}], "}"}]}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.661360802030921*^9, 3.66136103279212*^9}, {
   3.661361351225333*^9, 3.661361365826168*^9}, {3.6613614571693926`*^9, 
   3.661361463497755*^9}, {3.661361520962042*^9, 3.661361609435102*^9}, {
   3.6613621448187237`*^9, 3.6613621450417366`*^9}, {3.661362678256235*^9, 
   3.6613626831595154`*^9}, {3.661433740448456*^9, 3.6614337660409193`*^9}, {
   3.661433883657647*^9, 3.661433894709279*^9}, {3.661433927721167*^9, 
   3.6614339306653357`*^9}, {3.6614374038249893`*^9, 3.661437406496142*^9}, {
   3.661437602874374*^9, 3.661437605448521*^9}, {3.661437639986497*^9, 
   3.661437702442069*^9}, {3.6614384044652224`*^9, 3.6614384168589315`*^9}, {
   3.661438625552868*^9, 3.6614386279930077`*^9}, 3.661438691977667*^9, {
   3.6624189972916536`*^9, 3.6624190236521616`*^9}, {3.662430189432808*^9, 
   3.662430189527813*^9}, {3.662430332119969*^9, 3.6624303356311693`*^9}, {
   3.662813869868584*^9, 3.662813871788694*^9}, {3.6628143046894546`*^9, 
   3.662814306795575*^9}, {3.6629079586422625`*^9, 3.662907959788328*^9}, {
   3.6670570467528977`*^9, 3.6670570485099983`*^9}, {3.667057145677556*^9, 
   3.6670571474016542`*^9}, {3.6670573374205227`*^9, 
   3.6670573386675944`*^9}, {3.6670579193258057`*^9, 3.667057920598879*^9}, {
   3.673882324113147*^9, 3.6738823869277396`*^9}, {3.6833731156221714`*^9, 
   3.683373115626172*^9}, 3.6833786997734838`*^9, {3.6833815014327297`*^9, 
   3.6833815015007334`*^9}, {3.6833910241673985`*^9, 
   3.6833910322378607`*^9}, {3.683391066972847*^9, 3.683391147528455*^9}, {
   3.683391241280817*^9, 3.6833912413578215`*^9}, {3.683391303907399*^9, 
   3.683391336827282*^9}, {3.6833914241252747`*^9, 3.6833916165592813`*^9}, {
   3.6833916488861303`*^9, 3.6833916492901535`*^9}, {3.685597288186344*^9, 
   3.685597324857442*^9}}],

Cell[BoxData[
 RowBox[{"SimulatePopulationThreeDrugs", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.6738823971183224`*^9, 3.673882397473343*^9}, 
   3.683378699780484*^9, 3.683391151133661*^9, 3.6833913428656273`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SynergyVSHeterogeneityComparisonPlot", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", 
              RowBox[{"UntreatedProgressionTimes", "[", "0", "]"}], "]"}], 
             "]"}], "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", 
              RowBox[{"Monotherapy1ProgressionTimes", "[", "0", "]"}], "]"}], 
             "]"}], "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", 
              RowBox[{"CombinationProgressionTimesSynergy", "[", "3", "]"}], 
              "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{"EmpiricalDistribution", "[", 
              RowBox[{"CombinationProgressionTimes", "[", "0", "]"}], "]"}], 
             "]"}], "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"SurvivalFunction", "[", 
             RowBox[{
             "EmpiricalDistribution", "[", 
              "CombinationProgressionTimesThreeDrugs", "]"}], "]"}], "[", "x",
             "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", 
           RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"100", "*", "i"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", 
               RowBox[{"2", "/", "61"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "2000", ",", 
              RowBox[{
               RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
          "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "*", "61", "*", "15"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Progression free survival (months)\>\"", ",", 
        RowBox[{"Rotate", "[", 
         RowBox[{"\"\<Patients (%)\>\"", ",", "0"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "220", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"115", ",", "30"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Red", 
          RowBox[{"(*", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"0.67", ",", "0.1", ",", "0.67"}], "]"}], "*)"}], ",", 
          RowBox[{"Dashing", "[", "None", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Dashing", "[", "None", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Dashing", "[", "None", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<Untreated\>\"", ",", "\"\<Monotherapy\>\"", ",", 
          "\"\<Combination,\\nSynergy: 3\[Times] higher dose\>\"", ",", 
          "\"\<Combination,\\nIndependent drug action (\[Rho]=0.0)\>\"", ",", 
          "\"\<3 Drug Combination,\\n   2 synergistic together (3\[Times] \
higher dose),\\n   1 independent (\[Rho]=0.0)\>\""}], "}"}], ",", "Right"}], 
       "]"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S7C, progression free survival, 3 drug mix of \
synergy and independence.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.673882433198386*^9, 3.673882437571636*^9}, {
   3.673882469154443*^9, 3.673882487623499*^9}, {3.673882518884287*^9, 
   3.6738825278097973`*^9}, {3.6738825598046274`*^9, 3.673882597035757*^9}, {
   3.673882634991928*^9, 3.673882644569476*^9}, {3.673882675137224*^9, 
   3.6738826849437847`*^9}, {3.6738827299693604`*^9, 
   3.6738827941930337`*^9}, {3.6738830316766167`*^9, 3.673883044473349*^9}, {
   3.674746597043511*^9, 3.674746620339546*^9}, {3.6833815015047336`*^9, 
   3.6833815015217347`*^9}, {3.6833916713894176`*^9, 
   3.6833917611995544`*^9}, {3.6833920182092547`*^9, 3.683392033441126*^9}, {
   3.6855973620865707`*^9, 3.685597384166834*^9}, {3.685597414482568*^9, 
   3.6855974151916084`*^9}, {3.7160750818677464`*^9, 3.716075084634905*^9}, 
   3.7160751816784554`*^9, {3.716076280366297*^9, 3.716076291020906*^9}, {
   3.7160763729425917`*^9, 3.716076379661976*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Modeling dose-reduction or antagonistic interactions in combination therapy,
as compared to precision monotherapy.\
\>", "Section",
 CellChangeTimes->{{3.716076487303133*^9, 3.7160765062192144`*^9}, {
  3.716077177819628*^9, 3.716077186059099*^9}}],

Cell[CellGroupData[{

Cell["\<\
A combination that must be administered with lower doses of each agent is \
functionally equivalent to a combination without dose-reduction but with an \
antagonistic drug interactios that causes each drug to act as being \
equivalent to a lower dose.
This scenario can be simulated by adapting the previously defined code for \
\[OpenCurlyQuote]mixed effects\[CloseCurlyQuote] (benefit both from \
uncorrelated responses between drugs, and benefit from synergy), but setting \
the \[OpenCurlyQuote]DoseChange\[CloseCurlyQuote] parameter to be smaller \
than 1.0, indicated that each drug acts as equivalent to a smaller dose than \
monotherapy.

Precision monotherapy, meaning that each patient receives the one drug to \
which their tumor is most sensitive, is simulated as monotherapy but with the \
drug sensitivity parameter (KI) set to the smaller of the two independently \
sampled KI parameters (one KI value for each drug).\
\>", "Subsubsection",
 CellChangeTimes->{{3.716077209256426*^9, 3.7160774063637*^9}, {
  3.7160774551634912`*^9, 3.7160775567633023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulatePopulationPrecisionMonotherapy", "[", 
   RowBox[{"Correlation_", ",", "DoseChange_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"KI2Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"KIJointDistribution", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KI1Table", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Correlation", "*", "KI1Table"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["Correlation", "2"]}], ")"}], "KI2Table"}]}], 
          ")"}]}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI1", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI2", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"NumberOfTumorsSimulated", "=", "200"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgressionThreshold", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"UntreatedProgressionTimesPrecision", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeMixedEffects", "[", 
          RowBox[{"1000", ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "1", ",", 
           "ProgressionThreshold"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MonotherapyProgressionTimesPrecision", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeMixedEffects", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "1", ",", 
           "ProgressionThreshold"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CombinationProgressionTimesPrecision", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeMixedEffects", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "DoseChange", ",", 
           "ProgressionThreshold"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrecisionMonotherapyProgressionTimesPrecision", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeMixedEffects", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "logKI1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "logKI2", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "1", ",", 
           "ProgressionThreshold"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SurvivalPlotPrecision", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "UntreatedProgressionTimesPrecision", "]"}], "]"}], "[", "x",
                "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "MonotherapyProgressionTimesPrecision", "]"}], "]"}], "[", 
               "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "CombinationProgressionTimesPrecision", "]"}], "]"}], "[", 
               "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", 
                 "PrecisionMonotherapyProgressionTimesPrecision", "]"}], 
                "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"100", "*", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", "1", ",", 
                 RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "*", 
                  RowBox[{"2", "/", "61"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", "2000", ",", 
                 RowBox[{
                  RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], 
             ",", "None"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"36", "*", "30.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"3", "/", "4"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Progression free survival (months)\>\"", ",", 
           "\"\<Patients (%)\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "1000", "}"}], ",", 
           RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"60", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.3", ",", "0", ",", "0.6"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "0.015", "]"}]}], "]"}]}], "}"}]}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.706822603666225*^9, 3.706822610609622*^9}, {
   3.706822719938875*^9, 3.7068227505826283`*^9}, {3.706822855834648*^9, 
   3.7068229196522985`*^9}, {3.706822965299909*^9, 3.7068230899580393`*^9}, {
   3.706823411941456*^9, 3.7068234125114884`*^9}, {3.7068894086574354`*^9, 
   3.7068894087354393`*^9}, {3.706889663440008*^9, 3.706889663537013*^9}, {
   3.7068896991170483`*^9, 3.706889699235055*^9}, {3.7069146266262836`*^9, 
   3.7069146266922874`*^9}, 3.706915194913788*^9, {3.706915373745016*^9, 
   3.7069153752091*^9}, 3.706915709738234*^9, {3.70691658033803*^9, 
   3.706916609732711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "simulating", " ", "the", " ", "case", " ", "of", " ", "dose", " ", 
     "reduction", " ", "to", " ", "66", "%", " ", "of", " ", "monotherapy", 
     " ", "dose"}], ",", " ", 
    RowBox[{
    "in", " ", "comparison", " ", "to", " ", "precision", " ", 
     "monotherapy"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SimulatePopulationPrecisionMonotherapy", "[", 
   RowBox[{"0.0", ",", "0.66"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.706889388191264*^9, 3.706889388267269*^9}, {
   3.7068894524089375`*^9, 3.706889456054146*^9}, {3.7069150351636505`*^9, 
   3.7069150498504906`*^9}, 3.7069171998674645`*^9, {3.7160775671638975`*^9, 
   3.716077589580179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6F, Precision monotherapy and dose reduced combination.pdf\>\
\""}], ",", "SurvivalPlotPrecision", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7068895687785935`*^9, 3.706889602434519*^9}, {
  3.706889690673566*^9, 3.706889690692567*^9}, {3.706890129394659*^9, 
  3.7068901298276834`*^9}, {3.7068907742815447`*^9, 3.7068907768396907`*^9}, {
  3.706914841563577*^9, 3.7069148590105753`*^9}, {3.7069148979958053`*^9, 
  3.706914898178816*^9}, {3.7069149540200095`*^9, 3.706914954219021*^9}, {
  3.7069150754199533`*^9, 3.706915078674139*^9}, {3.716077927212491*^9, 
  3.716077957148203*^9}, {3.716077989228038*^9, 3.7160779977715263`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Exploring the effect of variable drug potency (effective dose) and variable \
cross-resistance\
\>", "Section",
 CellChangeTimes->{{3.6818195436645594`*^9, 3.6818195506125717`*^9}, {
  3.683392110429529*^9, 3.6833921381341143`*^9}}],

Cell[TextData[StyleBox["We have so far examined combinations of two equally \
effective monotherapies. More commonly, clinical trials combine the best \
available treatment with other treatments that, by themselves, are less \
effective.\nWe have also mostly examined the most simple scenario of fully \
uncorrelated responses. But tumors can of course be multi-drug resistant, and \
drugs with similar mechanisms can be expected to show activity on an \
overlapping population, that is, having correlated responses. Analysis of \
human clinical trials (Figures 1, 4) show that the observed effects of drugs \
in combination are most often consistent with partially correlated responses, \
and analysis of PDX drug trial data (Figure 2) also shows that drugs most \
often have partially correlated responses.\n\nWe therefore adapt the \
previously described models to vary the relative potency of a second drug and \
to vary correlation in sensitivity to the two drugs.\nWe also assume that the \
more correlated is sensitivity, the more overlapping are resistant \
sub-populations.\nTwo drugs that share a common molecular target (for \
example, trastuzumab and pertuzumab; or methotrexate and pralatrexate) are \
expected to have very highly correlated responses (tumors resistant to one of \
these drugs are likely resistant to the other drug), and similarly, tumor \
sub-populations with mutations that increase their resistance to one drug are \
also likely to be more resistant to the second drug.\nThus, the degree of \
cross-resistance scales with correlation in responsiveness, with a minimum of \
1% cross-resistance as has been used so far.",
 FontSize->16,
 FontWeight->"Plain",
 FontColor->RGBColor[
  0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.6833727718175087`*^9, 3.6833729354508677`*^9}, {3.6833761403000903`*^9, 
   3.6833764146477823`*^9}, {3.683377379249954*^9, 3.6833774898352795`*^9}, {
   3.683377877317442*^9, 3.683377894186407*^9}, {3.683377965663495*^9, 
   3.683378043626954*^9}, {3.6833780747307334`*^9, 3.683378134389146*^9}, {
   3.683378168406091*^9, 3.6833782242992883`*^9}, {3.6833782544580135`*^9, 
   3.683378484433167*^9}, {3.683380994658744*^9, 3.6833810526790624`*^9}, {
   3.6833869784889994`*^9, 3.6833870610797234`*^9}, {3.683387105237249*^9, 
   3.683387164558642*^9}, {3.6833872306344213`*^9, 3.6833876563437705`*^9}, {
   3.68338788536687*^9, 3.683387922471992*^9}, {3.6833895301829476`*^9, 
   3.6833896574052243`*^9}, {3.6833921933252707`*^9, 3.683392617590537*^9}, {
   3.683392682819268*^9, 3.6833928036911817`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SurvivalTimeVariableDoseVariableCrossResistance", "[", 
   RowBox[{
   "KI1_", ",", "KI2_", ",", "growthrate_", ",", "progressionthreshold_", ",",
     "FirstDrugDose_", ",", "SecondDrugDose_", ",", "CrossResistance_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "potency", " ", "of", " ", "each", " ", "drug", " ", "needs", " ", "a", 
       " ", "non"}], "-", 
      RowBox[{
      "zero", " ", "minimum", " ", "to", " ", "be", " ", "enforced"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MinimumDrugPotency", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "changes", " ", "in", " ", "relative", " ", "dose", " ", "of", " ", 
       "the", " ", "first", " ", "and", " ", "second", " ", "drug", " ", 
       "are", " ", "most", " ", "easily", " ", "implemented", " ", "by", " ", 
       "scaling", " ", "KI", " ", "for", " ", "the", " ", "appropriate", " ", 
       "drug"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"KI1internal", "=", 
      RowBox[{"KI1", "/", 
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{"FirstDrugDose", ",", "MinimumDrugPotency"}], "}"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2internal", "=", 
      RowBox[{"KI2", "/", 
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{"SecondDrugDose", ",", "MinimumDrugPotency"}], "}"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"cell", " ", "division", " ", "rate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"gr", "=", "growthrate"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"spontaneous", " ", "cell", " ", "loss", " ", "rate"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"celllossrate", "=", "CellLossRate"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"previously", " ", "defined", " ", "as", " ", "80", "%"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"death", " ", "rate"}], " ", "=", " ", 
       RowBox[{
       "growth", " ", "rate", " ", "\[Times]", " ", "cell", " ", "loss", " ", 
        "factor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dr", "=", 
      RowBox[{"gr", "*", "celllossrate"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"rl", " ", "=", " ", 
        RowBox[{"'", "resistance", " ", 
         RowBox[{"level", "'"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"being", " ", "the", " ", "fold"}], "-", 
        RowBox[{
        "change", " ", "in", " ", "KI", " ", "in", " ", "drug", " ", 
         "resistant", " ", "sub"}], "-", "populations"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rl", "=", "10"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"pre", "-", 
       RowBox[{"existing", " ", "resistance", " ", "frequencies"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resistance", " ", "to", " ", "drug", " ", "1"}], " ", "*)"}], 
     " ", 
     RowBox[{"rf1", "=", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "CrossResistance"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resistance", " ", "to", " ", "drug", " ", "2"}], " ", "*)"}], 
     " ", 
     RowBox[{"rf2", "=", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "CrossResistance"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resistance", " ", "to", " ", "both", " ", "drugs"}], " ", 
      "*)"}], " ", 
     RowBox[{"rfCross", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}], ",", 
         RowBox[{"500", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]], "*", "CrossResistance"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initial", " ", "population", " ", "size"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"p0", "=", 
      SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"drug", " ", "dose"}], ",", " ", 
       RowBox[{"previously", " ", "defined"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d", "=", "DrugDose"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"duration", " ", "of", " ", "numerical", " ", "simulation"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SimulationDuration", "=", "6"}], ";", " ", 
     RowBox[{"(*", "years", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"simulating", " ", "an", " ", "untreated", " ", "tumor"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultUntreated", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
         "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "tumor", " ", "cells", " ",
        "with", " ", "baseline", " ", "drug", " ", "sensitivity"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultS", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
         "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
       "with", " ", "resistance", " ", "to", " ", "drug", " ", "1"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultR1", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rf1"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
       "with", " ", "resistance", " ", "to", " ", "drug", " ", "2"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultR2", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rf2"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
       "with", " ", "resistance", " ", "to", " ", "both", " ", "drugs"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultRR", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogDrugInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rfCross"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Summing", " ", "up", " ", "the", " ", "total", " ", "population", 
         " ", "size", " ", "at", " ", "each", " ", "time"}], ";", " ", 
        RowBox[{"sum", " ", "of", " ", "populations", " ", "S"}]}], ",", " ", 
       "R1", ",", " ", "R2", ",", " ", 
       RowBox[{
        RowBox[{"RR", ".", " ", "Table"}], " ", "has", " ", "an", " ", 
        "entry", " ", "at", " ", "every", " ", "2", " ", 
        RowBox[{"days", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PopulationOverTimeTable", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}]}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.1"}], ")"}], "*", "365"}], 
          ",", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "If", " ", "progression", " ", "threshold", " ", "is", " ", "not", " ",
         "reached", " ", "within", " ", "the", " ", "duration", " ", "of", 
        " ", "the", " ", "simulation"}], ",", " ", 
       RowBox[{
       "return", " ", "a", " ", "number", " ", "larger", " ", "than", " ", 
        "the", " ", "duration", " ", "of", " ", "simulation", " ", 
        RowBox[{"(", 
         RowBox[{
         "this", " ", "can", " ", "be", " ", "used", " ", "to", " ", 
          "identify", " ", "such", " ", "events"}], ")"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PopulationOverTimeTable", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "<", 
        "ProgressionThreshold"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"SimulationDuration", "+", "1"}], ")"}], "*", "365"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"final", " ", 
        RowBox[{"output", ":", " ", 
         RowBox[{
         "the", " ", "earliest", " ", "time", " ", "at", " ", "which", " ", 
          "the", " ", "total", " ", "population", " ", "size", " ", 
          "surpasses", " ", 
          RowBox[{"the", " ", "'"}], "progression", " ", 
          RowBox[{"threshold", "'"}]}]}]}], ",", " ", 
       RowBox[{
       "taken", " ", "in", " ", "this", " ", "file", " ", "to", " ", "be", 
        " ", "twice", " ", "the", " ", "initial", " ", "population"}], ",", 
       " ", 
       RowBox[{
       "though", " ", "it", " ", "could", " ", "be", " ", "varied"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PopulationOverTimeTable", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ">", "ProgressionThreshold"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6818197541475*^9, 3.6818198149996214`*^9}, {
   3.6818198989020023`*^9, 3.681819900091006*^9}, {3.6818343275642786`*^9, 
   3.681834461712937*^9}, {3.681835653340981*^9, 3.681835840354309*^9}, {
   3.681835873514377*^9, 3.681835874264378*^9}, {3.68183591284274*^9, 
   3.681835934246153*^9}, {3.681835974274225*^9, 3.6818361587961125`*^9}, {
   3.681836204513209*^9, 3.681836232945256*^9}, {3.68183631331959*^9, 
   3.6818363196076007`*^9}, {3.6818364561633673`*^9, 
   3.6818365095074673`*^9}, {3.681836588135788*^9, 3.6818365885257883`*^9}, {
   3.682284898456669*^9, 3.682284955439928*^9}, {3.6822851603376474`*^9, 
   3.6822851607036686`*^9}, {3.6822854539904437`*^9, 3.6822854676782265`*^9}, 
   3.68228552822669*^9, {3.683392521318031*^9, 3.683392530942581*^9}, {
   3.683392935086697*^9, 3.6833932750931444`*^9}, {3.683393305519885*^9, 
   3.683393453242334*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
   RowBox[{"Correlation_", ",", "FirstDrugDose_", ",", "SecondDrugDose_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"X1", ",", "X2"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2Table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"KIJointDistribution", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KI1Table", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Correlation", "*", "KI1Table"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["Correlation", "2"]}], ")"}], "KI2Table"}]}], 
          ")"}]}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI1", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI2", "=", 
      RowBox[{"10", "^", 
       RowBox[{"KIJointDistribution", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"NumberOfTumorsSimulated", "=", "500"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgressionThreshold", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"UntreatedSurvivalTimes", "[", 
       RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SurvivalTimeVariableDoseVariableCrossResistance", "[", 
          RowBox[{"1000", ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold", ",", 
           "FirstDrugDose", ",", "SecondDrugDose", ",", "Correlation"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monotherapy1SurvivalTimes", "[", 
       RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SurvivalTimeVariableDoseVariableCrossResistance", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold", ",", 
           "FirstDrugDose", ",", "SecondDrugDose", ",", "Correlation"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monotherapy2SurvivalTimes", "[", 
       RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SurvivalTimeVariableDoseVariableCrossResistance", "[", 
          RowBox[{"1000", ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold", ",", 
           "FirstDrugDose", ",", "SecondDrugDose", ",", "Correlation"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CombinationSurvivalTimes", "[", 
       RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SurvivalTimeVariableDoseVariableCrossResistance", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold", ",", 
           "FirstDrugDose", ",", "SecondDrugDose", ",", "Correlation"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalPlotVariableDoseVariableCrossResistance", "[", 
       RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{"Monotherapy2SurvivalTimes", "[", 
                  RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{"Monotherapy1SurvivalTimes", "[", 
                  RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{"EmpiricalDistribution", "[", 
                 RowBox[{"CombinationSurvivalTimes", "[", 
                  RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "*", 
                RowBox[{"2", "/", "61"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "2000", ",", 
               RowBox[{
                RowBox[{"6", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"36", "*", "30.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"4", "/", "5"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Time (months)\>\"", ",", "\"\<PFS (%)\>\""}], "}"}]}], 
        ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "200", "}"}], ",", 
           RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"55", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}],
         ",", 
        RowBox[{"Filling", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"2", "\[Rule]", 
           RowBox[{"{", "3", "}"}]}], "}"}]}], ",", 
        RowBox[{"FillingStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "6"}], "]"}], ",", 
           RowBox[{"Opacity", "[", "0.35", "]"}]}], "]"}]}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6818197541475*^9, 3.6818198149996214`*^9}, {
   3.6818198989020023`*^9, 3.681819900091006*^9}, {3.6818343275642786`*^9, 
   3.681834461712937*^9}, {3.681835653340981*^9, 3.681835840354309*^9}, {
   3.681835873514377*^9, 3.681835874264378*^9}, {3.68183591284274*^9, 
   3.681835934246153*^9}, {3.681835974274225*^9, 3.6818361587961125`*^9}, {
   3.681836204513209*^9, 3.681836232945256*^9}, {3.68183631331959*^9, 
   3.6818363196076007`*^9}, {3.6818364561633673`*^9, 
   3.6818365095074673`*^9}, {3.681836588135788*^9, 3.6818365885257883`*^9}, {
   3.682284898456669*^9, 3.682284955439928*^9}, {3.6822851603376474`*^9, 
   3.6822851607036686`*^9}, {3.6822854539904437`*^9, 3.6822854676782265`*^9}, 
   3.68228552822669*^9, {3.683392521318031*^9, 3.683392530942581*^9}, {
   3.683392935086697*^9, 3.6833932750931444`*^9}, {3.683393351208498*^9, 
   3.6833933586389227`*^9}, {3.6833933993992543`*^9, 
   3.6833933994042544`*^9}, {3.68339360003273*^9, 3.6833936123674355`*^9}, {
   3.683394071692707*^9, 3.6833941974469*^9}, {3.6833942732092333`*^9, 
   3.6833942745343094`*^9}, {3.6833943498296156`*^9, 
   3.6833943676426344`*^9}, {3.6841993526916904`*^9, 3.684199396202179*^9}, {
   3.7037155511155367`*^9, 3.703715551467557*^9}, {3.716077744110018*^9, 
   3.7160777558536897`*^9}}],

Cell[CellGroupData[{

Cell["Executing one instance:", "Subsubsection",
 CellChangeTimes->{{3.6833945083746843`*^9, 3.683394517198189*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"correlation", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstdrugpotency", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seconddrugpotency", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
  RowBox[{"correlation", ",", "firstdrugpotency", ",", "seconddrugpotency"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6833942120027323`*^9, 3.683394214861896*^9}, 
   3.683394371307844*^9, {3.6833945269607472`*^9, 3.68339455200918*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plotting dependence of median PFS on correlation
(this step is time-consuming)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6856987621533213`*^9, 3.685698776186124*^9}, {
  3.685699818616748*^9, 3.685699827240241*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "executing", " ", "the", " ", "simulation", " ", "across", " ", "a", " ", 
     "range", " ", "of", " ", "correlation", " ", "values"}], ",", " ", 
    RowBox[{
    "from", " ", "0", " ", "to", " ", "1.", " ", "The", " ", "results", " ", 
     "will", " ", "be", " ", "stored", " ", "in", " ", "the", " ", 
     RowBox[{"terms", " ", "'"}], 
     RowBox[{
      RowBox[{"Monotherapy1SurvivalTimes", "[", 
       RowBox[{"correlation", ",", "SecondDrugDose"}], "]"}], "'"}], " ", 
     RowBox[{"and", " ", "'"}], 
     RowBox[{
      RowBox[{"CombinationSurvivalTimes", "[", 
       RowBox[{"Correlation", ",", "SecondDrugDose"}], "]"}], "'"}], " ", 
     "for", " ", "the", " ", "specified", " ", "values", " ", 
     RowBox[{"of", " ", "'"}], 
     RowBox[{"correlation", "'"}], " ", 
     RowBox[{"and", " ", "'"}], 
     RowBox[{
      RowBox[{"SecondDrugDose", "'"}], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CorrelationStepSize", "=", "0.025"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
      RowBox[{"correlation", ",", "1", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0", ",", "1", ",", "CorrelationStepSize"}],
       "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6856988918487396`*^9, 3.6856989094577465`*^9}, {
   3.685699777553399*^9, 3.685699777689407*^9}, {3.6856998313694773`*^9, 
   3.6856999152492743`*^9}, 3.685702850546164*^9, {3.685706855927726*^9, 
   3.685706863067862*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "taking", " ", "the", " ", "median", " ", "PFS", " ", "with", " ", 
     "monotherapy", " ", "in", " ", "these", " ", "simulations"}], ",", " ", 
    RowBox[{
    "computed", " ", "from", " ", "the", " ", "average", " ", "of", " ", 
     "the", " ", "many", " ", 
     RowBox[{"simulations", ".", " ", "Monotherapy"}], " ", "efficacy", " ", 
     "does", " ", "not", " ", "depend", " ", "on", " ", "correlations"}], ",",
     " ", 
    RowBox[{
    "so", " ", "the", " ", "simulation", " ", "at", " ", "different", " ", 
     "correlations", " ", "serve", " ", "as", " ", "simple", " ", "repeats", 
     " ", "of", " ", "the", " ", "monotherapy", " ", "efficacy"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MedianPFSofMonotherapy", "=", 
   RowBox[{
    RowBox[{"Mean", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Median", "[", 
        RowBox[{"Monotherapy1SurvivalTimes", "[", 
         RowBox[{"correlation", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "correlation", ",", "0", ",", "1", ",", "CorrelationStepSize"}], 
        "}"}]}], "]"}], "]"}], "//", "N"}]}]}]], "Input",
 CellChangeTimes->{{3.6856993549532275`*^9, 3.6856993802486744`*^9}, {
   3.6856998090742016`*^9, 3.6856998092732134`*^9}, {3.685699918824479*^9, 
   3.685699990856599*^9}, {3.6857000602325673`*^9, 3.685700095408579*^9}, 
   3.68570285345133*^9, 3.685706864491927*^9, {3.6857124737702274`*^9, 
   3.6857124741012287`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"fitting", " ", "a", " ", "linear"}], "-", "plus", "-", 
    RowBox[{
    "sigmoidal", " ", "curve", " ", "to", " ", "the", " ", "relationship", 
     " ", "between", " ", "response", " ", "correlation", " ", "and", " ", 
     RowBox[{"PFS", ".", " ", "We"}], " ", "attach", " ", "no", " ", 
     "importance", " ", "to", " ", "the", " ", "shape", " ", "of", " ", "the",
      " ", "function"}], " ", "-", " ", 
    RowBox[{
    "it", " ", "is", " ", "merely", " ", "a", " ", "line", " ", "to", " ", 
     "show", " ", "the", " ", "trend"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nh", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"model", "=", 
     RowBox[{"b", "-", 
      RowBox[{"h", "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}], "nh"], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "+", "1"}], ")"}], "nh"], "+", 
         SuperscriptBox["k", "nh"]}]]}], "-", 
      RowBox[{"m", "*", "x"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"sigmoidfit", "=", 
    RowBox[{"NonlinearModelFit", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"correlation", ",", 
          RowBox[{
           RowBox[{"Median", "[", 
            RowBox[{"CombinationSurvivalTimes", "[", 
             RowBox[{"correlation", ",", "1"}], "]"}], "]"}], "/", "30.5"}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "correlation", ",", "0", ",", "1", ",", "CorrelationStepSize"}], 
         "}"}]}], "]"}], ",", "model", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "35"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "5"}], "}"}]}], "}"}], ",", "x"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.6857004448585663`*^9, {3.68570053914596*^9, 3.6857005554098897`*^9}, {
   3.685700592387005*^9, 3.685700592530013*^9}, {3.6857009127793303`*^9, 
   3.6857009131553516`*^9}, {3.6857011974846144`*^9, 3.685701232514618*^9}, {
   3.6857026454594336`*^9, 3.685702689866974*^9}, {3.6857027934198966`*^9, 
   3.6857028011793404`*^9}, {3.6857028605227346`*^9, 3.685702868289179*^9}, {
   3.685703797156307*^9, 3.6857037997634563`*^9}, {3.685703832611335*^9, 
   3.6857039699531903`*^9}, {3.6857068664309387`*^9, 
   3.6857068689700174`*^9}, {3.6857125007232924`*^9, 3.685712500873293*^9}, {
   3.685712730681041*^9, 3.6857127659911146`*^9}, {3.685713245341074*^9, 
   3.68571332939432*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"correlation", ",", 
          RowBox[{
           RowBox[{"Median", "[", 
            RowBox[{"CombinationSurvivalTimes", "[", 
             RowBox[{"correlation", ",", "1"}], "]"}], "]"}], "/", "30.5"}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "correlation", ",", "0", ",", "1", ",", "CorrelationStepSize"}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"correlation", ",", 
          RowBox[{"MedianPFSofMonotherapy", "/", "30.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "correlation", ",", "0", ",", "1", ",", "CorrelationStepSize"}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"correlation", ",", 
          RowBox[{"sigmoidfit", "[", "correlation", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "correlation", ",", "0", ",", "1", ",", "CorrelationStepSize"}], 
         "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Joined", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
         RowBox[{"AbsolutePointSize", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Dashing", "[", 
          RowBox[{"{", 
           RowBox[{"0.05", ",", "0.05"}], "}"}], "]"}], ",", 
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"Filling", "\[Rule]", "None"}], ",", 
    RowBox[{"FillingStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1.0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "33"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "True"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"White", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "40"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.035"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "36", ",", "6"}], "}"}]}], "]"}], ",",
          "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"N", "[", "i", "]"}], ",", "i", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"-", "1"}], ",", "1", ",", 
                RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"N", "[", "i", "]"}], ",", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"-", "1"}], ",", "1", ",", 
                RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], "\[Rule]", "\"\<0.5\>\""}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], "\[Rule]", "\"\<-0.5\>\""}]}], 
           "}"}]}], ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Correlation in response, \[Rho]\>\"", ",", 
       "\"\<Median PFS (months)\>\""}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Simulated PFS as a function of correlation.pdf\>\""}], ",", "%", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.685699470003808*^9, 3.6856996202204*^9}, {
   3.685699652877268*^9, 3.685699712948704*^9}, {3.685699801821787*^9, 
   3.685699803355875*^9}, {3.685700102819003*^9, 3.6857001138096313`*^9}, {
   3.6857003567655277`*^9, 3.6857004134837723`*^9}, {3.6857005660604987`*^9, 
   3.6857005850695863`*^9}, {3.68570067919697*^9, 3.685700718741232*^9}, {
   3.685701456677439*^9, 3.6857015044501715`*^9}, {3.6857028199714155`*^9, 
   3.6857028366713705`*^9}, {3.685702877945731*^9, 3.6857028901454287`*^9}, {
   3.685706874730115*^9, 3.685706877982153*^9}, {3.7160751059791255`*^9, 
   3.7160751112434263`*^9}, 3.716075182479501*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Generating a matrix of results, over a range of correlation strengths (from \
0 to 1 in steps of 0.1) and a range of relative potency of the second drug \
(also from 0 to 1 in steps of 0.1)\n",
 StyleBox["(the first drug\[CloseCurlyQuote]s potency is held constant, and \
the second drug\[CloseCurlyQuote]s potency is adjusted from wholly \
ineffective to having efficacy equal to the first drug)\n\nNote: this step is \
time consuming (possibly up to 1 hour)",
  FontSize->16]
}], "Subsubsection",
 CellChangeTimes->{{3.6833945599016314`*^9, 3.6833946588942933`*^9}, {
  3.683394802008479*^9, 3.6833948493391857`*^9}, {3.6834590587919827`*^9, 
  3.683459125663807*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixOfPFStimes1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
      RowBox[{"correlation", ",", "1", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682290317796194*^9, 3.682290325319214*^9}, {
   3.6822903970713673`*^9, 3.682290451941473*^9}, {3.6822905961678114`*^9, 
   3.682290657262943*^9}, {3.6822907249540744`*^9, 3.6822907883291993`*^9}, {
   3.682344789722104*^9, 3.6823448158378057`*^9}, {3.6823449770153823`*^9, 
   3.6823449795994005`*^9}, {3.683393399425256*^9, 3.6833933994342566`*^9}, 
   3.683394458179813*^9, {3.683394690850121*^9, 3.6833947186207094`*^9}, {
   3.6833947895917687`*^9, 3.683394794769065*^9}, {3.683394859342758*^9, 
   3.6833948855402565`*^9}, {3.683456324896613*^9, 3.683456368242092*^9}, {
   3.6834564089294195`*^9, 3.683456409272439*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Relative", " ", "risk", " ", "is", " ", "calculated", " ", "according", 
     " ", "to", " ", "the", " ", "Cox", " ", "Proportional", " ", "Hazards", 
     " ", "Model"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"with", " ", "'"}], 
      RowBox[{"censoring", "'"}], " ", "of", " ", "any", " ", "simulated", 
      " ", "patients", " ", "that", " ", "remains", " ", "progression"}], "-", 
     RowBox[{"free", " ", "by", " ", "3", " ", 
      RowBox[{"years", ".", " ", 
       RowBox[{"(", 
        RowBox[{"Note", ",", " ", 
         RowBox[{
         "this", " ", "does", " ", "not", " ", "remove", " ", "them", " ", 
          "from", " ", "analysis"}], ",", " ", 
         RowBox[{
         "but", " ", "rather", " ", "caps", " ", "their", " ", "recorded", 
          " ", "survival", " ", "time", " ", "at", " ", "3", " ", "years", 
          " ", "without", " ", 
          RowBox[{"enforcing", " ", "'"}], 
          RowBox[{"progression", "'"}], " ", "at", " ", "3", " ", "years"}]}],
         ")"}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RelativeRisk", "[", 
    RowBox[{"correlation_", ",", "relativepotency_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"YearToCensorAt", "=", "3"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Monotherapy", " ", "1", " ", "outcomes", " ", "shorter", " ", "than", 
        " ", "3", " ", "years"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"M1below3yr", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Monotherapy1SurvivalTimes", "[", 
           RowBox[{"correlation", ",", "relativepotency"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "<=", 
           RowBox[{"YearToCensorAt", "*", "365"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Monotherapy", " ", "1", " ", "outcomes", " ", "longer", " ", "than", 
        " ", "3", " ", "years"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"M1above3yr", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"YearToCensorAt", "*", "365"}]}], "}"}], "]"}], "&"}], 
         ",", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"Monotherapy1SurvivalTimes", "[", 
             RowBox[{"correlation", ",", "relativepotency"}], "]"}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"YearToCensorAt", "*", "365"}]}], "&"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Combination", " ", "outcomes", " ", "shorter", " ", "than", " ", "3", 
        " ", "years"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Cbelow3yr", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"CombinationSurvivalTimes", "[", 
           RowBox[{"correlation", ",", "relativepotency"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "<=", 
           RowBox[{"YearToCensorAt", "*", "365"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Combination", " ", "outcomes", " ", "longer", " ", "than", " ", "3", 
        " ", "years"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Cabove3yr", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"YearToCensorAt", "*", "365"}]}], "}"}], "]"}], "&"}], 
         ",", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"CombinationSurvivalTimes", "[", 
             RowBox[{"correlation", ",", "relativepotency"}], "]"}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"YearToCensorAt", "*", "365"}]}], "&"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Table", " ", 
        RowBox[{"of", " ", "'"}], "event", " ", 
        RowBox[{
         RowBox[{"data", "'"}], ".", " ", "See"}], " ", "Mathematica", " ", 
        "help", " ", "file", " ", "on", " ", "CoxModelFit", " ", "for", " ", 
        "demonstration", " ", "of", " ", 
        RowBox[{"syntax", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"myeventdata", "=", 
       RowBox[{"EventData", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
          "M1below3yr", ",", "M1above3yr", ",", "Cbelow3yr", ",", 
           "Cabove3yr"}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "M1below3yr", "]"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "M1above3yr", "]"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "Cbelow3yr", "]"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "Cabove3yr", "]"}], "}"}]}], "]"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"descriptors", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"\"\<One drug\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", 
             RowBox[{"Sort", "[", 
              RowBox[{"Monotherapy1SurvivalTimes", "[", 
               RowBox[{"correlation", ",", "relativepotency"}], "]"}], "]"}], 
             "]"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"\"\<Two drugs\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", 
             RowBox[{"Sort", "[", 
              RowBox[{"CombinationSurvivalTimes", "[", 
               RowBox[{"correlation", ",", "relativepotency"}], "]"}], "]"}], 
             "]"}], "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"result", ":", " ", 
         RowBox[{
         "the", " ", "relative", " ", "risk", " ", "as", " ", "calculated", 
          " ", "by", " ", "Cox", " ", "Model"}]}], ",", " ", 
        RowBox[{
        "for", " ", "combination", " ", "therapy", " ", "versus", " ", 
         "monotherapy"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.68229096492162*^9, 3.682290982367652*^9}, 
   3.682291017181717*^9, {3.682328508507004*^9, 3.682328575546838*^9}, {
   3.6823449996042194`*^9, 3.6823450024467397`*^9}, {3.682351223497657*^9, 
   3.6823512393265624`*^9}, {3.683394888440422*^9, 3.68339512861616*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "turning", " ", "off", " ", "error", " ", "messsage", " ", "that", " ", 
    "concerns", " ", "the", " ", 
    RowBox[{"program", "'"}], "s", " ", "desire", " ", "for", " ", "more", 
    " ", "significant", " ", "figures"}], " ", "*)"}], 
  RowBox[{
   RowBox[{"Off", "[", 
    RowBox[{"FindRoot", "::", "lstol"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RelativeRiskTable1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RelativeRisk", "[", 
        RowBox[{"correlation", ",", "relativepotency"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<CorrelationVSPotency relative risk table1.csv\>\""}], ",", 
     "RelativeRiskTable1", ",", "\"\<CSV\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6822909411605678`*^9, 3.6822909433215723`*^9}, {
   3.682291020823724*^9, 3.682291026157734*^9}, {3.682296199402138*^9, 
   3.6822962305752373`*^9}, {3.6822964171524467`*^9, 3.682296430384204*^9}, {
   3.6824170494731855`*^9, 3.682417051416296*^9}, 3.683393399442257*^9, 
   3.6833944734786882`*^9, {3.6833951993642063`*^9, 3.6833952091277647`*^9}, {
   3.683395246713915*^9, 3.683395324108341*^9}, {3.68339535449708*^9, 
   3.683395367880845*^9}, {3.6834564216391463`*^9, 3.6834564241592903`*^9}, 
   3.683459044168146*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Repeating the simulations, for a total of 5 times, exporting results\n",
 StyleBox["Note: this step is time consuming (possibly hours)",
  FontSize->16]
}], "Subsection",
 CellChangeTimes->{{3.68229643363939*^9, 3.6822964357755117`*^9}, {
  3.682417062967957*^9, 3.6824170676472244`*^9}, {3.6833953733801594`*^9, 
  3.683395380658576*^9}, {3.683396048264761*^9, 3.6833960542051*^9}, {
  3.6834591081198034`*^9, 3.6834591176403484`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixOfPFStimes2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
      RowBox[{"correlation", ",", "1", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelativeRiskTable2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RelativeRisk", "[", 
      RowBox[{"correlation", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<CorrelationVSPotency relative risk table2.csv\>\""}], ",", 
    "RelativeRiskTable2", ",", "\"\<CSV\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixOfPFStimes3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
      RowBox[{"correlation", ",", "1", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelativeRiskTable3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RelativeRisk", "[", 
      RowBox[{"correlation", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<CorrelationVSPotency relative risk table3.csv\>\""}], ",", 
    "RelativeRiskTable3", ",", "\"\<CSV\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixOfPFStimes4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
      RowBox[{"correlation", ",", "1", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelativeRiskTable4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RelativeRisk", "[", 
      RowBox[{"correlation", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<CorrelationVSPotency relative risk table4.csv\>\""}], ",", 
    "RelativeRiskTable4", ",", "\"\<CSV\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixOfPFStimes5", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
      RowBox[{"correlation", ",", "1", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelativeRiskTable5", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RelativeRisk", "[", 
      RowBox[{"correlation", ",", "relativepotency"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"correlation", ",", "0.0", ",", "1.0", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"relativepotency", ",", "0.0", ",", "1.0", ",", "0.1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<CorrelationVSPotency relative risk table5.csv\>\""}], ",", 
   "RelativeRiskTable5", ",", "\"\<CSV\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.6822964573437457`*^9, 3.6822965190232735`*^9}, {
   3.682296593583538*^9, 3.6822965966317124`*^9}, {3.682417039561618*^9, 
   3.6824170439368687`*^9}, {3.683393399447257*^9, 3.683393399463258*^9}, {
   3.6833953467526364`*^9, 3.683395350521852*^9}, {3.6833960264255114`*^9, 
   3.6833960366730976`*^9}, {3.683456275095764*^9, 3.683456314217002*^9}, {
   3.6834563452177753`*^9, 3.683456374113428*^9}, 3.683456432823786*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Importing results and averaging. This reduces random error from different \
simulations, yielding more precise relative risk values\
\>", "Subsection",
 CellChangeTimes->{{3.682417055239515*^9, 3.6824170584967012`*^9}, {
  3.683395384960822*^9, 3.683395401610774*^9}, {3.6833960605164614`*^9, 
  3.6833960643476806`*^9}, {3.6855975499693174`*^9, 3.685597597449033*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RelativeRiskTable1", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<CorrelationVSPotency relative risk table1.csv\>\""}], ",", 
     "\"\<CSV\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelativeRiskTable2", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<CorrelationVSPotency relative risk table2.csv\>\""}], ",", 
     "\"\<CSV\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelativeRiskTable3", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<CorrelationVSPotency relative risk table3.csv\>\""}], ",", 
     "\"\<CSV\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelativeRiskTable4", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<CorrelationVSPotency relative risk table4.csv\>\""}], ",", 
     "\"\<CSV\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativeRiskTable5", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<CorrelationVSPotency relative risk table5.csv\>\""}], ",", 
      "\"\<CSV\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AverageRelativeRiskTable", "=", 
   RowBox[{"Mean", "[", 
    RowBox[{"{", 
     RowBox[{
     "RelativeRiskTable1", ",", "RelativeRiskTable2", ",", 
      "RelativeRiskTable3", ",", "RelativeRiskTable4", ",", 
      "RelativeRiskTable5"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6824170769677577`*^9, 3.6824171153049507`*^9}, {
  3.683395403654891*^9, 3.683395408123147*^9}, {3.6833954648053885`*^9, 
  3.6833954651014056`*^9}}],

Cell[CellGroupData[{

Cell["heatmap of relative risk", "Subsubsection",
 CellChangeTimes->{{3.6833954761890397`*^9, 3.6833954863026185`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Defining", " ", "a", " ", "custom", " ", "color", " ", "scheme"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "ColorData", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ColorData", "[", "\"\<MyCustom\>\"", "]"}], "=", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Range", "[", "7", "]"}], "-", "1"}], ")"}], "/", 
             "7"}], ",", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{
                RowBox[{"ColorData", "[", 
                 RowBox[{"3", ",", "6"}], "]"}], ",", "0.5"}], "]"}], ",", 
              RowBox[{"ColorData", "[", 
               RowBox[{"3", ",", "6"}], "]"}], ",", 
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ColorData", "[", "\"\<AvocadoColors\>\"", "]"}], 
                   "[", "0.5", "]"}], ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"3", ",", "6"}], "]"}]}], "}"}], ",", "0.5"}], 
               "]"}], ",", 
              RowBox[{
               RowBox[{"ColorData", "[", "\"\<AvocadoColors\>\"", "]"}], "[", 
               "0.5", "]"}], ",", 
              RowBox[{
               RowBox[{"ColorData", "[", "\"\<AvocadoColors\>\"", "]"}], "[", 
               "0.75", "]"}], ",", 
              RowBox[{
               RowBox[{"ColorData", "[", "\"\<AvocadoColors\>\"", "]"}], "[", 
               "1", "]"}]}], "}"}]}], "}"}], "]"}], ",", "x"}], "]"}]}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Protect", "[", "ColorData", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.68229312893641*^9, 3.6822932476877303`*^9}, {
   3.682293843312046*^9, 3.6822938555250688`*^9}, {3.6822938905491323`*^9, 
   3.68229389528214*^9}, {3.682293960848255*^9, 3.682294024966388*^9}, {
   3.682294071412481*^9, 3.6822941268555827`*^9}, {3.682294244656803*^9, 
   3.6822943356990557`*^9}, {3.682294368734164*^9, 3.6822944058092527`*^9}, {
   3.682295023551713*^9, 3.682295039094741*^9}, {3.6823538283246446`*^9, 
   3.682353844362562*^9}, {3.6823784994963245`*^9, 3.682378553550416*^9}, {
   3.6823786256505404`*^9, 3.6823786560622797`*^9}, {3.6823786939284453`*^9, 
   3.6823786992077475`*^9}, 3.682378901385311*^9, {3.6823789326330986`*^9, 
   3.682378939341482*^9}, 3.683395432340532*^9, {3.6840832132081976`*^9, 
   3.684083266735259*^9}, {3.6840832980850525`*^9, 3.684083319655286*^9}, {
   3.6840833660789413`*^9, 3.6840833757164927`*^9}, 3.6840834063972473`*^9, {
   3.684083448101633*^9, 3.684083595862084*^9}, {3.6840836330512114`*^9, 
   3.6840836370074377`*^9}, {3.6854623110481095`*^9, 3.6854623130661144`*^9}}],

Cell[BoxData[
 RowBox[{"ArrayPlot", "[", 
  RowBox[{
   RowBox[{"Reverse", "[", "AverageRelativeRiskTable", "]"}], ",", 
   RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<MyCustom\>\"", "]"}], "[", 
       RowBox[{"1", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1.4", "-", 
           RowBox[{"1.4", "*", "#"}]}], ")"}], "1"]}], "]"}], "&"}], ")"}]}], 
   ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1000", "}"}], ",", 
      RowBox[{"{", "220", "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"50", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "\"\<1.0\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "\"\<0.5\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"11", ",", "\"\<0.0\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}]}], "}"}], ",", 
        "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "\"\<0.0\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "\"\<0.5\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"11", ",", "\"\<1.0\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}]}], "}"}], ",", 
        "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Response correlation\>\"", ",", 
      "\"\<Relative activity of second drug\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.684083271526533*^9, 3.6840832792099724`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CorrelationVsPotencyHeatmap", "=", 
   RowBox[{"ArrayPlot", "[", 
    RowBox[{
     RowBox[{"Reverse", "[", "AverageRelativeRiskTable", "]"}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<MyCustom\>\"", "]"}], "[", 
         RowBox[{"1", "*", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1.4", "-", 
             RowBox[{"1.4", "*", "#"}]}], ")"}], "1"]}], "]"}], "&"}], 
       ")"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "220", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "\"\<1.0\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "\"\<0.5\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"11", ",", "\"\<0.0\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}]}], "}"}], ",", 
          "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "\"\<0.0\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "\"\<0.5\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"11", ",", "\"\<1.0\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}]}], "}"}], ",", 
          "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Response correlation\>\"", ",", 
        "\"\<Relative activity of second drug\>\""}], "}"}]}], ",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4.5", ",", "0.5"}], "}"}], ",", "0.4"}], "]"}], ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10.5", ",", "6.5"}], "}"}], ",", "0.4"}], "]"}], ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4.5", ",", "6.5"}], "}"}], ",", "0.4"}], "]"}], ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10.5", ",", "0.5"}], "}"}], ",", "0.4"}], "]"}], ",", 
        "Black", ",", 
        RowBox[{"FontSize", "\[Rule]", "11"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<1\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"4.5", ",", "6.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<2\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"10.5", ",", "6.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<3\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"4.5", ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Text", "[", 
         RowBox[{"\"\<4\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"10.5", ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6G, Relative risk heatmap.pdf\>\""}], ",", 
    "CorrelationVsPotencyHeatmap", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.6840838535778246`*^9, 3.7160751833265495`*^9, {3.7160830948600636`*^9, 
   3.716083095132079*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RelativeRiskColorscale", "=", 
   RowBox[{
    RowBox[{"ContourPlot", "[", 
     RowBox[{"y", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0.4", ",", "1"}], "}"}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<MyCustom\>\"", "]"}], "[", 
          RowBox[{"1", "*", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1.4", "-", 
              RowBox[{"1.4", "*", "#"}]}], ")"}], "1"]}], "]"}], "&"}], 
        ")"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
      RowBox[{"Contours", "\[Rule]", "50"}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"False", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.2"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0.4", ",", "1", ",", "0.1"}], "}"}]}], "]"}],
            ",", "None"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "220", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "10"}], ",", 
      RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{",", "\"\<Hazard Ratio\>\""}], "}"}]}]}], "]"}], 
    RowBox[{"(*", " ", 
     RowBox[{
     "this", " ", "next", " ", "part", " ", "is", " ", "necessary", " ", "to",
       " ", "remove", " ", "mesh", " ", "lines", " ", "from", " ", "the", " ",
       "exported", " ", "PDF"}], " ", "*)"}], "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"r_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "RGBColor", ",", "Hue", ",", "CMYKColor", ",", "GrayLevel"}], 
             "}"}], ",", 
            RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ")"}]}], ",", 
       "i___"}], "}"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "r", "]"}], ",", "r", ",", "i"}], "}"}]}]}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6G, relative risk colorscale.pdf\>\""}], ",", 
    "RelativeRiskColorscale", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6822944214273233`*^9, 3.682294456328418*^9}, {
   3.6822949752016163`*^9, 3.6822950065336795`*^9}, {3.682295048911759*^9, 
   3.6822952502672*^9}, {3.6822953408833904`*^9, 3.6822953508084097`*^9}, {
   3.6822956035078807`*^9, 3.6822956078948884`*^9}, {3.682326590468998*^9, 
   3.6823266101551237`*^9}, {3.682326663974202*^9, 3.682326688019577*^9}, {
   3.682328660339688*^9, 3.682328694842661*^9}, {3.6823287396402235`*^9, 
   3.6823287569842157`*^9}, {3.682378124938901*^9, 3.682378171199547*^9}, 
   3.6823782072606096`*^9, {3.682378524874776*^9, 3.682378525031785*^9}, {
   3.68237887601086*^9, 3.682378879213043*^9}, 3.6823789504841194`*^9, {
   3.6823789897243643`*^9, 3.682378990832427*^9}, 3.6824171273156376`*^9, {
   3.6824213530863376`*^9, 3.682421353945387*^9}, {3.683395490635866*^9, 
   3.6833955119690866`*^9}, {3.6833955612049026`*^9, 3.6833955757177324`*^9}, 
   3.684082355832158*^9, 3.6840838551519146`*^9, 3.7160751840615916`*^9, {
   3.716083106668739*^9, 3.7160831068917513`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RelativeRiskHorizontalColorscale", "=", 
   RowBox[{
    RowBox[{"ContourPlot", "[", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0.4", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<MyCustom\>\"", "]"}], "[", 
          RowBox[{"1", "*", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1.4", "-", 
              RowBox[{"1.4", "*", "#"}]}], ")"}], "1"]}], "]"}], "&"}], 
        ")"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
      RowBox[{"Contours", "\[Rule]", "50"}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"False", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0.4", ",", "1", ",", "0.1"}], "}"}]}], "]"}],
            ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "220", "}"}], ",", 
         RowBox[{"{", "220", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "10"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Hazard Ratio\>\"", ","}], "}"}]}], ",", 
      RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
    RowBox[{"(*", " ", 
     RowBox[{
     "this", " ", "next", " ", "part", " ", "is", " ", "necessary", " ", "to",
       " ", "remove", " ", "mesh", " ", "lines", " ", "from", " ", "the", " ",
       "exported", " ", "PDF"}], " ", "*)"}], "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"r_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "RGBColor", ",", "Hue", ",", "CMYKColor", ",", "GrayLevel"}], 
             "}"}], ",", 
            RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ")"}]}], ",", 
       "i___"}], "}"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "r", "]"}], ",", "r", ",", "i"}], "}"}]}]}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 6G, relative risk colorscale, horizontal.pdf\>\""}], ",", 
    "RelativeRiskHorizontalColorscale", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6823531330298758`*^9, 3.682353258943078*^9}, {
   3.6823790112745967`*^9, 3.682379020058099*^9}, 3.682417133584996*^9, {
   3.6833955474151134`*^9, 3.6833955530844383`*^9}, 3.68339558756041*^9, {
   3.6834592195551777`*^9, 3.683459220049206*^9}, 3.6840823908731623`*^9, 
   3.6840838618802996`*^9, 3.7160751860377045`*^9, {3.716083116781317*^9, 
   3.716083116988329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Point1Plot", "=", 
   RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
    RowBox[{"0.6", ",", "1", ",", "0.4"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682351421393976*^9, 3.682351446782428*^9}, {
   3.68235152095267*^9, 3.6823516110828257`*^9}, {3.6824172877248125`*^9, 
   3.6824173272080708`*^9}, {3.683459183691126*^9, 3.68345918603226*^9}, {
   3.684082715776746*^9, 3.684082733380753*^9}, {3.6840829261417785`*^9, 
   3.6840829576495805`*^9}, 3.6840830176350117`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Point2Plot", "=", 
   RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
    RowBox[{"0.6", ",", "1", ",", "1.0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682351421393976*^9, 3.682351446782428*^9}, {
   3.68235152095267*^9, 3.6823516110828257`*^9}, {3.6824172877248125`*^9, 
   3.6824173272080708`*^9}, {3.683459183691126*^9, 3.68345918603226*^9}, {
   3.684082715776746*^9, 3.684082733380753*^9}, {3.6840829261417785`*^9, 
   3.6840829600327168`*^9}, 3.684083018963087*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Point3Plot", "=", 
   RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
    RowBox[{"0.0", ",", "1", ",", "0.4"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682351421393976*^9, 3.682351446782428*^9}, {
   3.68235152095267*^9, 3.6823516110828257`*^9}, {3.6824172877248125`*^9, 
   3.6824173272080708`*^9}, {3.683459183691126*^9, 3.68345918603226*^9}, {
   3.684082715776746*^9, 3.684082733380753*^9}, {3.6840829261417785`*^9, 
   3.6840829626608667`*^9}, 3.6840830201741567`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Point4Plot", "=", 
   RowBox[{"SimulatePopulationVariableDoseVariableCrossResistance", "[", 
    RowBox[{"0.0", ",", "1", ",", "1.0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682351421393976*^9, 3.682351446782428*^9}, {
   3.68235152095267*^9, 3.6823516110828257`*^9}, {3.6824172877248125`*^9, 
   3.6824173272080708`*^9}, {3.683459183691126*^9, 3.68345918603226*^9}, {
   3.684082715776746*^9, 3.684082733380753*^9}, {3.6840829261417785`*^9, 
   3.6840829637729306`*^9}, 3.6840830291166677`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"adjusting", " ", "icon", " ", "size"}], " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"markerscaling", "=", "160"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"CorrelationVsPotencySurvivalCurves", "=", 
    RowBox[{"GraphicsGrid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"Point1Plot", ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "2000", ",", 
                   RowBox[{
                    RowBox[{"6", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"100", "*", "i"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "1", ",", 
                   RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{",", "\"\<Patients (%)\>\""}], "}"}]}], ",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "1", "]"}], ",", "White", ",", 
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "1", "]"}], ",", "Black", ",", 
                    RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], 
                   "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
                  "Black", ",", 
                  RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"\"\<1\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"18", "*", "30.5"}], ",", "0.88"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "markerscaling"}], 
              "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Show", "[", 
           RowBox[{"Point2Plot", ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "2000", ",", 
                   RowBox[{
                    RowBox[{"6", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "1", ",", 
                   RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], ",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "1", "]"}], ",", "White", ",", 
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "1", "]"}], ",", "Black", ",", 
                    RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], 
                   "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
                  "Black", ",", 
                  RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"\"\<2\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"18", "*", "30.5"}], ",", "0.88"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "markerscaling"}], 
              "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"Point3Plot", ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "*", 
                    RowBox[{"2", "/", "61"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "2000", ",", 
                   RowBox[{
                    RowBox[{"6", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"100", "*", "i"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "1", ",", 
                   RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<Patients (%)\>\""}], 
              "}"}]}], ",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "1", "]"}], ",", "White", ",", 
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "1", "]"}], ",", "Black", ",", 
                    RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], 
                   "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
                  "Black", ",", 
                  RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"\"\<3\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"18", "*", "30.5"}], ",", "0.88"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "markerscaling"}], 
              "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Show", "[", 
           RowBox[{"Point4Plot", ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "*", 
                    RowBox[{"2", "/", "61"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "2000", ",", 
                   RowBox[{
                    RowBox[{"6", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "1", ",", 
                   RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<PFS (months)\>\"", ","}], "}"}]}], ",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "1", "]"}], ",", "White", ",", 
                  RowBox[{"EdgeForm", "[", 
                   RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "1", "]"}], ",", "Black", ",", 
                    RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], 
                   "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
                  "Black", ",", 
                  RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"\"\<4\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"18", "*", "30.5"}], ",", "0.88"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "markerscaling"}], 
              "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Spacings", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "60"}], ",", 
         RowBox[{"-", "40"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "240", "}"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 6G, Simulated combinations at different correlation, \
potency.pdf\>\""}], ",", "CorrelationVsPotencySurvivalCurves", ",", 
      "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.682351615082054*^9, 3.682351677268611*^9}, {
   3.6823517233382463`*^9, 3.6823519416967354`*^9}, {3.68235214144116*^9, 
   3.68235235857858*^9}, {3.682352389911372*^9, 3.6823524371570745`*^9}, {
   3.682352691955648*^9, 3.6823528022689576`*^9}, {3.682352849882681*^9, 
   3.6823529082330184`*^9}, {3.6823530737674866`*^9, 3.6823530958537493`*^9}, 
   3.6823533135011983`*^9, {3.6823536411399384`*^9, 3.6823536412569447`*^9}, {
   3.682353719339411*^9, 3.6823537349163017`*^9}, {3.6823543979492254`*^9, 
   3.6823544755966663`*^9}, 3.6824174230205507`*^9, {3.683395637300255*^9, 
   3.68339564612976*^9}, {3.683395860428017*^9, 3.6833959491970944`*^9}, {
   3.6833959948327045`*^9, 3.6833959974418535`*^9}, {3.684082753832923*^9, 
   3.6840828556987495`*^9}, {3.684082993810649*^9, 3.6840830406243267`*^9}, {
   3.6840830712930803`*^9, 3.684083101618815*^9}, {3.684199567729663*^9, 
   3.684199567929663*^9}, {3.6841999896430674`*^9, 3.68419998981907*^9}, 
   3.716075186734744*^9, {3.7160831312121425`*^9, 3.7160831314201546`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "End of all figures and simulations in the main text.\n",
 StyleBox["What follows are two explorations of different possible model \
structures: firstly, Gompertz growth kinetics; secondly, a model of cytotoxic \
therapy administered in cycles.\nThe result that independent drug action is \
sufficient for benefit in a drug combination is demonstrated also in these \
alternative models.",
  FontSize->24]
}], "Title",
 CellChangeTimes->{{3.6855976525841866`*^9, 3.6855977362809734`*^9}, {
  3.685702916191919*^9, 3.6857029866959515`*^9}}],

Cell[CellGroupData[{

Cell["Exploring the effect of Gompertz growth kinetics", "Section",
 CellChangeTimes->{{3.685462386673316*^9, 3.68546240382936*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Gompertz", "[", "t_", "]"}], ":=", 
   RowBox[{"a", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "b"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "c"}], "*", "t"}], "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "set", " ", "of", " ", "parameters", " ", "gives", " ", "a", 
     " ", "maximum", " ", "population", " ", "size", " ", "of", " ", "4"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"a", " ", "population", " ", "at", " ", "t"}], "=", 
     RowBox[{"0", " ", "of", " ", "1"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "a", " ", "growth", " ", "rate", " ", "at", " ", "t"}], "=", 
     RowBox[{"0", " ", "of", " ", "1", " ", 
      RowBox[{"(", 
       RowBox[{
       "we", " ", "shall", " ", "adjust", " ", "this", " ", "subsequently"}], 
       ")"}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GompertzParameters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "4"}], ",", 
     RowBox[{"b", "\[Rule]", 
      RowBox[{"Log", "[", "4", "]"}]}], ",", 
     RowBox[{"c", "\[Rule]", 
      RowBox[{"1", "/", 
       RowBox[{"Log", "[", "4", "]"}]}]}]}], "}"}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Gompertz", "[", "t", "]"}], "/.", "GompertzParameters"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "4"}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Time, aligned so G(0)=1\>\"", ",", 
      "\"\<Population size, G(t)\>\""}], "}"}]}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.685463689350868*^9, 3.68546369034087*^9}, {
  3.6854643286174283`*^9, 3.685464332139434*^9}, {3.685464555708802*^9, 
  3.6854646623469734`*^9}, {3.685465063705013*^9, 3.68546511032382*^9}, {
  3.6854652227636423`*^9, 3.6854652376706657`*^9}, {3.6854653290778103`*^9, 
  3.6854653953469167`*^9}}],

Cell[CellGroupData[{

Cell["\<\
The characteristic feature of Gompertz growth kinetics is that relative \
growth rate decreases linearly with respect to the logarithm of the \
population size, until ultimately the population size reaches an asymptote \
and growth rate is effectively zero:\
\>", "Subsubsection",
 CellChangeTimes->{{3.685464224442249*^9, 3.685464287278349*^9}, {
  3.6854647444321003`*^9, 3.6854647446421003`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LinearModelFit", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{"Gompertz", "[", "t", "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Gompertz", "'"}], "[", "t", "]"}], "/", 
          RowBox[{"Gompertz", "[", "t", "]"}]}]}], "}"}], "/.", 
       "GompertzParameters"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"-", "4"}], ",", "4", ",", "0.1"}], "}"}]}], "]"}], ",", 
    "logp", ",", "logp"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", 
          RowBox[{"Gompertz", "[", "t", "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Gompertz", "'"}], "[", "t", "]"}], "/", 
         RowBox[{"Gompertz", "[", "t", "]"}]}]}], "}"}], "/.", 
      "GompertzParameters"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "7"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\!\(\*SubscriptBox[\(Log\), \(10\)]\) G(t)\>\"", " ", ",", 
        RowBox[{"Rotate", "[", 
         RowBox[{
         "\"\<Relative\\ngrowth\\nrate:\\n\\n\!\(\*FractionBox[\(G' \
\((t)\)\), \(G \((t)\)\)]\)\>\"", ",", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"1", "-", 
      RowBox[{"1.66", "*", "logp"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"logp", ",", 
       RowBox[{"-", "3"}], ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Red", ",", "Dashed"}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "500", "}"}], ",", 
      RowBox[{"{", "220", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6854629862910743`*^9, 3.685463029755169*^9}, {
  3.6854643667135*^9, 3.6854645328257675`*^9}, {3.685464687793011*^9, 
  3.685464703469036*^9}, {3.6854654066869345`*^9, 3.68546544114999*^9}, {
  3.6854656250102863`*^9, 3.6854656711563587`*^9}, {3.6855977520698767`*^9, 
  3.6855977801064806`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "We will implement Gompertz kinetics in our previously established model \
structure by setting growth rate at each time to depend on the population \
size at that time, according to the relationship plotted above (relative \
growth rate = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"1.66", "\[Times]", 
     RowBox[{
      SubscriptBox["log", "10"], "(", 
      RowBox[{"relative", " ", "population", " ", "size"}], ")"}]}]}], 
   TraditionalForm]]],
 ". (where \[OpenCurlyQuote]relative population size\[CloseCurlyQuote] is in \
respect to the population at t=0, being ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", "10"], TraditionalForm]]],
 " cells in the simulation above."
}], "Subsubsection",
 CellChangeTimes->{{3.68546545429801*^9, 3.685465565080187*^9}, {
  3.685465699822404*^9, 3.6854657729035234`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "function", " ", "describing", " ", "drug", " ", "response", " ", "over", 
     " ", 
     RowBox[{"time", ".", " ", "Most"}], " ", "simply"}], ",", " ", 
    RowBox[{"therapy", " ", "is", " ", "continuous"}], ",", " ", 
    RowBox[{
     RowBox[{
     "but", " ", "this", " ", "function", " ", "can", " ", "be", " ", "used", 
      " ", "to", " ", "describe", " ", "time"}], "-", 
     RowBox[{"dependent", " ", "therapy", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", ".", "g", ".", " ", "periodic"}], " ", "cycles", " ", 
        "of", " ", "treatment"}], ")"}]}]}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DrugTreatmentOverTime", "[", 
     RowBox[{"t_", ",", "RelativeGrowthDuringTreatment_"}], "]"}], ":=", 
    "RelativeGrowthDuringTreatment"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"continuous", " ", "therapy"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "response", " ", "of", " ", "growth", " ", "to", " ", "drug", " ", 
       "treatment"}], " ", "-", " ", 
      RowBox[{"a", " ", "simple", " ", "Hill", " ", "function"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "hyperbolic", " ", "in", " ", "the", " ", "case", " ", "of", " ", 
       "Hill", " ", "Coefficient", " ", "NH"}], "=", 
      RowBox[{
       RowBox[{"1.", " ", "d"}], " ", "=", " ", 
       RowBox[{"drug", " ", "dose"}]}]}], ",", " ", 
     RowBox[{"KI", " ", "=", " ", 
      RowBox[{"drug", " ", "sensitivity", " ", 
       RowBox[{"(", "IC50", ")"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DrugInhibitionModel", "=", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"drug", "/", "KI"}], ")"}], "NH"]}]]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"same", " ", "model", " ", "as", " ", "above"}], ",", " ", 
     RowBox[{
      RowBox[{
      "but", " ", "expressing", " ", "drug", " ", "concentration", " ", "and",
        " ", "KI", " ", "as", " ", "their", " ", 
       RowBox[{"logarithms", ".", " ", "This"}], " ", "makes", " ", "for", 
       " ", "easier", " ", "plotting", " ", "on", " ", "a", " ", "log"}], "-", 
      RowBox[{"scale", " ", "of", " ", "drug", " ", "concentration"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LogDrugInhibitionModel", "=", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["10", "LogDrug"], "/", 
          SuperscriptBox["10", "LogKI"]}], ")"}], "NH"]}]]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DrugDose", "=", "0.2"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6855938026749845`*^9, 3.6855938064582005`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "as", " ", "its", " ", 
     "inputs", " ", "\[IndentingNewLine]", "KI", " ", "for", " ", "drug", " ",
      "1", " ", 
     RowBox[{"(", "KI1", ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"KI", " ", "for", " ", "drug", " ", "2", " ", 
     RowBox[{"(", "KI2", ")"}]}], ",", "\[IndentingNewLine]", 
    "ProgressionThreshold", ",", " ", 
    RowBox[{
    "being", " ", "how", " ", "large", " ", "an", " ", "increase", " ", "in", 
     " ", "tumor", " ", "volume", " ", "is", " ", "our", " ", "output", " ", 
     RowBox[{"(", "2", ")"}]}], ",", " ", "and", ",", "\[IndentingNewLine]", 
    "growthratenumber", ",", " ", 
    RowBox[{
    "which", " ", "indicates", " ", "which", " ", "value", " ", "from", " ", 
     "the", " ", "list", " ", "of", " ", "randomly", " ", "generated", " ", 
     "growth", " ", "rates", " ", "is", " ", "being", " ", "taken", " ", "in",
      " ", "this", " ", "particular", " ", "instance", " ", "of", " ", "the", 
     " ", 
     RowBox[{"simulation", ".", " ", "This"}], " ", "takes", " ", "integer", 
     " ", "values", " ", "indicating", " ", "a", " ", "position", " ", "in", 
     " ", "the", " ", "previously", " ", "generated", " ", 
     RowBox[{"list", " ", "'"}], 
     RowBox[{
      RowBox[{"DistributionOfGrowthRates", "'"}], "."}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProgressionTimeGompertz", "[", 
    RowBox[{
    "KI1_", ",", "KI2_", ",", "growthrate_", ",", "ProgressionThreshold_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KI1internal", "=", "KI1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"KI2internal", "=", "KI2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"cell", " ", "division", " ", "rate"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gr", "=", "growthrate"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"spontaneous", " ", "cell", " ", "death", " ", "rate"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"celllossrate", "=", "CellLossRate"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"previously", " ", "defined", " ", "as", " ", "80", "%"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "rate"}], " ", "=", " ", 
        RowBox[{
        "growth", " ", "rate", " ", "\[Times]", " ", "cell", " ", "loss", " ",
          "factor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dr", "=", 
       RowBox[{"gr", "*", "celllossrate"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"rl", " ", "=", " ", 
         RowBox[{"'", "resistance", " ", 
          RowBox[{"level", "'"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"being", " ", "the", " ", "fold"}], "-", 
         RowBox[{
         "change", " ", "in", " ", "KI", " ", "in", " ", "drug", " ", 
          "resistant", " ", "sub"}], "-", "populations"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rl", "=", "10"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"pre", "-", 
        RowBox[{"existing", " ", "resistance", " ", "frequencies"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "drug", " ", "1"}], " ", "*)"}], 
      " ", 
      RowBox[{"rf1", "=", 
       RowBox[{"500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "drug", " ", "2"}], " ", "*)"}], 
      " ", 
      RowBox[{"rf2", "=", 
       RowBox[{"500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "both", " ", "drugs"}], " ", 
       "*)"}], " ", 
      RowBox[{"rfCross", "=", 
       RowBox[{"5", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"initial", " ", "population", " ", "size"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"p0", "=", 
       SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"relative", " ", "growth", " ", "rate"}], " ", "=", " ", 
         "RGR"}], " ", ";", " ", 
        RowBox[{
        "here", " ", "is", " ", "where", " ", "we", " ", "implement", " ", 
         "Gompertzian", " ", "kinetics"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RGR", "[", "p_", "]"}], ":=", 
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"1", "-", 
           RowBox[{"1.66", "*", 
            RowBox[{"Log", "[", 
             RowBox[{"10", ",", 
              RowBox[{"p", "/", "p0"}]}], "]"}]}]}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"drug", " ", "dose"}], ",", " ", 
        RowBox[{"previously", " ", "defined"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", "DrugDose"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"duration", " ", "of", " ", "numerical", " ", "simulation"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SimulationDuration", "=", "4"}], ";", " ", 
      RowBox[{"(*", "years", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"simulating", " ", "an", " ", "untreated", " ", "tumor"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresultUntreated", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
          "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "simulating", " ", "growth", " ", "of", " ", "tumor", " ", "cells", 
        " ", "with", " ", "baseline", " ", "drug", " ", "sensitivity"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresult", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pS", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pS", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pS", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pS", "[", "0", "]"}], "\[Equal]", "p0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pR1", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pR1", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pR1", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pR1", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rf1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pR2", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pR2", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pR2", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pR2", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rf2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pRR", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pRR", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pRR", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pRR", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rfCross"}]}]}], "\[IndentingNewLine]", "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"pS", ",", "pR1", ",", "pR2", ",", "pRR"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Summing", " ", "up", " ", "the", " ", "total", " ", "population", 
          " ", "size", " ", "at", " ", "each", " ", "time"}], ";", " ", 
         RowBox[{"sum", " ", "of", " ", "populations", " ", "S"}]}], ",", " ",
         "R1", ",", " ", "R2", ",", " ", 
        RowBox[{
         RowBox[{"RR", ".", " ", "Table"}], " ", "has", " ", "an", " ", 
         "entry", " ", "at", " ", "every", " ", "2", " ", 
         RowBox[{"days", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PopulationOverTimeTable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pS", "[", "t", "]"}], "+", 
              RowBox[{"pR1", "[", "t", "]"}], "+", 
              RowBox[{"pR2", "[", "t", "]"}], "+", 
              RowBox[{"pRR", "[", "t", "]"}]}], ")"}], "/.", 
            "mysimresult"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SimulationDuration", "-", "0.1"}], ")"}], "*", "365"}], 
           ",", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "progression", " ", "threshold", " ", "is", " ", "not", 
         " ", "reached", " ", "within", " ", "the", " ", "duration", " ", 
         "of", " ", "the", " ", "simulation"}], ",", " ", 
        RowBox[{
        "return", " ", "a", " ", "number", " ", "larger", " ", "than", " ", 
         "the", " ", "duration", " ", "of", " ", "simulation", " ", 
         RowBox[{"(", 
          RowBox[{
          "this", " ", "can", " ", "be", " ", "used", " ", "to", " ", 
           "identify", " ", "such", " ", "events"}], ")"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PopulationOverTimeTable", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "<", 
         "ProgressionThreshold"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "+", "1"}], ")"}], "*", "365"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"final", " ", 
         RowBox[{"output", ":", " ", 
          RowBox[{
          "the", " ", "earliest", " ", "time", " ", "at", " ", "which", " ", 
           "the", " ", "total", " ", "population", " ", "size", " ", 
           "surpasses", " ", 
           RowBox[{"the", " ", "'"}], "progression", " ", 
           RowBox[{"threshold", "'"}]}]}]}], ",", " ", 
        RowBox[{
        "taken", " ", "in", " ", "this", " ", "file", " ", "to", " ", "be", 
         " ", "twice", " ", "the", " ", "initial", " ", "population"}], ",", 
        " ", 
        RowBox[{
        "though", " ", "it", " ", "could", " ", "be", " ", "varied"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PopulationOverTimeTable", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
           "ProgressionThreshold"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6613624139911203`*^9, 3.6613624142151327`*^9}, {
   3.661362651344696*^9, 3.6613626515187054`*^9}, {3.661362741354844*^9, 
   3.6613627415148535`*^9}, {3.661362798060087*^9, 3.6613627981300917`*^9}, {
   3.6614336684773397`*^9, 3.6614336707844715`*^9}, {3.6614339076940217`*^9, 
   3.6614339079890385`*^9}, {3.661433953224626*^9, 3.6614339894016953`*^9}, {
   3.6614346259381027`*^9, 3.6614346261851172`*^9}, {3.661434758042659*^9, 
   3.661434763921995*^9}, {3.661436281480795*^9, 3.6614362820188255`*^9}, {
   3.661436812322157*^9, 3.6614368360745153`*^9}, {3.661438022898398*^9, 
   3.661438023144412*^9}, {3.661438116870773*^9, 3.6614381171697903`*^9}, {
   3.661438410730581*^9, 3.661438437767127*^9}, {3.6614385780331497`*^9, 
   3.6614385975632668`*^9}, {3.6627284035780935`*^9, 
   3.6627284036740985`*^9}, {3.6627284437993937`*^9, 
   3.6627284443304243`*^9}, {3.662728477685332*^9, 3.662728477862342*^9}, {
   3.662728536438692*^9, 3.6627285364926953`*^9}, {3.662728630230057*^9, 
   3.662728630326062*^9}, {3.6627388991014028`*^9, 3.662738899455423*^9}, {
   3.6627445672096*^9, 3.6627445672496023`*^9}, {3.662744606008819*^9, 
   3.662744606041821*^9}, {3.6628115295967283`*^9, 3.6628115296477313`*^9}, {
   3.6628115986546783`*^9, 3.66281159886769*^9}, {3.6628120938450017`*^9, 
   3.662812093890004*^9}, 3.662812423763872*^9, {3.662812636789056*^9, 
   3.6628126396842213`*^9}, {3.6628127097392282`*^9, 3.66281270993424*^9}, {
   3.6628138076690264`*^9, 3.66281380790104*^9}, {3.6628139290019665`*^9, 
   3.662813929278982*^9}, {3.662814041223385*^9, 3.6628140444985723`*^9}, {
   3.6628143892422905`*^9, 3.662814389312295*^9}, {3.6670569383126955`*^9, 
   3.667056938379699*^9}, {3.6670570678151026`*^9, 3.6670570690631742`*^9}, {
   3.667057165447687*^9, 3.667057194073324*^9}, {3.667057895996472*^9, 
   3.667057896067476*^9}, {3.667058088182464*^9, 3.66705808828547*^9}, 
   3.6670581305398865`*^9, {3.6670582892309637`*^9, 3.6670582896839895`*^9}, {
   3.6670583953220315`*^9, 3.6670584158712068`*^9}, {3.6670586395289993`*^9, 
   3.667058639644006*^9}, 3.6670587792949934`*^9, {3.674745891876693*^9, 
   3.674745897956702*^9}, {3.6809125538758802`*^9, 3.6809126138623114`*^9}, {
   3.680912655366685*^9, 3.6809127360452995`*^9}, 3.6833714732368746`*^9, {
   3.6833717694142904`*^9, 3.6833717694342904`*^9}, {3.6833764194670577`*^9, 
   3.6833764762203035`*^9}, {3.683377512263562*^9, 3.6833778209772196`*^9}, {
   3.6833778544511337`*^9, 3.683377871133088*^9}, {3.6833779105413427`*^9, 
   3.6833779521197205`*^9}, {3.6833785017161555`*^9, 
   3.6833786725369263`*^9}, {3.6833787372026243`*^9, 3.683378761305003*^9}, {
   3.6833803518099747`*^9, 3.683380368669939*^9}, {3.68338041064734*^9, 
   3.683380416742689*^9}, {3.683380748981692*^9, 3.683380749336712*^9}, {
   3.683380913894124*^9, 3.6833809157042274`*^9}, {3.683380952791349*^9, 
   3.683380977063737*^9}, {3.6833811159726825`*^9, 3.683381500865697*^9}, 
   3.6833822574079685`*^9, {3.6833823130831532`*^9, 3.6833823485931845`*^9}, {
   3.6833847362677517`*^9, 3.6833847530477114`*^9}, {3.6854624416054444`*^9, 
   3.6854626104697747`*^9}, {3.6854626654159164`*^9, 3.685462666755918*^9}, {
   3.685462781697628*^9, 3.685462781777628*^9}, {3.6854657916045556`*^9, 
   3.6854659312451816`*^9}, {3.6854662979793215`*^9, 3.685466306751336*^9}, {
   3.6854664770956526`*^9, 3.6854664771556525`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "a", " ", "matching", " ", "function", " ", "where", " ", "relative", " ",
      "growth", " ", "rate", " ", "does", " ", "not", " ", "vary", " ", 
     "over", " ", "time"}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "simple"}], " ", "exponential", " ", 
     RowBox[{"growth", ".", " ", "This"}], " ", "is", " ", "essentially", " ",
      "the", " ", "same", " ", "as", " ", "the", " ", "simulation", " ", 
     "used", " ", "in", " ", "the", " ", "main", " ", "text", " ", "but", " ",
      "here", " ", "the", " ", "internal", " ", "structure", " ", "of", " ", 
     "the", " ", "function", " ", "is", " ", "identical", " ", "to", " ", 
     "the", " ", "Gompertz", " ", "simulation", " ", "except", " ", "that", 
     " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"RGR", "'"}], " ", "function", " ", 
     RowBox[{"(", 
      RowBox[{"relative", " ", "growth", " ", "rate"}], ")"}], " ", "does", 
     " ", "not", " ", "depend", " ", "on", " ", "population", " ", 
     RowBox[{"size", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProgressionTimeWithoutGompertz", "[", 
    RowBox[{
    "KI1_", ",", "KI2_", ",", "growthrate_", ",", "ProgressionThreshold_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KI1internal", "=", "KI1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"KI2internal", "=", "KI2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"cell", " ", "division", " ", "rate"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gr", "=", "growthrate"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"spontaneous", " ", "cell", " ", "death", " ", "rate"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"celllossrate", "=", "CellLossRate"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"previously", " ", "defined", " ", "as", " ", "80", "%"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "rate"}], " ", "=", " ", 
        RowBox[{
        "growth", " ", "rate", " ", "\[Times]", " ", "cell", " ", "loss", " ",
          "factor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dr", "=", 
       RowBox[{"gr", "*", "celllossrate"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"rl", " ", "=", " ", 
         RowBox[{"'", "resistance", " ", 
          RowBox[{"level", "'"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"being", " ", "the", " ", "fold"}], "-", 
         RowBox[{
         "change", " ", "in", " ", "KI", " ", "in", " ", "drug", " ", 
          "resistant", " ", "sub"}], "-", "populations"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rl", "=", "10"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"pre", "-", 
        RowBox[{"existing", " ", "resistance", " ", "frequencies"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "drug", " ", "1"}], " ", "*)"}], 
      " ", 
      RowBox[{"rf1", "=", 
       RowBox[{"500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "drug", " ", "2"}], " ", "*)"}], 
      " ", 
      RowBox[{"rf2", "=", 
       RowBox[{"500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"resistance", " ", "to", " ", "both", " ", "drugs"}], " ", 
       "*)"}], " ", 
      RowBox[{"rfCross", "=", 
       RowBox[{"5", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"initial", " ", "population", " ", "size"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"p0", "=", 
       SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"relative", " ", "growth", " ", "rate"}], " ", "=", " ", 
         "RGR"}], " ", ";", " ", 
        RowBox[{
        "here", " ", "is", " ", "where", " ", "we", " ", "implement", " ", 
         "Gompertzian", " ", "kinetics"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RGR", "[", "p_", "]"}], ":=", "1"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"drug", " ", "dose"}], ",", " ", 
        RowBox[{"previously", " ", "defined"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", "DrugDose"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"duration", " ", "of", " ", "numerical", " ", "simulation"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SimulationDuration", "=", "4"}], ";", " ", 
      RowBox[{"(*", "years", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"simulating", " ", "an", " ", "untreated", " ", "tumor"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresultUntreated", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"p", "[", "t", "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
          "p", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "simulating", " ", "growth", " ", "of", " ", "tumor", " ", "cells", 
        " ", "with", " ", "baseline", " ", "drug", " ", "sensitivity"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mysimresult", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pS", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pS", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pS", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pS", "[", "0", "]"}], "\[Equal]", "p0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pR1", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pR1", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pR1", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pR1", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rf1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pR2", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pR2", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pR2", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pR2", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rf2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pRR", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"gr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pRR", "[", "t", "]"}], "*", 
               RowBox[{"DrugTreatmentOverTime", "[", 
                RowBox[{"t", ",", 
                 RowBox[{"LogDrugInhibitionModel", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                    RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
              RowBox[{"dr", "*", 
               RowBox[{"RGR", "[", 
                RowBox[{
                 RowBox[{"pS", "[", "t", "]"}], "+", 
                 RowBox[{"pR1", "[", "t", "]"}], "+", 
                 RowBox[{"pR2", "[", "t", "]"}], "+", 
                 RowBox[{"pRR", "[", "t", "]"}]}], "]"}], "*", 
               RowBox[{"pRR", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pRR", "[", "0", "]"}], "\[Equal]", 
             RowBox[{"p0", "*", "rfCross"}]}]}], "\[IndentingNewLine]", "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"pS", ",", "pR1", ",", "pR2", ",", "pRR"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Summing", " ", "up", " ", "the", " ", "total", " ", "population", 
          " ", "size", " ", "at", " ", "each", " ", "time"}], ";", " ", 
         RowBox[{"sum", " ", "of", " ", "populations", " ", "S"}]}], ",", " ",
         "R1", ",", " ", "R2", ",", " ", 
        RowBox[{
         RowBox[{"RR", ".", " ", "Table"}], " ", "has", " ", "an", " ", 
         "entry", " ", "at", " ", "every", " ", "2", " ", 
         RowBox[{"days", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PopulationOverTimeTable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pS", "[", "t", "]"}], "+", 
              RowBox[{"pR1", "[", "t", "]"}], "+", 
              RowBox[{"pR2", "[", "t", "]"}], "+", 
              RowBox[{"pRR", "[", "t", "]"}]}], ")"}], "/.", 
            "mysimresult"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"SimulationDuration", "-", "0.1"}], ")"}], "*", "365"}], 
           ",", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "progression", " ", "threshold", " ", "is", " ", "not", 
         " ", "reached", " ", "within", " ", "the", " ", "duration", " ", 
         "of", " ", "the", " ", "simulation"}], ",", " ", 
        RowBox[{
        "return", " ", "a", " ", "number", " ", "larger", " ", "than", " ", 
         "the", " ", "duration", " ", "of", " ", "simulation", " ", 
         RowBox[{"(", 
          RowBox[{
          "this", " ", "can", " ", "be", " ", "used", " ", "to", " ", 
           "identify", " ", "such", " ", "events"}], ")"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PopulationOverTimeTable", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "<", 
         "ProgressionThreshold"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "+", "1"}], ")"}], "*", "365"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"final", " ", 
         RowBox[{"output", ":", " ", 
          RowBox[{
          "the", " ", "earliest", " ", "time", " ", "at", " ", "which", " ", 
           "the", " ", "total", " ", "population", " ", "size", " ", 
           "surpasses", " ", 
           RowBox[{"the", " ", "'"}], "progression", " ", 
           RowBox[{"threshold", "'"}]}]}]}], ",", " ", 
        RowBox[{
        "taken", " ", "in", " ", "this", " ", "file", " ", "to", " ", "be", 
         " ", "twice", " ", "the", " ", "initial", " ", "population"}], ",", 
        " ", 
        RowBox[{
        "though", " ", "it", " ", "could", " ", "be", " ", "varied"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PopulationOverTimeTable", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
           "ProgressionThreshold"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6613624139911203`*^9, 3.6613624142151327`*^9}, {
   3.661362651344696*^9, 3.6613626515187054`*^9}, {3.661362741354844*^9, 
   3.6613627415148535`*^9}, {3.661362798060087*^9, 3.6613627981300917`*^9}, {
   3.6614336684773397`*^9, 3.6614336707844715`*^9}, {3.6614339076940217`*^9, 
   3.6614339079890385`*^9}, {3.661433953224626*^9, 3.6614339894016953`*^9}, {
   3.6614346259381027`*^9, 3.6614346261851172`*^9}, {3.661434758042659*^9, 
   3.661434763921995*^9}, {3.661436281480795*^9, 3.6614362820188255`*^9}, {
   3.661436812322157*^9, 3.6614368360745153`*^9}, {3.661438022898398*^9, 
   3.661438023144412*^9}, {3.661438116870773*^9, 3.6614381171697903`*^9}, {
   3.661438410730581*^9, 3.661438437767127*^9}, {3.6614385780331497`*^9, 
   3.6614385975632668`*^9}, {3.6627284035780935`*^9, 
   3.6627284036740985`*^9}, {3.6627284437993937`*^9, 
   3.6627284443304243`*^9}, {3.662728477685332*^9, 3.662728477862342*^9}, {
   3.662728536438692*^9, 3.6627285364926953`*^9}, {3.662728630230057*^9, 
   3.662728630326062*^9}, {3.6627388991014028`*^9, 3.662738899455423*^9}, {
   3.6627445672096*^9, 3.6627445672496023`*^9}, {3.662744606008819*^9, 
   3.662744606041821*^9}, {3.6628115295967283`*^9, 3.6628115296477313`*^9}, {
   3.6628115986546783`*^9, 3.66281159886769*^9}, {3.6628120938450017`*^9, 
   3.662812093890004*^9}, 3.662812423763872*^9, {3.662812636789056*^9, 
   3.6628126396842213`*^9}, {3.6628127097392282`*^9, 3.66281270993424*^9}, {
   3.6628138076690264`*^9, 3.66281380790104*^9}, {3.6628139290019665`*^9, 
   3.662813929278982*^9}, {3.662814041223385*^9, 3.6628140444985723`*^9}, {
   3.6628143892422905`*^9, 3.662814389312295*^9}, {3.6670569383126955`*^9, 
   3.667056938379699*^9}, {3.6670570678151026`*^9, 3.6670570690631742`*^9}, {
   3.667057165447687*^9, 3.667057194073324*^9}, {3.667057895996472*^9, 
   3.667057896067476*^9}, {3.667058088182464*^9, 3.66705808828547*^9}, 
   3.6670581305398865`*^9, {3.6670582892309637`*^9, 3.6670582896839895`*^9}, {
   3.6670583953220315`*^9, 3.6670584158712068`*^9}, {3.6670586395289993`*^9, 
   3.667058639644006*^9}, 3.6670587792949934`*^9, {3.674745891876693*^9, 
   3.674745897956702*^9}, {3.6809125538758802`*^9, 3.6809126138623114`*^9}, {
   3.680912655366685*^9, 3.6809127360452995`*^9}, 3.6833714732368746`*^9, {
   3.6833717694142904`*^9, 3.6833717694342904`*^9}, {3.6833764194670577`*^9, 
   3.6833764762203035`*^9}, {3.683377512263562*^9, 3.6833778209772196`*^9}, {
   3.6833778544511337`*^9, 3.683377871133088*^9}, {3.6833779105413427`*^9, 
   3.6833779521197205`*^9}, {3.6833785017161555`*^9, 
   3.6833786725369263`*^9}, {3.6833787372026243`*^9, 3.683378761305003*^9}, {
   3.6833803518099747`*^9, 3.683380368669939*^9}, {3.68338041064734*^9, 
   3.683380416742689*^9}, {3.683380748981692*^9, 3.683380749336712*^9}, {
   3.683380913894124*^9, 3.6833809157042274`*^9}, {3.683380952791349*^9, 
   3.683380977063737*^9}, {3.6833811159726825`*^9, 3.683381500865697*^9}, 
   3.6833822574079685`*^9, {3.6833823130831532`*^9, 3.6833823485931845`*^9}, {
   3.6833847362677517`*^9, 3.6833847530477114`*^9}, {3.6854624416054444`*^9, 
   3.6854626104697747`*^9}, {3.6854626654159164`*^9, 3.685462666755918*^9}, {
   3.685462781697628*^9, 3.685462781777628*^9}, 3.6854629021048965`*^9, {
   3.6854659535222187`*^9, 3.6854659554342213`*^9}, {3.685465987095271*^9, 
   3.6854659961402845`*^9}, {3.6854660771088057`*^9, 
   3.6854660950498357`*^9}, {3.6854664699996424`*^9, 3.685466472569646*^9}, {
   3.68559780003362*^9, 3.6855978708486705`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The faster kinetics that occur at small population size ('population \
rebound' time after effective treatment) can be seen in a side-by-side \
comparison of simulations conducted with identical input parameters (initial \
growth rate = 0.07, and drug sensitivities ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["KI", "1"], TraditionalForm]]],
 "=2 and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["KI", "2"], TraditionalForm]]],
 "=0.5)"
}], "Subsubsection",
 CellChangeTimes->{{3.6854661011608458`*^9, 3.6854662128910227`*^9}, {
  3.6854665385787563`*^9, 3.685466542389763*^9}, {3.685597881817298*^9, 
  3.685597883033367*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProgressionTimeGompertz", "[", 
   RowBox[{"2", ",", "0.5", ",", "0.07", ",", 
    RowBox[{"2", "*", 
     SuperscriptBox["10", "10"]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OneTumorTimeCourseWithGompertz", "=", "PopulationOverTimeTable"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgressionTimeWithoutGompertz", "[", 
   RowBox[{"2", ",", "0.5", ",", "0.07", ",", 
    RowBox[{"2", "*", 
     SuperscriptBox["10", "10"]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "OneTumorTimeCourseWithoutGompertz", "=", "PopulationOverTimeTable"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "OneTumorTimeCourseWithGompertz", ",", 
     "OneTumorTimeCourseWithoutGompertz"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], "}"}]}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Gompertz growth kinetics\>\"", ",", 
      "\"\<Exponential growth kinetics\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6854626209178033`*^9, 3.6854626373098516`*^9}, {
  3.6854626700109253`*^9, 3.685462671408931*^9}, {3.6854628398617687`*^9, 
  3.6854629102909145`*^9}, {3.685466019238325*^9, 3.6854660601027803`*^9}, {
  3.6854661700669546`*^9, 3.685466184467979*^9}, {3.685466499829691*^9, 
  3.6854665109457083`*^9}, {3.6854665554427843`*^9, 3.6854666243839035`*^9}, {
  3.685467342489851*^9, 3.6854673586518764`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulatePopulationGompertz", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"KI1table", ",", "KI2table"}], "}"}], ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI1", "=", 
      RowBox[{"10", "^", "KI1table"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"logKI2", "=", 
      RowBox[{"10", "^", "KI2table"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"NumberOfTumorsSimulated", "=", "200"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgressionThreshold", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "no", " ", 
        RowBox[{"treatment", ".", " ", "No"}], " ", "treatment", " ", "is", 
        " ", "implemented", " ", "by", " ", "setting", " ", "KI1", " ", "and",
         " ", "KI2", " ", "to", " ", "equal", " ", "1000"}], ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "neither", " ", "drug", " ", 
        "has", " ", "any", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"UntreatedProgressionTimes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ProgressionTimeGompertz", "[", 
         RowBox[{"1000", ",", "1000", ",", 
          RowBox[{
          "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "treatment", " ", "by", " ", "monotherapy", 
        " ", 
        RowBox[{"#1", ".", " ", "The"}], " ", "absence", " ", "of", " ", 
        "monotherapy", " ", "#2", " ", "is", " ", "implemented", " ", "by", 
        " ", "setting", " ", "KI2", " ", "to", " ", "equal", " ", "1000"}], 
       ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "drug", " ", "2", " ", "has",
         " ", "no", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Monotherapy1ProgressionTimes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ProgressionTimeGompertz", "[", 
         RowBox[{
          RowBox[{
          "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", "1000", ",", 
          RowBox[{
          "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "treatment", " ", "by", " ", "monotherapy", 
        " ", 
        RowBox[{"#2", ".", " ", "The"}], " ", "absence", " ", "of", " ", 
        "monotherapy", " ", "#1", " ", "is", " ", "implemented", " ", "by", 
        " ", "setting", " ", "KI1", " ", "to", " ", "equal", " ", "1000"}], 
       ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "drug", " ", "2", " ", "has",
         " ", "no", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Monotherapy2ProgressionTimes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ProgressionTimeGompertz", "[", 
         RowBox[{"1000", ",", 
          RowBox[{
          "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
       "time", " ", "for", " ", "treatment", " ", "by", " ", "a", " ", 
       "combination", " ", "of", " ", "monotherapy", " ", "#1", " ", "and", 
       " ", "#2"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CombinationProgressionTimes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ProgressionTimeGompertz", "[", 
         RowBox[{
          RowBox[{
          "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plotting", " ", "survival", " ", "functions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"SurvivalPlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", "UntreatedProgressionTimes", 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3.5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", "Monotherapy2ProgressionTimes", 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3.5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", "Monotherapy1ProgressionTimes", 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3.5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", "CombinationProgressionTimes", 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3.5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "*", 
                RowBox[{"2", "/", "61"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "2000", ",", 
               RowBox[{
                RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"36", "*", "30.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"3", "/", "4"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Progression free survival (months)\>\"", ",", 
           "\"\<Patients (%)\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "250", "}"}], ",", 
           RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}],
         ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Untreated\>\"", ",", "\"\<Monotherapy B\>\"", ",", 
           "\"\<Monotherapy A\>\"", ",", 
           "\"\<Combination,\\nindependent drug action\>\""}], "}"}]}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6854662397970667`*^9, 3.6854662563900976`*^9}, {
  3.6854663273773966`*^9, 3.6854663362384095`*^9}, {3.6854664474836044`*^9, 
  3.6854664476836042`*^9}, {3.685467268786733*^9, 3.685467276145745*^9}, {
  3.685593951873518*^9, 3.6855939599229784`*^9}, {3.7037155468112907`*^9, 
  3.7037155471723113`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The benefit of independent drug action persists regardless of the choice of \
exponential or Gompertz growth kinetics :\
\>", "Subsubsection",
 CellChangeTimes->{{3.685466919859001*^9, 3.6854669441050396`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Note", " ", "that", " ", "while", " ", "the", " ", "result", " ", "of", 
     " ", "the", " ", "simulation", " ", "is", " ", "time", " ", "to", " ", 
     "tumor", " ", "doubling"}], ",", " ", 
    RowBox[{"the", " ", "simulation", " ", 
     RowBox[{"(", "internally", ")"}], " ", "proceeds", " ", "for", " ", 
     "years"}], ",", " ", 
    RowBox[{
     RowBox[{
     "producing", " ", "numerically", " ", "very", " ", "large", " ", 
      "values", " ", "for", " ", "population", " ", "size"}], ";", " ", 
     RowBox[{
     "in", " ", "the", " ", "Gompertz", " ", "model", " ", "this", " ", 
      "generates", " ", "some", " ", "numerical", " ", "computation", " ", 
      "errors", " ", "as", " ", "relative", " ", "growth", " ", "rate", " ", 
      "asymptotically", " ", "approaches", " ", "zero"}]}], ",", " ", 
    RowBox[{
    "and", " ", "so", " ", "some", " ", "error", " ", "messages", " ", "are", 
     " ", "here", " ", "turned", " ", 
     RowBox[{"off", ".", " ", "The"}], " ", "time", " ", "to", " ", 
     "doubling", " ", "is", " ", "calculated", " ", "from", " ", "data", " ", 
     "before", " ", "these", " ", "numerical", " ", "errors", " ", "take", 
     " ", "effect"}], ",", " ", 
    RowBox[{
    "and", " ", "is", " ", "therefore", " ", "reported", " ", 
     "accurately"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Off", "[", 
    RowBox[{"Max", "::", "nord"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Off", "[", 
    RowBox[{"InterpolatingFunction", "::", "dmval"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Off", "[", 
    RowBox[{"NDSolve", "::", "nlnum"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6855940020643888`*^9, 3.685594227522284*^9}, {
  3.7160832758214135`*^9, 3.7160833017078943`*^9}}],

Cell[BoxData[{
 RowBox[{"SimulatePopulationGompertz", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S7B, Gompertz PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.685598070762105*^9, 3.685598077425486*^9}, {
   3.685600700586522*^9, 3.6856007007945337`*^9}, {3.71607511916288*^9, 
   3.7160751208759775`*^9}, 3.7160751874377847`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Spider plots, for monotherapy\n",
 StyleBox["Here we use precisely the same selection of growth rate and drug \
sensitivity parameters in Figure 6D, to compare tumor\[CloseCurlyQuote]s drug \
responses in this alternative model structure",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6628101118266363`*^9, 3.6628101159888744`*^9}, {
  3.663199370979868*^9, 3.6631993750230994`*^9}, {3.6833824936374807`*^9, 
  3.6833824949335546`*^9}, {3.683382843706503*^9, 3.6833828461066403`*^9}, {
  3.6833854797402754`*^9, 3.683385480743333*^9}, {3.6855933585205803`*^9, 
  3.6855934033051414`*^9}}],

Cell[TextData[{
 StyleBox["Because growth rates and drug sensitivities (KI) are randomly \
drawn from distributions, reproducible example trajectories can only be \
generated here by \[OpenCurlyQuote]hard-coding\[CloseCurlyQuote] some sample \
values.\n\nA small set of growth rates was generated by\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Table[Max[{1/100,RandomVariate[NormalDistribution[6.9/100,2.1/100]]\
}],{50}];",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->GrayLevel[0]],
 StyleBox["\n\nA small  set of KI values was generated by\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["10^Table[RandomVariate[NormalDistribution[MedianLogDrugSensitivity,\
StandardDeviationInDrugSensitivity]],{50}]\n\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->GrayLevel[0]],
 StyleBox["These parameters generate 50 different tumor kinetic trajectories. \
A few of these trajectories have been selected here, non-randomly, to \
illustrate the variety of different kinetic trajectories.",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.6833727718175087`*^9, 3.6833729354508677`*^9}, {3.6833761403000903`*^9, 
   3.6833764146477823`*^9}, {3.683377379249954*^9, 3.6833774898352795`*^9}, {
   3.683377877317442*^9, 3.683377894186407*^9}, {3.683377965663495*^9, 
   3.683378043626954*^9}, {3.6833780747307334`*^9, 3.683378134389146*^9}, {
   3.683378168406091*^9, 3.6833782242992883`*^9}, {3.6833782544580135`*^9, 
   3.683378484433167*^9}, {3.6833795989259124`*^9, 3.683379628567608*^9}, {
   3.6833806214523973`*^9, 3.683380638522374*^9}, {3.6833815103122377`*^9, 
   3.683381514820495*^9}, {3.683384804343645*^9, 3.6833848049566803`*^9}, {
   3.683385488416772*^9, 3.6833855707574816`*^9}, {3.684196334948473*^9, 
   3.684196494467812*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ASmallSetOfGrowthRates", "=", 
    RowBox[{"{", 
     RowBox[{
     "0.052`", ",", "0.06`", ",", "0.057`", ",", "0.086`", ",", "0.068`", ",",
       "0.095`", ",", "0.057`", ",", "0.053`", ",", "0.045`", ",", "0.033`", 
      ",", "0.083`", ",", "0.084`", ",", "0.061`", ",", "0.094`", ",", 
      "0.092`", ",", "0.077`", ",", "0.088`", ",", "0.1`", ",", "0.098`", ",",
       "0.055`", ",", "0.059`", ",", "0.098`", ",", "0.048`", ",", "0.043`", 
      ",", "0.028`", ",", "0.108`", ",", "0.1`", ",", "0.029`", ",", "0.062`",
       ",", "0.058`", ",", "0.045`", ",", "0.063`", ",", "0.088`", ",", 
      "0.079`", ",", "0.038`", ",", "0.057`", ",", "0.121`", ",", "0.075`", 
      ",", "0.054`", ",", "0.101`", ",", "0.063`", ",", "0.069`", ",", 
      "0.069`", ",", "0.046`", ",", "0.047`", ",", "0.113`", ",", "0.058`", 
      ",", "0.094`", ",", "0.09`", ",", "0.067`"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ASmallSetOfKIvalues", "=", 
    RowBox[{"{", 
     RowBox[{
     "5.41`", ",", "3.84`", ",", "0.62`", ",", "0.95`", ",", "1.83`", ",", 
      "3.46`", ",", "0.79`", ",", "1.06`", ",", "0.38`", ",", "4.06`", ",", 
      "4.1`", ",", "3.54`", ",", "0.61`", ",", "2.85`", ",", "3.2`", ",", 
      "3.82`", ",", "1.45`", ",", "1.3`", ",", "1.25`", ",", "0.96`", ",", 
      "3.63`", ",", "0.43`", ",", "0.68`", ",", "2.53`", ",", "3.96`", ",", 
      "1.14`", ",", "1.69`", ",", "0.32`", ",", "1.38`", ",", "0.4`", ",", 
      "0.96`", ",", "1.68`", ",", "0.63`", ",", "2.1`", ",", "0.34`", ",", 
      "1.79`", ",", "0.15`", ",", "15.78`", ",", "0.2`", ",", "0.12`", ",", 
      "0.42`", ",", "1.90`", ",", "26.7`", ",", "0.24`", ",", "0.89`", ",", 
      "1.25`", ",", "4.62`", ",", "0.93`", ",", "0.8`", ",", "2.62`"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProgressionTimeGompertz", "[", 
      RowBox[{
       RowBox[{
       "ASmallSetOfKIvalues", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
        "\[RightDoubleBracket]"}], ",", "1000", ",", 
       RowBox[{
       "ASmallSetOfGrowthRates", "\[LeftDoubleBracket]", 
        "SimulatedTumorNumber", "\[RightDoubleBracket]"}], ",", 
       "ProgressionThreshold"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "TotalPopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], 
      "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"pS", "[", "t", "]"}], "+", 
                RowBox[{"pR1", "[", "t", "]"}], "+", 
                RowBox[{"pR2", "[", "t", "]"}], "+", 
                RowBox[{"pRR", "[", "t", "]"}]}], ")"}], "/.", 
              "mysimresult"}], ")"}], "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "SPopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pS", "[", "t", "]"}], "/.", "mysimresult"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "R1PopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pR1", "[", "t", "]"}], "/.", "mysimresult"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "R2PopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pR2", "[", "t", "]"}], "/.", "mysimresult"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RRPopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pRR", "[", "t", "]"}], "/.", "mysimresult"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"SimulatedTumorNumber", ",", "1", ",", "50"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"a", " ", "subset", " ", "was", " ", "selected", " ", 
    RowBox[{"(", 
     RowBox[{"non", "-", "randomly"}], ")"}], " ", "to", " ", "illustrate", 
    " ", "the", " ", "diversity", " ", "of", " ", "different", " ", 
    "treatment", " ", "outcomes"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"TotalPopulationOverTimeGompertz", "[", "stn", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"stn", ",", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "3", ",", "4", ",", "7", ",", "9", ",", "10", ",", "20", 
          ",", "22", ",", "23"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"30", "*", "30.5"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"16", ",", "i"}], "]"}], ",", 
             RowBox[{"ColorConvert", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"16", ",", "i"}], "]"}], ",", "\"\<Grayscale\>\""}], 
              "]"}]}], "}"}], ",", "0.7"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8", 
           ",", "9", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.0", ",", "0"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"AxesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"6", "/", "4"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Change from baseline\\n tumor volume(%)\>\""}], "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       "*)"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S7B, Gompertz kinetics.pdf\>\""}], ",", "%", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6833850659216065`*^9, 3.6833851193996654`*^9}, {
   3.683385151007473*^9, 3.683385169231516*^9}, {3.6833852033544674`*^9, 
   3.6833853227862988`*^9}, {3.6833855432879105`*^9, 3.683385647166852*^9}, {
   3.683385696153654*^9, 3.6833857179549007`*^9}, {3.683389739010892*^9, 
   3.6833897553018236`*^9}, {3.6833898398636603`*^9, 
   3.6833898478211155`*^9}, {3.684195578265291*^9, 3.684195579095293*^9}, {
   3.6841956334564095`*^9, 3.684195702647558*^9}, 3.6841963117174263`*^9, {
   3.685593429225624*^9, 3.6855934327738276`*^9}, 3.68559368842645*^9, {
   3.6855938336337547`*^9, 3.6855938883448844`*^9}, {3.6855979012324085`*^9, 
   3.685597991883593*^9}, {3.7160751316115913`*^9, 3.7160751332766867`*^9}, 
   3.7160751882068286`*^9}],

Cell[CellGroupData[{

Cell["A larger batch produced by randomly drawn parameters", "Subsubsection",
 CellChangeTimes->{{3.683385797600456*^9, 3.683385804538853*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ProgressionTimeGompertz", "[", 
     RowBox[{
      RowBox[{
      "logKI1", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
       "\[RightDoubleBracket]"}], ",", "1000", ",", 
      RowBox[{
      "DistributionOfGrowthRates", "\[LeftDoubleBracket]", 
       "SimulatedTumorNumber", "\[RightDoubleBracket]"}], ",", 
      "ProgressionThreshold"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "TotalPopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], 
     "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pS", "[", "t", "]"}], "+", 
               RowBox[{"pR1", "[", "t", "]"}], "+", 
               RowBox[{"pR2", "[", "t", "]"}], "+", 
               RowBox[{"pRR", "[", "t", "]"}]}], ")"}], "/.", "mysimresult"}],
             ")"}], "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "SPopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pS", "[", "t", "]"}], "/.", "mysimresult"}], ")"}], "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "R1PopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pR1", "[", "t", "]"}], "/.", "mysimresult"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "R2PopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pR2", "[", "t", "]"}], "/.", "mysimresult"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "RRPopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pRR", "[", "t", "]"}], "/.", "mysimresult"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"SimulatedTumorNumber", ",", "1", ",", "200"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6628101235253057`*^9, 3.6628101789304743`*^9}, {
   3.6628102536167464`*^9, 3.662810291503914*^9}, {3.6628105464424953`*^9, 
   3.6628105786153355`*^9}, {3.6628127413220353`*^9, 
   3.6628127414000397`*^9}, {3.663191791647355*^9, 3.6631919060098963`*^9}, {
   3.6631920412896338`*^9, 3.663192089168372*^9}, {3.66319431827287*^9, 
   3.6631943993045044`*^9}, 3.683381501024706*^9, {3.6833825476395693`*^9, 
   3.683382555050993*^9}, {3.683382757158553*^9, 3.683382822166271*^9}, {
   3.6833845504121213`*^9, 3.6833845751455355`*^9}, {3.6833848451039762`*^9, 
   3.6833848558405905`*^9}, {3.683384891684641*^9, 3.683384947862854*^9}, 
   3.6833856628927517`*^9, 3.6833857529919047`*^9, 3.6855934735171576`*^9, 
   3.6855936916376333`*^9, 3.685593902400688*^9, {3.6855979278789325`*^9, 
   3.6855979319491653`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
      "TotalPopulationOverTimeGompertz", "[", "SimulatedTumorNumber", "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"SimulatedTumorNumber", ",", "50", ",", "100"}], "}"}]}], 
     "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"3", "*", "366"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "0.7", ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0.3", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
       RowBox[{"{", "200", "}"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"AxesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "400", "}"}], ",", 
       RowBox[{"{", "500", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Change from baseline\\n tumor volume(%)\>\""}], "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6628101235253057`*^9, 3.6628101789304743`*^9}, {
   3.6628102536167464`*^9, 3.662810291503914*^9}, {3.6628105464424953`*^9, 
   3.6628105786153355`*^9}, {3.6628127413220353`*^9, 
   3.6628127414000397`*^9}, {3.663191791647355*^9, 3.6631919060098963`*^9}, {
   3.6631920412896338`*^9, 3.663192249128522*^9}, {3.6631922916989565`*^9, 
   3.6631924710992174`*^9}, {3.66319252289218*^9, 3.663192547996616*^9}, {
   3.6631926297242904`*^9, 3.6631926661393733`*^9}, {3.66319272027547*^9, 
   3.6631927252037516`*^9}, {3.6631927569085646`*^9, 3.663192776835705*^9}, {
   3.663192819076121*^9, 3.6631928804916334`*^9}, {3.6631944056908703`*^9, 
   3.663194410082121*^9}, {3.6631989610504217`*^9, 3.6631989617684627`*^9}, {
   3.6631990004986777`*^9, 3.663199009890215*^9}, {3.6670573731865687`*^9, 
   3.6670573825651054`*^9}, {3.6680844419722176`*^9, 3.668084451180744*^9}, {
   3.6708541284251394`*^9, 3.670854134036461*^9}, {3.683382524137225*^9, 
   3.6833825394350996`*^9}, 3.683382921117931*^9, {3.683384954589239*^9, 
   3.6833849553762836`*^9}, {3.6833857765682535`*^9, 3.683385776647258*^9}, {
   3.68338621499533*^9, 3.6833862151913414`*^9}, {3.683389702870825*^9, 
   3.683389725350111*^9}, 3.6855979339982824`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This interface allows the user to scroll through different individual tumors \
and inspect the growth (or inhibition) of its sub - populations over time.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6833829800623026`*^9, 3.683383022278717*^9}, 
   3.6833859881373544`*^9}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TotalPopulationOverTimeGompertz", "[", "sample", "]"}], ",", 
       RowBox[{"SPopulationOverTimeGompertz", "[", "sample", "]"}], ",", 
       RowBox[{"R1PopulationOverTimeGompertz", "[", "sample", "]"}], ",", 
       RowBox[{"R2PopulationOverTimeGompertz", "[", "sample", "]"}], ",", 
       RowBox[{"RRPopulationOverTimeGompertz", "[", "sample", "]"}]}], "}"}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"30", "*", "30.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Opacity", "[", "1", "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"col", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"col", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{"Green", ",", "0.3"}], "]"}], ",", "Red", ",", "Blue", 
              ",", "Purple"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.0", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"AxesStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "1"}], ",", "1", ",", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", 
               RowBox[{"2", "/", "61"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "2000", ",", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
          "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Time (months)\>\"", ",", "\"\<Change from baseline (%)\>\""}], 
       "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Total population\>\"", ",", "\"\<Most sensitive (S)\>\"", ",", 
        "\"\<Resistant to drug 1 (R1)\>\"", ",", 
        "\"\<Resistant to drug 2 (R2)\>\"", ",", 
        "\"\<Cross-resistant (RR)\>\""}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"sample", ",", "1", ",", "200", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.668084848788486*^9, 3.6680848666845093`*^9}, {
  3.6833826879475946`*^9, 3.683382740268587*^9}, {3.6833828871959906`*^9, 
  3.683382942596159*^9}, {3.683382973099904*^9, 3.6833829787042246`*^9}, {
  3.6833858325204535`*^9, 3.6833859230686326`*^9}, {3.683385956636553*^9, 
  3.683385967155154*^9}, {3.6833868445173364`*^9, 3.6833869231548347`*^9}, {
  3.685598031934884*^9, 3.6855980386232667`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "A model of treatment with cytotoxic chemotherapy in cycles\n",
 StyleBox["Here we alter two features of the model presented in Figure 6:\n\
(1) Drug response: treatment does not only arrest tumor cell proliferation, \
but actively induces cell death\n(2) Drug administration: treatment is not \
present continuously, but is administered once a month (and in this model, \
exerts a cell killing effect for 3 days; this parameter can be varied)",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6855784002834454`*^9, 3.6855784570366917`*^9}, {
  3.6855907768569174`*^9, 3.685590777146934*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "(1) Drug response.\nThis model of cytotoxic drug response takes the \
following simple form:\nRelative tumor growth rate = 1 - ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    FractionBox[
     RowBox[{"[", 
      RowBox[{"drug", " ", "concentration"}], "]"}], 
     SubscriptBox["K", "I"]],
    FontSize->24], TraditionalForm]]],
 "\n\nNote that in this model of cytotoxic drug response, \
\[OpenCurlyQuote]relative tumor growth\[CloseCurlyQuote] reaches negative \
numbers at high drug concentration. These negative numbers are interpreted by \
recalling that such a scale refers to the relative change in tumor cell \
population in each cell division time; thus the cell population decreases \
rather than increases in each cell division time, even before accounting for \
the cell loss factor (which is a separate source of population decrease)\nFor \
example,\n1 = uninhibited growth; population doubles in each cell division \
time (before accounting for cell loss)\n0 =  growth arrest (no cell division; \
before accounting for cell loss)\n-1  = population halves in each cell \
division time (before accounting for cell loss). Equivalent to growth arrest \
plus 50% cell killing in each cell division time.\n-2 = population quartered \
in each cell division time. Equivalent to growth arrest plus 75% cell killing \
in each cell division time.\netc."
}], "Subsubsection",
 CellChangeTimes->{{3.685579531382141*^9, 3.6855796357891126`*^9}, {
   3.6855797769331856`*^9, 3.685579918365275*^9}, {3.6855907059778633`*^9, 
   3.6855907351925344`*^9}, 3.6855907897136526`*^9, {3.685591732754592*^9, 
   3.6855917376008687`*^9}, {3.685591773576926*^9, 3.685592000537908*^9}, {
   3.685592042066283*^9, 3.6855921087690983`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LogCytotoxicInhibitionModel", "=", 
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["10", 
        RowBox[{"LogDrug", "-", "LogKI"}]], ")"}], "NH"]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "d", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", "LogCytotoxicInhibitionModel", ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NH", "\[Rule]", "1"}], ",", 
     RowBox[{"LogKI", "\[Rule]", 
      RowBox[{"Log", "[", 
       RowBox[{"10", ",", "KI"}], "]"}]}], ",", 
     RowBox[{"LogDrug", "\[Rule]", 
      RowBox[{"Log", "[", 
       RowBox[{"10", ",", "d"}], "]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6855789470297174`*^9, 3.6855789493488503`*^9}, {
  3.6855910963941936`*^9, 3.6855911014414825`*^9}, {3.685591140889739*^9, 
  3.68559114266584*^9}, {3.685592011674545*^9, 3.685592012058567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "custom", " ", "axis", " ", "ticks", " ", "for", " ", "log", " ", 
    "scale"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"logframeticks", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           SuperscriptBox["\"\<10\>\"", 
            RowBox[{"ToString", "[", "x", "]"}]], ",", 
           RowBox[{"{", 
            RowBox[{"0.03", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{"10", ",", "x"}], "]"}], ",", "\"\<\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"1", "*", 
                SuperscriptBox["10", "y"]}], ",", 
               RowBox[{"9", "*", 
                SuperscriptBox["10", "y"]}], ",", 
               RowBox[{"1", "*", 
                SuperscriptBox["10", "y"]}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "10"}], ",", "10", ",", "1"}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LogCytotoxicInhibitionModel", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LogKI", "\[Rule]", "0"}], ",", 
          RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}], ",", 
       RowBox[{"LogDrugInhibitionModel", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LogKI", "\[Rule]", "0"}], ",", 
          RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"LogDrug", ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"3", "/", "4"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Drug concentration (as multiples of \!\(\*SubscriptBox[\(K\), \(I\
\)]\))\>\"", ",", 
        RowBox[{"Rotate", "[", 
         RowBox[{
         "\"\<Relative tumor\\ngrowth rate\\n(negative indicates\\ncell \
killing;\\ne.g. -1 implies\\n50% cell killing\\neach cell\\ndivision \
time)\>\"", ",", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"logframeticks", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "3"}], ",", "1", ",", "0.5"}], "}"}]}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Model of cytotoxic drug response\>\"", ",", 
        "\"\<Model of cytostatic drug response\>\""}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6627279792048206`*^9, 3.662728068213911*^9}, {
   3.6855789540551195`*^9, 3.6855790766791334`*^9}, {3.685579189983614*^9, 
   3.6855792033273773`*^9}, {3.6855792613826976`*^9, 3.685579493495974*^9}, {
   3.685591034365646*^9, 3.6855910511546063`*^9}, {3.6855911234357405`*^9, 
   3.6855912659318905`*^9}, 3.716083365888565*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
In comparison to the model in the main text (Figure 6), where drug \
administration was continuous, here a higher drug concentration is required \
to have a similar effect because of its transient effect (acting for 3 days \
out of every 30)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6855928902337956`*^9, 3.6855929867213144`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "When", " ", "drug", " ", "is", " ", "present", " ", "only", " ", "3", 
     " ", "days", " ", "out", " ", "of", " ", "every", " ", "30"}], ",", " ", 
    RowBox[{
    "a", " ", "significant", " ", "response", " ", "is", " ", "only", " ", 
     "observed", " ", "with", " ", "a", " ", "dose", " ", "that", " ", "is", 
     " ", "higher", " ", 
     RowBox[{"(", 
      RowBox[{"relative", " ", "to", " ", "KI"}], ")"}], " ", "than", " ", 
     "was", " ", "used", " ", "in", " ", "the", " ", "model", " ", "of", " ", 
     "continuously", " ", "administered", " ", "therapy", " ", 
     RowBox[{"(", 
      RowBox[{"as", " ", "in", " ", "Figure", " ", "6"}], ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DrugDose", "=", "1.5"}], ";"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"logframeticksDownward", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["\"\<10\>\"", 
           RowBox[{"ToString", "[", "x", "]"}]], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", "x"}], "]"}], ",", "\"\<\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "y"]}], ",", 
              RowBox[{"9", "*", 
               SuperscriptBox["10", "y"]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "y"]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "10"}], ",", "10", ",", "1"}], "}"}]}], "]"}], ",", 
        "1"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogNormallyDistributedKIvalues", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
        "MedianLogDrugSensitivity", ",", 
         "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
      RowBox[{"{", "100000", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CustomHistogramPlot", "[", 
    RowBox[{"data_", ",", "bins_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"countBorder", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"#1", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Riffle", "[", 
              RowBox[{"#2", ",", "#2"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
         "&"}], "@@", 
        RowBox[{"HistogramList", "[", 
         RowBox[{"data", ",", "bins", ",", "\"\<Count\>\""}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"countBorder", ",", 
       RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
       RowBox[{"FillingStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.75", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "1", "]"}], ",", "Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "True"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"False", ",", "False"}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"i", "*", "2000"}], "+", "2000"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", "i", "]"}], ",", "Red"}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0.05"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "\"\<0\>\"", "\[Rule]", "\"\<growth\\narrest (0)\>\""}], ",", 
                RowBox[{"\"\<1\>\"", "\[Rule]", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<uninhibited\\ngrowth (1)\>\"", ",", 
                   RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}]}], "]"}]}], ",", 
                RowBox[{
                "\"\<-1\>\"", "\[Rule]", 
                 "\"\<complete\\nkilling (-1)\>\""}]}], "}"}]}], ")"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"logframeticksDownward", ",", "None"}], "}"}]}], "}"}]}], 
       ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.0", "]"}], ",", 
              RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Red", ",", 
              RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Probability\>\"", ",", 
              RowBox[{"GrayLevel", "[", "0.", "]"}]}], "]"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Drug effect (GR value)\>\"", ",", "Red"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Drug sensitivity (\!\(\*SubscriptBox[\(K\), \(I\)]\))\>\"", 
            ","}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"5", "/", "6"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "110"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", ",", 
              RowBox[{"1", "/", "100"}]}], "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"10", ",", "100"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "4200"}], "}"}]}], "}"}]}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SensitivityDistributionAndDrugResponsePlot", "=", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CustomHistogramPlot", "[", 
     RowBox[{"LogNormallyDistributedKIvalues", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "2", ",", "0.05"}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LogCytotoxicInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "DrugDose"}], "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}], ")"}], "-", 
               "CellLossRate"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "CellLossRate"}], ")"}]}], ")"}]}], "-", 
          "1"}], ")"}], "*", "2000"}], "+", "2000"}], ",", 
      RowBox[{"{", 
       RowBox[{"LogKI", ",", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", 
          RowBox[{"1", "/", "100"}]}], "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "100"}], "]"}]}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], ",", 
      RowBox[{"AxesStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"None", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "i", "]"}], ",", "Black"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"logframeticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Drug sensitivity (\!\(\*SubscriptBox[\(K\), \(I\)]\))\>\"", 
           ","}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Probability\>\"", ",", "\"\<GR\>\""}], "}"}]}], 
        "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"3", "/", "4"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "250", "}"}], ",", 
         RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd6ktHxF/mvHe1ObN4NoYa2Lu0B0DvfEvSD6349b
x0C0jPuqkyB6ite3cyC6xTPwAoi2MLx9FUTfYtp4HUTvkDcvrC587ajhvqgE
RAd71VaD6H8sN+tAtH1Nh04TkC5L+qgHol+w5s66VPTacdl8wf0g+pHVH9bL
QHqWgLEQiI7RPisHom3665VAtFDpTk0QzRBQpwuimQpjGniKXzu+r3rVCKI3
sLw8A6LL9I6cA9Eh539fBtEikjE3QLRET+DZ0tLXjh4XTC+A6JTDTNe3AmnD
+BM3QbTDJNP7IPrA6t2PQPSki6eO7wLSUU5XwDQAre+gvA==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
(2) Drug administration
Note that drug dose response extends \[OpenCurlyQuote]tumor growth growth\
\[CloseCurlyQuote] to negative numbers; which refer to the relative change in \
tumor cell population in each cell division time.
For example,
1 = uninhibited growth; population doubles in each cell division time (before \
accounting for cell loss factor)
0 =  growth arrest (no cell division; before accounting for cell loss)
-1  = population halves in each cell division time (before accounting for \
cell loss). Equivalent to growth arrest plus 50% cell killing in each cell \
division time.
-2 = population quartered in each cell division time. Equivalent to growth \
arrest plus 75% cell killing in each cell division time.\
\>", "Subsubsection",
 CellChangeTimes->{{3.685579531382141*^9, 3.6855796357891126`*^9}, {
  3.6855797769331856`*^9, 3.685579918365275*^9}, {3.6855907059778633`*^9, 
  3.6855907351925344`*^9}, {3.6855907897136526`*^9, 3.685590842792689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"here", " ", "the", " ", 
    RowBox[{"drug", "'"}], "s", " ", "effect", " ", "is", " ", "present", " ",
     "for", " ", "3", " ", "days", " ", "out", " ", "of", " ", "every", " ", 
    "30"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DurationOfDrugEffectPerCycle", "=", "3"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CycleLength", "=", "30"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumberOfCycles", "=", "36"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"'", 
      RowBox[{"36", "'"}], " ", "cycles", " ", "indicates", " ", "that", " ", 
      "treatment", " ", "cycles", " ", "continue", " ", "for", " ", "3", " ", 
      "years", " ", 
      RowBox[{"(", 
       RowBox[{
       "essentially", " ", "indefinitely", " ", "given", " ", "the", " ", 
        "timescale", " ", "being", " ", "simulated"}], ")"}]}], ";", " ", 
     RowBox[{
     "this", " ", "parameter", " ", "could", " ", "be", " ", "adjusted", " ", 
      "to", " ", "describe", " ", "treatment", " ", "with", " ", "a", " ", 
      "smaller", " ", "fixed", " ", "number", " ", "of", " ", "cycles"}], ";",
      " ", 
     RowBox[{
     "the", " ", "benefit", " ", "of", " ", "independent", " ", "drug", " ", 
      "action", " ", "persists", " ", "in", " ", "such", " ", "models"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DrugTreatmentOverTime", "[", 
     RowBox[{"t_", ",", "RelativeGrowthDuringTreatment_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"And", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"t", ",", "CycleLength"}], "]"}], "<=", 
         "DurationOfDrugEffectPerCycle"}], ",", 
        RowBox[{"t", "<", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"NumberOfCycles", "+", "0.5"}], ")"}], "*", 
          "CycleLength"}]}]}], "]"}], ",", "RelativeGrowthDuringTreatment", 
      ",", "1"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"a", " ", "simple", " ", "illustration", " ", "of", " ", "a", " ", 
     RowBox[{"drug", "'"}], "s", " ", "presence", " ", "and", " ", "effect", 
     " ", "over", " ", 
     RowBox[{"time", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DrugTreatmentOverTime", "[", 
      RowBox[{"t", ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{"6", "*", "30"}]}], "}"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "200"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Time (days)\>\"", ",", "\"\<relative tumor growth rate\>\""}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.66272799196655*^9, 3.6627279981789055`*^9}, {
  3.662728043156478*^9, 3.6627280454116073`*^9}, {3.673825396729566*^9, 
  3.6738254063371153`*^9}, {3.673825499409439*^9, 3.6738254994644423`*^9}, {
  3.6738261460964274`*^9, 3.6738261552809525`*^9}, {3.685578784596427*^9, 
  3.6855788871982956`*^9}, {3.685578999903742*^9, 3.6855790005277777`*^9}, {
  3.685579065415489*^9, 3.685579138791686*^9}, {3.6855909047572327`*^9, 
  3.685590913611739*^9}, {3.6855921473553057`*^9, 3.6855923472997417`*^9}, {
  3.6855924984113846`*^9, 3.685592510340067*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProgressionTimeCytotoxic", "[", 
   RowBox[{
   "KI1_", ",", "KI2_", ",", "growthrate_", ",", "ProgressionThreshold_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1internal", "=", "KI1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2internal", "=", "KI2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"cell", " ", "division", " ", "rate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"gr", "=", "growthrate"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"spontaneous", " ", "cell", " ", "death", " ", "rate"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"celllossrate", "=", "CellLossRate"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"previously", " ", "defined", " ", "as", " ", "80", "%"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"death", " ", "rate"}], " ", "=", " ", 
       RowBox[{
       "growth", " ", "rate", " ", "\[Times]", " ", "cell", " ", "loss", " ", 
        "factor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dr", "=", 
      RowBox[{"gr", "*", "celllossrate"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"rl", " ", "=", " ", 
        RowBox[{"'", "resistance", " ", 
         RowBox[{"level", "'"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"being", " ", "the", " ", "fold"}], "-", 
        RowBox[{
        "change", " ", "in", " ", "KI", " ", "in", " ", "drug", " ", 
         "resistant", " ", "sub"}], "-", "populations"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rl", "=", "10"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"pre", "-", 
       RowBox[{"existing", " ", "resistance", " ", "frequencies"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resistance", " ", "to", " ", "drug", " ", "1"}], " ", "*)"}], 
     " ", 
     RowBox[{"rf1", "=", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resistance", " ", "to", " ", "drug", " ", "2"}], " ", "*)"}], 
     " ", 
     RowBox[{"rf2", "=", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"resistance", " ", "to", " ", "both", " ", "drugs"}], " ", 
      "*)"}], " ", 
     RowBox[{"rfCross", "=", 
      RowBox[{"5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initial", " ", "population", " ", "size"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"p0", "=", 
      SuperscriptBox["10", "10"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"drug", " ", "dose"}], ",", " ", 
       RowBox[{"previously", " ", "defined"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d", "=", "DrugDose"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"duration", " ", "of", " ", "numerical", " ", "simulation"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SimulationDuration", "=", "4"}], ";", " ", 
     RowBox[{"(*", "years", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"simulating", " ", "an", " ", "untreated", " ", "tumor"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultUntreated", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
         "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "tumor", " ", "cells", " ",
        "with", " ", "baseline", " ", "drug", " ", "sensitivity"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultS", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogCytotoxicInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", "p0"}]}], "}"}], ",", 
         "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
       "with", " ", "resistance", " ", "to", " ", "drug", " ", "1"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultR1", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogCytotoxicInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI2internal"}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rf1"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
       "with", " ", "resistance", " ", "to", " ", "drug", " ", "2"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultR2", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogCytotoxicInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "KI1internal"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rf2"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "growth", " ", "of", " ", "subpopulation", " ", 
       "with", " ", "resistance", " ", "to", " ", "both", " ", "drugs"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mysimresultRR", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"gr", "*", 
              RowBox[{"p", "[", "t", "]"}], "*", 
              RowBox[{"DrugTreatmentOverTime", "[", 
               RowBox[{"t", ",", 
                RowBox[{"LogCytotoxicInhibitionModel", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LogDrug", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", "d"}], "]"}]}], ",", 
                   RowBox[{"LogKI", "\[Rule]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI1internal", "*", "rl"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"KI2internal", "*", "rl"}]}], "]"}]}], "}"}], 
                    "]"}]}], ",", 
                   RowBox[{"NH", "\[Rule]", "1"}]}], "}"}]}]}], "]"}]}], "-", 
             RowBox[{"dr", "*", 
              RowBox[{"p", "[", "t", "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"p0", "*", "rfCross"}]}]}], "}"}], ",", "p", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"SimulationDuration", "*", "365"}]}], "}"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Summing", " ", "up", " ", "the", " ", "total", " ", "population", 
         " ", "size", " ", "at", " ", "each", " ", "time"}], ";", " ", 
        RowBox[{"sum", " ", "of", " ", "populations", " ", "S"}]}], ",", " ", 
       "R1", ",", " ", "R2", ",", " ", 
       RowBox[{
        RowBox[{"RR", ".", " ", "Table"}], " ", "has", " ", "an", " ", 
        "entry", " ", "at", " ", "every", " ", "2", " ", 
        RowBox[{"days", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PopulationOverTimeTable", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}]}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.1"}], ")"}], "*", "365"}], 
          ",", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "If", " ", "progression", " ", "threshold", " ", "is", " ", "not", " ",
         "reached", " ", "within", " ", "the", " ", "duration", " ", "of", 
        " ", "the", " ", "simulation"}], ",", " ", 
       RowBox[{
       "return", " ", "a", " ", "number", " ", "larger", " ", "than", " ", 
        "the", " ", "duration", " ", "of", " ", "simulation", " ", 
        RowBox[{"(", 
         RowBox[{
         "this", " ", "can", " ", "be", " ", "used", " ", "to", " ", 
          "identify", " ", "such", " ", "events"}], ")"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PopulationOverTimeTable", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], "<", 
        "ProgressionThreshold"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"SimulationDuration", "+", "1"}], ")"}], "*", "365"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"final", " ", 
        RowBox[{"output", ":", " ", 
         RowBox[{
         "the", " ", "earliest", " ", "time", " ", "at", " ", "which", " ", 
          "the", " ", "total", " ", "population", " ", "size", " ", 
          "surpasses", " ", 
          RowBox[{"the", " ", "'"}], "progression", " ", 
          RowBox[{"threshold", "'"}]}]}]}], ",", " ", 
       RowBox[{
       "taken", " ", "in", " ", "this", " ", "file", " ", "to", " ", "be", 
        " ", "twice", " ", "the", " ", "initial", " ", "population"}], ",", 
       " ", 
       RowBox[{
       "though", " ", "it", " ", "could", " ", "be", " ", "varied"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PopulationOverTimeTable", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ">", "ProgressionThreshold"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6613624139911203`*^9, 3.6613624142151327`*^9}, {
   3.661362651344696*^9, 3.6613626515187054`*^9}, {3.661362741354844*^9, 
   3.6613627415148535`*^9}, {3.661362798060087*^9, 3.6613627981300917`*^9}, {
   3.6614336684773397`*^9, 3.6614336707844715`*^9}, {3.6614339076940217`*^9, 
   3.6614339079890385`*^9}, {3.661433953224626*^9, 3.6614339894016953`*^9}, {
   3.6614346259381027`*^9, 3.6614346261851172`*^9}, {3.661434758042659*^9, 
   3.661434763921995*^9}, {3.661436281480795*^9, 3.6614362820188255`*^9}, {
   3.661436812322157*^9, 3.6614368360745153`*^9}, {3.661438022898398*^9, 
   3.661438023144412*^9}, {3.661438116870773*^9, 3.6614381171697903`*^9}, {
   3.661438410730581*^9, 3.661438437767127*^9}, {3.6614385780331497`*^9, 
   3.6614385975632668`*^9}, {3.6627284035780935`*^9, 
   3.6627284036740985`*^9}, {3.6627284437993937`*^9, 
   3.6627284443304243`*^9}, {3.662728477685332*^9, 3.662728477862342*^9}, {
   3.662728536438692*^9, 3.6627285364926953`*^9}, {3.662728630230057*^9, 
   3.662728630326062*^9}, {3.6627388991014028`*^9, 3.662738899455423*^9}, {
   3.6627445672096*^9, 3.6627445672496023`*^9}, {3.662744606008819*^9, 
   3.662744606041821*^9}, {3.6628115295967283`*^9, 3.6628115296477313`*^9}, {
   3.6628115986546783`*^9, 3.66281159886769*^9}, {3.6628120938450017`*^9, 
   3.662812093890004*^9}, 3.662812423763872*^9, {3.662812636789056*^9, 
   3.6628126396842213`*^9}, {3.6628127097392282`*^9, 3.66281270993424*^9}, {
   3.6628138076690264`*^9, 3.66281380790104*^9}, {3.6628139290019665`*^9, 
   3.662813929278982*^9}, {3.662814041223385*^9, 3.6628140444985723`*^9}, {
   3.6628143892422905`*^9, 3.662814389312295*^9}, {3.6670569383126955`*^9, 
   3.667056938379699*^9}, {3.6670570678151026`*^9, 3.6670570690631742`*^9}, {
   3.667057165447687*^9, 3.667057194073324*^9}, {3.667057895996472*^9, 
   3.667057896067476*^9}, {3.667058088182464*^9, 3.66705808828547*^9}, 
   3.6670581305398865`*^9, {3.6670582892309637`*^9, 3.6670582896839895`*^9}, {
   3.6670583953220315`*^9, 3.6670584158712068`*^9}, {3.6670586395289993`*^9, 
   3.667058639644006*^9}, 3.6670587792949934`*^9, {3.6738259288119993`*^9, 
   3.67382592898901*^9}, {3.673826028621708*^9, 3.6738260288127193`*^9}, {
   3.6738260687260017`*^9, 3.6738260692050295`*^9}, {3.6738261931891212`*^9, 
   3.6738261939481645`*^9}, {3.673826248725298*^9, 3.6738262488523045`*^9}, {
   3.673826370997291*^9, 3.6738263710602946`*^9}, {3.6855789392822747`*^9, 
   3.685578941282389*^9}, {3.6855923524630365`*^9, 3.685592409214283*^9}, {
   3.685592466603565*^9, 3.6855924718798676`*^9}, {3.6855925339784193`*^9, 
   3.685592537099598*^9}, 3.685592694766616*^9, {3.685593004232316*^9, 
   3.6855930044253273`*^9}, {3.68559318036339*^9, 3.685593206689896*^9}}],

Cell[TextData[StyleBox["\[OpenCurlyQuote]SimulatePopulation\[CloseCurlyQuote] \
executes the above simulation (ProgressionTime) for each individual in a \
population of 200.\nIt takes a single input parameter, being the correlation \
between KI for drug 1 and KI for drug 2",
 FontSize->16,
 FontWeight->"Plain",
 FontColor->RGBColor[
  0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.6833727718175087`*^9, 3.6833729354508677`*^9}, {3.6833761403000903`*^9, 
   3.6833764146477823`*^9}, {3.683377379249954*^9, 3.6833774898352795`*^9}, {
   3.683377877317442*^9, 3.683377894186407*^9}, {3.683377965663495*^9, 
   3.683378043626954*^9}, {3.6833780747307334`*^9, 3.683378134389146*^9}, {
   3.683378168406091*^9, 3.6833782242992883`*^9}, {3.6833782544580135`*^9, 
   3.683378484433167*^9}, {3.6833795989259124`*^9, 3.683379628567608*^9}, {
   3.6833806214523973`*^9, 3.683380638522374*^9}, {3.6833815103122377`*^9, 
   3.683381514820495*^9}, {3.683384804343645*^9, 3.6833848049566803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulatePopulationCytotoxic", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"KI1table", ",", "KI2table"}], "}"}], ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KI1table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KI2table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomVariate", "[", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{
          "MedianLogDrugSensitivity", ",", 
           "StandardDeviationInDrugSensitivity"}], "]"}], "]"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"logKI1", "=", 
      RowBox[{"10", "^", "KI1table"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"logKI2", "=", 
      RowBox[{"10", "^", "KI2table"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"NumberOfTumorsSimulated", "=", "200"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgressionThreshold", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "no", " ", 
        RowBox[{"treatment", ".", " ", "No"}], " ", "treatment", " ", "is", 
        " ", "implemented", " ", "by", " ", "setting", " ", "KI1", " ", "and",
         " ", "KI2", " ", "to", " ", "equal", " ", "1000"}], ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "neither", " ", "drug", " ", 
        "has", " ", "any", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"UntreatedProgressionTimes", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeCytotoxic", "[", 
          RowBox[{"1000", ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "treatment", " ", "by", " ", "monotherapy", 
        " ", 
        RowBox[{"#1", ".", " ", "The"}], " ", "absence", " ", "of", " ", 
        "monotherapy", " ", "#2", " ", "is", " ", "implemented", " ", "by", 
        " ", "setting", " ", "KI2", " ", "to", " ", "equal", " ", "1000"}], 
       ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "drug", " ", "2", " ", "has",
         " ", "no", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Monotherapy1ProgressionTimes", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeCytotoxic", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "1000", ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
        "time", " ", "for", " ", "treatment", " ", "by", " ", "monotherapy", 
        " ", 
        RowBox[{"#2", ".", " ", "The"}], " ", "absence", " ", "of", " ", 
        "monotherapy", " ", "#1", " ", "is", " ", "implemented", " ", "by", 
        " ", "setting", " ", "KI1", " ", "to", " ", "equal", " ", "1000"}], 
       ";", " ", 
       RowBox[{
       "at", " ", "this", " ", "magnitude", " ", "drug", " ", "2", " ", "has",
         " ", "no", " ", "inhibitory", " ", "effect", " ", "on", " ", 
        "growth"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Monotherapy2ProgressionTimes", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeCytotoxic", "[", 
          RowBox[{"1000", ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "simulating", " ", "progression", " ", "free", " ", "survival", " ", 
       "time", " ", "for", " ", "treatment", " ", "by", " ", "a", " ", 
       "combination", " ", "of", " ", "monotherapy", " ", "#1", " ", "and", 
       " ", "#2"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"CombinationProgressionTimes", "=", 
      RowBox[{"Parallelize", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ProgressionTimeCytotoxic", "[", 
          RowBox[{
           RowBox[{
           "logKI1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "logKI2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "DistributionOfGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "ProgressionThreshold"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumberOfTumorsSimulated"}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plotting", " ", "survival", " ", "functions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"SurvivalPlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", "UntreatedProgressionTimes", 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3.5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", "Monotherapy2ProgressionTimes", 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3.5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", "Monotherapy1ProgressionTimes", 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3.5", "*", "365"}], ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"SurvivalFunction", "[", 
                RowBox[{
                "EmpiricalDistribution", "[", "CombinationProgressionTimes", 
                 "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{"3.5", "*", "365"}], ",", "2"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "*", 
                RowBox[{"2", "/", "61"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "2000", ",", 
               RowBox[{
                RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.015", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"36", "*", "30.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"3", "/", "4"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Progression free survival (months)\>\"", ",", 
           "\"\<Patients (%)\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "250", "}"}], ",", 
           RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}],
         ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Untreated\>\"", ",", "\"\<Monotherapy B\>\"", ",", 
           "\"\<Monotherapy A\>\"", ",", 
           "\"\<Combination,\\nindependent drug action\>\""}], "}"}]}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.661360802030921*^9, 3.66136103279212*^9}, {
   3.661361351225333*^9, 3.661361365826168*^9}, {3.6613614571693926`*^9, 
   3.661361463497755*^9}, {3.661361520962042*^9, 3.661361609435102*^9}, {
   3.6613621448187237`*^9, 3.6613621450417366`*^9}, {3.661362678256235*^9, 
   3.6613626831595154`*^9}, {3.661433740448456*^9, 3.6614337660409193`*^9}, {
   3.661433883657647*^9, 3.661433894709279*^9}, {3.661433927721167*^9, 
   3.6614339306653357`*^9}, {3.6614374038249893`*^9, 3.661437406496142*^9}, {
   3.661437602874374*^9, 3.661437605448521*^9}, {3.661437639986497*^9, 
   3.661437702442069*^9}, {3.6614384044652224`*^9, 3.6614384168589315`*^9}, {
   3.661438625552868*^9, 3.6614386279930077`*^9}, 3.661438691977667*^9, {
   3.6624189972916536`*^9, 3.6624190236521616`*^9}, {3.662430189432808*^9, 
   3.662430189527813*^9}, {3.662430332119969*^9, 3.6624303356311693`*^9}, {
   3.662813869868584*^9, 3.662813871788694*^9}, {3.6628143046894546`*^9, 
   3.662814306795575*^9}, {3.6629079586422625`*^9, 3.662907959788328*^9}, {
   3.6670570467528977`*^9, 3.6670570485099983`*^9}, {3.667057145677556*^9, 
   3.6670571474016542`*^9}, {3.6670573374205227`*^9, 
   3.6670573386675944`*^9}, {3.6670579193258057`*^9, 3.667057920598879*^9}, {
   3.683373115559168*^9, 3.6833731155631685`*^9}, {3.683378699625475*^9, 
   3.6833787170064697`*^9}, 3.683379564839963*^9, {3.6833806412235284`*^9, 
   3.683380674099409*^9}, {3.683381500898699*^9, 3.683381501005705*^9}, {
   3.68338168396017*^9, 3.683381686643323*^9}, {3.683381721651325*^9, 
   3.6833817371342106`*^9}, {3.6833817842359047`*^9, 
   3.6833818437373085`*^9}, {3.683381903858747*^9, 3.6833821191210594`*^9}, {
   3.6833822470963793`*^9, 3.683382270734731*^9}, {3.68338239135463*^9, 
   3.6833824438236313`*^9}, {3.68338247387335*^9, 3.6833824863120613`*^9}, {
   3.6833847679495635`*^9, 3.68338479202194*^9}, {3.683388708584955*^9, 
   3.683388785743368*^9}, {3.685593089046167*^9, 3.685593091650316*^9}, {
   3.6855931245361967`*^9, 3.6855931287124357`*^9}, {3.6855931993364754`*^9, 
   3.6855932457041273`*^9}, {3.703715541514988*^9, 3.703715541748001*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The benefit of independent drug action in a combination is present also in a \
model of cycles of cytotoxic therapy:\
\>", "Subsubsection",
 CellChangeTimes->{{3.6855933165831814`*^9, 3.685593344640786*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SimulatePopulationCytotoxic", "[", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S7B, Cytotoxic model PFS.pdf\>\""}], ",", "%", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.662429115532384*^9, 3.6624291158194003`*^9}, 
   3.6855931406751204`*^9, {3.68559814532937*^9, 3.685598155089928*^9}, {
   3.6855995690588026`*^9, 3.685599569258814*^9}, {3.685600205300194*^9, 
   3.685600206250248*^9}, {3.7160751391960254`*^9, 3.716075140699111*^9}, 
   3.7160751887018566`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Spider plots, for monotherapy\n",
 StyleBox["Here we use precisely the same selection of growth rate and drug \
sensitivity parameters in Figure 6D, to compare tumor\[CloseCurlyQuote]s drug \
responses in this alternative model structure",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6628101118266363`*^9, 3.6628101159888744`*^9}, {
  3.663199370979868*^9, 3.6631993750230994`*^9}, {3.6833824936374807`*^9, 
  3.6833824949335546`*^9}, {3.683382843706503*^9, 3.6833828461066403`*^9}, {
  3.6833854797402754`*^9, 3.683385480743333*^9}, {3.6855933585205803`*^9, 
  3.6855934033051414`*^9}}],

Cell[TextData[{
 StyleBox["Because growth rates and drug sensitivities (KI) are randomly \
drawn from distributions, reproducible example trajectories can only be \
generated here by \[OpenCurlyQuote]hard-coding\[CloseCurlyQuote] some sample \
values.\nNote: in the simulation of cycles of cytotoxic therapy, numerical \
error is larger than in simulations of continuous therapy because of the \
discontinuity in drug administration (3 days in every 30) - this introduces \
minor variation between repeat executions of the simulation. \n\nA small set \
of growth rates was generated by\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["Table[Max[{1/100,RandomVariate[NormalDistribution[6.9/100,2.1/100]]\
}],{50}];",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->GrayLevel[0]],
 StyleBox["\n\nA small  set of KI values was generated by\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]],
 StyleBox["10^Table[RandomVariate[NormalDistribution[MedianLogDrugSensitivity,\
StandardDeviationInDrugSensitivity]],{50}]\n\n",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->GrayLevel[0]],
 StyleBox["These parameters generate 50 different tumor kinetic trajectories. \
A few of these trajectories have been selected here, non-randomly, to \
illustrate the variety of different kinetic trajectories.",
  FontSize->16,
  FontWeight->"Plain",
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Text",
 CellChangeTimes->{{3.6613596068145585`*^9, 3.6613596383893642`*^9}, {
   3.6808762073132544`*^9, 3.6808762130965853`*^9}, {3.6808765165289407`*^9, 
   3.68087655096891*^9}, {3.680876598393623*^9, 3.680876776441807*^9}, {
   3.6808768538742356`*^9, 3.6808768619856997`*^9}, {3.680876900841922*^9, 
   3.6808769332997785`*^9}, {3.6808775018262963`*^9, 3.680877628418537*^9}, {
   3.6808777543787413`*^9, 3.6808778007133913`*^9}, {3.6808779376362233`*^9, 
   3.680878055338956*^9}, {3.680878184955369*^9, 3.6808781932348423`*^9}, {
   3.6808782489010267`*^9, 3.680878261669757*^9}, {3.6808790929323025`*^9, 
   3.680879095939474*^9}, {3.6808791399629927`*^9, 3.6808792060117702`*^9}, {
   3.680879382908888*^9, 3.6808794029230328`*^9}, {3.6808794359159203`*^9, 
   3.680879493228198*^9}, {3.680879528214199*^9, 3.6808796103878994`*^9}, {
   3.680879646163945*^9, 3.6808796883723593`*^9}, {3.680880041756572*^9, 
   3.6808803518053055`*^9}, {3.680880395084781*^9, 3.680880471157132*^9}, {
   3.680881051374319*^9, 3.6808810758507185`*^9}, {3.680881170693144*^9, 
   3.680881203309009*^9}, {3.6808813877325573`*^9, 3.6808814258367367`*^9}, {
   3.6808815001659884`*^9, 3.6808815598374014`*^9}, {3.6808816675825644`*^9, 
   3.6808817544535327`*^9}, {3.6808818025102816`*^9, 3.68088181559803*^9}, {
   3.680881881397794*^9, 3.680881888806217*^9}, {3.680881927013403*^9, 
   3.6808819959343443`*^9}, {3.6808820793743167`*^9, 3.6808821393686523`*^9}, 
   3.6808821740419006`*^9, {3.6808822226461725`*^9, 3.680882223304175*^9}, {
   3.680882308335638*^9, 3.6808824721825123`*^9}, {3.6808826722506084`*^9, 
   3.680882694208728*^9}, {3.680911689610447*^9, 3.6809116898834624`*^9}, {
   3.6833713090625534`*^9, 3.6833713107235556`*^9}, 3.683371371948731*^9, {
   3.6833714378228235`*^9, 3.6833714412928286`*^9}, {3.6833716441941147`*^9, 
   3.6833717765743003`*^9}, {3.683371815906356*^9, 3.683372176810667*^9}, {
   3.6833727718175087`*^9, 3.6833729354508677`*^9}, {3.6833761403000903`*^9, 
   3.6833764146477823`*^9}, {3.683377379249954*^9, 3.6833774898352795`*^9}, {
   3.683377877317442*^9, 3.683377894186407*^9}, {3.683377965663495*^9, 
   3.683378043626954*^9}, {3.6833780747307334`*^9, 3.683378134389146*^9}, {
   3.683378168406091*^9, 3.6833782242992883`*^9}, {3.6833782544580135`*^9, 
   3.683378484433167*^9}, {3.6833795989259124`*^9, 3.683379628567608*^9}, {
   3.6833806214523973`*^9, 3.683380638522374*^9}, {3.6833815103122377`*^9, 
   3.683381514820495*^9}, {3.683384804343645*^9, 3.6833848049566803`*^9}, {
   3.683385488416772*^9, 3.6833855707574816`*^9}, {3.684196334948473*^9, 
   3.684196494467812*^9}, {3.685600559906476*^9, 3.685600659010144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ASmallSetOfGrowthRates", "=", 
    RowBox[{"{", 
     RowBox[{
     "0.052`", ",", "0.06`", ",", "0.057`", ",", "0.086`", ",", "0.068`", ",",
       "0.095`", ",", "0.057`", ",", "0.053`", ",", "0.045`", ",", "0.033`", 
      ",", "0.083`", ",", "0.084`", ",", "0.061`", ",", "0.094`", ",", 
      "0.092`", ",", "0.077`", ",", "0.088`", ",", "0.1`", ",", "0.098`", ",",
       "0.055`", ",", "0.059`", ",", "0.098`", ",", "0.048`", ",", "0.043`", 
      ",", "0.028`", ",", "0.108`", ",", "0.1`", ",", "0.029`", ",", "0.062`",
       ",", "0.058`", ",", "0.045`", ",", "0.063`", ",", "0.088`", ",", 
      "0.079`", ",", "0.038`", ",", "0.057`", ",", "0.121`", ",", "0.075`", 
      ",", "0.054`", ",", "0.101`", ",", "0.063`", ",", "0.069`", ",", 
      "0.069`", ",", "0.046`", ",", "0.047`", ",", "0.113`", ",", "0.058`", 
      ",", "0.094`", ",", "0.09`", ",", "0.067`"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ASmallSetOfKIvalues", "=", 
    RowBox[{"{", 
     RowBox[{
     "5.41`", ",", "3.84`", ",", "0.62`", ",", "0.95`", ",", "1.83`", ",", 
      "3.46`", ",", "0.79`", ",", "1.06`", ",", "0.38`", ",", "4.06`", ",", 
      "4.1`", ",", "3.54`", ",", "0.61`", ",", "2.85`", ",", "3.2`", ",", 
      "3.82`", ",", "1.45`", ",", "1.3`", ",", "1.25`", ",", "0.96`", ",", 
      "3.63`", ",", "0.43`", ",", "0.68`", ",", "2.53`", ",", "3.96`", ",", 
      "1.14`", ",", "1.69`", ",", "0.32`", ",", "1.38`", ",", "0.4`", ",", 
      "0.96`", ",", "1.68`", ",", "0.63`", ",", "2.1`", ",", "0.34`", ",", 
      "1.79`", ",", "0.15`", ",", "15.78`", ",", "0.2`", ",", "0.12`", ",", 
      "0.42`", ",", "1.90`", ",", "26.7`", ",", "0.24`", ",", "0.89`", ",", 
      "1.25`", ",", "4.62`", ",", "0.93`", ",", "0.8`", ",", "2.62`"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProgressionTimeCytotoxic", "[", 
      RowBox[{
       RowBox[{
       "ASmallSetOfKIvalues", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
        "\[RightDoubleBracket]"}], ",", "1000", ",", 
       RowBox[{
       "ASmallSetOfGrowthRates", "\[LeftDoubleBracket]", 
        "SimulatedTumorNumber", "\[RightDoubleBracket]"}], ",", 
       "ProgressionThreshold"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "TotalPopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], 
      "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
              "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
              "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
              "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], 
               ")"}]}], ")"}], "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "SPopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "R1PopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], 
      "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "R2PopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], 
      "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RRPopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], 
      "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}], 
            "/", 
            SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
          ",", "10"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"SimulatedTumorNumber", ",", "1", ",", "50"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"a", " ", "subset", " ", "was", " ", "selected", " ", 
    RowBox[{"(", 
     RowBox[{"non", "-", "randomly"}], ")"}], " ", "to", " ", "illustrate", 
    " ", "the", " ", "diversity", " ", "of", " ", "different", " ", 
    "treatment", " ", "outcomes"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"TotalPopulationOverTimeCytotoxic", "[", "stn", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"stn", ",", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "3", ",", "4", ",", "7", ",", "9", ",", "10", ",", "20", 
          ",", "22", ",", "23"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"30", "*", "30.5"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"16", ",", "i"}], "]"}], ",", 
             RowBox[{"ColorConvert", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"16", ",", "i"}], "]"}], ",", "\"\<Grayscale\>\""}], 
              "]"}]}], "}"}], ",", "0.7"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8", 
           ",", "9", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.0", ",", "0"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"AxesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"6", "/", "4"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Change from baseline\\n tumor volume(%)\>\""}], "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       "*)"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S7B, Cytotoxic model kinetics.pdf\>\""}], ",", 
    "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6833850659216065`*^9, 3.6833851193996654`*^9}, {
   3.683385151007473*^9, 3.683385169231516*^9}, {3.6833852033544674`*^9, 
   3.6833853227862988`*^9}, {3.6833855432879105`*^9, 3.683385647166852*^9}, {
   3.683385696153654*^9, 3.6833857179549007`*^9}, {3.683389739010892*^9, 
   3.6833897553018236`*^9}, {3.6833898398636603`*^9, 
   3.6833898478211155`*^9}, {3.684195578265291*^9, 3.684195579095293*^9}, {
   3.6841956334564095`*^9, 3.684195702647558*^9}, 3.6841963117174263`*^9, {
   3.685593429225624*^9, 3.6855934327738276`*^9}, {3.685598272173625*^9, 
   3.6855982983021193`*^9}, {3.685599574155094*^9, 3.685599574307103*^9}, {
   3.6856001413945384`*^9, 3.685600141649553*^9}, {3.7160751461714244`*^9, 
   3.716075146587448*^9}, 3.7160751892638893`*^9}],

Cell[CellGroupData[{

Cell["A larger batch produced by randomly drawn parameters", "Subsubsection",
 CellChangeTimes->{{3.683385797600456*^9, 3.683385804538853*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ProgressionTimeCytotoxic", "[", 
     RowBox[{
      RowBox[{
      "logKI1", "\[LeftDoubleBracket]", "SimulatedTumorNumber", 
       "\[RightDoubleBracket]"}], ",", "1000", ",", 
      RowBox[{
      "DistributionOfGrowthRates", "\[LeftDoubleBracket]", 
       "SimulatedTumorNumber", "\[RightDoubleBracket]"}], ",", 
      "ProgressionThreshold"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "TotalPopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], 
     "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
             "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}]}],
             ")"}], "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "SPopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultS"}], ")"}], "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "R1PopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR1"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "R2PopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultR2"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "RRPopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", "t", "]"}], "/.", "mysimresultRR"}], ")"}], 
           "/", 
           SuperscriptBox["10", "10"]}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"SimulationDuration", "-", "0.5"}], ")"}], "*", "365"}], 
         ",", "10"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"SimulatedTumorNumber", ",", "1", ",", "200"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6628101235253057`*^9, 3.6628101789304743`*^9}, {
   3.6628102536167464`*^9, 3.662810291503914*^9}, {3.6628105464424953`*^9, 
   3.6628105786153355`*^9}, {3.6628127413220353`*^9, 
   3.6628127414000397`*^9}, {3.663191791647355*^9, 3.6631919060098963`*^9}, {
   3.6631920412896338`*^9, 3.663192089168372*^9}, {3.66319431827287*^9, 
   3.6631943993045044`*^9}, 3.683381501024706*^9, {3.6833825476395693`*^9, 
   3.683382555050993*^9}, {3.683382757158553*^9, 3.683382822166271*^9}, {
   3.6833845504121213`*^9, 3.6833845751455355`*^9}, {3.6833848451039762`*^9, 
   3.6833848558405905`*^9}, {3.683384891684641*^9, 3.683384947862854*^9}, 
   3.6833856628927517`*^9, 3.6833857529919047`*^9, 3.6855934735171576`*^9, 
   3.685598388578283*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
      "TotalPopulationOverTimeCytotoxic", "[", "SimulatedTumorNumber", "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"SimulatedTumorNumber", ",", "50", ",", "100"}], "}"}]}], 
     "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"3", "*", "366"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "0.7", ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0.3", ",", "0.5"}], "}"}], "]"}]}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}], ",", 
       RowBox[{"{", "200", "}"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"AxesStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", 
              RowBox[{"2", "/", "61"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "2000", ",", 
             RowBox[{
              RowBox[{"3", "/", "2"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "400", "}"}], ",", 
       RowBox[{"{", "500", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Time (months)\>\"", ",", 
       "\"\<Change from baseline\\n tumor volume(%)\>\""}], "}"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
      "}"}]}]}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6628101235253057`*^9, 3.6628101789304743`*^9}, {
   3.6628102536167464`*^9, 3.662810291503914*^9}, {3.6628105464424953`*^9, 
   3.6628105786153355`*^9}, {3.6628127413220353`*^9, 
   3.6628127414000397`*^9}, {3.663191791647355*^9, 3.6631919060098963`*^9}, {
   3.6631920412896338`*^9, 3.663192249128522*^9}, {3.6631922916989565`*^9, 
   3.6631924710992174`*^9}, {3.66319252289218*^9, 3.663192547996616*^9}, {
   3.6631926297242904`*^9, 3.6631926661393733`*^9}, {3.66319272027547*^9, 
   3.6631927252037516`*^9}, {3.6631927569085646`*^9, 3.663192776835705*^9}, {
   3.663192819076121*^9, 3.6631928804916334`*^9}, {3.6631944056908703`*^9, 
   3.663194410082121*^9}, {3.6631989610504217`*^9, 3.6631989617684627`*^9}, {
   3.6631990004986777`*^9, 3.663199009890215*^9}, {3.6670573731865687`*^9, 
   3.6670573825651054`*^9}, {3.6680844419722176`*^9, 3.668084451180744*^9}, {
   3.6708541284251394`*^9, 3.670854134036461*^9}, {3.683382524137225*^9, 
   3.6833825394350996`*^9}, 3.683382921117931*^9, {3.683384954589239*^9, 
   3.6833849553762836`*^9}, {3.6833857765682535`*^9, 3.683385776647258*^9}, {
   3.68338621499533*^9, 3.6833862151913414`*^9}, {3.683389702870825*^9, 
   3.683389725350111*^9}, 3.685598393302553*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This interface allows the user to scroll through different individual tumors \
and inspect the growth (or inhibition) of its sub-populations over time.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6833829800623026`*^9, 3.683383022278717*^9}, 
   3.6833859881373544`*^9, {3.685598440904276*^9, 3.6855984413283*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TotalPopulationOverTimeCytotoxic", "[", "sample", "]"}], ",", 
       RowBox[{"SPopulationOverTimeCytotoxic", "[", "sample", "]"}], ",", 
       RowBox[{"R1PopulationOverTimeCytotoxic", "[", "sample", "]"}], ",", 
       RowBox[{"R2PopulationOverTimeCytotoxic", "[", "sample", "]"}], ",", 
       RowBox[{"RRPopulationOverTimeCytotoxic", "[", "sample", "]"}]}], "}"}],
      ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"30", "*", "30.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Opacity", "[", "1", "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"col", ",", 
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"col", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", 
               RowBox[{"Green", ",", "0.3"}], "]"}], ",", "Red", ",", "Blue", 
              ",", "Purple"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.0", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"AxesStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"100", "*", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "1"}], ",", "1", ",", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", 
               RowBox[{"2", "/", "61"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "2000", ",", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "*", "122"}]}], "}"}]}], "]"}], ",", 
          "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Time (months)\>\"", ",", "\"\<Change from baseline (%)\>\""}], 
       "}"}]}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
        RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", "*", "366"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Total population\>\"", ",", "\"\<Most sensitive (S)\>\"", ",", 
        "\"\<Resistant to drug 1 (R1)\>\"", ",", 
        "\"\<Resistant to drug 2 (R2)\>\"", ",", 
        "\"\<Cross-resistant (RR)\>\""}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"sample", ",", "1", ",", "200", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.668084848788486*^9, 3.6680848666845093`*^9}, {
  3.6833826879475946`*^9, 3.683382740268587*^9}, {3.6833828871959906`*^9, 
  3.683382942596159*^9}, {3.683382973099904*^9, 3.6833829787042246`*^9}, {
  3.6833858325204535`*^9, 3.6833859230686326`*^9}, {3.683385956636553*^9, 
  3.683385967155154*^9}, {3.6833868445173364`*^9, 3.6833869231548347`*^9}, {
  3.6855984008419847`*^9, 3.685598411898617*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1903, 982},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{841.8, 1190.52},
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->36},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1721, 22, 70, "Section"],
Cell[2304, 46, 10454, 222, 1227, "Text"],
Cell[CellGroupData[{
Cell[12783, 272, 121, 1, 39, "Subsubsection"],
Cell[12907, 275, 2514, 61, 114, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15458, 341, 112, 1, 39, "Subsubsection"],
Cell[15573, 344, 1522, 38, 108, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17132, 387, 132, 1, 39, "Subsubsection"],
Cell[17267, 390, 2077, 52, 146, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19381, 447, 427, 7, 67, "Subsubsection"],
Cell[19811, 456, 4117, 108, 261, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23965, 569, 274, 5, 39, "Subsubsection"],
Cell[24242, 576, 1994, 51, 51, "Input"]
}, Open  ]],
Cell[26251, 630, 259, 5, 39, "Subsubsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26547, 640, 253, 3, 70, "Section"],
Cell[26803, 645, 6473, 155, 292, "Text"],
Cell[33279, 802, 3667, 83, 233, "Input"],
Cell[36949, 887, 3568, 94, 109, "Input"],
Cell[CellGroupData[{
Cell[40542, 985, 131, 1, 39, "Subsubsection"],
Cell[40676, 988, 5227, 117, 139, "Text"],
Cell[45906, 1107, 2841, 78, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48784, 1190, 663, 12, 67, "Subsection"],
Cell[49450, 1204, 144, 3, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49631, 1212, 559, 11, 43, "Subsection"],
Cell[50193, 1225, 2953, 85, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53183, 1315, 2235, 50, 241, "Subsection"],
Cell[55421, 1367, 13707, 351, 413, "Input"],
Cell[69131, 1720, 11899, 296, 432, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81079, 2022, 272, 3, 70, "Section"],
Cell[81354, 2027, 7383, 152, 597, "Text"],
Cell[88740, 2181, 21502, 475, 1063, "Input"],
Cell[110245, 2658, 3014, 41, 74, "Text"],
Cell[113262, 2701, 16261, 361, 664, "Input"],
Cell[CellGroupData[{
Cell[129548, 3066, 147, 2, 39, "Subsubsection"],
Cell[129698, 3070, 890, 17, 90, "Input"],
Cell[130591, 3089, 373, 9, 30, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131013, 3104, 321, 4, 70, "Section"],
Cell[131337, 3110, 3945, 66, 200, "Text"],
Cell[135285, 3178, 12947, 330, 486, "Input"],
Cell[CellGroupData[{
Cell[148257, 3512, 143, 1, 39, "Subsubsection"],
Cell[148403, 3515, 5241, 136, 201, "Input"],
Cell[153647, 3653, 5829, 147, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159513, 3805, 282, 5, 39, "Subsubsection"],
Cell[159798, 3812, 6068, 158, 164, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[165915, 3976, 265, 3, 70, "Section"],
Cell[166183, 3981, 3619, 75, 282, "Input"],
Cell[169805, 4058, 390, 9, 30, "Input"],
Cell[170198, 4069, 2027, 53, 88, "Input"],
Cell[172228, 4124, 7339, 185, 221, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179604, 4314, 380, 5, 70, "Section"],
Cell[CellGroupData[{
Cell[180009, 4323, 168, 2, 39, "Subsubsection"],
Cell[180180, 4327, 5560, 149, 201, "Input"],
Cell[185743, 4478, 5793, 145, 107, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191573, 4628, 282, 5, 39, "Subsubsection"],
Cell[191858, 4635, 6187, 161, 164, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[198094, 4802, 167, 3, 70, "Section"],
Cell[198264, 4807, 435, 10, 50, "Input"],
Cell[198702, 4819, 618, 12, 50, "Input"],
Cell[199323, 4833, 620, 12, 50, "Input"],
Cell[199946, 4847, 9063, 233, 316, "Input"],
Cell[209012, 5082, 330, 9, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209379, 5096, 361, 4, 70, "Section"],
Cell[209743, 5102, 6348, 129, 265, "Text"],
Cell[216094, 5233, 11853, 276, 738, "Input"],
Cell[CellGroupData[{
Cell[227972, 5513, 164, 3, 39, "Subsubsection"],
Cell[228139, 5518, 9328, 221, 434, "Input"],
Cell[237470, 5741, 460, 10, 50, "Input"],
Cell[237933, 5753, 454, 10, 50, "Input"],
Cell[238390, 5765, 559, 11, 50, "Input"],
Cell[238952, 5778, 8880, 230, 316, "Input"],
Cell[247835, 6010, 329, 9, 30, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[248213, 6025, 276, 5, 70, "Section"],
Cell[CellGroupData[{
Cell[248514, 6034, 307, 5, 39, "Subsubsection"],
Cell[248824, 6041, 24879, 578, 1124, "Input"],
Cell[273706, 6621, 708, 15, 50, "Input"],
Cell[274417, 6638, 1279, 30, 50, "Input"],
Cell[275699, 6670, 9213, 224, 297, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284949, 6899, 390, 6, 67, "Subsubsection"],
Cell[285342, 6907, 14943, 336, 662, "Input"],
Cell[300288, 7245, 13156, 304, 569, "Input"],
Cell[313447, 7551, 221, 3, 30, "Input"],
Cell[313671, 7556, 8682, 212, 297, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[322402, 7774, 258, 5, 111, "Section"],
Cell[CellGroupData[{
Cell[322685, 7783, 1082, 18, 207, "Subsubsection"],
Cell[323770, 7803, 12259, 295, 569, "Input"],
Cell[336032, 8100, 747, 16, 50, "Input"],
Cell[336782, 8118, 808, 15, 30, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[337639, 8139, 242, 5, 70, "Section"],
Cell[337884, 8146, 4503, 61, 221, "Text"],
Cell[342390, 8209, 18631, 444, 1006, "Input"],
Cell[361024, 8655, 13073, 300, 626, "Input"],
Cell[CellGroupData[{
Cell[374122, 8959, 116, 1, 39, "Subsubsection"],
Cell[374241, 8962, 575, 11, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374853, 8978, 228, 5, 67, "Subsubsection"],
Cell[375084, 8985, 1663, 39, 88, "Input"],
Cell[376750, 9026, 1545, 34, 69, "Input"],
Cell[378298, 9062, 2797, 68, 113, "Input"],
Cell[381098, 9132, 7098, 189, 202, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[388233, 9326, 688, 12, 111, "Subsubsection"],
Cell[388924, 9340, 1134, 20, 30, "Input"],
Cell[390061, 9362, 7945, 189, 449, "Input"],
Cell[398009, 9553, 1667, 36, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[399713, 9594, 454, 8, 73, "Subsection"],
Cell[400170, 9604, 5247, 124, 297, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[405454, 9733, 379, 6, 49, "Subsection"],
Cell[405836, 9741, 1973, 53, 145, "Input"],
Cell[CellGroupData[{
Cell[407834, 9798, 119, 1, 39, "Subsubsection"],
Cell[407956, 9801, 3061, 66, 145, "Input"],
Cell[411020, 9869, 2868, 80, 73, "Input"],
Cell[413891, 9951, 5209, 140, 149, "Input"],
Cell[419103, 10093, 5100, 122, 130, "Input"],
Cell[424206, 10217, 4533, 116, 149, "Input"],
Cell[428742, 10335, 540, 9, 30, "Input"],
Cell[429285, 10346, 538, 9, 30, "Input"],
Cell[429826, 10357, 540, 9, 30, "Input"],
Cell[430369, 10368, 540, 9, 30, "Input"],
Cell[430912, 10379, 13185, 299, 354, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[444158, 10685, 556, 10, 177, "Title"],
Cell[CellGroupData[{
Cell[444739, 10699, 132, 1, 70, "Section"],
Cell[444874, 10702, 2632, 70, 145, "Input"],
Cell[CellGroupData[{
Cell[447531, 10776, 409, 7, 67, "Subsubsection"],
Cell[447943, 10785, 3388, 91, 249, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[451368, 10881, 859, 21, 67, "Subsubsection"],
Cell[452230, 10904, 2992, 75, 252, "Input"],
Cell[455225, 10981, 22580, 485, 1232, "Input"],
Cell[477808, 11468, 22090, 471, 1137, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[499935, 11944, 646, 16, 67, "Subsubsection"],
Cell[500584, 11962, 1698, 41, 132, "Input"],
Cell[502285, 12005, 13067, 308, 624, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[515389, 12318, 220, 4, 39, "Subsubsection"],
Cell[515612, 12324, 1841, 39, 126, "Input"],
Cell[517456, 12365, 519, 11, 50, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[518024, 12382, 614, 11, 99, "Section"],
Cell[518641, 12395, 3945, 66, 200, "Text"],
Cell[522589, 12463, 12930, 329, 486, "Input"],
Cell[CellGroupData[{
Cell[535544, 12796, 143, 1, 39, "Subsubsection"],
Cell[535690, 12799, 5104, 133, 201, "Input"],
Cell[540797, 12934, 5868, 148, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[546702, 13087, 282, 5, 39, "Subsubsection"],
Cell[546987, 13094, 6165, 160, 164, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[553201, 13260, 614, 10, 157, "Section"],
Cell[CellGroupData[{
Cell[553840, 13274, 1742, 30, 361, "Subsubsection"],
Cell[555585, 13306, 989, 25, 93, "Input"],
Cell[556577, 13333, 5359, 144, 147, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[561973, 13482, 344, 6, 39, "Subsubsection"],
Cell[562320, 13490, 852, 19, 50, "Input"],
Cell[563175, 13511, 12805, 339, 375, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[576017, 13855, 980, 17, 207, "Subsubsection"],
Cell[577000, 13874, 4168, 95, 202, "Input"],
Cell[581171, 13971, 18829, 426, 947, "Input"],
Cell[600003, 14399, 2920, 40, 53, "Text"],
Cell[602926, 14441, 15099, 336, 624, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[618062, 14782, 217, 4, 39, "Subsubsection"],
Cell[618282, 14788, 692, 15, 69, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[619023, 14809, 614, 11, 99, "Section"],
Cell[619640, 14822, 4277, 70, 242, "Text"],
Cell[623920, 14894, 13278, 341, 486, "Input"],
Cell[CellGroupData[{
Cell[637223, 15239, 143, 1, 39, "Subsubsection"],
Cell[637369, 15242, 5314, 141, 201, "Input"],
Cell[642686, 15385, 5867, 148, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[648590, 15538, 324, 5, 39, "Subsubsection"],
Cell[648917, 15545, 6170, 160, 164, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

