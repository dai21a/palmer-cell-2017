(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1209962,      30039]
NotebookOptionsPosition[   1184349,      29326]
NotebookOutlinePosition[   1184970,      29350]
CellTagsIndexPosition[   1184927,      29347]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Written for Wolfram Mathematica 11.0", "Section",
 CellChangeTimes->{{3.683729666894598*^9, 3.68372968669573*^9}}],

Cell[TextData[{
 "Some abbreviations:\n",
 StyleBox["PFS  = progression free survival, defined for this data as time \
for tumor volume to double (close to clinical criteria, where progression = \
25% increase in longest dimension; with 25% increase in all dimensions \
implying approximately double volume)\n\nTumor types:\nCM  = cutaneous \
melanoma (but referred to in code as \[OpenCurlyQuote]Melanoma\
\[CloseCurlyQuote] rather than an abbreviation)\nNSCLC  = non-small cell lung \
cancer\nPDAC  = pancreatic ductal adenocarcinoma\nCRC  = colorectal carcinoma\
\nBRCA  = breast cancer\nGC  = gastric cancer\n\nObjective response criteria:\
\nPD  = progressive disease\nSD  = stable disease\nPR = partial response\nCR \
= complete response",
  FontSize->16,
  FontColor->RGBColor[
   0.7607843137254902, 0.29411764705882354`, 0.08235294117647059]]
}], "Section",
 CellChangeTimes->{{3.6835566551479473`*^9, 3.683556803712228*^9}, {
  3.683556843389307*^9, 3.6835568593533325`*^9}, {3.6835622662885466`*^9, 
  3.6835623522356977`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Importing PDX curve metrics, from Gao ",
 StyleBox["et al",
  FontSlant->"Italic"],
 " (2015), Nature Medicine"
}], "Section",
 CellChangeTimes->{{3.6682712302078934`*^9, 3.6682712360182257`*^9}, {
  3.683556889978383*^9, 3.6835569076174173`*^9}, {3.71547140978039*^9, 
  3.7154714188849106`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6676615480960007`*^9, 3.6676615537603245`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PDXclinicaltrialresponses", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<PDX-CT curve metrics.xlsx\>\""}], ",", "\"\<XLSX\>\""}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6613005560580482`*^9, 3.6613005845816803`*^9}}],

Cell[CellGroupData[{

Cell["\<\
An illustration of the data format:
Our analysis is primarily concerned with \[OpenCurlyQuote]TimeToDouble\
\[CloseCurlyQuote], indicating the duration of Progression Free Survival (PFS)\
\>", "Subsubsection",
 CellChangeTimes->{{3.683556929718458*^9, 3.683556987951562*^9}, {
  3.6835570259006276`*^9, 3.683557028042631*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PDXclinicaltrialresponses", "\[LeftDoubleBracket]", 
   RowBox[{"1", ";;", "8"}], "\[RightDoubleBracket]"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.683556922447443*^9, 3.6835569261664524`*^9}, {
  3.6835623938717656`*^9, 3.683562394241766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ModelNames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Cutaneous melanoma\>\"", ",", "\"\<Non-small cell lung cancer\>\"", 
     ",", "\"\<Pancreatic ductal adenocarcinoma\>\"", ",", 
     "\"\<Colorectal carcinoma\>\"", ",", "\"\<Breast cancer\>\"", ",", 
     "\"\<Gastric cancer\>\""}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.663699932228986*^9, 3.6636999332790456`*^9}, 
   3.6639130777583427`*^9}],

Cell[BoxData[
 RowBox[{"AllModels", "=", 
  RowBox[{"Sort", "[", 
   RowBox[{"Intersection", "[", 
    RowBox[{"PDXclinicaltrialresponses", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"2", ";;"}], ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.661300605544879*^9, 3.661300636190632*^9}}],

Cell[BoxData[
 RowBox[{"AllTreatments", "=", 
  RowBox[{"Sort", "[", 
   RowBox[{"Intersection", "[", 
    RowBox[{"PDXclinicaltrialresponses", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"2", ";;"}], ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6613006391558013`*^9, 3.661300648085312*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
annotation of tumors types was prepared from a different portion of the \
Supplementary Materials of Gao et al. Nature Medicine\
\>", "Subsubsection",
 CellChangeTimes->{3.683557076265721*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ModelsAndTumorTypes", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<Tumor types of models.csv\>\""}], ",", "\"\<CSV\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6616817150785604`*^9, 3.661681779267232*^9}, {
  3.6616819020352535`*^9, 3.6616819022582664`*^9}, {3.683476289959731*^9, 
  3.6834763022194324`*^9}, {3.68355703870065*^9, 3.6835570785277243`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CutaneousMelanomaModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ModelsAndTumorTypes", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<CM\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSCLCModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ModelsAndTumorTypes", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<NSCLC\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PDACModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ModelsAndTumorTypes", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<PDAC\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorectalModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ModelsAndTumorTypes", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<CRC\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BreastModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ModelsAndTumorTypes", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<BRCA\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GastricModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ModelsAndTumorTypes", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<GC\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.661300670565598*^9, 3.6613006803491573`*^9}, {
  3.661300730847046*^9, 3.661300765446025*^9}, {3.6613398665274787`*^9, 
  3.6613399001194*^9}, {3.6613401003348517`*^9, 3.6613401689117737`*^9}, {
  3.661340200671591*^9, 3.6613402798141174`*^9}, {3.6616818431798873`*^9, 
  3.6616818944428196`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Focusing analysis on PDX models tested against many therapies\n",
 StyleBox["(referred to in code as \[OpenCurlyQuote]well covered models\
\[CloseCurlyQuote])",
  FontSize->16]
}], "Subsubsection",
 CellChangeTimes->{{3.664317029700242*^9, 3.664317068375455*^9}, {
  3.664317813566077*^9, 3.6643178146061363`*^9}, {3.6834765937631073`*^9, 
  3.6834765941931324`*^9}, {3.683522737497336*^9, 3.6835227827049217`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WellCoveredModelClasses", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Well covered models.csv\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WellCoveredModels", "=", 
    RowBox[{"WellCoveredModelClasses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CutaneousMelanomaModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"WellCoveredModelClasses", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<CM\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSCLCModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"WellCoveredModelClasses", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<NSCLC\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PDACModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"WellCoveredModelClasses", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<PDAC\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorectalModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"WellCoveredModelClasses", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<CRC\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BreastModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"WellCoveredModelClasses", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<BRCA\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GastricModels", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"WellCoveredModelClasses", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Equal]", "\"\<GC\>\""}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6643173794402466`*^9, 3.664317388575769*^9}, {
  3.664320281801252*^9, 3.6643202853274536`*^9}, {3.674433688143204*^9, 
  3.674433710579345*^9}, {3.683476446732698*^9, 3.683476474127265*^9}, {
  3.683476681177108*^9, 3.6834766923457465`*^9}, {3.683477651995635*^9, 
  3.6834776730648403`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AllModelGroups", "=", 
    RowBox[{"{", 
     RowBox[{
     "CutaneousMelanomaModels", ",", "NSCLCModels", ",", "PDACModels", ",", 
      "ColorectalModels", ",", "BreastModels", ",", "GastricModels"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"MonotherapiesByGroup", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Intersection", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "AllModelGroups", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
             "\[Equal]", "\"\<single\>\""}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[NotEqual]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "AllModelGroups", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationTherapiesByGroup", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Intersection", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"PDXclinicaltrialresponses", ",", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{
               "AllModelGroups", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
              "\[Equal]", "\"\<combo\>\""}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[NotEqual]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "AllModelGroups", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "removing", " ", "\"\<untreated\>\"", " ", "from", " ", "the", " ", "list",
     " ", "of", " ", "treatments"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllTreatmentsExcludingUntreated", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{"AllTreatments", ",", 
     RowBox[{"{", "\"\<untreated\>\"", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6643173794402466`*^9, 3.664317388575769*^9}, {
  3.664320281801252*^9, 3.6643202853274536`*^9}, {3.674433688143204*^9, 
  3.674433710579345*^9}, {3.683476446732698*^9, 3.683476474127265*^9}, {
  3.683476681177108*^9, 3.6834766923457465`*^9}, {3.683477651995635*^9, 
  3.6834776730648403`*^9}, {3.683555894894536*^9, 3.6835558951145363`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting a \[OpenCurlyQuote]treatment matrix\[CloseCurlyQuote] - PDX \
models by treatments", "Section",
 CellChangeTimes->{{3.674433715980364*^9, 3.6744337346604023`*^9}, {
  3.6834767130589314`*^9, 3.6834767298368907`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "assigning", " ", "a", " ", "number", " ", "to", " ", "each", " ", 
     "tumor", " ", "type"}], ",", " ", 
    RowBox[{"for", " ", "purpose", " ", "of", " ", "coloring", " ", 
     RowBox[{"a", " ", "'"}], "treatment", " ", 
     RowBox[{"matrix", "'"}], " ", 
     RowBox[{"(", 
      RowBox[{
      "matrix", " ", "of", " ", "therapies", " ", "tested", " ", "on", " ", 
       "PDX", " ", "models"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ModelToIndicationNumber", "[", "pdxmodel_", "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"CutaneousMelanomaModels", ",", "pdxmodel"}], "]"}], ",", 
     "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"NSCLCModels", ",", "pdxmodel"}], "]"}], ",", 
     "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"PDACModels", ",", "pdxmodel"}], "]"}], ",", 
     "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"ColorectalModels", ",", "pdxmodel"}], "]"}], ",", 
     "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"BreastModels", ",", "pdxmodel"}], "]"}], ",", 
     "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"GastricModels", ",", "pdxmodel"}], "]"}], ",", 
     "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", "True", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"-", "1"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6637531186960773`*^9, 3.66375323011045*^9}, {
  3.6637547040557547`*^9, 3.663754710975151*^9}, {3.6835624211848097`*^9, 
  3.68356244575585*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"computing", " ", "the", " ", "treatment", " ", "matrix"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ModelsTreatmentsMatrix", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"PDXclinicaltrialresponses", ",", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[Equal]", 
               RowBox[{
               "AllModels", "\[LeftDoubleBracket]", "models", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[Equal]", 
               RowBox[{
               "AllTreatmentsExcludingUntreated", "\[LeftDoubleBracket]", 
                "treatments", "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], 
          "]"}], "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "0", ",", 
        RowBox[{"ModelToIndicationNumber", "[", 
         RowBox[{
         "AllModels", "\[LeftDoubleBracket]", "models", 
          "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"models", ",", "1", ",", 
        RowBox[{"Length", "[", "AllModels", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"treatments", ",", "1", ",", 
        RowBox[{"Length", "[", "AllTreatmentsExcludingUntreated", "]"}]}], 
       "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.683562410931793*^9, {3.6835624489808545`*^9, 3.683562459479871*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"loading", " ", "the", " ", "clustering", " ", "package"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Needs", "[", "\"\<HierarchicalClustering`\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.661680843644717*^9, 3.6616808495950575`*^9}, 
   3.683477858333437*^9, {3.6835624638238797`*^9, 3.683562471053892*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Mathematica", " ", "does", " ", "not", " ", "track", " ", "object", " ", 
     "labels", " ", "when", " ", "performing", " ", "hierarchical", " ", 
     RowBox[{"clustering", ".", " ", "Therefore"}], " ", "we", " ", "attach", 
     " ", "a", " ", "column", " ", "of", " ", "numbers", " ", "that", " ", 
     "uniquely", " ", "identify", " ", "each", " ", "PDX", " ", "model", " ", 
     "in", " ", "sequence"}], ",", " ", 
    RowBox[{
    "so", " ", "that", " ", "subsequently", " ", "we", " ", "can", " ", 
     "affix", " ", "the", " ", "proper", " ", "PDX", " ", "model", " ", 
     "labels", " ", "to", " ", "the", " ", "clustered", " ", "treatment", " ",
      "matrix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ModelLabels", "=", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "AllModels", "]"}], "]"}], "/", "10000"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LabelledModelsTreatmentsMatrix", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"ModelsTreatmentsMatrix", "\[Transpose]"}], ",", 
       "ModelLabels"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"%", "//", "Dimensions"}]}]}]], "Input",
 CellChangeTimes->{{3.6616811302171087`*^9, 3.661681170898435*^9}, {
  3.6637563353760614`*^9, 3.6637563509919543`*^9}, {3.683562494557933*^9, 
  3.68356257070406*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Similarly", ",", " ", 
    RowBox[{
    "we", " ", "attach", " ", "a", " ", "row", " ", "of", " ", "numbers", " ",
      "that", " ", "uniquely", " ", "identify", " ", "each", " ", "treatment",
      " ", "in", " ", "sequence"}], ",", " ", 
    RowBox[{
    "so", " ", "that", " ", "subsequently", " ", "we", " ", "can", " ", 
     "affix", " ", "the", " ", "proper", " ", "treatment", " ", "labels", " ",
      "to", " ", "the", " ", "clustered", " ", "treatment", " ", "matrix"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TreatmentsLabels", "=", 
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "AllTreatmentsExcludingUntreated", "]"}], 
         "]"}], ",", "0"}], "]"}], "/", "1000"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LabelledModelsTreatmentsMatrix", "=", 
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"LabelledModelsTreatmentsMatrix", "\[Transpose]"}], ",", 
        "TreatmentsLabels"}], "]"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//", "Dimensions"}]}]}]], "Input",
 CellChangeTimes->{{3.663756302559184*^9, 3.663756321101245*^9}, {
   3.6637563668238597`*^9, 3.663756384103848*^9}, 3.672787188373801*^9, {
   3.6835625740290656`*^9, 3.683562594056099*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "turning", " ", "off", " ", "an", " ", "error", " ", "message", " ", 
    "about", " ", 
    RowBox[{"ties", ".", " ", "There"}], " ", "are", " ", 
    RowBox[{"many", " ", "'"}], 
    RowBox[{"ties", "'"}], " ", "in", " ", "this", " ", "treatment", " ", 
    "matrix", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "PDX", " ", "models", " ", "receiving", " ", "the", " ", "same", " ", 
       "set", " ", "of", " ", "treatments"}], ";", " ", 
      RowBox[{
      "and", " ", "treatments", " ", "tested", " ", "on", " ", "the", " ", 
       "same", " ", "sets", " ", "of", " ", "PDX", " ", "models"}]}], ")"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Off", "[", 
    RowBox[{"Agglomerate", "::", "ties"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"heirarchical", " ", "clustering"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClusteredModelsTreatmentsMatrix", "=", 
     RowBox[{"ClusterFlatten", "[", 
      RowBox[{"Agglomerate", "[", 
       RowBox[{
        RowBox[{"ClusterFlatten", "[", 
         RowBox[{"Agglomerate", "[", 
          RowBox[{"(", "LabelledModelsTreatmentsMatrix", ")"}], "]"}], "]"}], 
        "\[Transpose]"}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6637543229759583`*^9, 3.6637543384158416`*^9}, 
   3.663755003775898*^9, 3.664316753191427*^9, {3.683562598272105*^9, 
   3.683562604627116*^9}, {3.683562686469252*^9, 3.6835627796654043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "using", " ", "our", " ", "affixed", " ", "row", " ", "and", " ", "column",
     " ", "of", " ", "numbers", " ", "to", " ", "correctly", " ", "order", 
    " ", "the", " ", "PDX", " ", "and", " ", "treatment", " ", "labels", " ", 
    "in", " ", "the", " ", "clustered", " ", "matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClusteredModelSequence", "=", 
     RowBox[{"AllModels", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{
        RowBox[{"ClusteredModelsTreatmentsMatrix", "\[Transpose]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", 
         RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "*", "10000"}], 
      "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClusteredTreatmentSequence", "=", 
     RowBox[{"AllTreatmentsExcludingUntreated", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{
        RowBox[{"ClusteredModelsTreatmentsMatrix", "\[Transpose]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"2", ";;"}], ",", "1"}], "\[RightDoubleBracket]"}], "*", 
       "1000"}], "\[RightDoubleBracket]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6616812058904366`*^9, 3.6616812291297655`*^9}, 
   3.663756111727269*^9, {3.6637564064801283`*^9, 3.663756442223172*^9}, {
   3.6637565209516754`*^9, 3.663756521487706*^9}, {3.663756582679206*^9, 
   3.663756602087316*^9}, 3.6834780342264977`*^9, {3.6835627888794174`*^9, 
   3.6835628158634624`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Plotting a matrix of PDX models versus treatments, with a spot at every \
intersection where a particular treatment was tested on a particular PDX \
model.\n\nWhite indicates the treatment was ",
 StyleBox["not",
  FontSlant->"Italic"],
 " tested on that PDX model.\n\nRed = well covered Melanoma PDX models\nGreen \
= well covered Non-Small Cell Lung Cancer (NSCLC) PDX models\nMagenta = well \
covered Pancreatic Ductal Adenocarcinoma (PDAC) PDX models\nOrange = well \
covered Colorectal cancer PDX models\nBlue = well covered Breast cancer PDX \
models\nGray = well covered Gastric cancer PDX models\n\nBlack = models from \
a variety of tumor types that are deemed to be not \
\[OpenCurlyQuote]well-covered\[CloseCurlyQuote] - they are tested in a very \
limited set of treatments and were considered unsuitable for analyses that \
compare how a single PDX model responds to a variety of different monotherapy \
and combination therapy treatments.\n\n(note in the top row, PDX model X-055 \
is indeed part of the data set but was not tested with any form of treatment, \
only tested as \[OpenCurlyQuote]untreated\[CloseCurlyQuote])"
}], "Subsubsection",
 CellChangeTimes->{{3.6835628237584777`*^9, 3.683563207633128*^9}, 
   3.6856036852762365`*^9}],

Cell[BoxData[
 RowBox[{"ModelsTreatmentsPlot", "=", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"ClusteredModelsTreatmentsMatrix", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"2", ";;"}], ",", 
      RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2400", "}"}], ",", 
       RowBox[{"{", "2400", "}"}]}], "}"}]}], ",", 
    RowBox[{"MeshStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0005", "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
       RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
             "ClusteredModelSequence", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "ClusteredModelSequence", "]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
             "ClusteredModelSequence", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "ClusteredModelSequence", "]"}]}], 
            "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Rotate", "[", 
              RowBox[{
               RowBox[{
               "ClusteredTreatmentSequence", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "ClusteredTreatmentSequence", "]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Rotate", "[", 
              RowBox[{
               RowBox[{
               "ClusteredTreatmentSequence", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "ClusteredTreatmentSequence", "]"}]}], 
            "}"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Courier New\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}]}], "}"}]}], ",", 
    RowBox[{"ColorRules", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "\[Rule]", "White"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "\[Rule]", "Black"}], ",", 
       RowBox[{"1", "\[Rule]", "Red"}], ",", 
       RowBox[{"2", "\[Rule]", 
        RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
       RowBox[{"3", "\[Rule]", 
        RowBox[{"Darker", "[", "Magenta", "]"}]}], ",", 
       RowBox[{"4", "\[Rule]", "Orange"}], ",", 
       RowBox[{"5", "\[Rule]", "Blue"}], ",", 
       RowBox[{"6", "\[Rule]", "Gray"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6616805390322943`*^9, 3.661680543098527*^9}, 
   3.661680895211667*^9, {3.661680959843364*^9, 3.6616810601380997`*^9}, {
   3.661681190434552*^9, 3.6616811919396386`*^9}, {3.661681244874666*^9, 
   3.6616813771382313`*^9}, {3.6616814113391876`*^9, 3.661681416052457*^9}, {
   3.6616814591389217`*^9, 3.661681463899194*^9}, {3.6637550352326975`*^9, 
   3.6637550364487667`*^9}, {3.6637560077533216`*^9, 
   3.6637560879529095`*^9}, {3.663756141886994*^9, 3.6637561653753376`*^9}, {
   3.663756464314436*^9, 3.6637565067608633`*^9}, {3.66375659744005*^9, 
   3.6637565977930703`*^9}, {3.67278570930681*^9, 3.67278572670697*^9}, {
   3.6834772598742075`*^9, 3.6834772632283993`*^9}, {3.6834774902483835`*^9, 
   3.683477493620577*^9}, {3.6834775237482996`*^9, 3.683477560257388*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Complete treatment matrix.pdf\>\""}], ",", "ModelsTreatmentsPlot", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.66773884115506*^9, 3.6677388680455976`*^9}, {
   3.6834772163857193`*^9, 3.6834772329396667`*^9}, 3.7154650574510574`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Creating figure that focuses on well-covered models.", "Subsection",
 CellChangeTimes->{{3.6727853621995687`*^9, 3.6727853698516455`*^9}, {
  3.6834794853264956`*^9, 3.6834795052886376`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CombinationsInClusteredTreatmentSequence", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"ClusteredTreatmentSequence", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"StringCases", "[", 
        RowBox[{"#", ",", "\"\< + \>\""}], "]"}], "\[NotEqual]", 
       RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MonotherapiesInClusteredTreatmentSequence", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"ClusteredTreatmentSequence", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"StringCases", "[", 
        RowBox[{"#", ",", "\"\< + \>\""}], "]"}], "==", 
       RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672785413625054*^9, 3.6727854713815727`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CombinationPositionsInClusteredTreatmentSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"ClusteredTreatmentSequence", ",", 
        RowBox[{
        "CombinationsInClusteredTreatmentSequence", "\[LeftDoubleBracket]", 
         "i", "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
       "Length", "[", "CombinationsInClusteredTreatmentSequence", "]"}]}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MonotherapyPositionsInClusteredTreatmentSequence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"ClusteredTreatmentSequence", ",", 
        RowBox[{
        "MonotherapiesInClusteredTreatmentSequence", "\[LeftDoubleBracket]", 
         "i", "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
       "Length", "[", "MonotherapiesInClusteredTreatmentSequence", "]"}]}], 
      "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6727855192030244`*^9, 3.6727856045197935`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeparatingMonoAndComboSequence", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "MonotherapyPositionsInClusteredTreatmentSequence", ",", 
     "CombinationPositionsInClusteredTreatmentSequence"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6727858371550035`*^9, 3.6727858517601433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotdata", "=", 
   RowBox[{
    RowBox[{"ClusteredModelsTreatmentsMatrix", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"2", ";;"}], ",", 
      RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"52", ";;"}], ",", "SeparatingMonoAndComboSequence"}], 
    "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.672785808419733*^9, {3.672785868250289*^9, 3.6727859114597125`*^9}, {
   3.6727860316589937`*^9, 3.6727862600252895`*^9}, {3.672786307466753*^9, 
   3.6727863075367537`*^9}, {3.6727863462500935`*^9, 
   3.6727863690103097`*^9}, {3.672786408533681*^9, 3.672786451982112*^9}, {
   3.672786502594595*^9, 3.6727865062416306`*^9}, {3.6727866028655963`*^9, 
   3.67278660627663*^9}, {3.6727866370099363`*^9, 3.672786640932974*^9}, {
   3.6727873268691516`*^9, 3.6727874753546143`*^9}, {3.6834777546545067`*^9, 
   3.6834777562565985`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MonoPartOfPlot", "=", 
   RowBox[{
    RowBox[{"plotdata", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{"1", ";;", "37"}]}], "\[RightDoubleBracket]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "\[Rule]", "1"}], ",", 
      RowBox[{"3", "\[Rule]", "1"}], ",", 
      RowBox[{"4", "\[Rule]", "1"}], ",", 
      RowBox[{"5", "\[Rule]", "1"}], ",", 
      RowBox[{"6", "\[Rule]", "1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComboPartOfPlot", "=", 
   RowBox[{
    RowBox[{"plotdata", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{"38", ";;"}]}], "\[RightDoubleBracket]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "\[Rule]", "2"}], ",", 
      RowBox[{"3", "\[Rule]", "2"}], ",", 
      RowBox[{"4", "\[Rule]", "2"}], ",", 
      RowBox[{"5", "\[Rule]", "2"}], ",", 
      RowBox[{"6", "\[Rule]", "2"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReMergedPlotData", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"MonoPartOfPlot", "\[Transpose]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "230", "}"}]}], "]"}], "}"}], ",", 
      RowBox[{"ComboPartOfPlot", "\[Transpose]"}]}], "]"}], 
    "\[Transpose]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.672788829095501*^9, 3.672788980462929*^9}, {
  3.6727901438811445`*^9, 3.672790171230398*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotDataShiftingGastricToEnd", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ReMergedPlotData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", "145"}], ",", "All"}], "\[RightDoubleBracket]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"ReMergedPlotData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"192", ";;"}], ",", "All"}], "\[RightDoubleBracket]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ReMergedPlotData", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"146", ";;", "191"}], ",", "All"}], 
      "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.672797228593694*^9, 3.6727973152016478`*^9}, {
  3.672797351553727*^9, 3.6727974110411296`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaddingColumnOfZeros", "=", 
   RowBox[{"{", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"Length", "[", 
        RowBox[{"PlotDataShiftingGastricToEnd", "\[Transpose]"}], "]"}], 
       "}"}]}], "]"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682469304664011*^9, 3.6824693246271524`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotDataShiftingGastricToEndWithPaddingBetweenTumorTypes", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"PlotDataShiftingGastricToEnd", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "33"}], "\[RightDoubleBracket]"}], ",", 
     "PaddingColumnOfZeros", ",", 
     RowBox[{"PlotDataShiftingGastricToEnd", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"33", "+", "1"}], ";;", 
       RowBox[{"33", "+", "29"}]}], "\[RightDoubleBracket]"}], ",", 
     "PaddingColumnOfZeros", ",", 
     RowBox[{"PlotDataShiftingGastricToEnd", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"33", "+", "29", "+", "1"}], ";;", 
       RowBox[{"33", "+", "29", "+", "41"}]}], "\[RightDoubleBracket]"}], ",",
      "PaddingColumnOfZeros", ",", 
     RowBox[{"PlotDataShiftingGastricToEnd", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"33", "+", "29", "+", "41", "+", "1"}], ";;", 
       RowBox[{"33", "+", "29", "+", "41", "+", "42"}]}], 
      "\[RightDoubleBracket]"}], ",", "PaddingColumnOfZeros", ",", 
     RowBox[{"PlotDataShiftingGastricToEnd", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"33", "+", "29", "+", "41", "+", "42", "+", "1"}], ";;", 
       RowBox[{"33", "+", "29", "+", "41", "+", "42", "+", "39"}]}], 
      "\[RightDoubleBracket]"}], ",", "PaddingColumnOfZeros", ",", 
     RowBox[{"PlotDataShiftingGastricToEnd", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"33", "+", "29", "+", "41", "+", "42", "+", "39", "+", "1"}], ";;", 
       RowBox[{
       "33", "+", "29", "+", "41", "+", "42", "+", "39", "+", "46"}]}], 
      "\[RightDoubleBracket]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682468920044012*^9, 3.682469026762116*^9}, {
  3.682469222197294*^9, 3.6824692701570377`*^9}, {3.6824693315955515`*^9, 
  3.682469366259534*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ModelsTreatmentsPlotWhiteGridLines", "=", 
    RowBox[{"ArrayPlot", "[", 
     RowBox[{
      RowBox[{
      "PlotDataShiftingGastricToEndWithPaddingBetweenTumorTypes", 
       "\[Transpose]"}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.6", ",", "0.6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.6", ",", "0.6"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "550", "}"}], ",", 
         RowBox[{"{", "1000", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"100", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "25"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"MeshStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"AbsoluteThickness", "[", "0.3", "]"}], ",", "White", ",", 
         RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], ",", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"0", "-", "0.6"}], ",", "37.5", ",", 
                   RowBox[{"63", "+", "0.6"}]}], "}"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"37", "/", "2"}], ",", 
                 RowBox[{"Rotate", "[", 
                  RowBox[{"\"\<37\\nMonotherapies\>\"", ",", 
                   RowBox[{
                    RowBox[{"\[Pi]", "/", "2"}], "*", "0"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"37.5", "+", "63"}], ")"}], "/", "2"}], ",", 
                 RowBox[{"Rotate", "[", 
                  RowBox[{"\"\<25\\nCombinations\>\"", ",", 
                   RowBox[{
                    RowBox[{"\[Pi]", "/", "2"}], "*", "0"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", 
                RowBox[{"1", "/", "2"}]}], ",", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.00"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "37.5", ",", "63"}], "}"}]}], "}"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], ",", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.5"}], ",", 
                   RowBox[{"33", "+", "0.5"}], ",", 
                   RowBox[{"62", "+", "1.5"}], ",", 
                   RowBox[{"103", "+", "2.5"}], ",", 
                   RowBox[{"145", "+", "3.5"}], ",", 
                   RowBox[{"184", "+", "4.5"}], ",", 
                   RowBox[{"230", "+", "5.5"}]}], "}"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"33", "/", "2"}], ",", "\"\<33\\nMelanoma\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"33", "+", "63"}], ")"}], "/", "2"}]}], ",", 
                 "\"\<29\\nNSCLC\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"62", "+", "103"}], ")"}], "/", "2"}]}], ",", 
                 "\"\<41\\nPancreatic\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"103", "+", "145"}], ")"}], "/", "2"}]}], ",", 
                 "\"\<42\\nColorectal\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"4", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"145", "+", "184"}], ")"}], "/", "2"}]}], ",", 
                 "\"\<39\\nBreast\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"5", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"184", "+", "230"}], ")"}], "/", "2"}]}], ",", 
                 "\"\<46\\nGastric\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "+", 
                  RowBox[{"1", "/", "2"}]}], ",", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.00"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "0", ",", "33", ",", "62", ",", "103", ",", "145", ",", 
                   "184", ",", "230"}], "}"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"230", "/", "2"}], ",", 
                "\"\<Organization of drug treatments across 230 PDX \
models\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}]}], "]"}]}], 
          "}"}]}], "}"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "->", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
         RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
         RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
      RowBox[{"ColorRules", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0", "\[Rule]", "White"}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "\[Rule]", "Black"}], ",", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}]}], ",", 
         RowBox[{"2", "\[Rule]", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}]}]}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModelsTreatmentsPlotJustBlackGridLines", "=", 
   RowBox[{"ArrayPlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{
          "PlotDataShiftingGastricToEndWithPaddingBetweenTumorTypes", 
           "\[Transpose]"}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{
          "PlotDataShiftingGastricToEndWithPaddingBetweenTumorTypes", 
           "\[Transpose]"}], "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.6", ",", "0.6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", "0.6"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Mesh", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "37.5", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"33", "+", "0.5"}], ",", 
          RowBox[{"62", "+", "1.5"}], ",", 
          RowBox[{"103", "+", "2.5"}], ",", 
          RowBox[{"145", "+", "3.5"}], ",", 
          RowBox[{"184", "+", "4.5"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "550", "}"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "25"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"MeshStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], ",", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0", "-", "0.6"}], ",", "37.5", ",", 
                  RowBox[{"63", "+", "0.6"}]}], "}"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"37", "/", "2"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{"\"\<37\\nMonotherapies\>\"", ",", 
                  RowBox[{
                   RowBox[{"\[Pi]", "/", "2"}], "*", "0"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"37.5", "+", "63"}], ")"}], "/", "2"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{"\"\<25\\nCombinations\>\"", ",", 
                  RowBox[{
                   RowBox[{"\[Pi]", "/", "2"}], "*", "0"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], ",", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.00"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "37.5", ",", "63"}], "}"}]}], "}"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], ",", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.5"}], ",", 
                  RowBox[{"33", "+", "0.5"}], ",", 
                  RowBox[{"62", "+", "1.5"}], ",", 
                  RowBox[{"103", "+", "2.5"}], ",", 
                  RowBox[{"145", "+", "3.5"}], ",", 
                  RowBox[{"184", "+", "4.5"}], ",", 
                  RowBox[{"230", "+", "5.5"}]}], "}"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"33", "/", "2"}], ",", "\"\<33\\nMelanoma\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"33", "+", "63"}], ")"}], "/", "2"}]}], ",", 
                "\"\<29\\nNSCLC\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"62", "+", "103"}], ")"}], "/", "2"}]}], ",", 
                "\"\<41\\nPancreatic\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"3", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"103", "+", "145"}], ")"}], "/", "2"}]}], ",", 
                "\"\<42\\nColorectal\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"145", "+", "184"}], ")"}], "/", "2"}]}], ",", 
                "\"\<39\\nBreast\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"5", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"184", "+", "230"}], ")"}], "/", "2"}]}], ",", 
                "\"\<46\\nGastric\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], ",", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.00"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "33", ",", "62", ",", "103", ",", "145", ",", 
                  "184", ",", "230"}], "}"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"230", "/", "2"}], ",", 
               "\"\<Organization of drug treatments across 230 PDX \
models\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}]}], "]"}]}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], ",", 
     RowBox[{"ColorRules", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"White", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "]"}]}], ",", 
        RowBox[{"1", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "4"}], "]"}], ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "]"}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "6"}], "]"}], ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "]"}]}]}], "}"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6824672584149723`*^9, 3.6824674156009626`*^9}, {
   3.6824674529641*^9, 3.682467469449043*^9}, {3.682467525669258*^9, 
   3.6824675361638584`*^9}, {3.682467641302872*^9, 3.6824677153081055`*^9}, {
   3.6824678418683443`*^9, 3.6824678984065776`*^9}, {3.682467931791487*^9, 
   3.6824679649943867`*^9}, {3.682468004479645*^9, 3.682468143972623*^9}, {
   3.6824682550799785`*^9, 3.682468319885685*^9}, {3.6824686389359336`*^9, 
   3.682468720014571*^9}, {3.6824687526194363`*^9, 3.6824687545175447`*^9}, {
   3.6824688338560824`*^9, 3.6824688394104*^9}, {3.6824688703681707`*^9, 
   3.6824688740563817`*^9}, {3.682469207559457*^9, 3.6824692080124826`*^9}, {
   3.6824693698487396`*^9, 3.6824694038486843`*^9}, {3.682469435101472*^9, 
   3.6824694624580364`*^9}, {3.6824694999541807`*^9, 
   3.6824695171471643`*^9}, {3.682469943471549*^9, 3.6824699629166613`*^9}, {
   3.682470011259426*^9, 3.68247006202833*^9}, {3.6824700935321317`*^9, 
   3.6824700990844493`*^9}, {3.682470219605343*^9, 3.6824702401995206`*^9}, {
   3.6824702874352226`*^9, 3.682470313325703*^9}, {3.6824703585432897`*^9, 
   3.6824703936552978`*^9}, {3.6824704318534822`*^9, 3.682470435964718*^9}, {
   3.682470672529248*^9, 3.6824707060441656`*^9}, {3.6824727689721584`*^9, 
   3.6824728232652636`*^9}, {3.6834787919268355`*^9, 
   3.6834788088308024`*^9}, {3.7154651651772194`*^9, 3.7154651799760656`*^9}, 
   3.715465218875291*^9, 3.715465738443008*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TreatmentMatrixFigure", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
    "ModelsTreatmentsPlotWhiteGridLines", ",", 
     "ModelsTreatmentsPlotJustBlackGridLines", ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.6", ",", "0.6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", "0.6"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "575", "}"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "25"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "+", 
               RowBox[{"1", "/", "2"}]}], ",", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.00"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "37.5", ",", "63"}], "}"}]}], "}"}]}], "]"}],
           ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], ",", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0", "-", "0.6"}], ",", "25", ",", "63"}], "}"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"25", "/", "2"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<25\\nCombin.\>\"", ",", 
                    RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "13"}], "}"}]}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"25", "+", "63"}], ")"}], "/", "2"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<37\\nMonotherapies  \>\"", ",", 
                    RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "13"}], "}"}]}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], ",", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"33", "+", "0"}], ",", 
                  RowBox[{"62", "+", "1"}], ",", 
                  RowBox[{"103", "+", "2"}], ",", 
                  RowBox[{"145", "+", "3"}], ",", 
                  RowBox[{"184", "+", "4"}], ",", 
                  RowBox[{"230", "+", "5"}]}], "}"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"33", "/", "2"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<33\\nMelanoma\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "13"}], "}"}]}]}], "]"}], ",", "0"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"33", "+", "63"}], ")"}], "/", "2"}]}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<29\\nNSCLC\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "13"}], "}"}]}]}], "]"}], ",", "0"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"62", "+", "103"}], ")"}], "/", "2"}]}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<41\\nPDAC\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "13"}], "}"}]}]}], "]"}], ",", "0"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"3", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"103", "+", "145"}], ")"}], "/", "2"}]}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<42\\nColorectal\\ncarcinoma\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "13"}], "}"}]}]}], "]"}], ",", "0"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"145", "+", "184"}], ")"}], "/", "2"}]}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<39\\nBreast\\ncancer\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "13"}], "}"}]}]}], "]"}], ",", "0"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"5", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"184", "+", "230"}], ")"}], "/", "2"}]}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<46\\nGastric\\ncancer\>\"", ",", 
                    RowBox[{"LineSpacing", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "13"}], "}"}]}]}], "]"}], ",", "0"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", 
                 RowBox[{"1", "/", "2"}]}], ",", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.00"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "33", ",", "62", ",", "103", ",", "145", ",", 
                  "184", ",", "230"}], "}"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"230", "/", "2"}], ",", 
               RowBox[{"Rotate", "[", 
                RowBox[{
                "\"\<Organization of drug treatments across 230 PDX \
models\>\"", ",", "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}]}], "]"}]}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.", "]"}], ",", 
        RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S3B, Treatment matrix.pdf\>\""}], ",", 
    "TreatmentMatrixFigure", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.682470725074254*^9, 3.682470842902993*^9}, {
   3.6824711300654182`*^9, 3.682471242251835*^9}, {3.682471316524083*^9, 
   3.682471348359904*^9}, {3.682471425642324*^9, 3.6824714261193514`*^9}, {
   3.6824728463405833`*^9, 3.682473003262559*^9}, 3.6824730620649223`*^9, {
   3.682475274406461*^9, 3.6824753054362354`*^9}, {3.682475343473411*^9, 
   3.682475345476526*^9}, {3.683478813347061*^9, 3.683478838126478*^9}, {
   3.6834789048002915`*^9, 3.683478965231748*^9}, {3.6855786812305145`*^9, 
   3.6855786856147656`*^9}, {3.6855796988917217`*^9, 3.6855797322816315`*^9}, 
   3.715465057459058*^9, {3.7154651990331554`*^9, 3.7154652160381284`*^9}, {
   3.715465270825262*^9, 3.7154653413682966`*^9}, {3.7154657607912865`*^9, 
   3.715465764422494*^9}, {3.7154667725821576`*^9, 3.715466773814228*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global comparison of monotherapy with combination therapy", "Section",
 CellChangeTimes->{{3.6616654824513316`*^9, 3.661665502826497*^9}, {
  3.6629934639651437`*^9, 3.6629934645591774`*^9}, {3.6835177425366416`*^9, 
  3.6835177508161154`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "A", " ", "list", " ", "of", " ", "drug", " ", "responses", " ", "sorted", 
    " ", "by", " ", "PDX", " ", "model"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ResponsesByModel", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[Equal]", 
           RowBox[{
           "WellCoveredModels", "\[LeftDoubleBracket]", "model", 
            "\[RightDoubleBracket]"}]}], "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"model", ",", "1", ",", 
         RowBox[{"Length", "[", "WellCoveredModels", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "A", " ", "list", " ", "of", " ", "monotherapy", " ", "responses", " ", 
      "sorted", " ", "by", " ", "PDX", " ", "model"}], ";", " ", 
     RowBox[{
      RowBox[{"specifically", " ", "progression"}], "-", "free", "-", 
      RowBox[{"survival", " ", 
       RowBox[{"(", 
        RowBox[{
        "time", " ", "without", " ", "tumor", " ", "volume", " ", 
         "doubling"}], ")"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerModelMonotherapyResponses", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"PDXclinicaltrialresponses", ",", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[Equal]", 
              RowBox[{
              "WellCoveredModels", "\[LeftDoubleBracket]", "model", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
              "\[Equal]", "\"\<single\>\""}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[NotEqual]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"model", ",", "1", ",", 
         RowBox[{"Length", "[", "WellCoveredModels", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "A", " ", "list", " ", "of", " ", "combination", " ", "responses", " ", 
      "sorted", " ", "by", " ", "PDX", " ", "model"}], ";", " ", 
     RowBox[{
      RowBox[{"specifically", " ", "progression"}], "-", "free", "-", 
      RowBox[{"survival", " ", 
       RowBox[{"(", 
        RowBox[{
        "time", " ", "without", " ", "tumor", " ", "volume", " ", 
         "doubling"}], ")"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerModelCombinationResponses", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"PDXclinicaltrialresponses", ",", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[Equal]", 
              RowBox[{
              "WellCoveredModels", "\[LeftDoubleBracket]", "model", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
              "\[Equal]", "\"\<combo\>\""}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[NotEqual]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"model", ",", "1", ",", 
         RowBox[{"Length", "[", "WellCoveredModels", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "How", " ", "many", " ", "monotherapies", " ", "are", " ", "tested", " ",
       "on", " ", "each", " ", "PDX", " ", "model"}], ",", " ", 
     RowBox[{"on", " ", 
      RowBox[{"average", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"AverageNumberOfMonotherapyTreatmentsPerModel", "=", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", "PerModelMonotherapyResponses"}], "]"}], "]"}], 
     "//", "N"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "How", " ", "many", " ", "combination", " ", "therapies", " ", "are", 
      " ", "tested", " ", "on", " ", "each", " ", "PDX", " ", "model"}], ",", 
     " ", 
     RowBox[{"on", " ", 
      RowBox[{"average", "?"}]}]}], " ", "*)"}], 
   RowBox[{"AverageNumberOfCombinationTreatmentsPerModel", "=", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", "PerModelCombinationResponses"}], "]"}], "]"}], 
     "//", "N"}]}]}]}]], "Input",
 CellChangeTimes->{{3.661682471218809*^9, 3.6616825367305565`*^9}, {
  3.6616826242505617`*^9, 3.661682651434117*^9}, {3.6616836758597107`*^9, 
  3.6616837018351965`*^9}, {3.6644143236539555`*^9, 3.664414351125527*^9}, {
  3.683516083771145*^9, 3.683516083771145*^9}, {3.683516780552619*^9, 
  3.6835168098592954`*^9}, {3.6835171696748753`*^9, 3.6835172063159714`*^9}, {
  3.683556028528777*^9, 3.683556028952779*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Histogram", " ", "of", " ", "the", " ", "number", " ", "of", " ", 
    "different", " ", "monotherapies", " ", "and", " ", "combination", " ", 
    "therapies", " ", "tested", " ", "on", " ", "each", " ", "PDX", " ", 
    "model"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", "PerModelMonotherapyResponses"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", "PerModelCombinationResponses"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.5"}], ",", "20.5", ",", "1"}], "}"}], ",", 
    RowBox[{"ChartLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Monotherapies\>\"", ",", "\"\<Combinations\>\""}], "}"}]}],
     ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "4"}], "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "6"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Number of therapies tested per PDX\>\"", ",", "\"\<Count\>\""}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.664322370286707*^9, 3.6643224074868345`*^9}, {
  3.6681034299926867`*^9, 3.668103444629524*^9}, {3.6835161876723633`*^9, 
  3.683516329004661*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Average", " ", "PFS", " ", "in", " ", "response", " ", "to", " ", 
     "monotherapy"}], ",", " ", 
    RowBox[{"for", " ", "each", " ", "PDX", " ", "model"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PerModelMeanMonoResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Mean", ",", "PerModelMonotherapyResponses"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Average", " ", "PFS", " ", "in", " ", "response", " ", "to", " ", 
      "combination", " ", "therapy"}], ",", " ", 
     RowBox[{"for", " ", "each", " ", "PDX", " ", "model"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerModelMeanComboResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Mean", ",", "PerModelCombinationResponses"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Best", " ", "response", " ", "to", " ", "any", " ", "monotherapy"}], 
     ",", " ", 
     RowBox[{"for", " ", "each", " ", "PDX", " ", "model"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerModelMaxMonoResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Max", ",", "PerModelMonotherapyResponses"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Best", " ", "response", " ", "to", " ", "any", " ", "combination", " ", 
      "therapy"}], ",", " ", 
     RowBox[{"for", " ", "each", " ", "PDX", " ", "model"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerModelMaxComboResponses", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Max", ",", "PerModelCombinationResponses"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6616837117537637`*^9, 3.661683757864401*^9}, {
  3.6835168973142977`*^9, 3.683516964914164*^9}, {3.6835172191367044`*^9, 
  3.683517222993925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
     " ", "drug", " ", "responses", " ", 
     RowBox[{"(", 
      RowBox[{"PFS", " ", "times"}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "provided", " ", "that", " ", "it", " ", "is", " ", "longer", 
     " ", "than", " ", "1"}], ",", " ", 
    RowBox[{
    "it", " ", "randomly", " ", "selects", " ", "a", " ", "pair", " ", "of", 
     " ", "drugs"}], ",", " ", 
    RowBox[{
    "and", " ", "supposes", " ", "that", " ", "the", " ", "response", " ", 
     "to", " ", "the", " ", "drug", " ", "pair", " ", "is", " ", "the", " ", 
     "best", " ", "one", " ", "of", " ", "the", " ", "two", " ", 
     RowBox[{"responses", ".", " ", "This"}], " ", "is", " ", "repeated", " ",
      "10000", " ", "times"}], ",", " ", 
    RowBox[{"and", " ", "the", " ", 
     RowBox[{"function", "'"}], "s", " ", "output", " ", "is", " ", "the", 
     " ", "average", " ", "of", " ", "this", " ", 
     RowBox[{"set", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "AverageBestOfRandomlyChosenPairs", "[", "listofresponses_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"NumberOfRandomPairs", ",", "IndividualBestResponses"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"listofresponses", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "listofresponses", "]"}], "\[Equal]", "1"}], 
         ",", 
         RowBox[{"Return", "[", 
          RowBox[{
          "listofresponses", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NumberOfRandomPairs", "=", "10000"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IndividualBestResponses", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"RandomSample", "[", 
            RowBox[{"listofresponses", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", "NumberOfRandomPairs", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Mean", "[", "IndividualBestResponses", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "above", " ", "function", " ", "is", " ", "applied", " ", 
     "to", " ", "each", " ", "PDXs", " ", "list", " ", "of", " ", 
     "monotherapy", " ", "responses"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerModelAverageBestOfRandomMonotherapyPairs", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
      "AverageBestOfRandomlyChosenPairs", ",", 
       "PerModelMonotherapyResponses"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.66168383022654*^9, 3.661683834674794*^9}, {
  3.6835170174971714`*^9, 3.683517127577468*^9}, {3.683517234601589*^9, 
  3.683517352690344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "option", " ", "allows", " ", "figures", " ", "with", " ", 
    "legends", " ", "to", " ", "be", " ", "exported", " ", "without", " ", 
    "legends", " ", "without", " ", "altering", " ", "the", " ", "figure", 
    " ", "size"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"$FrontEndSession", ",", 
     RowBox[{"PrintingStyleEnvironment", "\[Rule]", "\"\<Working\>\""}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Plot", " ", "of", " ", "progression", " ", "free", " ", "survival", " ",
       "over", " ", "all", " ", "PDX", " ", "models"}], ",", " ", 
     RowBox[{
     "comparing", " ", "their", " ", "average", " ", "monotherapy", " ", 
      "response"}], ",", " ", 
     RowBox[{"average", " ", "combination", " ", "response"}], ",", " ", 
     RowBox[{
     "and", " ", "average", " ", "response", " ", "to", " ", "random", " ", 
      "pairs", " ", "of", " ", "monotherapies"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"AveragePFSPlot", "=", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SurvivalFunction", "[", 
          RowBox[{
          "EmpiricalDistribution", "[", "PerModelMeanMonoResponses", "]"}], 
          "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SurvivalFunction", "[", 
          RowBox[{
          "EmpiricalDistribution", "[", "PerModelMeanComboResponses", "]"}], 
          "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SurvivalFunction", "[", 
          RowBox[{
          "EmpiricalDistribution", "[", 
           "PerModelAverageBestOfRandomMonotherapyPairs", "]"}], "]"}], "[", 
         "x", "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"5", "*", 
         RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
      RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"4", "*", 
            RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "*", "100"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "300", ",", 
               RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "4"}], "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "6"}], "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "8"}], "]"}], ",", 
           RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
      ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Progression free survival (months)\>\"", ",", 
         "\"\<PDX patients (%)\>\""}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "225", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"(*", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", 
               RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Average monotherapy\>\"", ",", 
              "\"\<Average combination\>\"", ",", 
              "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.45", ",", "0.99"}], "}"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}]}], "*)"}], 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Average monotherapy\>\"", ",", "\"\<Average combination\>\"", 
         ",", "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"3", "/", "4"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 3A, PFS averages.pdf\>\""}], ",", "AveragePFSPlot", ",", 
      "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.661683866986643*^9, {3.6620255055011272`*^9, 3.662025620292693*^9}, {
   3.662026285341731*^9, 3.6620262970294*^9}, {3.662026335270587*^9, 
   3.6620263584439125`*^9}, {3.6620264169422584`*^9, 
   3.6620264485500665`*^9}, {3.6620265771224203`*^9, 3.662026577206425*^9}, {
   3.662026612454441*^9, 3.6620266173657217`*^9}, {3.6620269554530597`*^9, 
   3.6620269601333275`*^9}, {3.6620283304937077`*^9, 
   3.6620284326375494`*^9}, {3.6620285163663387`*^9, 
   3.6620285178304224`*^9}, {3.662032543213661*^9, 3.662032552900215*^9}, 
   3.6620330400390778`*^9, 3.662033089430903*^9, 3.66241309549409*^9, {
   3.6624185570864754`*^9, 3.662418561085704*^9}, {3.66368186081036*^9, 
   3.6636819132243576`*^9}, {3.6643211645377417`*^9, 3.6643212344897428`*^9}, 
   3.664321300459516*^9, {3.664321437410349*^9, 3.6643214390974455`*^9}, {
   3.664321512657653*^9, 3.664321559497332*^9}, {3.6643218732792797`*^9, 
   3.664321899911803*^9}, {3.6644033054053993`*^9, 3.6644033055884094`*^9}, {
   3.6644033587014475`*^9, 3.6644033839868937`*^9}, {3.6648154055485554`*^9, 
   3.664815409159561*^9}, {3.664815444302617*^9, 3.6648154588866444`*^9}, {
   3.674732275647051*^9, 3.6747322762050533`*^9}, {3.6824649710011396`*^9, 
   3.6824649946854944`*^9}, {3.6824722781020823`*^9, 
   3.6824722979192157`*^9}, {3.6835173563645535`*^9, 3.6835175140985756`*^9}, 
   3.6835175486755533`*^9, {3.6842889970083356`*^9, 3.68428901141416*^9}, {
   3.6855797516247377`*^9, 3.685579751853751*^9}, 3.7154650574780593`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "statistical", " ", "comparisons", " ", "by", " ", "Log", " ", "Rank", " ",
     "Test"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"mono", " ", "vs", " ", "combo"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LogRankTest", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "PerModelMeanMonoResponses", ",", "PerModelMeanComboResponses"}], "}"}],
      ",", "\"\<Equal\>\"", ",", "\"\<PValueTable\>\""}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "mono", " ", "vs", " ", "random", " ", "pairs", " ", "of", " ", "mono"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", ",", 
       "PerModelMeanMonoResponses"}], "}"}], ",", "\"\<Equal\>\"", ",", 
     "\"\<PValueTable\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "random", " ", "pairs", " ", "of", " ", "mono", " ", "vs", " ", "combo"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", ",", 
       "PerModelMeanComboResponses"}], "}"}], ",", "\"\<Equal\>\"", ",", 
     "\"\<PValueTable\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6681674783994393`*^9, 3.6681675216779146`*^9}, {
  3.6835176613059955`*^9, 3.6835176704185166`*^9}, {3.683517701322284*^9, 
  3.683517702346343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "statistical", " ", "comparisons", " ", "by", " ", "Mann", " ", "Whitney", 
    " ", "Test"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"mono", " ", "vs", " ", "combo"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MannWhitneyTest", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "PerModelMeanMonoResponses", ",", "PerModelMeanComboResponses"}], "}"}],
      ",", "0", ",", "\"\<PValueTable\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "mono", " ", "vs", " ", "random", " ", "pairs", " ", "of", " ", "mono"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"MannWhitneyTest", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", ",", 
       "PerModelMeanMonoResponses"}], "}"}], ",", "0", ",", 
     "\"\<PValueTable\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "random", " ", "pairs", " ", "of", " ", "mono", " ", "vs", " ", "combo"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"MannWhitneyTest", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", ",", 
       "PerModelMeanComboResponses"}], "}"}], ",", "0", ",", 
     "\"\<PValueTable\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6727928341955214`*^9, 3.6727928606946745`*^9}, {
  3.6835176855783834`*^9, 3.683517697858086*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Cox", " ", "proportional", " ", "hazards", " ", "model"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
        "PerModelMeanComboResponses", ",", 
         "PerModelAverageBestOfRandomMonotherapyPairs"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
            "PerModelMeanComboResponses", ",", 
             "PerModelAverageBestOfRandomMonotherapyPairs"}], "]"}], "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<actual combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "PerModelMeanComboResponses", "]"}], "}"}]}],
         "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<random monotherapy pairs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
          "Length", "[", "PerModelAverageBestOfRandomMonotherapyPairs", "]"}],
           "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.677800843193298*^9, 3.677800915894456*^9}, {
   3.6778009459911776`*^9, 3.6778010364943542`*^9}, 3.683517713281968*^9}],

Cell[CellGroupData[{

Cell["Analysis within each tumor type", "Subsubsection",
 CellChangeTimes->{{3.6648476661828437`*^9, 3.6648476770364647`*^9}, {
  3.6654115388453503`*^9, 3.665411539381381*^9}, {3.6835190112972107`*^9, 
  3.683519015464449*^9}, {3.7154657987564583`*^9, 3.7154657994284964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "data", " ", "for", " ", "each", " ", "tumor", " ", "type", " ", "are", 
    " ", "extracted", " ", "from", " ", "previous", " ", "data", " ", 
    "structures", " ", "by", " ", "tracking", " ", "the", " ", "positions", 
    " ", 
    RowBox[{"(", 
     RowBox[{"row", " ", "numbers"}], ")"}], " ", "corresponding", " ", "to", 
    " ", "each", " ", "tumor", " ", "type"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CutaneousMelanomaModelPositions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "CutaneousMelanomaModels", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "CutaneousMelanomaModels", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NSCLSModelPositions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "NSCLCModels", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NSCLCModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACModelPositions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "PDACModels", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PDACModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ColorectalModelPositions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "ColorectalModels", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ColorectalModels", "]"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BreastModelPositions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "BreastModels", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "BreastModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GastricModelPositions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "GastricModels", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "GastricModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6648477028279395`*^9, 3.664847879581049*^9}, {
  3.6835182254182606`*^9, 3.68351822820142*^9}, {3.6835190216668034`*^9, 
  3.683519102116405*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "random", " ", "pairs", " ", "of", " ", "monotherapies", " ", "are", " ", 
    "significantly", " ", "better", " ", "than", " ", "monotherapies", " ", 
    "in", " ", "every", " ", "tumor", " ", "type"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
       "CutaneousMelanomaModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "CutaneousMelanomaModelPositions", "\[RightDoubleBracket]"}]}], "}"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
       "NSCLSModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "NSCLSModelPositions", "\[RightDoubleBracket]"}]}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
       "PDACModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "PDACModelPositions", "\[RightDoubleBracket]"}]}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
       "ColorectalModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "ColorectalModelPositions", "\[RightDoubleBracket]"}]}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
       "BreastModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "BreastModelPositions", "\[RightDoubleBracket]"}]}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
       "GastricModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "GastricModelPositions", "\[RightDoubleBracket]"}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6676688499196415`*^9, 3.6676688946471996`*^9}, {
  3.6744876742004743`*^9, 3.6744876931051083`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "random", " ", "pairs", " ", "of", " ", "monotherapies", " ", "are", " ", 
     "statistically", " ", "indistinguishable", " ", "from", " ", "observed", 
     " ", "combinations", " ", "in", " ", "every", " ", "tumor", " ", "type", 
     " ", "but", " ", "melanoma"}], ",", " ", 
    RowBox[{"and", " ", "gastric", " ", "cancer", " ", 
     RowBox[{"(", 
      RowBox[{
      "where", " ", "tested", " ", "combinations", " ", "are", " ", 
       "inferior"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
       "CutaneousMelanomaModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "CutaneousMelanomaModelPositions", "\[RightDoubleBracket]"}]}], "}"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
       "NSCLSModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "NSCLSModelPositions", "\[RightDoubleBracket]"}]}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
       "PDACModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "PDACModelPositions", "\[RightDoubleBracket]"}]}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
       "ColorectalModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "ColorectalModelPositions", "\[RightDoubleBracket]"}]}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
       "BreastModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "BreastModelPositions", "\[RightDoubleBracket]"}]}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogRankTest", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
       "GastricModelPositions", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]", 
       "GastricModelPositions", "\[RightDoubleBracket]"}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.674487701609123*^9, 3.6744877578710294`*^9}, {
  3.6835183961540265`*^9, 3.6835183996342254`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Cox proportional hazards model, comparing observed effects of combinations \
with random pairs of monotherapies (under assumption of independent drug \
action), in each tumor type\
\>", "Subsubsection",
 CellChangeTimes->{{3.678579876871832*^9, 3.678579881198079*^9}, {
  3.683518761608929*^9, 3.6835188311999097`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Melanoma", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"modelpositions", "=", "CutaneousMelanomaModelPositions"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "modelpositions", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "modelpositions", 
          "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
              "modelpositions", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PerModelAverageBestOfRandomMonotherapyPairs", 
              "\[LeftDoubleBracket]", "modelpositions", 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<tested combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
            "modelpositions", "\[RightDoubleBracket]"}], "]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<random monotherapy pairs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelAverageBestOfRandomMonotherapyPairs", 
            "\[LeftDoubleBracket]", "modelpositions", 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678579889182536*^9, 3.678579950215027*^9}, {
  3.683518481114886*^9, 3.68351848189093*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "NSCLC", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"modelpositions", "=", "NSCLSModelPositions"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "modelpositions", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "modelpositions", 
          "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
              "modelpositions", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PerModelAverageBestOfRandomMonotherapyPairs", 
              "\[LeftDoubleBracket]", "modelpositions", 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<tested combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
            "modelpositions", "\[RightDoubleBracket]"}], "]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<random monotherapy pairs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelAverageBestOfRandomMonotherapyPairs", 
            "\[LeftDoubleBracket]", "modelpositions", 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678579889182536*^9, 3.678579990927356*^9}, 
   3.683518500575999*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "PDAC", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"modelpositions", "=", "PDACModelPositions"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "modelpositions", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "modelpositions", 
          "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
              "modelpositions", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PerModelAverageBestOfRandomMonotherapyPairs", 
              "\[LeftDoubleBracket]", "modelpositions", 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<tested combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
            "modelpositions", "\[RightDoubleBracket]"}], "]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<random monotherapy pairs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelAverageBestOfRandomMonotherapyPairs", 
            "\[LeftDoubleBracket]", "modelpositions", 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678579889182536*^9, 3.678580007022276*^9}, 
   3.683518500599*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "CRC", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"modelpositions", "=", "ColorectalModelPositions"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "modelpositions", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "modelpositions", 
          "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
              "modelpositions", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PerModelAverageBestOfRandomMonotherapyPairs", 
              "\[LeftDoubleBracket]", "modelpositions", 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<tested combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
            "modelpositions", "\[RightDoubleBracket]"}], "]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<random monotherapy pairs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelAverageBestOfRandomMonotherapyPairs", 
            "\[LeftDoubleBracket]", "modelpositions", 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678579889182536*^9, 3.6785800235332203`*^9}, 
   3.683518500616001*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Breast", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"modelpositions", "=", "BreastModelPositions"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "modelpositions", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "modelpositions", 
          "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
              "modelpositions", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PerModelAverageBestOfRandomMonotherapyPairs", 
              "\[LeftDoubleBracket]", "modelpositions", 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<tested combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
            "modelpositions", "\[RightDoubleBracket]"}], "]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<random monotherapy pairs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelAverageBestOfRandomMonotherapyPairs", 
            "\[LeftDoubleBracket]", "modelpositions", 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678579889182536*^9, 3.6785800383410673`*^9}, 
   3.683518500627002*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Gastric", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"modelpositions", "=", "GastricModelPositions"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "modelpositions", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "modelpositions", 
          "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
              "modelpositions", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PerModelAverageBestOfRandomMonotherapyPairs", 
              "\[LeftDoubleBracket]", "modelpositions", 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<tested combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
            "modelpositions", "\[RightDoubleBracket]"}], "]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<random monotherapy pairs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelAverageBestOfRandomMonotherapyPairs", 
            "\[LeftDoubleBracket]", "modelpositions", 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678579889182536*^9, 3.6785800509647894`*^9}, 
   3.6835185006430025`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Repeating Figure 3B for each tumor subtype", "Subsubsection",
 CellChangeTimes->{{3.678579882154134*^9, 3.678579883935236*^9}, {
  3.683518865016844*^9, 3.6835188667209415`*^9}, {3.6835192197371325`*^9, 
  3.6835192254884615`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
          "CutaneousMelanomaModelPositions", "\[RightDoubleBracket]"}], "]"}],
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "CutaneousMelanomaModelPositions", "\[RightDoubleBracket]"}], "]"}],
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "CutaneousMelanomaModelPositions", 
          "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"7", "*", 
       RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"6", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", "100"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "300", ",", 
             RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "8"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "160", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Average monotherapy\>\"", ",", "\"\<Average combination\>\"",
              ",", "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.45", ",", "0.99"}], "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}]}], ","}], 
     "*)"}], 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4B, Melanoma PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6648479016083093`*^9, 3.6648479758525553`*^9}, {
   3.6747323144947147`*^9, 3.6747323152047167`*^9}, {3.6835191783847675`*^9, 
   3.683519203315193*^9}, {3.683519262909602*^9, 3.683519286690962*^9}, 
   3.685603385722103*^9, 3.71546505750006*^9, {3.7154658292071996`*^9, 
   3.7154658729987044`*^9}, {3.7154659421176577`*^9, 3.7154659676391172`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
          "NSCLSModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}], "[",
        "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "NSCLSModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}], "[",
        "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "NSCLSModelPositions", 
          "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"5", "*", 
       RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", "100"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "300", ",", 
             RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "8"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "160", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Average monotherapy\>\"", ",", "\"\<Average combination\>\"",
              ",", "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.45", ",", "0.99"}], "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}]}], ","}], 
     " ", "*)"}], 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4B, NSCLC PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6648479016083093`*^9, 3.6648479758525553`*^9}, {
   3.6747323144947147`*^9, 3.6747323152047167`*^9}, {3.6835191783847675`*^9, 
   3.683519203315193*^9}, {3.683519262909602*^9, 3.683519290413175*^9}, 
   3.6856033883302526`*^9, 3.7154650575100613`*^9, {3.7154659746935205`*^9, 
   3.7154659749665365`*^9}, {3.7154660110335994`*^9, 3.715466056694211*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
          "PDACModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "PDACModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "PDACModelPositions", 
          "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"5", "*", 
       RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", "100"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "300", ",", 
             RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "8"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "160", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Average monotherapy\>\"", ",", "\"\<Average combination\>\"",
              ",", "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.45", ",", "0.99"}], "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}]}], ","}], 
     " ", "*)"}], 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4B, PDAC PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.664848006303297*^9, 3.6648480116196012`*^9}, {
   3.664848065852703*^9, 3.664848078588432*^9}, {3.6747323157747188`*^9, 
   3.6747323163347206`*^9}, {3.6835192966825333`*^9, 3.683519298963664*^9}, 
   3.683519331914549*^9, 3.685603390945402*^9, 3.7154650575160613`*^9, {
   3.715465977590687*^9, 3.715465977958708*^9}, 3.715466012075659*^9, {
   3.7154660428544197`*^9, 3.715466062200526*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
          "ColorectalModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}],
        "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "ColorectalModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}],
        "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "ColorectalModelPositions", 
          "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"5", "*", 
       RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", "100"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "300", ",", 
             RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "8"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "160", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Average monotherapy\>\"", ",", "\"\<Average combination\>\"",
              ",", "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.45", ",", "0.99"}], "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}]}], ","}], 
     " ", "*)"}], 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4B, CRC PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.664848006303297*^9, 3.6648480116196012`*^9}, {
   3.664848065852703*^9, 3.664848078588432*^9}, {3.6747323157747188`*^9, 
   3.6747323163347206`*^9}, {3.6835192966825333`*^9, 3.683519300923776*^9}, {
   3.6835938587547283`*^9, 3.683593865003086*^9}, 3.685603392977518*^9, 
   3.7154650575220613`*^9, {3.7154659800708284`*^9, 3.715465980392847*^9}, 
   3.7154660128557034`*^9, {3.7154660689339113`*^9, 3.715466092677269*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
          "BreastModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "BreastModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "BreastModelPositions", 
          "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"5", "*", 
       RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", "100"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "300", ",", 
             RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "8"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "160", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Average monotherapy\>\"", ",", "\"\<Average combination\>\"",
              ",", "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.45", ",", "0.99"}], "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}]}], ","}], 
     " ", "*)"}], 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4B, Breast PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.664848006303297*^9, 3.6648480116196012`*^9}, {
   3.664848065852703*^9, 3.664848128236272*^9}, {3.674732316854722*^9, 
   3.674732317295723*^9}, {3.683519304326971*^9, 3.683519348560501*^9}, 
   3.685603395297651*^9, 3.7154650575290623`*^9, {3.7154659825349693`*^9, 
   3.7154659829669943`*^9}, 3.7154660163699045`*^9, {3.715466074408224*^9, 
   3.715466088533032*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
          "GastricModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "GastricModelPositions", "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "GastricModelPositions", 
          "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"5", "*", 
       RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", "100"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "300", ",", 
             RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "8"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "160", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Average monotherapy\>\"", ",", "\"\<Average combination\>\"",
              ",", "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.45", ",", "0.99"}], "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}]}], ","}], 
     " ", "*)"}], 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4B, Gastric PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.664848006303297*^9, 3.6648480116196012`*^9}, {
   3.664848065852703*^9, 3.664848128236272*^9}, {3.674732316854722*^9, 
   3.674732317295723*^9}, {3.683519304326971*^9, 3.683519351761684*^9}, {
   3.6835938727575293`*^9, 3.683593880474971*^9}, 3.6856033981238127`*^9, 
   3.7154650575350623`*^9, {3.715465985207122*^9, 3.715465985480138*^9}, 
   3.7154660182450123`*^9, {3.715466080474571*^9, 3.7154660850448327`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Repeating Figure 3B in all PDX models excepting melanoma (where combinations \
show genuine \[OpenCurlyQuote]synergy\[CloseCurlyQuote], defined in this \
analysis as superior response to independent drug action - see Supplementary \
Figure S4D)
n=197 non-melanoma PDXs\
\>", "Subsubsection",
 CellChangeTimes->{{3.683518945184429*^9, 3.6835189842646646`*^9}, {
  3.6835561511010027`*^9, 3.683556180610067*^9}, {3.68560341748192*^9, 
  3.6856034175939264`*^9}, {3.7154661449322577`*^9, 3.7154661459403152`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllPositionsExceptingMelanoma", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "NSCLSModelPositions", ",", "PDACModelPositions", ",", 
     "ColorectalModelPositions", ",", "BreastModelPositions", ",", 
     "GastricModelPositions"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "%", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{"EmpiricalDistribution", "[", 
        RowBox[{
        "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
         "AllPositionsExceptingMelanoma", "\[RightDoubleBracket]"}], "]"}], 
       "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{"EmpiricalDistribution", "[", 
        RowBox[{
        "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
         "AllPositionsExceptingMelanoma", "\[RightDoubleBracket]"}], "]"}], 
       "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{"EmpiricalDistribution", "[", 
        RowBox[{
        "PerModelAverageBestOfRandomMonotherapyPairs", "\[LeftDoubleBracket]",
          "AllPositionsExceptingMelanoma", "\[RightDoubleBracket]"}], "]"}], 
       "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", 
     RowBox[{"5", "*", 
      RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
   RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"4", "*", 
         RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
   RowBox[{"Frame", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "*", "100"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "1", ",", 
            RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "300", ",", 
            RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "6"}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "8"}], "]"}], ",", 
        RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
     "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1000", "}"}], ",", 
      RowBox[{"{", "210", "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"60", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Average monotherapy\>\"", ",", "\"\<Average combination\>\"", ",", 
      "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"3", "/", "4"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<All tumor types except melanoma\>\"", ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Black"}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.67448784832701*^9, 3.674487857849027*^9}, {
   3.674488112600355*^9, 3.6744881229949737`*^9}, {3.6747322968546543`*^9, 
   3.674732297375656*^9}, {3.683518306389892*^9, 3.683518328049131*^9}, {
   3.6835186053819933`*^9, 3.6835187208455973`*^9}, 3.68351898628078*^9, {
   3.715466158919058*^9, 3.7154661963441987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Cox", " ", "proportional", " ", "hazards", " ", "model"}], ",", 
    " ", 
    RowBox[{
    "comparing", " ", "observed", " ", "effects", " ", "of", " ", 
     "combinations", " ", "to", " ", "random", " ", "pairs", " ", "of", " ", 
     "monotherapies", " ", 
     RowBox[{"(", 
      RowBox[{
      "under", " ", "the", " ", "assumption", " ", "of", " ", "independent", 
       " ", "drug", " ", "action"}], ")"}]}], ",", " ", 
    RowBox[{
    "in", " ", "all", " ", "PDX", " ", "models", " ", "excepting", " ", 
     "melanoma"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
          "AllPositionsExceptingMelanoma", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PerModelAverageBestOfRandomMonotherapyPairs", 
          "\[LeftDoubleBracket]", "AllPositionsExceptingMelanoma", 
          "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
              "AllPositionsExceptingMelanoma", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PerModelAverageBestOfRandomMonotherapyPairs", 
              "\[LeftDoubleBracket]", "AllPositionsExceptingMelanoma", 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<tested combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
            "AllPositionsExceptingMelanoma", "\[RightDoubleBracket]"}], "]"}],
           "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<random pairs of monotherapies\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PerModelAverageBestOfRandomMonotherapyPairs", 
            "\[LeftDoubleBracket]", "AllPositionsExceptingMelanoma", 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678459989346778*^9, 3.6784600232817183`*^9}, 
   3.678579819180532*^9, 3.6835185005539975`*^9, {3.6835185398102427`*^9, 
   3.6835185873229604`*^9}, {3.6835562004501085`*^9, 3.6835562034241123`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparing each PDXs longest PFS observed with any monotherapy and with any \
combination\
\>", "Subsubsection",
 CellChangeTimes->{{3.683519427364008*^9, 3.683519501427244*^9}, {
  3.6835195372642937`*^9, 3.68351954104051*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestResponsesPlot", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "PerModelMaxMonoResponses", "]"}], 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{
         "EmpiricalDistribution", "[", "PerModelMaxComboResponses", "]"}], 
         "]"}], "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"10", "*", 
        RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"10", "*", 
           RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", "100"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "330", ",", 
              RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "8"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Progression free survival (months)\>\"", ",", 
        "\"\<PDX patients (%)\>\""}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "225", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#", ",", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Monotherapy\>\"", ",", "\"\<Combination\>\""}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", "0.8"}], "}"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"3", "/", "4"}]}], ",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Best retrospective:\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.515", ",", "0.81"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 3C, best monotherapy and best combination \
responses.pdf\>\""}], ",", "BestResponsesPlot", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.665422744969304*^9, 3.6654227669135594`*^9}, {
   3.672792167355012*^9, 3.672792179240031*^9}, {3.6742871229585986`*^9, 
   3.6742871574135695`*^9}, 3.6747323221847425`*^9, {3.6785830877174816`*^9, 
   3.678583096637992*^9}, {3.6824653354289837`*^9, 3.6824653674758167`*^9}, {
   3.6824721959873853`*^9, 3.682472204779888*^9}, {3.6835193734859266`*^9, 
   3.6835193739259515`*^9}, {3.6835195075015917`*^9, 3.683519529617857*^9}, {
   3.6842890352415223`*^9, 3.6842890355615406`*^9}, 3.715465057545063*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Cox", " ", "proportional", " ", "hazards", " ", "model", " ", "does", " ",
     "not", " ", "detect", " ", "a", " ", "significant", " ", "difference", 
    " ", "in", " ", "relative", " ", "risk", " ", 
    RowBox[{"between", " ", "'"}], "best", " ", "retrospective", " ", 
    RowBox[{"monotherapy", "'"}], " ", 
    RowBox[{"and", " ", "'"}], "best", " ", "retrospective", " ", 
    RowBox[{"combination", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
        "PerModelMaxMonoResponses", ",", "PerModelMaxComboResponses"}], "]"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
            "PerModelMaxMonoResponses", ",", "PerModelMaxComboResponses"}], 
            "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<best monotherapy per PDX\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "PerModelMaxMonoResponses", "]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<best combination per PDX\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "PerModelMaxComboResponses", "]"}], "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678460240300131*^9, 3.678460266871651*^9}, {
  3.6835193959472113`*^9, 3.683519407874893*^9}, {3.6835195708212137`*^9, 
  3.6835196064192495`*^9}}]
}, Open  ]],

Cell["\<\
Comparing each PDXs longest PFS observed with any monotherapy and with any \
combination,
but focusing only on matching sets of drugs (drugs tested in the same tumor \
type both as a monotherapy and as a part of a combination)\
\>", "Subsubsection",
 CellChangeTimes->{{3.683519427364008*^9, 3.683519501427244*^9}, {
  3.6835195372642937`*^9, 3.68351954104051*^9}, {3.683521992496724*^9, 
  3.6835220324960117`*^9}}],

Cell[CellGroupData[{

Cell["\<\

First, for each tumor type, selecting monotherapies that are contained within \
a combination tested on that same tumor type\
\>", "Subsubsection",
 CellChangeTimes->{{3.6835233946619234`*^9, 3.683523407960684*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MonotherapiesWithinCombinationsPerGroup", "=", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Intersection", ",", 
       RowBox[{"Map", "[", 
        RowBox[{"Flatten", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\< + \>\""}], "]"}], "&"}], ",", 
           "CombinationTherapiesByGroup", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\"\<gemcitabine\>\"", "\[Rule]", "\"\<gemcitabine-50mpk\>\""}],
       "}"}]}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "need", " ", "to", " ", "adjust", " ", "gemcitabine", " ", "name", " ", 
    "because", " ", "dosage", " ", "was", " ", "written", " ", "its", " ", 
    "name", " ", "as", " ", "a", " ", "monotherapy", " ", "name", " ", "but", 
    " ", "not", " ", "in", " ", "the", " ", "combination", " ", "name"}], " ",
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "data", " ", "structure", " ", "is", " ", "a", " ", "table", 
     " ", "of", " ", "length", " ", "6"}], ",", " ", 
    RowBox[{"one", " ", "entry", " ", "per", " ", "tumor", " ", "type"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesWithinCombinationsPerGroup", "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.6784605324048386`*^9, 3.6784606495485387`*^9}, 
   3.6834764485468016`*^9, {3.683522051778115*^9, 3.683522098634795*^9}, {
   3.6835224715861263`*^9, 3.683522615986386*^9}, {3.6835232004358144`*^9, 
   3.6835232658015532`*^9}, {3.683523378956025*^9, 3.6835234024183674`*^9}, {
   3.683523491257448*^9, 3.6835234914914618`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "In", " ", "total", " ", "there", " ", "are", " ", "42", " ", "drug"}], 
     "-", "by", "-", 
     RowBox[{
     "tumor", " ", "type", " ", "trials", " ", "of", " ", "monotherapies"}]}],
     ",", " ", 
    RowBox[{
    "that", " ", "were", " ", "also", " ", "tested", " ", "in", " ", "a", " ",
      "combination"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Flatten", "[", "MonotherapiesWithinCombinationsPerGroup", "]"}], "//",
    "Length"}]}]], "Input",
 CellChangeTimes->{{3.6784630623732157`*^9, 3.6784630909024086`*^9}, {
  3.6835232819694777`*^9, 3.6835232909699926`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Taking", " ", "the", " ", "best", " ", "monotherapy", " ", "response", 
     " ", "per", " ", "PDX", " ", "model"}], ";", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "conducted", " ", "on", " ", "a", " ", "per"}], 
     "-", "tumor", "-", 
     RowBox[{
     "type", " ", "basis", " ", "since", " ", "different", " ", "therapies", 
      " ", "were", " ", "tested", " ", "on", " ", "different", " ", "tumor", 
      " ", "types"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestMonotherapyResponsesFromCombinationIngredientsMelanoma", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "CutaneousMelanomaModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "MonotherapiesWithinCombinationsPerGroup", 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<single\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "CutaneousMelanomaModels", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestMonotherapyResponsesFromCombinationIngredientsNSCLC", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "NSCLCModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "MonotherapiesWithinCombinationsPerGroup", 
                  "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<single\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NSCLCModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestMonotherapyResponsesFromCombinationIngredientsPDAC", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "PDACModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "MonotherapiesWithinCombinationsPerGroup", 
                  "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<single\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PDACModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestMonotherapyResponsesFromCombinationIngredientsCRC", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "ColorectalModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "MonotherapiesWithinCombinationsPerGroup", 
                  "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<single\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ColorectalModels", "]"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestMonotherapyResponsesFromCombinationIngredientsBreast", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "BreastModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "MonotherapiesWithinCombinationsPerGroup", 
                  "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<single\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "BreastModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestMonotherapyResponsesFromCombinationIngredientsGastric", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "GastricModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "MonotherapiesWithinCombinationsPerGroup", 
                  "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<single\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "GastricModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6784606850315685`*^9, 3.6784610490793905`*^9}, 
   3.6835226347404585`*^9, {3.6835232960782847`*^9, 3.6835233442060375`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "merging", " ", "results", " ", "from", " ", "different", " ", "tumor", 
    " ", "types"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AllBestMonotherapyResponsesFromCombinationIngredients", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
     "BestMonotherapyResponsesFromCombinationIngredientsMelanoma", ",", 
      "BestMonotherapyResponsesFromCombinationIngredientsNSCLC", ",", 
      "BestMonotherapyResponsesFromCombinationIngredientsPDAC", ",", 
      "BestMonotherapyResponsesFromCombinationIngredientsCRC", ",", 
      "BestMonotherapyResponsesFromCombinationIngredientsBreast", ",", 
      "BestMonotherapyResponsesFromCombinationIngredientsGastric"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6784610606560526`*^9, 3.6784610930139036`*^9}, {
  3.683523355033657*^9, 3.683523366921337*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For each tumor type, selecting combinations where both constituents were \
tested as monotherapies on that same tumor type\
\>", "Subsubsection",
 CellChangeTimes->{{3.6835233946619234`*^9, 3.683523444584779*^9}, 
   3.6835235964254637`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CombinationIngredientsByGroup", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"#", ",", "\"\< + \>\""}], "]"}], "&"}], ",", 
      "CombinationTherapiesByGroup", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\"\<gemcitabine\>\"", "\[Rule]", "\"\<gemcitabine-50mpk\>\""}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombinationIngredientsBothTestedAsMonotherapiesByGroup", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
        "CombinationIngredientsByGroup", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{
             "MonotherapiesByGroup", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{
             "MonotherapiesByGroup", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "]"}]}], "]"}], "&"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\"\<gemcitabine-50mpk\>\"", "\[Rule]", "\"\<gemcitabine\>\""}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationsBothTestedAsMonotherapiesByGroup", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "<>", "\"\< + \>\"", "<>", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "&"}], ",", 
        RowBox[{
        "CombinationIngredientsBothTestedAsMonotherapiesByGroup", 
         "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "6", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "data", " ", "structure", " ", "is", " ", "a", " ", "table", 
     " ", "of", " ", "length", " ", "6"}], ",", " ", 
    RowBox[{"one", " ", "entry", " ", "per", " ", "tumor", " ", "type"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"CombinationsBothTestedAsMonotherapiesByGroup", "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.678462415663019*^9, 3.678462522254815*^9}, {
  3.6784625610751047`*^9, 3.6784625645361285`*^9}, {3.683522196723405*^9, 
  3.68352220065263*^9}, {3.683523470274248*^9, 3.683523486226161*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "In", " ", "total", " ", "there", " ", "are", " ", "24", " ", "drug"}], 
     "-", "by", "-", 
     RowBox[{
     "tumor", " ", "type", " ", "trials", " ", "of", " ", "combinations"}]}], 
    ",", " ", 
    RowBox[{
    "where", " ", "both", " ", "parts", " ", "of", " ", "the", " ", 
     "combination", " ", "were", " ", "also", " ", "tested", " ", "as", " ", 
     "monotherapies"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "Flatten", "[", "CombinationsBothTestedAsMonotherapiesByGroup", "]"}], "//",
    "Length"}]}]], "Input",
 CellChangeTimes->{{3.6784631017984967`*^9, 3.6784631395997524`*^9}, {
  3.6835235340598965`*^9, 3.683523554137045*^9}, {3.6835562576362085`*^9, 
  3.6835562594502144`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Taking", " ", "the", " ", "best", " ", "combination", " ", "response", 
     " ", "per", " ", "PDX", " ", "model"}], ";", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "conducted", " ", "on", " ", "a", " ", "per"}], 
     "-", "tumor", "-", 
     RowBox[{
     "type", " ", "basis", " ", "since", " ", "different", " ", "therapies", 
      " ", "were", " ", "tested", " ", "on", " ", "different", " ", "tumor", 
      " ", "types"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestCombinationFromThoseTestedAsMonotherapiesMelanoma", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "CutaneousMelanomaModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "CombinationsBothTestedAsMonotherapiesByGroup", 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<combo\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "CutaneousMelanomaModels", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestCombinationFromThoseTestedAsMonotherapiesNSCLC", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "NSCLCModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "CombinationsBothTestedAsMonotherapiesByGroup", 
                  "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<combo\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NSCLCModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestCombinationFromThoseTestedAsMonotherapiesPDAC", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "PDACModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "CombinationsBothTestedAsMonotherapiesByGroup", 
                  "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<combo\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PDACModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestCombinationFromThoseTestedAsMonotherapiesCRC", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "ColorectalModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "CombinationsBothTestedAsMonotherapiesByGroup", 
                  "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<combo\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ColorectalModels", "]"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestCombinationFromThoseTestedAsMonotherapiesBreast", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "BreastModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "CombinationsBothTestedAsMonotherapiesByGroup", 
                  "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<combo\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "BreastModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestCombinationFromThoseTestedAsMonotherapiesGastric", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "GastricModels", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "CombinationsBothTestedAsMonotherapiesByGroup", 
                  "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "\[Equal]", "\"\<combo\>\""}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "GastricModels", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6784626096124325`*^9, 3.6784626582527742`*^9}, 
   3.678462871922455*^9, {3.68352357573328*^9, 3.683523579780512*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "merging", " ", "results", " ", "from", " ", "different", " ", "tumor", 
    " ", "types"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AllBestCombinationResponsesFromThoseTestedAsMonotherapies", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
     "BestCombinationFromThoseTestedAsMonotherapiesMelanoma", ",", 
      "BestCombinationFromThoseTestedAsMonotherapiesNSCLC", ",", 
      "BestCombinationFromThoseTestedAsMonotherapiesPDAC", ",", 
      "BestCombinationFromThoseTestedAsMonotherapiesCRC", ",", 
      "BestCombinationFromThoseTestedAsMonotherapiesBreast", ",", 
      "BestCombinationFromThoseTestedAsMonotherapiesGastric"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.678462745279396*^9, 3.6784627820446954`*^9}, {
  3.6835235913461733`*^9, 3.6835235916831923`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestResponsesPlotOverlappingDrugs", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{
          "AllBestMonotherapyResponsesFromCombinationIngredients", 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}],
         "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{
          "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}],
         "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"10", "*", 
        RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"8", "*", 
           RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", "100"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "330", ",", 
              RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "8"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Best retrospective\\nmonotherapy\>\"", ",", 
        "\"\<Best retrospective\\ncombination\>\""}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"3", "/", "4"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4C, best mono and best combo, only \
overlapping drugs, all tumor types.pdf\>\""}], ",", 
    "BestResponsesPlotOverlappingDrugs", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.678462897490666*^9, 3.6784629021047*^9}, {
   3.678465882811798*^9, 3.678465894182878*^9}, {3.678583742247919*^9, 
   3.6785837499583597`*^9}, {3.678583802111343*^9, 3.6785838024413614`*^9}, 
   3.683519331964552*^9, {3.6835222342115498`*^9, 3.683522270673635*^9}, {
   3.683522313157065*^9, 3.6835223541294084`*^9}, {3.6835224470357227`*^9, 
   3.683522457634329*^9}, {3.6856034297336206`*^9, 3.685603429825626*^9}, 
   3.715465057563064*^9, {3.715466266534213*^9, 3.715466286198338*^9}, {
   3.7154663473848376`*^9, 3.715466366470929*^9}, {3.7154664093683825`*^9, 
   3.7154664861687756`*^9}, {3.7154665948069897`*^9, 3.7154665957820454`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Cox proportional hazards model identifies a borderline-significant advantage \
(p = 0.065) to combination therapy\
\>", "Subsubsection",
 CellChangeTimes->{{3.6835236237460265`*^9, 3.683523630593418*^9}, {
  3.6835237380025616`*^9, 3.6835237768887854`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"calculating", " ", "relative", " ", "risk", " ", 
    RowBox[{"between", " ", "'"}], "best", " ", "retrospective", " ", 
    RowBox[{"monotherapy", "'"}], " ", 
    RowBox[{"and", " ", "'"}], "best", " ", "retrospective", " ", 
    RowBox[{"combination", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "AllBestMonotherapyResponsesFromCombinationIngredients", 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "AllBestMonotherapyResponsesFromCombinationIngredients", 
              "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
              "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<best retrospective monotherapy\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "AllBestMonotherapyResponsesFromCombinationIngredients", 
            "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<best retrospective combination\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
            "\[LeftDoubleBracket]", "All", "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678463009616555*^9, 3.6784630180590076`*^9}, {
  3.6835236183627186`*^9, 3.683523704147625*^9}, {3.6835238879561386`*^9, 
  3.6835239137886157`*^9}, {3.683523971259903*^9, 3.683523983211587*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "same", " ", "analysis", " ", "as", " ", "above", " ", "but", " ", 
    "altering", " ", "labels", " ", "to", " ", "see", " ", "relative", " ", 
    "risk", " ", "of", " ", "combination", " ", "compared", " ", "to", " ", 
    "monotherapy", " ", 
    RowBox[{"(", 
     RowBox[{
     "instead", " ", "of", " ", "monotherapy", " ", "compared", " ", "to", 
      " ", "combination"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "AllBestMonotherapyResponsesFromCombinationIngredients", 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "AllBestMonotherapyResponsesFromCombinationIngredients", 
              "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
              "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<best retrospective monotherapy\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "AllBestMonotherapyResponsesFromCombinationIngredients", 
            "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<combination (best retrospective)\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
            "\[LeftDoubleBracket]", "All", "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678583879230754*^9, 3.6785838874632244`*^9}, {
   3.6835236839784718`*^9, 3.6835237170353622`*^9}, {3.6835238717002087`*^9, 
   3.6835238788106155`*^9}, {3.6835239198179607`*^9, 3.683523996195329*^9}, 
   3.6835563016562915`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This small advantage of combinations is due to synergistic combinations in \
melanoma: analyzing all tumor types other than melanoma, there is no \
statistical difference between best monotherapy and best combination responses\
\>", "Subsubsection",
 CellChangeTimes->{{3.68352407891006*^9, 3.683524190753457*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "selecting", " ", "the", " ", "data", " ", "corresponding", " ", "to", " ",
     "all", " ", "tumor", " ", "types", " ", "other", " ", "than", " ", 
    "melanoma"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AllModelPositionsButMelanoma", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", "230", "]"}], ",", 
       "CutaneousMelanomaModelPositions"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{
          "AllBestMonotherapyResponsesFromCombinationIngredients", 
           "\[LeftDoubleBracket]", 
           RowBox[{"AllModelPositionsButMelanoma", ",", "9"}], 
           "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{
          "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
           "\[LeftDoubleBracket]", 
           RowBox[{"AllModelPositionsButMelanoma", ",", "9"}], 
           "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}]}], 
      "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"10", "*", 
        RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"8", "*", 
           RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", "100"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "330", ",", 
              RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "8"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Best retrospective\\nmonotherapy\>\"", ",", 
        "\"\<Best retrospective\\ncombination\>\""}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"3", "/", "4"}]}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Supplementary Figure S4C, best mono and best combo, only \
overlapping drugs, excluding melanoma.pdf\>\""}], ",", "%", ",", 
      "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6784629324041986`*^9, 3.678462933372254*^9}, {
   3.6784659026079445`*^9, 3.678465909120985*^9}, {3.678583759614912*^9, 
   3.6785837950079365`*^9}, 3.6835193319775524`*^9, {3.683522404282277*^9, 
   3.68352242618653*^9}, {3.6835241957277417`*^9, 3.6835242159118967`*^9}, {
   3.6856034363569994`*^9, 3.685603436523009*^9}, 3.7154650575740647`*^9, {
   3.715466516793527*^9, 3.715466544728125*^9}, {3.7154665878645926`*^9, 
   3.7154665881046057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Cox", " ", "Proportional", " ", "Hazards", " ", "model", " ", "does", " ",
     "not", " ", "detect", " ", "a", " ", "significant", " ", "difference", 
    " ", "in", " ", "relative", " ", "risk"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "AllBestMonotherapyResponsesFromCombinationIngredients", 
          "\[LeftDoubleBracket]", 
          RowBox[{"AllModelPositionsButMelanoma", ",", "9"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
          "\[LeftDoubleBracket]", 
          RowBox[{"AllModelPositionsButMelanoma", ",", "9"}], 
          "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "AllBestMonotherapyResponsesFromCombinationIngredients", 
              "\[LeftDoubleBracket]", 
              RowBox[{"AllModelPositionsButMelanoma", ",", "9"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
              "\[LeftDoubleBracket]", 
              RowBox[{"AllModelPositionsButMelanoma", ",", "9"}], 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<best retrospective monotherapy\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "AllBestMonotherapyResponsesFromCombinationIngredients", 
            "\[LeftDoubleBracket]", 
            RowBox[{"AllModelPositionsButMelanoma", ",", "9"}], 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<combination (best retrospective)\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "AllBestCombinationResponsesFromThoseTestedAsMonotherapies", 
            "\[LeftDoubleBracket]", "AllModelPositionsButMelanoma", 
            "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.678462949649185*^9, 3.6784629771117563`*^9}, {
  3.678585148141331*^9, 3.67858514829434*^9}, {3.68352428310974*^9, 
  3.6835243204998784`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Analyzing best retrospective monotherapy or combination responses in terms of \
response criteria;
PD = progressive disease
SD = stable disease
PR = partial response
CR = complete response
(See Gao et al. Nature Medicine for additional information)\
\>", "Subsubsection",
 CellChangeTimes->{{3.667743480265402*^9, 3.6677434899089527`*^9}, {
  3.683524336936818*^9, 3.683524389480824*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
     " ", "response", " ", "classifications"}], ",", " ", 
    RowBox[{"and", " ", "returns", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"best", "'"}], " ", 
     RowBox[{"or", " ", "'"}], 
     RowBox[{"strongest", "'"}], " ", "response"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BestResponseOfSet", "[", "listofresponsetypes_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InitialResponse", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
         "listofresponsetypes"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReponsesAsNumbers", "=", 
       RowBox[{"InitialResponse", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<CR\>\"", "\[Rule]", "3"}], ",", 
          RowBox[{"\"\<PR\>\"", "\[Rule]", "2"}], ",", 
          RowBox[{"\"\<SD\>\"", "\[Rule]", "1"}], ",", 
          RowBox[{"\"\<PD\>\"", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BestResponseAsNumber", "=", 
       RowBox[{"Max", "[", "ReponsesAsNumbers", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BestResponseType", "=", 
       RowBox[{"(", 
        RowBox[{"BestResponseAsNumber", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "\[Rule]", "\"\<CR\>\""}], ",", 
           RowBox[{"2", "\[Rule]", "\"\<PR\>\""}], ",", 
           RowBox[{"1", "\[Rule]", "\"\<SD\>\""}], ",", 
           RowBox[{"0", "\[Rule]", "\"\<PD\>\""}]}], "}"}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683524415883334*^9, 3.683524455961626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "best", " ", "response", " ", "criteria", " ", "per", " ", "PDX", " ", 
     "model"}], ",", " ", 
    RowBox[{
    "to", " ", "any", " ", "monotherapy", " ", "or", " ", "to", " ", "any", 
     " ", "combination"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestMonotherapyResponseCriteriaPerModel", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BestResponseOfSet", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
           "ResponsesByModel", "\[LeftDoubleBracket]", "model", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               "\[Equal]", "\"\<single\>\""}], ",", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"model", ",", "1", ",", 
         RowBox[{"Length", "[", "ResponsesByModel", "]"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestCombinationResponseCriteriaPerModel", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BestResponseOfSet", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
           "ResponsesByModel", "\[LeftDoubleBracket]", "model", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
             "\[Equal]", "\"\<combo\>\""}], "&"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"model", ",", "1", ",", 
         RowBox[{"Length", "[", "ResponsesByModel", "]"}]}], "}"}]}], "]"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.667743770222986*^9, 3.667743826657214*^9}, {
  3.683524464978142*^9, 3.683524490851622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "How", " ", "frequent", " ", "are", " ", "different", " ", "response", " ", 
    RowBox[{"criteria", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FractionsOfResponseCriteriaWithPersonalizedMonotherapy", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"BestMonotherapyResponseCriteriaPerModel", ",", 
          RowBox[{
           RowBox[{"#", "\[Equal]", "category"}], "&"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"category", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<PD\>\"", ",", "\"\<SD\>\"", ",", "\"\<PR\>\"", ",", 
           "\"\<CR\>\""}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FractionsOfResponseCriteriaWithPersonalizedCombination", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"BestCombinationResponseCriteriaPerModel", ",", 
          RowBox[{
           RowBox[{"#", "\[Equal]", "category"}], "&"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"category", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<PD\>\"", ",", "\"\<SD\>\"", ",", "\"\<PR\>\"", ",", 
           "\"\<CR\>\""}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BarChart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "FractionsOfResponseCriteriaWithPersonalizedMonotherapy", ",", 
        "FractionsOfResponseCriteriaWithPersonalizedCombination"}], "}"}], 
      "\[Transpose]"}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"BarSpacing", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", "12.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "105"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "100", ",", "20"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "\"\<Progressive\\ndisease\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"5", ",", "\"\<Stable\\ndisease\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"8", ",", "\"\<Partial\\nresponse\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"11", ",", "\"\<Complete\\nresponse\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
          "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\\nBest observed response category\>\"", ",", 
        "\"\<Number of PDXs\>\""}], "}"}]}], ",", 
     RowBox[{"ChartLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Best retrospective monotherapy\>\"", ",", 
        "\"\<Best retrospective combination\>\""}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6677439567656555`*^9, 3.6677441097244043`*^9}, {
  3.6677441463795013`*^9, 3.6677444641946793`*^9}, {3.66774605521568*^9, 
  3.6677461305969915`*^9}, {3.6835245020362616`*^9, 3.68352458522902*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Chi-squared test rejects the hypothesis that the response distributions for \
monotherapies and for combinations are from different distributions:
(p = 0.3)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6681029972909374`*^9, 3.6681029992590504`*^9}, {
  3.668103529088355*^9, 3.668103536853799*^9}, {3.6681037227514315`*^9, 
  3.668103766313923*^9}, {3.668104669191565*^9, 3.6681046726957655`*^9}, {
  3.6681047313931227`*^9, 3.6681047739305553`*^9}, {3.6835246815605297`*^9, 
  3.6835246874248652`*^9}, {3.683524744097107*^9, 3.683524773593794*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"loading", " ", "a", " ", "hypothesis"}], "-", 
    RowBox[{"testing", " ", "package"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Needs", "[", "\"\<HypothesisTesting`\>\"", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expectedValues", "[", "rc_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rowTotals", ",", "colTotals", ",", "grandTotal"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"colTotals", ":=", 
        RowBox[{"Total", "[", "rc", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rowTotals", ":=", 
        RowBox[{"Total", "[", 
         RowBox[{"Transpose", "[", "rc", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"grandTotal", ":=", 
        RowBox[{"Total", "[", "rowTotals", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{"Times", ",", "rowTotals", ",", "colTotals"}], "]"}], "/", 
        "grandTotal"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"chiSquare", "[", "data_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "ev", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ev", "=", 
        RowBox[{"expectedValues", "[", "data", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"data", "-", "ev"}], ")"}], "2"], ")"}], "/", "ev"}], 
         ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"MyChiSquare", "=", 
    RowBox[{
     RowBox[{"chiSquare", "[", 
      RowBox[{"{", 
       RowBox[{
       "FractionsOfResponseCriteriaWithPersonalizedMonotherapy", ",", 
        "FractionsOfResponseCriteriaWithPersonalizedCombination"}], "}"}], 
      "]"}], "//", "N"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"degreesOfFreedom", "[", "rc_List", "]"}], ":=", 
    RowBox[{"Times", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Dimensions", "[", "rc", "]"}], "-", "1"}], ")"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"MyDegreesofFreedom", "=", 
    RowBox[{"degreesOfFreedom", "[", 
     RowBox[{"{", 
      RowBox[{
      "FractionsOfResponseCriteriaWithPersonalizedMonotherapy", ",", 
       "FractionsOfResponseCriteriaWithPersonalizedCombination"}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ChiSquarePValue", "[", 
    RowBox[{"MyChiSquare", ",", "MyDegreesofFreedom"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6681041505198984`*^9, 3.6681042535427914`*^9}, {
  3.683524693586218*^9, 3.683524726612107*^9}, {3.6835247799331565`*^9, 
  3.6835247805961943`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Is there a benefit to \[OpenCurlyQuote]personalized\[CloseCurlyQuote] or \
\[OpenCurlyQuote]precision\[CloseCurlyQuote] therapy, compared to \
\[OpenCurlyQuote]one-size-fits-all\[CloseCurlyQuote] therapy?\n",
 StyleBox["This is first addressed in terms of Progression Free Survival",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6835565560417757`*^9, 3.683556589315839*^9}, {
  3.6835616162454453`*^9, 3.683561668071536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "creating", " ", "a", " ", "list", " ", "of", " ", "all", " ", 
     "therapies"}], ",", " ", 
    RowBox[{
    "be", " ", "they", " ", "monotherapies", " ", "or", " ", "combinations"}],
     ",", " ", 
    RowBox[{
    "that", " ", "were", " ", "tested", " ", "in", " ", "each", " ", "tumor", 
     " ", "type"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AllTherapiesByGroup", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
        "MonotherapiesByGroup", "\[LeftDoubleBracket]", "indication", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "CombinationTherapiesByGroup", "\[LeftDoubleBracket]", "indication", 
         "\[RightDoubleBracket]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"indication", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{
  3.683556485127629*^9, {3.683556598086855*^9, 3.6835566152448816`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "calculating", " ", "median", " ", "PFS", " ", "for", " ", "each", " ", 
     "posible", " ", "treatment"}], ",", " ", 
    RowBox[{
    "calculated", " ", "over", " ", "all", " ", "PDXs", " ", "of", " ", "a", 
     " ", "tumor", " ", "type", " ", "that", " ", "were", " ", "tested", " ", 
     "with", " ", "that", " ", 
     RowBox[{"treatment", ".", " ", "Note"}], " ", "that", " ", "the", " ", 
     "treatment", " ", "matrix", " ", 
     RowBox[{"(", 
      RowBox[{"Figure", " ", "3", "A"}], ")"}], " ", "has", " ", "a", " ", 
     "few", " ", "gaps", " ", "within", " ", "blocks"}], ",", " ", 
    RowBox[{
    "meaning", " ", "that", " ", "median", " ", "PFS", " ", "is", " ", "by", 
     " ", "necessity", " ", "calculated", " ", "from", " ", "only", " ", 
     "those", " ", "xenografts", " ", "that", " ", "were", " ", "tested", " ",
      "with", " ", "a", " ", "particular", " ", "treatment"}], ",", " ", 
    RowBox[{"and", " ", "so", " ", "not", " ", "every", " ", 
     RowBox[{"treatment", "'"}], "s", " ", "median", " ", "PFS", " ", "is", 
     " ", "calculated", " ", "from", " ", "the", " ", "very", " ", "same", 
     " ", "set", " ", "of", " ", 
     RowBox[{"xenografts", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MedianPFSByTherapyByIndication", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"AllTherapiesByGroup", "\[LeftDoubleBracket]", 
              RowBox[{"indication", ",", "therapy"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"Median", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"PDXclinicaltrialresponses", ",", 
                 RowBox[{
                  RowBox[{"And", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "AllModelGroups", "\[LeftDoubleBracket]", "indication", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "==", 
                    RowBox[{"AllTherapiesByGroup", "\[LeftDoubleBracket]", 
                    RowBox[{"indication", ",", "therapy"}], 
                    "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"therapy", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{
              "AllTherapiesByGroup", "\[LeftDoubleBracket]", "indication", 
               "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
           RowBox[{
           "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"indication", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"this", " ", "data", " ", "has", " ", "6", " ", "rows"}], ",", 
     " ", 
     RowBox[{"one", " ", "for", " ", "each", " ", "tumor", " ", "type", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"in", " ", 
          RowBox[{"sequence", ":", " ", "Melanoma"}]}], ",", " ", "NSCLC", 
         ",", " ", "PDAC", ",", " ", 
         RowBox[{"Colorectal", " ", "cancer"}], ",", " ", 
         RowBox[{"Breast", " ", "cancer"}], ",", " ", 
         RowBox[{"Gastric", " ", "cancer"}]}], ")"}], ".", " ", "Within"}], 
      " ", "each", " ", "row", " ", "are", " ", "treatments", " ", "and", " ",
       "their", " ", "median", " ", "PFS", " ", 
      RowBox[{"(", 
       RowBox[{"in", " ", "days"}], ")"}]}], ",", " ", 
     RowBox[{
     "ranked", " ", "from", " ", "longest", " ", "to", " ", "shortest", " ", 
      "median", " ", "PFS"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Melanoma\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
       "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<TREATMENT\>\"", ",", "\"\<MEDIAN PFS\>\""}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<NSCLC\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
       "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<TREATMENT\>\"", ",", "\"\<MEDIAN PFS\>\""}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<PDAC\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
       "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", "3", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<TREATMENT\>\"", ",", "\"\<MEDIAN PFS\>\""}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Colorectal\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
       "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", "4", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<TREATMENT\>\"", ",", "\"\<MEDIAN PFS\>\""}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Breast\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
       "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", "5", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<TREATMENT\>\"", ",", "\"\<MEDIAN PFS\>\""}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Gastric\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
       "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", "6", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<TREATMENT\>\"", ",", "\"\<MEDIAN PFS\>\""}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6835564438635564`*^9, 3.6835564442935567`*^9}, {
  3.683556622211894*^9, 3.6835566442389317`*^9}, {3.683557303457119*^9, 
  3.6835575418505287`*^9}, {3.683557580772601*^9, 3.683557590168615*^9}, {
  3.6835576543687334`*^9, 3.6835576846587906`*^9}, {3.683557789090971*^9, 
  3.6835578497420807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "comparison", " ", "between", " ", "the", " ", "best", " ", 
    "\"\<one-size-fits-all\>\"", " ", "therapy", " ", "and", " ", 
    "personalized", " ", "therapy", " ", "is", " ", "necessarily", " ", 
    "limited", " ", "to", " ", "those", " ", "xenografts", " ", "that", " ", 
    "were", " ", "tested", " ", "with", " ", "the", " ", "aforementioned", 
    " ", "best", " ", 
    RowBox[{"therapy", ".", " ", "Here"}], " ", "we", " ", "calculate", " ", 
    "a", " ", "list", " ", "of", " ", "PDX", " ", "models", " ", "eligible", 
    " ", "for", " ", "such", " ", "a", " ", "comparison"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ModelsPerIndicationReceivingBestTherapy", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"PDXclinicaltrialresponses", ",", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{
               "AllModelGroups", "\[LeftDoubleBracket]", "indication", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
              RowBox[{
              "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", 
               RowBox[{"indication", ",", "1", ",", "1"}], 
               "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"indication", ",", "1", ",", "6", ",", "1"}], "}"}]}], "]"}],
       "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"208", " ", "PDX", " ", "models", " ", "out", " ", "of", " ", 
      RowBox[{"230", " ", "'"}], "well"}], "-", 
     RowBox[{
      RowBox[{"covered", "'"}], " ", "PDX", " ", "models", " ", "in", " ", 
      "total", " ", "are", " ", "eligible", " ", "for", " ", "this", " ", 
      "analysis"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Length", "[", 
    RowBox[{"Flatten", "[", "ModelsPerIndicationReceivingBestTherapy", "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6835579301012297`*^9, 3.6835580303064137`*^9}, {
  3.6835580868955126`*^9, 3.6835580882365146`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "within", " ", "this", " ", "set", " ", "of", " ", "208", " ", "PDX", " ",
      "models"}], ",", " ", 
    RowBox[{
    "finding", " ", "their", " ", "PFS", " ", "on", " ", "the", " ", "single",
      " ", "best", " ", "therapy", " ", "per", " ", "tumor", " ", "type"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PFSPerIndicationOnBestTherapy", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "ModelsPerIndicationReceivingBestTherapy", 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"indication", ",", "model"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", 
                 RowBox[{"indication", ",", "1", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"model", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "ModelsPerIndicationReceivingBestTherapy", "\[LeftDoubleBracket]",
              "indication", "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"indication", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"For", " ", "each", " ", "individual", " ", "PDX"}], ",", " ", 
     RowBox[{
     "what", " ", "is", " ", "the", " ", "longest", " ", "PFS", " ", 
      "acheived", " ", "by", " ", "any", " ", "tested", " ", 
      RowBox[{"treatment", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OtherBestPFSPerIndication", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"PDXclinicaltrialresponses", ",", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{
                "ModelsPerIndicationReceivingBestTherapy", 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"indication", ",", "model"}], 
                 "\[RightDoubleBracket]"}]}], "]"}], "&"}]}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"model", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "ModelsPerIndicationReceivingBestTherapy", "\[LeftDoubleBracket]",
              "indication", "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"indication", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.683558036668425*^9, 3.683558060084468*^9}, {
  3.683558095596527*^9, 3.683558104765543*^9}, {3.6835581700306673`*^9, 
  3.6835581704906683`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "on", " ", "the", " ", "horizontal", " ", "axis", " ", "is", " ", "PFS", 
     " ", "in", " ", "months", " ", 
     RowBox[{"(", 
      RowBox[{"30.5", " ", "days", " ", "per", " ", "month"}], ")"}], " ", 
     "with", " ", "the", " ", "single", " ", "best", " ", "therapy", " ", 
     "per", " ", "tumor", " ", "type"}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "on", " ", "the", " ", "vertical", " ", "axis", " ", "is", 
      " ", "how", " ", "much", " ", "better", " ", "they", " ", "are", " ", 
      "observed", " ", "to", " ", "respond", " ", "with", " ", "any", " ", 
      "other", " ", 
      RowBox[{"therapy", ".", "\[IndentingNewLine]", "Points"}], " ", "with", 
      " ", "a", " ", "vertical", " ", "coordinate", " ", "of", " ", "zero", 
      " ", "are", " ", "those", " ", "that", " ", "respond", " ", "better", 
      " ", "to", " ", "the", " ", "best"}], "-", 
     RowBox[{
     "overall", " ", "therapy", " ", "than", " ", "to", " ", "any", " ", 
      RowBox[{"other", ".", "\[IndentingNewLine]", "A"}], " ", "horizontal", 
      " ", "line", " ", "is", " ", "drawn", " ", "at", " ", "4", " ", 
      RowBox[{"weeks", "."}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Flatten", "[", "PFSPerIndicationOnBestTherapy", "]"}], ",", 
        RowBox[{
         RowBox[{"Flatten", "[", "OtherBestPFSPerIndication", "]"}], "-", 
         RowBox[{"Flatten", "[", "PFSPerIndicationOnBestTherapy", "]"}]}]}], 
       "}"}], "\[Transpose]"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"30.5", "*", "11"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "7"}], ",", 
          RowBox[{"30.5", "*", "11"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Prolog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
          RowBox[{"Dashing", "[", 
           RowBox[{"{", 
            RowBox[{"0.04", ",", "0.025"}], "}"}], "]"}], ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"400", ",", "400"}], "}"}]}], "}"}], "]"}], ","}], 
         RowBox[{"(*", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"0", "+", "14"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"400", ",", 
               RowBox[{"400", "+", "14"}]}], "}"}]}], "}"}], "]"}], "*)"}], 
         "}"}]}], ","}], "*)"}], 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
        RowBox[{"Dashing", "[", "None", "]"}], ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "28"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"400", ",", "28"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[Equal]", "0"}], ",", "0", ",", 
                RowBox[{"\"\<+\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"i", "/", 
                   RowBox[{"(", 
                    RowBox[{"61", "/", "2"}], ")"}]}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "400", ",", "61"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "/", 
               RowBox[{"(", 
                RowBox[{"61", "/", "2"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "400", ",", "61"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"AbsolutePointSize", "[", "3", "]"}]}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Single best therapy per tumor type,\\nPFS (months)\>\"", ",", 
        RowBox[{"Rotate", "[", 
         RowBox[{
         "\"\<Improvement with\\npersonalized\\ntherapy,\\n\[CapitalDelta] \
PFS (months)\>\"", ",", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"150", ",", "20"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"70", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "250", "}"}]}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Supplementary Figure S3A, Benefit of personalized \
therapy.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.665411964367689*^9, 3.665412202106287*^9}, {
   3.6654123316856985`*^9, 3.6654123480586348`*^9}, {3.683556500405656*^9, 
   3.6835565005766563`*^9}, {3.6835600616937966`*^9, 3.683560273105171*^9}, 
   3.715465057609067*^9, {3.7154666558304796`*^9, 3.715466684217103*^9}}],

Cell[CellGroupData[{

Cell["\<\
How many tumors have a sizeable benefit to \[OpenCurlyQuote]precision\
\[CloseCurlyQuote] therapy? This is defined here as having a more durable \
response to the retrospectively chosen best personal treatment, as compared \
to the best overall therapy for that tumor type.\
\>", "Subsubsection",
 CellChangeTimes->{{3.683560587810723*^9, 3.683560654841836*^9}, {
  3.6835609884043775`*^9, 3.6835609951593885`*^9}, {3.683561118477592*^9, 
  3.6835611510786476`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DifferencesBetweenOneSizeFitsAllAndPersonalizedPFS", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", "PFSPerIndicationOnBestTherapy", "]"}], "-", 
    RowBox[{"Flatten", "[", "OtherBestPFSPerIndication", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6649090173608212`*^9, 3.664909062644411*^9}}],

Cell[BoxData[{
 RowBox[{"Print", "[", 
  "\"\<Percentage of tumors that are ideally treated by the overall best \
treatment per tumor type (not more than four weeks benefit with any other \
treatment)\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"100", "*", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Select", "[", 
       RowBox[{"DifferencesBetweenOneSizeFitsAllAndPersonalizedPFS", ",", 
        RowBox[{
         RowBox[{"#", ">=", 
          RowBox[{"-", "28"}]}], "&"}]}], "]"}], "]"}], "/", 
     RowBox[{
     "Length", "[", "DifferencesBetweenOneSizeFitsAllAndPersonalizedPFS", 
      "]"}]}]}], "//", "N"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Percentage of tumors that survive at least four weeks longer on some \
treatment other than the overall best treatment per tumor type\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"100", "*", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Select", "[", 
      RowBox[{"DifferencesBetweenOneSizeFitsAllAndPersonalizedPFS", ",", 
       RowBox[{
        RowBox[{"#", "<", 
         RowBox[{"-", "28"}]}], "&"}]}], "]"}], "]"}], "/", 
    RowBox[{
    "Length", "[", "DifferencesBetweenOneSizeFitsAllAndPersonalizedPFS", 
     "]"}]}]}], "//", "N"}]}], "Input",
 CellChangeTimes->{{3.6649090136796107`*^9, 3.6649092006923075`*^9}, {
  3.6654119148638573`*^9, 3.665411947110702*^9}, {3.6654120625083027`*^9, 
  3.6654120663045197`*^9}, {3.6654122102767544`*^9, 3.6654122167471247`*^9}, {
  3.6835603456382947`*^9, 3.683560398591384*^9}, {3.683560505385578*^9, 
  3.683560512532591*^9}, {3.6835605434176455`*^9, 3.683560562375678*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["How large is this benefit on average?", "Subsubsection",
 CellChangeTimes->{{3.683561155625654*^9, 3.6835611581526594`*^9}}],

Cell[BoxData[{
 RowBox[{"Print", "[", 
  "\"\<What is the typical benefit of personalized therapy compared to the \
overall best therapy per indication? (for tumors with at least 4 weeks \
benefit on some treatment other than overall best treatment per tumor type)\>\
\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{"Round", "[", 
      RowBox[{"-", 
       RowBox[{"Mean", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"DifferencesBetweenOneSizeFitsAllAndPersonalizedPFS", ",", 
          RowBox[{
           RowBox[{"#", "<", 
            RowBox[{"-", "28"}]}], "&"}]}], "]"}], "]"}]}], "]"}], "]"}], 
    "<>", "\"\< days\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[EqualTilde] \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Mean", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"DifferencesBetweenOneSizeFitsAllAndPersonalizedPFS", ",", 
          RowBox[{
           RowBox[{"#", "<", 
            RowBox[{"-", "28"}]}], "&"}]}], "]"}], "]"}]}], "/", "7"}], "]"}],
     "]"}], "<>", "\"\< weeks\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.664911021443448*^9, 3.6649110610597143`*^9}, {
  3.6675706812354045`*^9, 3.667570701246041*^9}, {3.683560406104396*^9, 
  3.683560528175619*^9}, {3.683561165716673*^9, 3.6835611675106754`*^9}, {
  3.715466853271773*^9, 3.7154668636853685`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
In PDX data, what benefit from multi-drug combinations is expected by \
independent action?\
\>", "Section",
 CellChangeTimes->{{3.684061524314664*^9, 3.6840615515132194`*^9}, {
  3.684067335314034*^9, 3.6840673601574545`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MedianPFSByMonotherapyByIndication", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
            RowBox[{"indication", ",", "therapy"}], "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{"Median", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"PDXclinicaltrialresponses", ",", 
               RowBox[{
                RowBox[{"And", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "AllModelGroups", "\[LeftDoubleBracket]", "indication", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "==", 
                   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
                    RowBox[{"indication", ",", "therapy"}], 
                    "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"therapy", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "MonotherapiesByGroup", "\[LeftDoubleBracket]", "indication", 
             "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          ">", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "&"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"indication", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6840620269234114`*^9, 3.6840620515708213`*^9}}],

Cell[BoxData[
 RowBox[{"MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.684062072393012*^9, 3.6840620810715084`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResponsesPerIndicationOnBestOneDrug", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{
             "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"tumortype", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6840620828776116`*^9, 3.684062130825354*^9}, {
  3.6840621869155626`*^9, 3.6840623013311067`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "specific", " ", 
     "PDX", " ", "model", " ", "and", " ", "a", " ", "specific", " ", 
     "drug"}], ",", " ", 
    RowBox[{
    "and", " ", "returns", " ", "the", " ", "measured", " ", "PFS", " ", 
     "when", " ", "that", " ", "drug", " ", "was", " ", "tested", " ", "on", 
     " ", "that", " ", "PDX"}], ",", " ", 
    RowBox[{"or", " ", 
     RowBox[{"returns", " ", "'"}], 
     RowBox[{"Null", "'"}], " ", "if", " ", "no", " ", "such", " ", "test", 
     " ", "exists", " ", "in", " ", "the", " ", "data"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FindTumorsResponseToDrug", "[", 
    RowBox[{"PDXmodel_", ",", "drug_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "search", " ", "for", " ", "a", " ", "specific", " ", "PDX", " ", 
       RowBox[{"model", "'"}], "s", " ", "response", " ", "to", " ", "a", " ",
        "specific", " ", "drug"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"selection", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[Equal]", "PDXmodel"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[Equal]", "drug"}]}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"if", " ", "no", " ", "data", " ", "found"}], ",", " ", 
        RowBox[{"return", " ", "nothing"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"selection", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"if", " ", "data", " ", "found"}], ",", " ", 
        RowBox[{"return", " ", "the", " ", "9", "th", " ", "column"}], ",", 
        " ", 
        RowBox[{"which", " ", "is", " ", "TimeToDouble"}], ",", " ", 
        RowBox[{"i", ".", "e"}], ",", " ", 
        RowBox[{
        "duration", " ", "of", " ", "progression", " ", "free", " ", 
         "survival"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"selection", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6840624865016975`*^9, 3.6840625211836815`*^9}, {
  3.684062568974415*^9, 3.6840626904533634`*^9}, {3.6840630787515726`*^9, 
  3.6840631128515224`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "specific", " ", 
     "PDX", " ", "model", " ", "and", " ", "a", " ", "list", " ", "of", " ", 
     "drug"}], ",", " ", 
    RowBox[{
    "and", " ", "returns", " ", "the", " ", "best", " ", "PFS", " ", 
     "observed", " ", "in", " ", "that", " ", "PDX", " ", "model", " ", 
     "from", " ", "any", " ", "drug", " ", "in", " ", "the", " ", "specified",
      " ", "list", " ", "of", " ", 
     RowBox[{"drugs", ".", " ", "This"}], " ", "function", " ", 
     RowBox[{"returns", " ", "'"}], 
     RowBox[{"Null", "'"}], " ", "if", " ", "none", " ", "of", " ", "the", 
     " ", "specified", " ", "drugs", " ", "were", " ", "tested", " ", "on", 
     " ", "that", " ", 
     RowBox[{"PDX", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FindTumorsBestResponseToDrugList", "[", 
    RowBox[{"PDXmodel_", ",", "druglist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListOfResponses", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"FindTumorsResponseToDrug", "[", 
          RowBox[{"PDXmodel", ",", "drug"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"drug", ",", "druglist"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "select", " ", "all", " ", "cases", " ", "where", " ", "the", " ", 
         "drug", " ", "was", " ", "actually", " ", "tested", " ", "on", " ", 
         "the", " ", "PDX", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", ".", "e"}], ",", " ", 
            RowBox[{"the", " ", "entry", " ", "is", " ", 
             RowBox[{"not", " ", "'"}], 
             RowBox[{"Null", "'"}]}]}], ")"}], ".", " ", "This"}], " ", "is", 
         " ", "acheived", " ", "by", " ", "testing", " ", "if", " ", "each", 
         " ", "entry", " ", "is", " ", "a", " ", "number"}], ",", " ", 
        RowBox[{"using", " ", 
         RowBox[{"the", " ", "'"}], 
         RowBox[{"NumberQ", "'"}], " ", "function"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MeasuredResponses", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"ListOfResponses", ",", 
         RowBox[{
          RowBox[{"NumberQ", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"if", " ", "there", " ", "is", " ", "no", " ", "data"}], ",", 
        " ", 
        RowBox[{"return", " ", "Null"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MeasuredResponses", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"if", " ", "data", " ", "is", " ", "found"}], ",", " ", 
        RowBox[{
        "return", " ", "the", " ", "longest", " ", "measured", " ", "PFS"}]}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Max", "[", "MeasuredResponses", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6840632802250957`*^9, 3.684063506440035*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "particular", " ", 
     "tumor", " ", "type", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "as", " ", "a", " ", "number", " ", "from", " ", "1", " ", "to", " ", 
        "6"}], ";", " ", 
       RowBox[{
       "from", " ", "melanoma", " ", "to", " ", "gastric", " ", "cancer"}]}], 
      ")"}]}], ",", " ", 
    RowBox[{"and", " ", "a", " ", "list", " ", "of", " ", "drugs"}], ",", " ", 
    RowBox[{
    "and", " ", "returns", " ", "a", " ", "list", " ", "over", " ", "PDX", 
     " ", "models", " ", "of", " ", "each", " ", "PDXs", " ", "best", " ", 
     "observed", " ", "response", " ", "to", " ", "any", " ", "drug", " ", 
     "in", " ", "the", " ", "specified", " ", "list"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BestResponsesInTumorTypeToDrugList", "[", 
    RowBox[{"tumortype_", ",", "druglist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListOfAllResponses", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"FindTumorsBestResponseToDrugList", "[", 
          RowBox[{
           RowBox[{"AllModelGroups", "\[LeftDoubleBracket]", 
            RowBox[{"tumortype", ",", "tumornumber"}], 
            "\[RightDoubleBracket]"}], ",", "druglist"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"tumornumber", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
             "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "when", " ", "a", " ", "particular", " ", "PDX", " ", "model", " ", 
         "was", " ", "not", " ", "tested", " ", "in", " ", "any", " ", "of", 
         " ", "the", " ", "specified", " ", "drugs"}], ",", " ", 
        RowBox[{"there", " ", "is", " ", "an", " ", "entry", " ", 
         RowBox[{"of", " ", "'"}], 
         RowBox[{
          RowBox[{"Null", "'"}], ".", " ", "In"}], " ", "the", " ", "next", 
         " ", "step", " ", "we", " ", "select", " ", "all", " ", "cases", " ",
          "where", " ", "a", " ", "xenograft", " ", "was", " ", "tested", " ",
          "on", " ", "at", " ", "least", " ", "one", " ", "drug", " ", "in", 
         " ", "the", " ", "list"}], ",", " ", 
        RowBox[{
        "by", " ", "selecting", " ", "entries", " ", "which", " ", "are", " ", 
         RowBox[{"not", " ", "'"}], 
         RowBox[{
          RowBox[{"Null", "'"}], ".", " ", "This"}], " ", "is", " ", 
         "acheived", " ", "by", " ", "testing", " ", "if", " ", "each", " ", 
         "entry", " ", "is", " ", "a", " ", "number"}], ",", " ", 
        RowBox[{"using", " ", 
         RowBox[{"the", " ", "'"}], 
         RowBox[{"NumberQ", "'"}], " ", "function"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{"ListOfAllResponses", ",", 
        RowBox[{
         RowBox[{"NumberQ", "[", "#", "]"}], "&"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6840628239609995`*^9, 3.684063012574787*^9}, {
  3.684063114930642*^9, 3.684063163904443*^9}, {3.6840636859273005`*^9, 
  3.6840639194186563`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"responses", " ", "when", " ", "untreated"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ResponsesWhenUntreated", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BestResponsesInTumorTypeToDrugList", "[", 
         RowBox[{"tumortype", ",", 
          RowBox[{"{", "\"\<untreated\>\"", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tumortype", ",", "1", ",", "6"}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Responses", " ", "for", " ", "each", " ", "PDX", " ", "when", " ", 
      "treated", " ", "with", " ", "the", " ", "best", " ", "monotherapy", 
      " ", "for", " ", "that", " ", "tumor", " ", "type"}], ",", " ", 
     RowBox[{
     "according", " ", "to", " ", "its", " ", "median", " ", "PFS"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResponsesOnBestOneDrugPerTumorType", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BestResponsesInTumorTypeToDrugList", "[", 
         RowBox[{"tumortype", ",", 
          RowBox[{"{", 
           RowBox[{
           "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
            RowBox[{"tumortype", ",", "1", ",", "1"}], 
            "\[RightDoubleBracket]"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tumortype", ",", "1", ",", "6"}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Best", " ", "responses", " ", "for", " ", "each", " ", "PDX", " ", 
      "when", " ", "treated", " ", "with", " ", "either", " ", "of", " ", 
      "the", " ", "top", " ", "two", " ", "monotherapies", " ", "for", " ", 
      "that", " ", "tumor", " ", "type"}], ",", " ", 
     RowBox[{
     "according", " ", "to", " ", "their", " ", "median", " ", "PFS"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResponsesOnBestTwoDrugsPerTumorType", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BestResponsesInTumorTypeToDrugList", "[", 
         RowBox[{"tumortype", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "2", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tumortype", ",", "1", ",", "6"}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Best", " ", "responses", " ", "for", " ", "each", " ", "PDX", " ", 
      "when", " ", "treated", " ", "with", " ", "either", " ", "of", " ", 
      "the", " ", "top", " ", "three", " ", "monotherapies", " ", "for", " ", 
      "that", " ", "tumor", " ", "type"}], ",", " ", 
     RowBox[{
     "according", " ", "to", " ", "their", " ", "median", " ", "PFS"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResponsesOnBestThreeDrugsPerTumorType", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BestResponsesInTumorTypeToDrugList", "[", 
         RowBox[{"tumortype", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "2", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "3", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tumortype", ",", "1", ",", "6"}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Best", " ", "responses", " ", "for", " ", "each", " ", "PDX", " ", 
      "when", " ", "treated", " ", "with", " ", "either", " ", "of", " ", 
      "the", " ", "top", " ", "four", " ", "monotherapies", " ", "for", " ", 
      "that", " ", "tumor", " ", "type"}], ",", " ", 
     RowBox[{
     "according", " ", "to", " ", "their", " ", "median", " ", "PFS"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResponsesOnBestFourDrugsPerTumorType", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BestResponsesInTumorTypeToDrugList", "[", 
         RowBox[{"tumortype", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "2", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "3", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "4", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tumortype", ",", "1", ",", "6"}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Best", " ", "responses", " ", "for", " ", "each", " ", "PDX", " ", 
      "when", " ", "treated", " ", "with", " ", "either", " ", "of", " ", 
      "the", " ", "top", " ", "five", " ", "monotherapies", " ", "for", " ", 
      "that", " ", "tumor", " ", "type"}], ",", " ", 
     RowBox[{
     "according", " ", "to", " ", "their", " ", "median", " ", "PFS"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResponsesOnBestFiveDrugsPerTumorType", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BestResponsesInTumorTypeToDrugList", "[", 
         RowBox[{"tumortype", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "2", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "3", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "4", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "MedianPFSByMonotherapyByIndication", "\[LeftDoubleBracket]", 
             RowBox[{"tumortype", ",", "5", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tumortype", ",", "1", ",", "6"}], "}"}]}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6840642137744923`*^9, 3.6840645465605264`*^9}, {
  3.6840650407557926`*^9, 3.6840651410005264`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{"EmpiricalDistribution", "[", "ResponsesWhenUntreated", "]"}], 
       "]"}], "[", "t", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{
       "EmpiricalDistribution", "[", "ResponsesOnBestOneDrugPerTumorType", 
        "]"}], "]"}], "[", "t", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{
       "EmpiricalDistribution", "[", "ResponsesOnBestTwoDrugsPerTumorType", 
        "]"}], "]"}], "[", "t", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{
       "EmpiricalDistribution", "[", "ResponsesOnBestThreeDrugsPerTumorType", 
        "]"}], "]"}], "[", "t", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{
       "EmpiricalDistribution", "[", "ResponsesOnBestFourDrugsPerTumorType", 
        "]"}], "]"}], "[", "t", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SurvivalFunction", "[", 
       RowBox[{
       "EmpiricalDistribution", "[", "ResponsesOnBestFiveDrugsPerTumorType", 
        "]"}], "]"}], "[", "t", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"7", "*", "30.5"}]}], "}"}], ",", 
   RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"6", "*", "30.5"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
   RowBox[{"Frame", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "*", "100"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "1", ",", 
            RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "330", ",", 
            RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Progression free survival (months)\>\"", ",", 
      "\"\<PDX patients (%)\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1000", "}"}], ",", 
      RowBox[{"{", "280", "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"60", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"3", "/", "4"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Untreated\>\"", ",", "\"\<Best 1 drug per tumor type\>\"", ",", 
      "\"\<Best of 2 drugs per tumor type\>\"", ",", 
      "\"\<Best of 3 drugs per tumor type\>\"", ",", 
      "\"\<Best of 4 drugs per tumor type\>\"", ",", 
      "\"\<Best of 5 drugs per tumor type\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.684064559661276*^9, 3.6840648242884116`*^9}, {
  3.68406490922927*^9, 3.6840649282603583`*^9}, {3.6840651309519515`*^9, 
  3.684065163401808*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], 
    ",", " ", 
    RowBox[{
    "best", " ", "1", " ", "drug", " ", "versus", " ", "untreated"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
        "ResponsesWhenUntreated", ",", "ResponsesOnBestOneDrugPerTumorType"}],
         "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
            "ResponsesWhenUntreated", ",", 
             "ResponsesOnBestOneDrugPerTumorType"}], "]"}], "]"}], "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<no treatment\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "ResponsesWhenUntreated", "]"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 1 drug\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "ResponsesOnBestOneDrugPerTumorType", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best1DrugRelativeRisk", "=", 
    RowBox[{
     RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best1DrugRiskInterval", "=", 
    RowBox[{
     RowBox[{
     "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6840650167074175`*^9, 3.6840650226917596`*^9}, {
  3.684065175927524*^9, 3.684065299127571*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], 
    ",", " ", 
    RowBox[{
    "best", " ", "2", " ", "drugs", " ", "versus", " ", "best", " ", "1", " ",
      "drug"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
        "ResponsesOnBestOneDrugPerTumorType", ",", 
         "ResponsesOnBestTwoDrugsPerTumorType"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
            "ResponsesOnBestOneDrugPerTumorType", ",", 
             "ResponsesOnBestTwoDrugsPerTumorType"}], "]"}], "]"}], "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 1 drug\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "ResponsesOnBestOneDrugPerTumorType", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 2 drugs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "ResponsesOnBestTwoDrugsPerTumorType", "]"}],
           "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best2DrugsRelativeRisk", "=", 
    RowBox[{
     RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best2DrugsRiskInterval", "=", 
    RowBox[{
     RowBox[{
     "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6840653077100616`*^9, 3.6840653512825537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], 
    ",", " ", 
    RowBox[{
    "best", " ", "3", " ", "drugs", " ", "versus", " ", "best", " ", "2", " ",
      "drugs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
        "ResponsesOnBestTwoDrugsPerTumorType", ",", 
         "ResponsesOnBestThreeDrugsPerTumorType"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
            "ResponsesOnBestTwoDrugsPerTumorType", ",", 
             "ResponsesOnBestThreeDrugsPerTumorType"}], "]"}], "]"}], "}"}]}],
         "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 2 drugs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "ResponsesOnBestTwoDrugsPerTumorType", "]"}],
           "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 3 drugs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
          "Length", "[", "ResponsesOnBestThreeDrugsPerTumorType", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best3DrugsRelativeRisk", "=", 
    RowBox[{
     RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best3DrugsRiskInterval", "=", 
    RowBox[{
     RowBox[{
     "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6840653568708735`*^9, 3.6840653913338447`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], 
    ",", " ", 
    RowBox[{
    "best", " ", "4", " ", "drugs", " ", "versus", " ", "best", " ", "3", " ",
      "drugs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
        "ResponsesOnBestThreeDrugsPerTumorType", ",", 
         "ResponsesOnBestFourDrugsPerTumorType"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
            "ResponsesOnBestThreeDrugsPerTumorType", ",", 
             "ResponsesOnBestFourDrugsPerTumorType"}], "]"}], "]"}], "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 3 drugs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
          "Length", "[", "ResponsesOnBestThreeDrugsPerTumorType", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 4 drugs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
          "Length", "[", "ResponsesOnBestFourDrugsPerTumorType", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best4DrugsRelativeRisk", "=", 
    RowBox[{
     RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best4DrugsRiskInterval", "=", 
    RowBox[{
     RowBox[{
     "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.684065402936508*^9, 3.684065426012828*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], 
    ",", " ", 
    RowBox[{
    "best", " ", "5", " ", "drugs", " ", "versus", " ", "best", " ", "4", " ",
      "drugs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
        "ResponsesOnBestFourDrugsPerTumorType", ",", 
         "ResponsesOnBestFiveDrugsPerTumorType"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
            "ResponsesOnBestFourDrugsPerTumorType", ",", 
             "ResponsesOnBestFiveDrugsPerTumorType"}], "]"}], "]"}], "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 4 drugs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
          "Length", "[", "ResponsesOnBestFourDrugsPerTumorType", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<top 5 drugs\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
          "Length", "[", "ResponsesOnBestFiveDrugsPerTumorType", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best5DrugsRelativeRisk", "=", 
    RowBox[{
     RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Best5DrugsRiskInterval", "=", 
    RowBox[{
     RowBox[{
     "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6840654391295786`*^9, 3.6840654714894295`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"loading", " ", "package"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.6840655426725006`*^9, 3.684065546367712*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ErrorListPlot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "Best1DrugRelativeRisk"}], "}"}], ",", 
        RowBox[{"ErrorBar", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Best1DrugRiskInterval", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "-", "Best1DrugRelativeRisk"}], ",", 
           RowBox[{
            RowBox[{
            "Best1DrugRiskInterval", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "-", "Best1DrugRelativeRisk"}]}], 
          "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "Best2DrugsRelativeRisk"}], "}"}], ",", 
        RowBox[{"ErrorBar", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Best2DrugsRiskInterval", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "-", "Best2DrugsRelativeRisk"}], ",", 
           RowBox[{
            RowBox[{
            "Best2DrugsRiskInterval", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "-", "Best2DrugsRelativeRisk"}]}], 
          "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "Best3DrugsRelativeRisk"}], "}"}], ",", 
        RowBox[{"ErrorBar", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Best3DrugsRiskInterval", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "-", "Best3DrugsRelativeRisk"}], ",", 
           RowBox[{
            RowBox[{
            "Best3DrugsRiskInterval", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "-", "Best3DrugsRelativeRisk"}]}], 
          "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "Best4DrugsRelativeRisk"}], "}"}], ",", 
        RowBox[{"ErrorBar", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Best4DrugsRiskInterval", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "-", "Best4DrugsRelativeRisk"}], ",", 
           RowBox[{
            RowBox[{
            "Best4DrugsRiskInterval", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "-", "Best4DrugsRelativeRisk"}]}], 
          "}"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.5", ",", "4.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.12"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.06"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1.2", ",", "0.2"}], "}"}]}], "]"}], 
         ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.06"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "5", ",", "1"}], "}"}]}], "]"}], ",", 
         "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Number of drugs\>\"", ",", 
       RowBox[{"Rotate", "[", 
        RowBox[{"\"\<Hazard\\nRatio,\\nN vs N-1\\ndrugs\>\"", ",", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "225", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"90", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1.4"}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0.05"}], "}"}], "]"}], ",", "Gray", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5.5", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"AbsolutePointSize", "[", "6", "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "1.5", "]"}]}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 3D, Hazard ratios of multidrug combinations in PDX \
data.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6840655606965313`*^9, 3.6840656005218096`*^9}, {
   3.684065693914151*^9, 3.684065705891836*^9}, {3.6840657363195767`*^9, 
   3.6840660189927444`*^9}, {3.6840660532777057`*^9, 3.684066214169908*^9}, {
   3.68406627329529*^9, 3.684066350437702*^9}, {3.6840664051658325`*^9, 
   3.6840664607640123`*^9}, {3.6840668188384933`*^9, 3.684066885450303*^9}, {
   3.684067008176323*^9, 3.68406706407752*^9}, {3.6840674837785254`*^9, 
   3.6840675118341303`*^9}, {3.6840679791378584`*^9, 3.684067980317926*^9}, {
   3.6845985227892046`*^9, 3.6845985527919207`*^9}, {3.6855480689975953`*^9, 
   3.685548072708808*^9}, 3.715465057635068*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Is there a benefit to \[OpenCurlyQuote]personalized\[CloseCurlyQuote] or \
\[OpenCurlyQuote]precision\[CloseCurlyQuote] therapy, compared to \
\[OpenCurlyQuote]one-size-fits-all\[CloseCurlyQuote] therapy?\n",
 StyleBox["This is next addressed in terms of response criteria:\nPD = \
progressive disease\nSD = stable disease\nPR = partial response\nCR =  \
complete response",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6835565560417757`*^9, 3.683556589315839*^9}, {
  3.6835616162454453`*^9, 3.683561695075582*^9}, {3.6835617384676585`*^9, 
  3.683561758150689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "each", " ", "PDXs", " ", "response", " ", 
    "criteria", " ", "when", " ", "treated", " ", "with", " ", "the", " ", 
    "best", " ", "overall", " ", "treatment", " ", "per", " ", "tumor", " ", 
    RowBox[{"type", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ResponseCriteriaPerIndicationOnBestTherapy", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"PDXclinicaltrialresponses", ",", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
               RowBox[{
               "ModelsPerIndicationReceivingBestTherapy", 
                "\[LeftDoubleBracket]", 
                RowBox[{"indication", ",", "model"}], 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
               RowBox[{
               "MedianPFSByTherapyByIndication", "\[LeftDoubleBracket]", 
                RowBox[{"indication", ",", "1", ",", "1"}], 
                "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"model", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "ModelsPerIndicationReceivingBestTherapy", "\[LeftDoubleBracket]", 
            "indication", "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"indication", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.667671144975911*^9, 3.6676711639469957`*^9}, 
   3.6835613240009403`*^9, {3.683561759881692*^9, 3.6835617910457444`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "list", " ", "of", " ", "all", " ", "response", " ", "criteria", 
    " ", "acheived", " ", "by", " ", "each", " ", "PDX", " ", "model"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AllResponseCriteriaPerModelPerIndication", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"PDXclinicaltrialresponses", ",", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
              RowBox[{
              "ModelsPerIndicationReceivingBestTherapy", 
               "\[LeftDoubleBracket]", 
               RowBox[{"indication", ",", "model"}], 
               "\[RightDoubleBracket]"}]}], "]"}], "&"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"model", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "ModelsPerIndicationReceivingBestTherapy", "\[LeftDoubleBracket]", 
            "indication", "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"indication", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6676711721004624`*^9, 3.6676712114757147`*^9}, {
  3.667671263038664*^9, 3.667671263393684*^9}, {3.6835617976637573`*^9, 
  3.683561811106779*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
    " ", "observed", " ", "response", " ", "criteria", " ", "and", " ", 
    "returns", " ", "the", " ", 
    RowBox[{"strongest", " ", "/", " ", "best"}], " ", "response"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BestResponseOfSet", "[", "listofresponsetypes_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InitialResponse", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
         "listofresponsetypes"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReponsesAsNumbers", "=", 
       RowBox[{"InitialResponse", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<CR\>\"", "\[Rule]", "3"}], ",", 
          RowBox[{"\"\<PR\>\"", "\[Rule]", "2"}], ",", 
          RowBox[{"\"\<SD\>\"", "\[Rule]", "1"}], ",", 
          RowBox[{"\"\<PD\>\"", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BestResponseAsNumber", "=", 
       RowBox[{"Max", "[", "ReponsesAsNumbers", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BestResponseType", "=", 
       RowBox[{"(", 
        RowBox[{"BestResponseAsNumber", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "\[Rule]", "\"\<CR\>\""}], ",", 
           RowBox[{"2", "\[Rule]", "\"\<PR\>\""}], ",", 
           RowBox[{"1", "\[Rule]", "\"\<SD\>\""}], ",", 
           RowBox[{"0", "\[Rule]", "\"\<PD\>\""}]}], "}"}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683561812796781*^9, 3.6835618328238153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "best", " ", "response", " ", 
    "observed", " ", "with", " ", "any", " ", "treatment", " ", "for", " ", 
    "each", " ", "PDX", " ", 
    RowBox[{"model", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BestResponseCriteriaPerModelPerIndication", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
     "BestResponseOfSet", ",", "AllResponseCriteriaPerModelPerIndication", 
      ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6676712294337416`*^9, 3.6676712785105486`*^9}, {
  3.683561835906824*^9, 3.683561857262862*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Responses", " ", "are", " ", "tabulated", " ", "in", " ", "Gao", " ", 
     "et", " ", "al"}], ",", " ", 
    RowBox[{"Nature", " ", "Medicine"}], ",", " ", 
    RowBox[{
     RowBox[{"with", " ", "sub"}], "-", "classifications"}], ",", " ", 
    RowBox[{
     RowBox[{"like", " ", 
      RowBox[{"SD", " ", "--"}]}], ">", " ", 
     RowBox[{"PD", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"initially", " ", "stable"}], ",", " ", 
        RowBox[{"later", " ", "progressing"}]}], ")"}], " ", "and", " ", 
      RowBox[{"SD", " ", "--"}]}], ">", " ", 
     RowBox[{"--", 
      RowBox[{">", " ", 
       RowBox[{"PD", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"initially", " ", "stable"}], ",", " ", 
           RowBox[{"much", " ", "later", " ", "progressing"}]}], ")"}], ".", 
         " ", "Here"}], " ", "we", " ", "take", " ", "just", " ", "the", " ", 
        "first", " ", "two", " ", "characters", " ", "to", " ", "determine", 
        " ", 
        RowBox[{"the", " ", "'"}], 
        RowBox[{"major", "'"}], " ", "or", " ", "initial", " ", "response", 
        " ", "criteria"}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MajorResponseCategoryPerIndicationOnBestTherapy", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
      "ResponseCriteriaPerIndicationOnBestTherapy", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6676712979576607`*^9, 3.667671330233507*^9}, {
  3.6835619035079346`*^9, 3.6835619474980087`*^9}, {3.683561990469082*^9, 
  3.6835620626001973`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "How", " ", "many", " ", "steps", " ", "in", " ", "response", " ", 
    "criteria", " ", "is", " ", "the", " ", "benefit", " ", "of", " ", 
    "personalized", " ", 
    RowBox[{"therapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "NumberOfmRECISTcriteriaDifferentBetweenBestResponseAndBestTherapy", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"MajorResponseCategoryPerIndicationOnBestTherapy", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<PD\>\"", "\[Rule]", "0"}], ",", 
         RowBox[{"\"\<SD\>\"", "\[Rule]", "1"}], ",", 
         RowBox[{"\"\<PR\>\"", "\[Rule]", "2"}], ",", 
         RowBox[{"\"\<CR\>\"", "\[Rule]", "3"}]}], "}"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"BestResponseCriteriaPerModelPerIndication", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<PD\>\"", "\[Rule]", "0"}], ",", 
         RowBox[{"\"\<SD\>\"", "\[Rule]", "1"}], ",", 
         RowBox[{"\"\<PR\>\"", "\[Rule]", "2"}], ",", 
         RowBox[{"\"\<CR\>\"", "\[Rule]", "3"}]}], "}"}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6676713325106373`*^9, 3.667671410676108*^9}, {
  3.683562068021206*^9, 3.6835621096472807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Given", " ", "a", " ", "list", " ", "of", " ", "responses"}], 
    ",", " ", 
    RowBox[{
    "returns", " ", "a", " ", "table", " ", "with", " ", "the", " ", 
     "fraction", " ", "of", " ", "responses", " ", "in", " ", "each", " ", 
     "criteria", " ", 
     RowBox[{"(", 
      RowBox[{"PD", ",", " ", "SD", ",", " ", "PR", ",", " ", "CR"}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HowManyResponses", "[", "listofresponses_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FirstTwoCharacters", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "listofresponses"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NumberOfConditions", "=", 
       RowBox[{"Length", "[", "listofresponses", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FractionOfProgressiveDisease", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"FirstTwoCharacters", ",", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "\"\<PD\>\""}], "&"}]}], "]"}], "]"}], 
        "/", "NumberOfConditions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FractionOfStableDisease", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"FirstTwoCharacters", ",", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "\"\<SD\>\""}], "&"}]}], "]"}], "]"}], 
        "/", "NumberOfConditions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FractionOfPartialResponses", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"FirstTwoCharacters", ",", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "\"\<PR\>\""}], "&"}]}], "]"}], "]"}], 
        "/", "NumberOfConditions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FractionOfCompleteResponses", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"FirstTwoCharacters", ",", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "\"\<CR\>\""}], "&"}]}], "]"}], "]"}], 
        "/", "NumberOfConditions"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "FractionOfProgressiveDisease", ",", "FractionOfStableDisease", ",", 
        "FractionOfPartialResponses", ",", "FractionOfCompleteResponses"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.667576480649187*^9, 3.6675766371111364`*^9}, {
  3.6835622380114975`*^9, 3.6835622613505373`*^9}}],

Cell[CellGroupData[{

Cell["\<\
The rate of partial or complete response is 2.2\[Times] higher with \
\[OpenCurlyQuote]personalized\[CloseCurlyQuote] therapy than with \
\[OpenCurlyQuote]one-size-fits-all\[CloseCurlyQuote] therapy, and the rate of \
complete response is 5.8\[Times] higher:\
\>", "Subsubsection",
 CellChangeTimes->{{3.6835637610530806`*^9, 3.6835638327431808`*^9}}],

Cell[BoxData[{
 RowBox[{"Print", "[", 
  "\"\<Summing over all PDXs from all indications; what is the response rate \
(%) with the single best therapy per indication?\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Progressive Disease\>\"", ",", "\"\<Stable Disease\>\"", ",", 
       "\"\<Partial Response\>\"", ",", "\"\<Complete Response\>\""}], "}"}], 
     ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"100", "*", 
        RowBox[{"HowManyResponses", "[", 
         RowBox[{
         "Flatten", "[", "MajorResponseCategoryPerIndicationOnBestTherapy", 
          "]"}], "]"}]}], ",", "0.1"}], "]"}]}], "}"}], "//", "N"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{
  3.6675770680657854`*^9, {3.667581134726385*^9, 3.6675811462910466`*^9}, 
   3.667748244358892*^9, {3.6835635832099085`*^9, 3.683563605754198*^9}, {
   3.6835666559868193`*^9, 3.683566714415161*^9}}],

Cell[BoxData[{
 RowBox[{"Print", "[", 
  "\"\<Summing over all PDXs from all indications; what is the best response \
(%) acheivable with 'personalized' therapy?\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Progressive Disease\>\"", ",", "\"\<Stable Disease\>\"", ",", 
       "\"\<Partial Response\>\"", ",", "\"\<Complete Response\>\""}], "}"}], 
     ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"100", "*", 
        RowBox[{"HowManyResponses", "[", 
         RowBox[{
         "Flatten", "[", "BestResponseCriteriaPerModelPerIndication", "]"}], 
         "]"}]}], ",", "0.1"}], "]"}]}], "}"}], "//", "N"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.6675768870324306`*^9, 3.667576941842566*^9}, {
  3.6835636953383217`*^9, 3.683563696928413*^9}, {3.6835667219205904`*^9, 
  3.6835667386415467`*^9}, {3.6837442028040047`*^9, 3.683744210524446*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plotting response rate for monotherapies, combination therapies, and random \
pairs of monotherapies (according to independent drug action)\
\>", "Section",
 CellChangeTimes->{{3.6644142672387285`*^9, 3.664414273294075*^9}, {
  3.6835669327986517`*^9, 3.6835669520557537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "A", " ", "list", " ", "of", " ", "drug", " ", "responses", " ", "sorted", 
    " ", "by", " ", "PDX", " ", "model"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ResponsesByModel", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "\[Equal]", 
          RowBox[{
          "WellCoveredModels", "\[LeftDoubleBracket]", "model", 
           "\[RightDoubleBracket]"}]}], "&"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"model", ",", "1", ",", 
        RowBox[{"Length", "[", "WellCoveredModels", "]"}]}], "}"}]}], "]"}]}],
    ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "A", " ", "list", " ", "of", " ", "response", " ", "criteria", " ", 
    "produced", " ", "by", " ", "each", " ", "monotherapy", " ", "in", " ", 
    "each", " ", "tumor", " ", "type", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "this", " ", "is", " ", "a", " ", "table", " ", "with", " ", "an", " ", 
       "entry", " ", "for", " ", "each", " ", "tumor", " ", "type"}], ",", 
      " ", 
      RowBox[{
      "which", " ", "then", " ", "contains", " ", "lists", " ", "of", " ", 
       "responses", " ", "for", " ", "each", " ", "treatment"}]}], ")"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PerMonotherapyByGroupResponseTypes", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "AllModelGroups", "\[LeftDoubleBracket]", "indication", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
                RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
                 RowBox[{"indication", ",", "TherapiesWithinIndication"}], 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "11"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"TherapiesWithinIndication", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "MonotherapiesByGroup", "\[LeftDoubleBracket]", "indication", 
             "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"indication", ",", "1", ",", 
         RowBox[{"Length", "[", "AllModelGroups", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "A", " ", "list", " ", "of", " ", "response", " ", "criteria", " ", 
     "produced", " ", "by", " ", "each", " ", "combination", " ", "therapy", 
     " ", "in", " ", "each", " ", "tumor", " ", "type", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "this", " ", "is", " ", "a", " ", "table", " ", "with", " ", "an", " ",
         "entry", " ", "for", " ", "each", " ", "tumor", " ", "type"}], ",", 
       " ", 
       RowBox[{
       "which", " ", "then", " ", "contains", " ", "lists", " ", "of", " ", 
        "responses", " ", "for", " ", "each", " ", "treatment"}]}], ")"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerCombinationByGroupResponseTypes", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "AllModelGroups", "\[LeftDoubleBracket]", "indication", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
                RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
                 RowBox[{"indication", ",", "TherapiesWithinIndication"}], 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "11"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"TherapiesWithinIndication", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
             "indication", "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"indication", ",", "1", ",", 
         RowBox[{"Length", "[", "AllModelGroups", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.664418835650027*^9, 3.6644188465356493`*^9}, {
  3.664419121821395*^9, 3.6644192107574816`*^9}, {3.6644193211397953`*^9, 
  3.6644194258877864`*^9}, {3.6644194863102427`*^9, 3.6644194866702633`*^9}, {
  3.683476449748871*^9, 3.68347647421727*^9}, {3.6835221211320815`*^9, 
  3.683522121134082*^9}, {3.6835670937938604`*^9, 3.6835671484019833`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "converts", " ", "a", " ", "string", " ", 
     "of", " ", "response", " ", "type", " ", "into", " ", "an", " ", 
     "integer"}], ",", " ", 
    RowBox[{
     RowBox[{"for", " ", "1"}], "=", "responding"}], ",", " ", 
    RowBox[{"0", " ", "=", " ", 
     RowBox[{"not", " ", "responding"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<CR\>\"", " ", "=", " ", 
     RowBox[{
      RowBox[{"complete", " ", "response"}], " ", "=", " ", "1"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PR\>\"", " ", "=", " ", 
     RowBox[{
      RowBox[{"partial", " ", "response"}], " ", "=", " ", "1"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<SD\>\"", " ", "=", " ", 
     RowBox[{
      RowBox[{"stable", " ", "disease"}], " ", "=", " ", "1"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<PD\>\"", " ", "=", " ", 
     RowBox[{
      RowBox[{"progressive", " ", "disease"}], " ", "=", " ", "0"}]}]}], "  ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ResponseOrNot", "[", "responsetype_", "]"}], ":=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Or", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"responsetype", ",", "2"}], "]"}], "\[Equal]", 
         "\"\<CR\>\""}], ",", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"responsetype", ",", "2"}], "]"}], "\[Equal]", 
         "\"\<PR\>\""}], ",", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"responsetype", ",", "2"}], "]"}], "\[Equal]", 
         "\"\<SD\>\""}]}], "]"}], ",", "1", ",", "0"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
     " ", "drug", " ", "response", " ", "criteria", " ", "and", " ", 
     "reports", " ", "what", " ", "fraction", " ", "counted", " ", "as", " ", 
     RowBox[{"a", " ", "'"}], 
     RowBox[{"response", "'"}], " ", 
     RowBox[{"(", 
      RowBox[{"SD", ",", " ", "PR", ",", " ", 
       RowBox[{"or", " ", "CR"}]}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResponseRate", "[", "listofresponsetypes_", "]"}], ":=", 
    RowBox[{"Mean", "[", 
     RowBox[{"Map", "[", 
      RowBox[{"ResponseOrNot", ",", "listofresponsetypes"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
     " ", "observed", " ", "response", " ", "criteria", " ", "and", " ", 
     "returns", " ", "the", " ", 
     RowBox[{"strongest", " ", "/", " ", "best"}], " ", "response"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BestResponseOfSet", "[", "listofresponsetypes_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"InitialResponse", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
          "listofresponsetypes"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ReponsesAsNumbers", "=", 
        RowBox[{"InitialResponse", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<CR\>\"", "\[Rule]", "3"}], ",", 
           RowBox[{"\"\<PR\>\"", "\[Rule]", "2"}], ",", 
           RowBox[{"\"\<SD\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<PD\>\"", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BestResponseAsNumber", "=", 
        RowBox[{"Max", "[", "ReponsesAsNumbers", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BestResponseType", "=", 
        RowBox[{"(", 
         RowBox[{"BestResponseAsNumber", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "\[Rule]", "\"\<CR\>\""}], ",", 
            RowBox[{"2", "\[Rule]", "\"\<PR\>\""}], ",", 
            RowBox[{"1", "\[Rule]", "\"\<SD\>\""}], ",", 
            RowBox[{"0", "\[Rule]", "\"\<PD\>\""}]}], "}"}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.66441472759406*^9, 3.66441477358169*^9}, {
  3.664414912965662*^9, 3.6644149144217453`*^9}, {3.664415021869891*^9, 
  3.6644151092778907`*^9}, {3.664416424110095*^9, 3.6644164331896143`*^9}, {
  3.6644197298941746`*^9, 3.6644197482302237`*^9}, {3.683567247760667*^9, 
  3.6835672502728105`*^9}, {3.6835673257701283`*^9, 3.683567385394539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "list", " ", "of", " ", "response", " ", "rates", " ", "for", 
    " ", "each", " ", "monotherapy", " ", "in", " ", "each", " ", "tumor", 
    " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MonotherapyByGroupResponseRates", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ResponseRate", "[", 
          RowBox[{
          "PerMonotherapyByGroupResponseTypes", "\[LeftDoubleBracket]", 
           RowBox[{"indication", ",", "TherapiesWithinIndication"}], 
           "\[RightDoubleBracket]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"TherapiesWithinIndication", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "MonotherapiesByGroup", "\[LeftDoubleBracket]", "indication", 
             "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"indication", ",", "1", ",", 
         RowBox[{"Length", "[", "AllModelGroups", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "a", " ", "list", " ", "of", " ", "response", " ", "rates", " ", "for", 
     " ", "each", " ", "combination", " ", "therapy", " ", "in", " ", "each", 
     " ", "tumor", " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CombinationByGroupResponseRates", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ResponseRate", "[", 
          RowBox[{
          "PerCombinationByGroupResponseTypes", "\[LeftDoubleBracket]", 
           RowBox[{"indication", ",", "TherapiesWithinIndication"}], 
           "\[RightDoubleBracket]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"TherapiesWithinIndication", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
             "indication", "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"indication", ",", "1", ",", 
         RowBox[{"Length", "[", "AllModelGroups", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.664416303969223*^9, 3.6644163377171535`*^9}, {
   3.6644194655340543`*^9, 3.6644196027669034`*^9}, {3.6834764497668715`*^9, 
   3.6834764742282705`*^9}, 3.6835221211460824`*^9, {3.683567403689585*^9, 
   3.6835674188494525`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "tumor", " ", 
     "type", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"numbered", " ", "1", " ", "to", " ", "6"}], ";", " ", 
        "melanoma"}], ",", " ", "NSCLC", ",", " ", "PDAC", ",", " ", "CRC", 
       ",", " ", "breast", ",", " ", "gastric"}], ")"}], " ", "and", " ", 
     "two", " ", "named", " ", "monotherapies"}], ",", " ", 
    RowBox[{
    "and", " ", "computes", " ", "the", " ", "response", " ", "rate", " ", 
     "of", " ", "the", " ", "hypothetical", " ", "combination", " ", 
     "according", " ", "to", " ", "independent", " ", "drug", " ", 
     RowBox[{"action", ":", " ", 
      RowBox[{"each", " ", "individual", " ", 
       RowBox[{"tumor", "'"}], "s", " ", "response", " ", "is", " ", "the", 
       " ", "better", " ", "one", " ", "of", " ", "its", " ", "two", " ", 
       "observed", " ", "responses"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ResponseRateFromRandomMonotherapyPair", "[", 
    RowBox[{"therapy1_", ",", "therapy2_", ",", "tumortype_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Therapy1Responses", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[Equal]", "therapy1"}]}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Therapy2Responses", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[Equal]", "therapy2"}]}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"For", " ", "any", " ", "two", " ", "monotherapies"}], ",", 
        " ", 
        RowBox[{
        "response", " ", "rate", " ", "is", " ", "necessarily", " ", 
         "calculated", " ", "over", " ", "the", " ", "PDX", " ", "models", 
         " ", "that", " ", "were", " ", "tested", " ", "with", " ", "both", 
         " ", "therapies"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ModelsInIntersection", "=", 
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"Therapy1Responses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"Therapy2Responses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Therapy1ResponsesInIntersection", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"Therapy1Responses", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[Equal]", 
              RowBox[{
              "ModelsInIntersection", "\[LeftDoubleBracket]", "model", 
               "\[RightDoubleBracket]"}]}], "&"}]}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"model", ",", "1", ",", 
           RowBox[{"Length", "[", "ModelsInIntersection", "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Therapy2ResponsesInIntersection", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"Therapy2Responses", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[Equal]", 
              RowBox[{
              "ModelsInIntersection", "\[LeftDoubleBracket]", "model", 
               "\[RightDoubleBracket]"}]}], "&"}]}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"model", ",", "1", ",", 
           RowBox[{"Length", "[", "ModelsInIntersection", "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BestResponsesPerPDX", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BestResponseOfSet", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Therapy1ResponsesInIntersection", "\[LeftDoubleBracket]", 
             RowBox[{"model", ",", "11"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"Therapy2ResponsesInIntersection", "\[LeftDoubleBracket]", 
             RowBox[{"model", ",", "11"}], "\[RightDoubleBracket]"}]}], "}"}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"model", ",", "1", ",", 
           RowBox[{"Length", "[", "ModelsInIntersection", "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ResponseRate", "[", "BestResponsesPerPDX", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.664420020329787*^9, 3.6644201100389175`*^9}, {
  3.66442014609398*^9, 3.6644203102303677`*^9}, {3.6644203657195415`*^9, 
  3.6644204793830433`*^9}, {3.683567422415656*^9, 3.6835674899035163`*^9}, {
  3.6835677755288534`*^9, 3.683567829354932*^9}, {3.6835931225496197`*^9, 
  3.6835931810279646`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "tumor", " ", 
     "type", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"by", " ", "number"}], ",", " ", 
       RowBox[{"from", " ", "1", " ", "to", " ", "6"}], ",", " ", 
       RowBox[{"as", " ", "above"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "randomly", " ", "selects", " ", "two", " ", "monotherapies", " ", "from",
      " ", "those", " ", "tested", " ", "on", " ", "that", " ", "tumor", " ", 
     "type"}], ",", " ", 
    RowBox[{
    "and", " ", "calls", " ", "the", " ", "above", " ", "function", " ", "to",
      " ", "compute", " ", "the", " ", "response", " ", "rate", " ", "to", 
     " ", "the", " ", "hypothetical", " ", "combination"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "ResponseRateFromOneRandomMonotherapyPair", "[", "tumortype_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"randompair", "=", 
       RowBox[{"RandomSample", "[", 
        RowBox[{
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ResponseRateFromRandomMonotherapyPair", "[", 
       RowBox[{
        RowBox[{
        "randompair", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
        "randompair", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "tumortype"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.664420659613352*^9, 3.664420716598611*^9}, {
  3.683593218218092*^9, 3.6835933046820374`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Different numbers of combination therapies were applied to the different \
disease indications :\
\>", "Subsubsection",
 CellChangeTimes->{{3.6644207899378057`*^9, 3.6644208080638423`*^9}}],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"Length", ",", "CombinationTherapiesByGroup"}], "]"}]], "Input",
 CellChangeTimes->{{3.664420742580097*^9, 3.6644208105019817`*^9}, 
   3.6834764497848725`*^9, 3.683522121158083*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For a fair comparison between the tested combinations and hypothetical \
combinations of random pairs of monotherapies, generate random pairs of \
monotherapies in abundance proportional to the number of combinations tested \
per disease indication. Otherwise, the comparison could be biased by some \
tumor types having systematically higher or lower response rates than others.\
\>", "Subsubsection",
 CellChangeTimes->{{3.664420814295199*^9, 3.664420880156966*^9}, {
  3.6835933523287625`*^9, 3.6835933767761607`*^9}}],

Cell[BoxData[
 RowBox[{"NumberOfRandomPairsToCreatePerIndication", "=", 
  RowBox[{"100", "*", 
   RowBox[{"Map", "[", 
    RowBox[{"Length", ",", "CombinationTherapiesByGroup"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.664420884579219*^9, 3.664420909182626*^9}, {
   3.6644210401581173`*^9, 3.6644210511897483`*^9}, 3.66442112097374*^9, 
   3.683476449791873*^9, 3.6835221211620836`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "how", " ", "many", " ", "possible", " ", "combinations", " ", "are", " ", 
    "there", " ", "for", " ", "each", " ", "tumor", " ", 
    RowBox[{"type", "?", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"list", " ", "of", " ", "length", " ", "6"}], ";", " ", 
       RowBox[{"one", " ", "entry", " ", "per", " ", "tumor", " ", "type"}]}],
       " "}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], "-", "1"}], ")"}], "/", "2"}]}], 
      ")"}], "&"}], ",", "MonotherapiesByGroup"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6644209172690887`*^9, 3.6644209480938516`*^9}, {
  3.683593470066497*^9, 3.6835934746257577`*^9}, {3.683593515985123*^9, 
  3.683593539803486*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computing response rates for hundreds of random pairs of monotherapies per \
tumor type; in abundance proportional to the number of combinations tested in \
each tumor type, as explained above.
Note, this step is time-consuming.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6835937410739975`*^9, 3.6835937669054747`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "computing", " ", "response", " ", "rates", " ", "for", " ", "hundreds", 
      " ", "of", " ", "random", " ", "pairs", " ", "of", " ", "monotherapies",
       " ", "per", " ", "tumor", " ", "type"}], ";", " ", 
     RowBox[{
     "in", " ", "abundance", " ", "proportional", " ", "to", " ", "the", " ", 
      "number", " ", "of", " ", "combinations", " ", "tested", " ", "in", " ",
       "each", " ", "tumor", " ", "type"}]}], ",", " ", 
    RowBox[{"as", " ", "explained", " ", "above"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ResponseRatesPerGroupFromRandomMonotherapyPairs", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
         "ResponseRateFromOneRandomMonotherapyPair", "[", "tumortype", "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "NumberOfRandomPairsToCreatePerIndication", "\[LeftDoubleBracket]", 
           "tumortype", "\[RightDoubleBracket]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"tumortype", ",", "1", ",", 
         RowBox[{"Length", "[", "AllModelGroups", "]"}]}], "}"}]}], "]"}], "//",
      "N"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6644209728792696`*^9, 3.6644210361178865`*^9}, {
  3.6644211249899693`*^9, 3.664421130606291*^9}, {3.664421374006212*^9, 
  3.66442137973454*^9}, {3.683593401806593*^9, 3.6835934423709126`*^9}, {
  3.6835935502420826`*^9, 3.683593585979127*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "plotting", " ", "response", " ", "rates", " ", "with", " ", "box"}], "-", 
    RowBox[{"whisker", " ", "plot"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ResponseRatePlot", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BoxWhiskerChart", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", "MonotherapyByGroupResponseRates", "]"}], "//",
           "N"}], ",", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Median\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Whiskers\>\"", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "4"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
             RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", "3.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"ChartStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"White", ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"3", ",", "4"}], "]"}], ",", 
               RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "]"}]}],
            "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "6"}], "]"}], "]"}], ",", 
          RowBox[{"Directive", "[", "Black", "]"}]}], "}"}]}], ",", 
       RowBox[{"ChartLabels", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Monotherapies\>\"", ",", "\"\<Combinations\>\"", ",", 
          "\"\<Random\\npairs of\\nmonotherapies\>\""}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"100", "*", "i"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "1", ",", 
                RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"4", "/", "5"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "280", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"BoxWhiskerChart", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Flatten", "[", "CombinationByGroupResponseRates", "]"}], "//",
           "N"}], ",", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Median\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Whiskers\>\"", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"3", ",", "6"}], "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
             RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", "3.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"ChartStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"White", ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"3", ",", "6"}], "]"}], ",", 
               RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "]"}]}],
            "]"}], ",", 
          RowBox[{"Directive", "[", "Black", "]"}]}], "}"}]}], ",", 
       RowBox[{"ChartLabels", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Monotherapies\>\"", ",", "\"\<Combinations\>\"", ",", 
          "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"100", "*", "i"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "1", ",", 
                RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"4", "/", "5"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "280", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"BoxWhiskerChart", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], ",", 
         RowBox[{
         "Flatten", "[", "ResponseRatesPerGroupFromRandomMonotherapyPairs", 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Median\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Whiskers\>\"", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
             RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", "3.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"ChartStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "6"}], "]"}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"White", ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", 
               RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "]"}]}],
            "]"}]}], "}"}]}], ",", 
       RowBox[{"ChartLabels", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Monotherapies\>\"", ",", "\"\<Combinations\>\"", ",", 
          "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"100", "*", "i"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "1", ",", 
                RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"4", "/", "5"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "280", "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6727938349675903`*^9, 3.6727939392275534`*^9}, {
  3.6727950684941435`*^9, 3.672795102605095*^9}, {3.674732326794759*^9, 
  3.674732328704765*^9}, {3.683594112834261*^9, 3.6835941249289527`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Statistical tests for differences in response rates by Kolomorov-Smirnov tests\
\>", "Subsubsection",
 CellChangeTimes->{{3.6835982223423114`*^9, 3.6835982793045692`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"monotherapies", " ", "vs", " ", "combinations"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"KolmogorovSmirnovTest", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "MonotherapyByGroupResponseRates", "]"}], ",", 
     RowBox[{"Flatten", "[", "CombinationByGroupResponseRates", "]"}], ",", 
     "\"\<PValueTable\>\""}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "random", " ", "pairs", " ", "of", " ", "monotherapies", " ", "vs", " ", 
     "combinations"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"KolmogorovSmirnovTest", "[", 
    RowBox[{
     RowBox[{
     "Flatten", "[", "ResponseRatesPerGroupFromRandomMonotherapyPairs", "]"}],
      ",", 
     RowBox[{"Flatten", "[", "CombinationByGroupResponseRates", "]"}], ",", 
     "\"\<PValueTable\>\""}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "monotherapies", " ", "vs", " ", "random", " ", "pairs", " ", "of", " ", 
     "monotherapies"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"KolmogorovSmirnovTest", "[", 
    RowBox[{
     RowBox[{
     "Flatten", "[", "ResponseRatesPerGroupFromRandomMonotherapyPairs", "]"}],
      ",", 
     RowBox[{"Flatten", "[", "MonotherapyByGroupResponseRates", "]"}], ",", 
     "\"\<PValueTable\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6681670763304424`*^9, 3.6681671656225495`*^9}, {
  3.668167198510431*^9, 3.668167206669897*^9}, {3.683598274315284*^9, 
  3.683598274491294*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot of response rates sized for publication:", "Subsubsection",
 CellChangeTimes->{{3.67399494196166*^9, 3.6739949519372306`*^9}, {
  3.6824732825375323`*^9, 3.6824732844336405`*^9}, {3.683593689944073*^9, 
  3.683593698024535*^9}, {3.684289234427915*^9, 3.684289236908057*^9}, {
  3.6845986161055417`*^9, 3.684598618305668*^9}, {3.6855786423412905`*^9, 
  3.685578651908838*^9}}],

Cell[BoxData[
 RowBox[{"ResponseRatePlot", "=", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BoxWhiskerChart", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", "MonotherapyByGroupResponseRates", "]"}], "//",
          "N"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Median\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "4"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Whiskers\>\"", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "4"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
            RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "3.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"White", ",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"ColorData", "[", 
               RowBox[{"3", ",", "4"}], "]"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", "Black", "]"}]}], "}"}]}], ",", 
      RowBox[{"ChartLabels", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<M\>\"", ",", "\"\<C\>\"", ",", "\"\<RP\>\""}], "}"}]}], 
      ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.05"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1.4"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "225", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "30"}], "}"}]}], "}"}]}]}], "]"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"BoxWhiskerChart", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Flatten", "[", "CombinationByGroupResponseRates", "]"}], "//",
          "N"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Median\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "6"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Whiskers\>\"", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "6"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
            RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "3.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"White", ",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"ColorData", "[", 
               RowBox[{"3", ",", "6"}], "]"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"Directive", "[", "Black", "]"}]}], "}"}]}], ",", 
      RowBox[{"ChartLabels", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Monotherapies\>\"", ",", "\"\<Combinations\>\"", ",", 
         "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1.4"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "225", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "30"}], "}"}]}], "}"}]}]}], "]"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"BoxWhiskerChart", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{
        "Flatten", "[", "ResponseRatesPerGroupFromRandomMonotherapyPairs", 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Median\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Whiskers\>\"", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
            RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "3.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"White", ",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], "]"}]}], 
          "]"}]}], "}"}]}], ",", 
      RowBox[{"ChartLabels", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Monotherapies\>\"", ",", "\"\<Combinations\>\"", ",", 
         "\"\<Random pairs of\\nmonotherapies\>\""}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1.4"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "225", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "30"}], "}"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6727938349675903`*^9, 3.6727939392275534`*^9}, {
  3.6727950684941435`*^9, 3.672795102605095*^9}, {3.6739949630228643`*^9, 
  3.673995083810773*^9}, {3.67399512536515*^9, 3.6739951311934834`*^9}, {
  3.6739953569673967`*^9, 3.6739953854140244`*^9}, {3.674732329084766*^9, 
  3.674732331044772*^9}, {3.6824657279644356`*^9, 3.6824657354668646`*^9}, {
  3.6824664056791983`*^9, 3.682466406132224*^9}, {3.682473291956071*^9, 
  3.68247335557271*^9}, {3.6842892598553696`*^9, 3.6842892779994073`*^9}, {
  3.684289380759285*^9, 3.684289424783803*^9}, {3.6845986302783527`*^9, 
  3.684598639117858*^9}, {3.6845990609559855`*^9, 3.6845990814821596`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"line1pos", "=", "0.368"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"line2pos", "=", "0.446"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"line3pos", "=", "0.521"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"line1h", "=", 
   RowBox[{"0.37", "+", "0.035"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"line2h", "=", 
   RowBox[{"0.36", "+", "0.035"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"line3h", "=", 
    RowBox[{"0.395", "+", "0.035"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResponseComposite", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Inset", "[", 
          RowBox[{"ResponseRatePlot", ",", 
           RowBox[{"{", 
            RowBox[{"0.4", ",", "0.2"}], "}"}], ",", "Automatic", ",", "1"}], 
          "]"}], "}"}], "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"line1pos", ",", "line1h"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"line2pos", ",", "line1h"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"line2pos", ",", "line2h"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"line3pos", ",", "line2h"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"line1pos", ",", "line3h"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"line3pos", ",", "line3h"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{"\"\<***\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"line1pos", "/", "2"}], "+", 
               RowBox[{"line2pos", "/", "2"}]}], ",", "line1h"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "0.7"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{"\"\<***\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"line1pos", "/", "2"}], "+", 
               RowBox[{"line3pos", "/", "2"}]}], ",", "line3h"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "0.7"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{"\"\<ns\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"line2pos", "/", "2"}], "+", 
               RowBox[{"line3pos", "/", "2"}]}], ",", "line2h"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "0.8"}]}], "}"}]}], "]"}]}], "}"}], "~", "Join", 
        "~", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.1", "]"}], ",", "White", ",", 
          RowBox[{"EdgeForm", "[", "None", "]"}]}], "}"}], "~", "Join", "~", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", 
              RowBox[{"0.1", "+", 
               RowBox[{"i", "*", "10"}]}], "]"}], ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.65", ",", 
                 RowBox[{"0.43", "+", "i"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.7", ",", "0.5"}], "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "0.06", ",", "0.003"}], "}"}]}], 
          "]"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.7"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.5"}], "}"}]}], "}"}]}]}], "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "225", "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 3B, response rates.pdf\>\""}], ",", "ResponseComposite", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6824658020286717`*^9, 3.6824663391503935`*^9}, {
   3.682466369999158*^9, 3.6824664168858395`*^9}, {3.6824733627291193`*^9, 
   3.682473586429914*^9}, {3.6835937062420053`*^9, 3.6835937118573265`*^9}, {
   3.6835938005003967`*^9, 3.6835938191234617`*^9}, {3.684289247284651*^9, 
   3.68428924919676*^9}, {3.684289364000326*^9, 3.684289364042329*^9}, {
   3.6842894332722883`*^9, 3.68428946599116*^9}, {3.6845991052165174`*^9, 
   3.6845991395194793`*^9}, 3.6855786647685733`*^9, 3.7154650576780705`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Evaluating the effect of random monotherapy pairs in context of \
animal-to-animal variability.\n\nA degree of animal-to-animal variability was \
reported by Gao ",
 StyleBox["et al",
  FontSlant->"Italic"],
 ". Nature Medicine (Figure 2a of that article) on the basis of 440 treatment \
models (meaning a specific treatment applied to a specific PDX) that were \
repeated on average in 5 different mice each, for a total of over 2000 \
drug-treated animals. Each treatment model was classified according to its \
\[OpenCurlyQuote]majority\[CloseCurlyQuote] response criteria (which response \
was most commonly observed across the repeats). Figure 2a of Gao ",
 StyleBox["et al",
  FontSlant->"Italic"],
 " shows the fraction of times that each response criteria was observed \
within treatment models belonging to each majority response criteria (i.e, \
how often did an individual animal vary from other replicates of the same \
treatment model?). For example, treatment models that were most often a \
complete response (CR) were only CR in 74% of individual animals, being PR in \
18% of animals and SD in 6% of animals.\nThis data was extracted from the \
published figure by digital image analysis.\n\nHere we use this data as an \
error model for Gao ",
 StyleBox["et al",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s PDX drug trials, and compute the expected benefit of \
repeating each drug trial twice and choosing the best observed response from \
two replicates. If this provides a significant improvement in response then \
our analysis of the benefits of random pairs of monotherapies may be no more \
than the benefit of random experimental repeats."
}], "Subsubsection",
 CellChangeTimes->{{3.6835941397107983`*^9, 3.6835943598083873`*^9}, {
  3.6835943989296246`*^9, 3.6835946718982377`*^9}, {3.6835952209626427`*^9, 
  3.683595324810582*^9}, {3.683595374706436*^9, 3.683595466802704*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AnimalToAnimalVariabilityMatrix", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Animal to animal consistency probability matrix.csv\>\""}], ",", 
      "\"\<CSV\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Reproducing", " ", "Figure", " ", "2", "A", " ", "of", " ", "Gao", " ", 
     "et", " ", "al"}], ",", " ", 
    RowBox[{"Nature", " ", "Medicine"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"BarChart", "[", 
  RowBox[{
   RowBox[{"100", "*", 
    RowBox[{"AnimalToAnimalVariabilityMatrix", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"2", ";;"}], ",", 
      RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "100"}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"BarSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"ChartStyle", "\[Rule]", 
    RowBox[{"EdgeForm", "[", "None", "]"}]}], ",", 
   RowBox[{"ChartLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<CR\>\"", ",", "\"\<PR\>\"", ",", "\"\<SD\>\"", ",", "\"\<PD\>\""}], 
     "}"}]}], ",", 
   RowBox[{"ChartLabels", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Majority\\nresponse\\nCR\>\"", ",", 
        "\"\<Majority\\nresponse\\nPR\>\"", ",", 
        "\"\<Majority\\nresponse\\nSD\>\"", ",", 
        "\"\<Majority\\nresponse\\nPD\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{",", ",", ","}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"50", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"70", ",", "30"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<\>\"", ",", "\"\<Fraction (%)\>\""}], "}"}]}], ",", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6678349635923038`*^9, 3.6678350029195533`*^9}, {
  3.6835948777390113`*^9, 3.683595098100615*^9}, {3.6835951451573067`*^9, 
  3.6835951858816357`*^9}, {3.683595351966135*^9, 3.6835953528691874`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "response", " ", 
     "criteria"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "applies", " ", 
      RowBox[{"the", " ", "'"}], "error", " ", 
      RowBox[{"model", "'"}]}], " ", "-", " ", 
     RowBox[{"it", " ", "samples", " ", "from", " ", "the", " ", "animal"}], 
     "-", "to", "-", 
     RowBox[{
     "animal", " ", "variability", " ", "data", " ", "so", " ", "that", " ", 
      "there", " ", "is", " ", "a", " ", "chance", " ", "of", " ", 
      "obtaining", " ", "a", " ", "different", " ", "response"}]}], ",", " ", 
    RowBox[{
    "consistent", " ", "with", " ", "observed", " ", "probabilities", " ", 
     "of", " ", "variation"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SampleResponseInDifferentAnimal", "[", "responsecategory_", "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "which", " ", "row", " ", "of", " ", "probabilities", " ", "in", " ", 
       "the", " ", "ConsistencyMatrix", " ", "should", " ", "we", " ", "look",
        " ", 
       RowBox[{"up", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AppropriateRow", "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"responsecategory", "\[Equal]", "\"\<CR\>\""}], ",", "2", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"responsecategory", "\[Equal]", "\"\<PR\>\""}], ",", "3", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"responsecategory", "\[Equal]", "\"\<SD\>\""}], ",", "4", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"responsecategory", "\[Equal]", "\"\<PD\>\""}], ",", "5"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"RandomizedResponseInDifferentAnimal", "=", 
       RowBox[{"RandomChoice", "[", 
        RowBox[{
         RowBox[{"AnimalToAnimalVariabilityMatrix", "\[LeftDoubleBracket]", 
          RowBox[{"AppropriateRow", ",", 
           RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<CR\>\"", ",", "\"\<PR\>\"", ",", "\"\<SD\>\"", ",", 
           "\"\<PD\>\""}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.6678350235627337`*^9, {3.6835954849947443`*^9, 3.6835955550737524`*^9}, {
   3.6835956060286665`*^9, 3.683595619771453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
     " ", "response", " ", "criteria"}], ",", " ", 
    RowBox[{
    "and", " ", "applies", " ", "the", " ", "error", " ", "model", " ", "to", 
     " ", "each", " ", "response", " ", "in", " ", "the", " ", "list"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "SimulatedAnimalToAnimalVariability", "[", "listofresponses_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "take", " ", "just", " ", "the", " ", "first", " ", "two", " ", 
        "characters", " ", 
        RowBox[{"(", 
         RowBox[{"CR", ",", " ", "PR", ",", " ", "SD", ",", " ", "PD"}], 
         ")"}], " ", "to", " ", "look", " ", "at", " ", "major", " ", 
        "response", " ", "categories"}], ",", " ", 
       RowBox[{
        RowBox[{"which", " ", "is", " ", "what", " ", "the", " ", "animal"}], 
        "-", "to", "-", 
        RowBox[{
        "animal", " ", "consistency", " ", "data", " ", "addresses"}]}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListOfMajorResponses", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "listofresponses"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
       "SampleResponseInDifferentAnimal", ",", "ListOfMajorResponses"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6678351639847655`*^9, 3.6678352368719344`*^9}, {
  3.6835955691225557`*^9, 3.6835956293950033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
     " ", "response", " ", "criteria", " ", 
     RowBox[{"(", 
      RowBox[{
      "representing", " ", "different", " ", "tumors", " ", "receiving", " ", 
       "a", " ", "treatment"}], ")"}]}], ",", " ", 
    RowBox[{
    "uses", " ", "the", " ", "above", " ", "function", " ", "to", " ", 
     "apply", " ", "the", " ", "error", " ", "model"}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "selects", " ", "for", " ", "each", " ", 
     "individual", " ", "tumor", " ", "the", " ", "best", " ", "of", " ", 
     "the", " ", "two", " ", "responses"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "BestResponsesPerPDXFromRealAnimalAndSimulatedSecondAnimalWithVariability",
     "[", "listofresponses_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListOfMajorResponses", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "listofresponses"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SecondAnimalMajorResponses", "=", 
       RowBox[{
       "SimulatedAnimalToAnimalVariability", "[", "ListOfMajorResponses", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BestResponseOfSet", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "ListOfMajorResponses", "\[LeftDoubleBracket]", "pdx", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "SecondAnimalMajorResponses", "\[LeftDoubleBracket]", "pdx", 
            "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pdx", ",", "1", ",", 
          RowBox[{"Length", "[", "ListOfMajorResponses", "]"}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.667835250126693*^9, 3.667835435824314*^9}, {
  3.6835979824185886`*^9, 3.683598065857361*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "a", " ", "list", " ", "of", " ", "response", " ", "rates", " ", 
     "computed", " ", "according", " ", "to", " ", "the", " ", "error", " ", 
     "model"}], ",", " ", 
    RowBox[{
     RowBox[{
     "where", " ", "every", " ", "observed", " ", "response", " ", "has", " ",
       "a", " ", "chance", " ", "to", " ", "be", " ", "superior", " ", "on", 
      " ", "account", " ", "of", " ", "animal"}], "-", "to", "-", 
     RowBox[{"animal", " ", "variability"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "MonotherapyByGroupResponseRatesFromActualAnimalAndSimulatedSecondAnimal", 
    "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ResponseRate", "[", 
         RowBox[{
         "BestResponsesPerPDXFromRealAnimalAndSimulatedSecondAnimalWithVariabi\
lity", "[", 
          RowBox[{
          "PerMonotherapyByGroupResponseTypes", "\[LeftDoubleBracket]", 
           RowBox[{"indication", ",", "TherapiesWithinIndication"}], 
           "\[RightDoubleBracket]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"TherapiesWithinIndication", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "MonotherapiesByGroup", "\[LeftDoubleBracket]", "indication", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"indication", ",", "1", ",", 
        RowBox[{"Length", "[", "AllModelGroups", "]"}]}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.667835495774743*^9, 3.6678355428914375`*^9}, 
   3.683476474243272*^9, {3.6835980793941355`*^9, 3.6835981263068185`*^9}}],

Cell[BoxData[
 RowBox[{"ResponseRatePlot", "=", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BoxWhiskerChart", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Flatten", "[", "MonotherapyByGroupResponseRates", "]"}], "//",
          "N"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Median\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"White", ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Whiskers\>\"", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "4"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
            RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "4.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "5"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", "Black", "]"}]}], "}"}]}], ",", 
      RowBox[{"ChartLabels", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rotate", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Monotherapies,\\nbest result of 2\\nmice for each PDX\>\"", 
             ",", 
             RowBox[{"LineSpacing", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "14"}], "}"}]}]}], "]"}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
         RowBox[{"Rotate", "[", 
          RowBox[{"\"\<Monotherapies\>\"", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
         RowBox[{"Rotate", "[", 
          RowBox[{"\"\<Combinations\>\"", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
         RowBox[{"Rotate", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Random pairs of\\nmonotherapies\>\"", ",", 
             RowBox[{"LineSpacing", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "14"}], "}"}]}]}], "]"}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"60", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"120", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"BoxWhiskerChart", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Flatten", "[", "CombinationByGroupResponseRates", "]"}], "//",
          "N"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Median\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"White", ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Whiskers\>\"", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "6"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
            RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "4.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "5"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", "Black", "]"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"60", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"120", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"BoxWhiskerChart", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{
        "Flatten", "[", "ResponseRatesPerGroupFromRandomMonotherapyPairs", 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Median\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"White", ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Whiskers\>\"", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
            RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "4.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "5"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", "Black", "]"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"60", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"120", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"BoxWhiskerChart", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "Flatten", "[", 
         "MonotherapyByGroupResponseRatesFromActualAnimalAndSimulatedSecondAni\
mal", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Median\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<MedianMarker\>\"", ",", "1", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"White", ",", 
            RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Whiskers\>\"", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"3", ",", "5"}], "]"}], ",", 
            RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", 
            RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Fences\>\"", ",", "0", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "4.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "5"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "6"}], "]"}], "]"}], ",", 
         RowBox[{"Directive", "[", "Black", "]"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{",", "\"\<Response rate (%)\>\""}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"100", "*", "i"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "1", ",", 
               RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"60", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"120", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7154691167152348`*^9, 3.71546932258801*^9}, {
  3.715469368683646*^9, 3.7154693920269814`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4A, response rates with simulated animal \
variability.pdf\>\""}], ",", "ResponseRatePlot", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6678361533623548`*^9, 3.6678361586566577`*^9}, {
   3.683598167489174*^9, 3.683598202244162*^9}, {3.6856034569151754`*^9, 
   3.6856034570421824`*^9}, 3.715465057699072*^9, {3.715468074501623*^9, 
   3.7154680752216644`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Kolomorov-Smirnov test shows no statistically significant difference in \
response rate between observed monotherapies and applying the error model to \
observed monotherapies, simulating the effect of taking the best result of 2 \
mice for each PDX-treatment.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6835982223423114`*^9, 3.683598249920889*^9}, {
  3.6835983464094076`*^9, 3.6835984185455337`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"monotherapies", " ", "vs", " ", "monotherapies"}], ",", " ", 
    RowBox[{"best", " ", "of", " ", "2", " ", "animals"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"KolmogorovSmirnovTest", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", "MonotherapyByGroupResponseRates", "]"}], ",", 
    RowBox[{
    "Flatten", "[", 
     "MonotherapyByGroupResponseRatesFromActualAnimalAndSimulatedSecondAnimal"\
, "]"}], ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6681670763304424`*^9, 3.6681671656225495`*^9}, {
  3.668167198510431*^9, 3.668167206669897*^9}, {3.6835983505266433`*^9, 
  3.6835983510746746`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Analysis of combinations that surpass independent drug action\
\>", "Section",
 CellChangeTimes->{{3.6613020660934176`*^9, 3.6613020837014246`*^9}, {
  3.6712880331219482`*^9, 3.671288035913954*^9}, {3.683598530008909*^9, 
  3.6835985410165386`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"converting", " ", "drug", " ", "codes", " ", "to", " ", "names"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NameSubstitutions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<LEE011\>\"", "\[Rule]", "\"\<Ribociclib\>\""}], ",", 
      RowBox[{"\"\<BKM120\>\"", "\[Rule]", "\"\<Buparlisib\>\""}], ",", 
      RowBox[{"\"\<BYL719\>\"", "\[Rule]", "\"\<Alpelisib\>\""}], ",", 
      RowBox[{"\"\<encorafenib\>\"", "\[Rule]", "\"\<Encorafenib\>\""}], ",", 
      RowBox[{"\"\<binimetinib\>\"", "\[Rule]", "\"\<Binimetinib\>\""}]}], 
     "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.673998755759797*^9, 3.6739988289449825`*^9}, {
  3.683598544465736*^9, 3.683598557042455*^9}, {3.6835986913551373`*^9, 
  3.683598697155469*^9}}],

Cell[CellGroupData[{

Cell["\<\
The first of four combinations in Melanoma that surpass independent drug \
action\
\>", "Subsection",
 CellChangeTimes->{{3.671886087609739*^9, 3.6718860927393503`*^9}, {
  3.6836359157818904`*^9, 3.6836359251554265`*^9}}],

Cell[BoxData[{
 RowBox[{"DrugA", "=", "\"\<BKM120\>\""}], "\[IndentingNewLine]", 
 RowBox[{"DrugB", "=", "\"\<encorafenib\>\""}]}], "Input",
 CellChangeTimes->{{3.671886127855822*^9, 3.6718861385024424`*^9}, {
  3.671886350234476*^9, 3.6718863550798855`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DrugAresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrugBresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Combinationresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6613007673441334`*^9, 3.661300836774104*^9}, 
   3.661301165157887*^9, {3.661301283973683*^9, 3.6613013402949047`*^9}, {
   3.6613014294230022`*^9, 3.661301437805482*^9}, {3.671886124435416*^9, 
   3.6718861740813155`*^9}}],

Cell[BoxData[
 RowBox[{"ModelsInIntersection", "=", 
  RowBox[{"Intersection", "[", 
   RowBox[{
    RowBox[{"Combinationresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugAresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671287090388113*^9, 3.6712871195471573`*^9}, {
  3.6718861792463255`*^9, 3.671886190324746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugAresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrugBresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombinationresponsesIntersection", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ModelsInIntersection", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712871277401705`*^9, 3.671287161098223*^9}, {
  3.6718861952185555`*^9, 3.671886232196431*^9}, {3.67188633725865*^9, 
  3.6718863373210497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"computing", " ", "the", " ", "expected", " ", "effect", " ", 
    RowBox[{"of", " ", "'"}], "independent", " ", "drug", " ", 
    RowBox[{"action", "'"}], " ", "by", " ", "assigning", " ", "each", " ", 
    "xenograft", " ", "the", " ", "more", " ", "durable", " ", "response", 
    " ", "observed", " ", "with", " ", "either", " ", "monotherapy"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BestOfMonotherapiesIntersection", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Max", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], 
       "\[Transpose]"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6712871799762516`*^9, 3.6712872113573003`*^9}, {
  3.6718862429226546`*^9, 3.6718862497844687`*^9}, {3.683598722425915*^9, 
  3.683598759515036*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoublingFreeSurvival", "[", "ClinicalTrialResponses_", "]"}], ":=", 
  RowBox[{"SurvivalFunction", "[", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"ClinicalTrialResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugAresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugBresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestOfMonotherapiesIntersection", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "CombinationresponsesIntersection", "]"}],
        "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"6", "*", "61"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", "61"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "DrugA", ",", "DrugB", ",", "\"\<Independent drug action\>\"", ",", 
           "\"\<Observed combination\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.3"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "180", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4D, \>\"", "<>", "DrugA", "<>", "\"\< \>\"", "<>",
      "DrugB", "<>", "\"\< Melanoma PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661300853637069*^9, 3.6613008567582474`*^9}, {
   3.6613008946384144`*^9, 3.6613009549578643`*^9}, {3.6613010424708695`*^9, 
   3.6613010724825864`*^9}, {3.661301142078567*^9, 3.6613011528061805`*^9}, 
   3.6613012255833435`*^9, {3.6613012566631207`*^9, 3.661301269429851*^9}, {
   3.6613013438551083`*^9, 3.661301372453744*^9}, {3.6613015596694517`*^9, 
   3.661301607206171*^9}, {3.6613016580150766`*^9, 3.6613016720458794`*^9}, {
   3.6712871662052326`*^9, 3.671287168535236*^9}, {3.6712872201223145`*^9, 
   3.6712872651223907`*^9}, {3.6712873179054775`*^9, 3.671287376695573*^9}, {
   3.671287468063719*^9, 3.6712877867269917`*^9}, {3.6712882230362487`*^9, 
   3.6712882441942854`*^9}, {3.671886257959284*^9, 3.671886311324197*^9}, {
   3.6739966910967045`*^9, 3.673996691208711*^9}, {3.673996859347328*^9, 
   3.673996915137519*^9}, 3.6739984204686193`*^9, 3.6739984604979086`*^9, {
   3.6739986824916058`*^9, 3.673998711163246*^9}, {3.6739988434848146`*^9, 
   3.6739988537234*^9}, {3.6739990015628557`*^9, 3.673999030203494*^9}, {
   3.6739997151866727`*^9, 3.673999725049237*^9}, 3.67473245289802*^9, 
   3.6756143609073496`*^9, {3.682473756178623*^9, 3.6824737857563148`*^9}, {
   3.682473983320615*^9, 3.6824739837356386`*^9}, {3.6824740421409793`*^9, 
   3.6824740445401163`*^9}, {3.682474541411536*^9, 3.682474564250842*^9}, {
   3.6824747686755342`*^9, 3.6824747721697345`*^9}, 3.683519332041556*^9, {
   3.6835987778430843`*^9, 3.68359882252164*^9}, {3.68359904614143*^9, 
   3.6835990796993494`*^9}, 3.6856034863408585`*^9, 3.7154650577110724`*^9, {
   3.7154683417879105`*^9, 3.715468382485239*^9}, {3.7155192593600464`*^9, 
   3.715519272462796*^9}}],

Cell[CellGroupData[{

Cell["statistics of observed vs independent drug action", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756148433459435`*^9, 3.6756148447620244`*^9}, {3.6835988395526137`*^9, 
  3.6835988584736958`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BestOfMonotherapiesIntersection", ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"BestOfMonotherapiesIntersection", ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"BestOfMonotherapiesIntersection", ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.6756146277766137`*^9, 3.6756146280126266`*^9}, {
  3.67561488175714*^9, 3.6756148820701585`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs best monotherapy", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756147686186695`*^9, 3.675614777345168*^9}, {3.6835988454569516`*^9, 
  3.683598847225053*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The second of four combinations in Melanoma that surpass independent drug \
action\n",
 StyleBox["The statistical significance of this combination of RAF and MEK \
inhibitors is borderline when evaluated in all melanoma PDXs, but is highly \
significant in BRAF V600-mutant PDX models.\n\nFirst, in all melanomas:",
  FontSize->16]
}], "Subsection",
 CellChangeTimes->{{3.671886087609739*^9, 3.6718860927393503`*^9}, {
  3.67188638109774*^9, 3.6718863811757402`*^9}, {3.683635931526791*^9, 
  3.683635999589684*^9}, {3.683730721392912*^9, 3.6837307237610474`*^9}, {
  3.7155225887984796`*^9, 3.7155226007021604`*^9}}],

Cell[BoxData[{
 RowBox[{"DrugA", "=", "\"\<encorafenib\>\""}], "\[IndentingNewLine]", 
 RowBox[{"DrugB", "=", "\"\<binimetinib\>\""}]}], "Input",
 CellChangeTimes->{{3.671886127855822*^9, 3.6718861385024424`*^9}, {
  3.671886350234476*^9, 3.6718863550798855`*^9}, {3.6718863883033533`*^9, 
  3.6718863908667583`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DrugAresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrugBresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Combinationresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6613007673441334`*^9, 3.661300836774104*^9}, 
   3.661301165157887*^9, {3.661301283973683*^9, 3.6613013402949047`*^9}, {
   3.6613014294230022`*^9, 3.661301437805482*^9}, {3.671886124435416*^9, 
   3.6718861740813155`*^9}}],

Cell[BoxData[
 RowBox[{"ModelsInIntersection", "=", 
  RowBox[{"Intersection", "[", 
   RowBox[{
    RowBox[{"Combinationresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugAresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671287090388113*^9, 3.6712871195471573`*^9}, {
  3.6718861792463255`*^9, 3.671886190324746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugAresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrugBresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombinationresponsesIntersection", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ModelsInIntersection", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712871277401705`*^9, 3.671287161098223*^9}, {
  3.6718861952185555`*^9, 3.671886232196431*^9}, {3.67188633725865*^9, 
  3.6718863373210497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BestOfMonotherapiesIntersection", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Max", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], 
      "\[Transpose]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712871799762516`*^9, 3.6712872113573003`*^9}, {
  3.6718862429226546`*^9, 3.6718862497844687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoublingFreeSurvival", "[", "ClinicalTrialResponses_", "]"}], ":=", 
  RowBox[{"SurvivalFunction", "[", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"ClinicalTrialResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugAresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugBresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestOfMonotherapiesIntersection", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "CombinationresponsesIntersection", "]"}],
        "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"6", "*", "61"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", "61"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "DrugA", ",", "DrugB", ",", "\"\<Independent drug action\>\"", ",", 
           "\"\<Observed combination\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.3"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "180", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4D, \>\"", "<>", "DrugA", "<>", "\"\< \>\"", "<>",
      "DrugB", "<>", "\"\< Melanoma PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661300853637069*^9, 3.6613008567582474`*^9}, {
   3.6613008946384144`*^9, 3.6613009549578643`*^9}, {3.6613010424708695`*^9, 
   3.6613010724825864`*^9}, {3.661301142078567*^9, 3.6613011528061805`*^9}, 
   3.6613012255833435`*^9, {3.6613012566631207`*^9, 3.661301269429851*^9}, {
   3.6613013438551083`*^9, 3.661301372453744*^9}, {3.6613015596694517`*^9, 
   3.661301607206171*^9}, {3.6613016580150766`*^9, 3.6613016720458794`*^9}, {
   3.6712871662052326`*^9, 3.671287168535236*^9}, {3.6712872201223145`*^9, 
   3.6712872651223907`*^9}, {3.6712873179054775`*^9, 3.671287376695573*^9}, {
   3.671287468063719*^9, 3.6712877867269917`*^9}, {3.6712882230362487`*^9, 
   3.6712882441942854`*^9}, {3.671886257959284*^9, 3.671886311324197*^9}, {
   3.6739966971370506`*^9, 3.673996697273058*^9}, 3.6739971313248844`*^9, 
   3.6739984241608305`*^9, 3.673998457443734*^9, 3.6739988684522424`*^9, 
   3.6740007271235523`*^9, 3.6747324529180193`*^9, {3.6824737981640244`*^9, 
   3.682473798469042*^9}, {3.682474063093178*^9, 3.6824740655423174`*^9}, {
   3.682474541429537*^9, 3.682474564796873*^9}, 3.6824747802451963`*^9, 
   3.6835193320605574`*^9, {3.6835988802149396`*^9, 3.6835988874353523`*^9}, {
   3.683599090118945*^9, 3.6835990951792345`*^9}, 3.685603488560985*^9, 
   3.7154650577240734`*^9, 3.7154683896986513`*^9, {3.7154684313850355`*^9, 
   3.715468437254371*^9}}],

Cell[CellGroupData[{

Cell["statistics of observed vs independent drug action", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.675614909863748*^9, 3.6756149117718573`*^9}, 3.6835989104186673`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BestOfMonotherapiesIntersection", ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"BestOfMonotherapiesIntersection", ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"BestOfMonotherapiesIntersection", ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756146211742363`*^9, 3.6756146214122496`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs best monotherapy", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.6756147686186695`*^9, 3.675614777345168*^9}, 3.6835989411094227`*^9, {
   3.715522572494547*^9, 3.7155225760627513`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Next, in BRAF-V600E melanomas:",
 FontSize->16]], "Subsection",
 CellChangeTimes->{{3.671886087609739*^9, 3.6718860927393503`*^9}, {
  3.67188638109774*^9, 3.6718863811757402`*^9}, {3.683635931526791*^9, 
  3.683635999589684*^9}, {3.683730721392912*^9, 3.6837307237610474`*^9}, {
  3.7155225887984796`*^9, 3.715522620030266*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Melanoma", " ", "responses", " ", "to", " ", "RAF", " ", "inhibition", 
    " ", "by", " ", "encorafenib"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RAFresponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"CutaneousMelanomaModels", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
           "\"\<encorafenib\>\""}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Melanoma", " ", "responses", " ", "to", " ", "MEK", " ", "inhibition", 
     " ", "by", " ", "binimetinib"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"MEKresponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"CutaneousMelanomaModels", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
           "\"\<binimetinib\>\""}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "PDX", " ", "models", " ", "were", " ", "tested", " ", 
     "with", " ", "both", " ", "RAF", " ", "and", " ", "MEK", " ", 
     RowBox[{"inhibition", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RAFMEKIntersection", "=", 
     RowBox[{"Intersection", "[", 
      RowBox[{
       RowBox[{"MEKresponses", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RAFresponses", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "importing", " ", "a", " ", "table", " ", "of", " ", "all", " ", "BRAF", 
     " ", "mutations", " ", "in", " ", "PDX", " ", 
     RowBox[{"models", ".", " ", "This"}], " ", "is", " ", "a", " ", "subset",
      " ", "of", " ", "the", " ", "mutation", " ", "data", " ", "in", " ", 
     "the", " ", "Supplementary", " ", "Materials", " ", "of", " ", "Gao", 
     " ", "et", " ", 
     RowBox[{"al", ".", " ", "Nature"}], " ", "Medicine"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BRAFmutations", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<BRAF mutations.csv\>\""}], ",", "\"\<CSV\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "identifying", " ", "PDX", " ", "models", " ", "that", " ", "were", " ", 
      "tested", " ", "with", " ", "both", " ", "RAF", " ", "and", " ", "MEK", 
      " ", "inhibition"}], ",", " ", 
     RowBox[{
     "and", " ", "which", " ", "contains", " ", "BRAF", " ", "V600", " ", 
      "mutations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Off", "[", 
    RowBox[{"StringTake", "::", "strse"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RAKMEKIntersectionWithBRAFV600mutations", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"BRAFmutations", "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"RAFMEKIntersection", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",",
              "4"}], "]"}], "\[Equal]", "\"\<V600\>\""}]}], "]"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"%", "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.677799620525365*^9, 3.677799637534338*^9}, {
  3.683479712454487*^9, 3.6834797492205896`*^9}, {3.6834797799873495`*^9, 
  3.683479780185361*^9}, {3.68347981514036*^9, 3.683479846333144*^9}, {
  3.6834800544960504`*^9, 3.683480071065998*^9}, {3.68348010169775*^9, 
  3.6834801018577595`*^9}, {3.683517910619255*^9, 3.6835179512355785`*^9}, {
  3.683555996488722*^9, 3.6835560026877346`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugAresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{
           "RAKMEKIntersectionWithBRAFV600mutations", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrugBresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{
           "RAKMEKIntersectionWithBRAFV600mutations", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombinationresponsesIntersection", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{
          "RAKMEKIntersectionWithBRAFV600mutations", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7155231989273767`*^9, 3.715523207230852*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BestOfMonotherapiesIntersection", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Max", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], 
      "\[Transpose]"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoublingFreeSurvival", "[", "ClinicalTrialResponses_", "]"}], ":=", 
  RowBox[{"SurvivalFunction", "[", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"ClinicalTrialResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugAresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugBresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestOfMonotherapiesIntersection", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "CombinationresponsesIntersection", "]"}],
        "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"6", "*", "61"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"6", "*", "61"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", "61"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "DrugA", ",", "DrugB", ",", "\"\<Independent drug action\>\"", ",", 
           "\"\<Observed combination\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.3"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "180", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4D, \>\"", "<>", "DrugA", "<>", "\"\< \>\"", "<>",
      "DrugB", "<>", "\"\< BRAF-mut Melanoma PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661300853637069*^9, 3.6613008567582474`*^9}, {
   3.6613008946384144`*^9, 3.6613009549578643`*^9}, {3.6613010424708695`*^9, 
   3.6613010724825864`*^9}, {3.661301142078567*^9, 3.6613011528061805`*^9}, 
   3.6613012255833435`*^9, {3.6613012566631207`*^9, 3.661301269429851*^9}, {
   3.6613013438551083`*^9, 3.661301372453744*^9}, {3.6613015596694517`*^9, 
   3.661301607206171*^9}, {3.6613016580150766`*^9, 3.6613016720458794`*^9}, {
   3.6712871662052326`*^9, 3.671287168535236*^9}, {3.6712872201223145`*^9, 
   3.6712872651223907`*^9}, {3.6712873179054775`*^9, 3.671287376695573*^9}, {
   3.671287468063719*^9, 3.6712877867269917`*^9}, {3.6712882230362487`*^9, 
   3.6712882441942854`*^9}, {3.671886257959284*^9, 3.671886311324197*^9}, {
   3.6739966971370506`*^9, 3.673996697273058*^9}, 3.6739971313248844`*^9, 
   3.6739984241608305`*^9, 3.673998457443734*^9, 3.6739988684522424`*^9, 
   3.6740007271235523`*^9, 3.6747324529180193`*^9, {3.6824737981640244`*^9, 
   3.682473798469042*^9}, {3.682474063093178*^9, 3.6824740655423174`*^9}, {
   3.682474541429537*^9, 3.682474564796873*^9}, 3.6824747802451963`*^9, 
   3.6835193320605574`*^9, {3.6835988802149396`*^9, 3.6835988874353523`*^9}, {
   3.683599090118945*^9, 3.6835990951792345`*^9}, 3.685603488560985*^9, 
   3.7154650577240734`*^9, 3.7154683896986513`*^9, {3.7154684313850355`*^9, 
   3.715468437254371*^9}, {3.715523257599733*^9, 3.715523306238515*^9}}],

Cell[CellGroupData[{

Cell["statistics of observed vs independent drug action", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.675614909863748*^9, 3.6756149117718573`*^9}, 3.6835989104186673`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BestOfMonotherapiesIntersection", ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"BestOfMonotherapiesIntersection", ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"BestOfMonotherapiesIntersection", ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756146211742363`*^9, 3.6756146214122496`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs best monotherapy", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.6756147686186695`*^9, 3.675614777345168*^9}, 3.6835989411094227`*^9, {
   3.715522572494547*^9, 3.7155225760627513`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The third of four combinations in Melanoma that surpass independent drug \
action\
\>", "Subsection",
 CellChangeTimes->{{3.671886087609739*^9, 3.6718860927393503`*^9}, {
  3.6836359157818904`*^9, 3.6836359251554265`*^9}, {3.6836360319645357`*^9, 
  3.683636032399561*^9}}],

Cell[BoxData[{
 RowBox[{"DrugA", "=", "\"\<LEE011\>\""}], "\[IndentingNewLine]", 
 RowBox[{"DrugB", "=", "\"\<binimetinib\>\""}]}], "Input",
 CellChangeTimes->{{3.671886127855822*^9, 3.6718861385024424`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DrugAresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrugBresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Combinationresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6613007673441334`*^9, 3.661300836774104*^9}, 
   3.661301165157887*^9, {3.661301283973683*^9, 3.6613013402949047`*^9}, {
   3.6613014294230022`*^9, 3.661301437805482*^9}, {3.671886124435416*^9, 
   3.6718861740813155`*^9}}],

Cell[BoxData[
 RowBox[{"ModelsInIntersection", "=", 
  RowBox[{"Intersection", "[", 
   RowBox[{
    RowBox[{"Combinationresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugAresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671287090388113*^9, 3.6712871195471573`*^9}, {
  3.6718861792463255`*^9, 3.671886190324746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugAresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrugBresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombinationresponsesIntersection", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ModelsInIntersection", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712871277401705`*^9, 3.671287161098223*^9}, {
  3.6718861952185555`*^9, 3.671886232196431*^9}, {3.67188633725865*^9, 
  3.6718863373210497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BestOfMonotherapiesIntersection", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Max", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], 
      "\[Transpose]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712871799762516`*^9, 3.6712872113573003`*^9}, {
  3.6718862429226546`*^9, 3.6718862497844687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoublingFreeSurvival", "[", "ClinicalTrialResponses_", "]"}], ":=", 
  RowBox[{"SurvivalFunction", "[", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"ClinicalTrialResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugAresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugBresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestOfMonotherapiesIntersection", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "CombinationresponsesIntersection", "]"}],
        "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"6", "*", "61"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", "61"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "DrugA", ",", "DrugB", ",", "\"\<Independent drug action\>\"", ",", 
           "\"\<Observed combination\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.3"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "180", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4D, \>\"", "<>", "DrugA", "<>", "\"\< \>\"", "<>",
      "DrugB", "<>", "\"\< Melanoma PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661300853637069*^9, 3.6613008567582474`*^9}, {
   3.6613008946384144`*^9, 3.6613009549578643`*^9}, {3.6613010424708695`*^9, 
   3.6613010724825864`*^9}, {3.661301142078567*^9, 3.6613011528061805`*^9}, 
   3.6613012255833435`*^9, {3.6613012566631207`*^9, 3.661301269429851*^9}, {
   3.6613013438551083`*^9, 3.661301372453744*^9}, {3.6613015596694517`*^9, 
   3.661301607206171*^9}, {3.6613016580150766`*^9, 3.6613016720458794`*^9}, {
   3.6712871662052326`*^9, 3.671287168535236*^9}, {3.6712872201223145`*^9, 
   3.6712872651223907`*^9}, {3.6712873179054775`*^9, 3.671287376695573*^9}, {
   3.671287468063719*^9, 3.6712877867269917`*^9}, {3.6712882230362487`*^9, 
   3.6712882441942854`*^9}, {3.671886257959284*^9, 3.671886311324197*^9}, {
   3.673996707688654*^9, 3.6739967078086605`*^9}, 3.673997146148732*^9, {
   3.673998427067997*^9, 3.6739984545145664`*^9}, 3.6739988722594604`*^9, 
   3.6740007305077457`*^9, 3.6747324529580193`*^9, {3.682473813611908*^9, 
   3.682473813797919*^9}, {3.6824740759009104`*^9, 3.6824740780940356`*^9}, {
   3.6824745414435377`*^9, 3.682474565213897*^9}, 3.6824747838204007`*^9, 
   3.683519332073558*^9, {3.6835989927903786`*^9, 3.6835989960545654`*^9}, {
   3.683599108671006*^9, 3.683599115987425*^9}, 3.68560349108913*^9, 
   3.7154650577390738`*^9, 3.715468390443694*^9, {3.7154684623438063`*^9, 
   3.7154684690621905`*^9}, 3.7155190677260857`*^9}],

Cell[CellGroupData[{

Cell["statistics of observed vs independent drug action", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.675614937673339*^9, 3.675614939128422*^9}, 3.683598910520673*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BestOfMonotherapiesIntersection", ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"BestOfMonotherapiesIntersection", ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"BestOfMonotherapiesIntersection", ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs monotherapy A", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756147686186695`*^9, 3.675614777345168*^9}, {3.6756149776066227`*^9, 
  3.67561497860168*^9}, {3.68359897463334*^9, 3.683598978057536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs monotherapy B", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756147686186695`*^9, 3.675614777345168*^9}, {3.6756149807128005`*^9, 
  3.6756149817988625`*^9}, {3.68359898127272*^9, 3.6835989838248653`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}, {
  3.6756149524901857`*^9, 3.6756149536022496`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}, {
  3.6756149566724253`*^9, 3.675614956909439*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The last of four combinations in Melanoma that surpass independent drug action\
\>", "Subsection",
 CellChangeTimes->{{3.671886087609739*^9, 3.6718860927393503`*^9}, {
  3.6836359157818904`*^9, 3.6836359251554265`*^9}, {3.6836360442292376`*^9, 
  3.6836360484664793`*^9}}],

Cell[BoxData[{
 RowBox[{"DrugA", "=", "\"\<LEE011\>\""}], "\[IndentingNewLine]", 
 RowBox[{"DrugB", "=", "\"\<encorafenib\>\""}]}], "Input",
 CellChangeTimes->{{3.671886127855822*^9, 3.6718861385024424`*^9}, {
  3.6718864222702208`*^9, 3.671886424656426*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DrugAresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrugBresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Combinationresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"CutaneousMelanomaModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6613007673441334`*^9, 3.661300836774104*^9}, 
   3.661301165157887*^9, {3.661301283973683*^9, 3.6613013402949047`*^9}, {
   3.6613014294230022`*^9, 3.661301437805482*^9}, {3.671886124435416*^9, 
   3.6718861740813155`*^9}}],

Cell[BoxData[
 RowBox[{"ModelsInIntersection", "=", 
  RowBox[{"Intersection", "[", 
   RowBox[{
    RowBox[{"Combinationresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugAresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671287090388113*^9, 3.6712871195471573`*^9}, {
  3.6718861792463255`*^9, 3.671886190324746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugAresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrugBresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombinationresponsesIntersection", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ModelsInIntersection", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712871277401705`*^9, 3.671287161098223*^9}, {
  3.6718861952185555`*^9, 3.671886232196431*^9}, {3.67188633725865*^9, 
  3.6718863373210497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BestOfMonotherapiesIntersection", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Max", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], 
      "\[Transpose]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712871799762516`*^9, 3.6712872113573003`*^9}, {
  3.6718862429226546`*^9, 3.6718862497844687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoublingFreeSurvival", "[", "ClinicalTrialResponses_", "]"}], ":=", 
  RowBox[{"SurvivalFunction", "[", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"ClinicalTrialResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugAresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugBresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestOfMonotherapiesIntersection", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "CombinationresponsesIntersection", "]"}],
        "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"6", "*", "61"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", "61"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "DrugA", ",", "DrugB", ",", "\"\<Independent drug action\>\"", ",", 
           "\"\<Observed combination\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.3"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "180", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4D, \>\"", "<>", "DrugA", "<>", "\"\< \>\"", "<>",
      "DrugB", "<>", "\"\< Melanoma PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661300853637069*^9, 3.6613008567582474`*^9}, {
   3.6613008946384144`*^9, 3.6613009549578643`*^9}, {3.6613010424708695`*^9, 
   3.6613010724825864`*^9}, {3.661301142078567*^9, 3.6613011528061805`*^9}, 
   3.6613012255833435`*^9, {3.6613012566631207`*^9, 3.661301269429851*^9}, {
   3.6613013438551083`*^9, 3.661301372453744*^9}, {3.6613015596694517`*^9, 
   3.661301607206171*^9}, {3.6613016580150766`*^9, 3.6613016720458794`*^9}, {
   3.6712871662052326`*^9, 3.671287168535236*^9}, {3.6712872201223145`*^9, 
   3.6712872651223907`*^9}, {3.6712873179054775`*^9, 3.671287376695573*^9}, {
   3.671287468063719*^9, 3.6712877867269917`*^9}, {3.6712882230362487`*^9, 
   3.6712882441942854`*^9}, {3.671886257959284*^9, 3.671886311324197*^9}, {
   3.6739967170091867`*^9, 3.673996717185197*^9}, 3.6739971590124683`*^9, {
   3.6739984300351667`*^9, 3.6739984510513687`*^9}, 3.6739988750676208`*^9, 
   3.6740007334839163`*^9, 3.67473245298802*^9, {3.68247383253199*^9, 
   3.682473832734002*^9}, {3.682474088708643*^9, 3.6824740907997627`*^9}, {
   3.682474540467482*^9, 3.682474565662923*^9}, 3.6824747873316016`*^9, 
   3.6835193320855584`*^9, {3.6835990212860084`*^9, 3.683599032714662*^9}, 
   3.6835991397237825`*^9, 3.685603493049242*^9, 3.715465057763076*^9, 
   3.7154683910117264`*^9, {3.7154685070163617`*^9, 3.7154685139747596`*^9}}],

Cell[CellGroupData[{

Cell["statistics of observed vs independent drug action", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.6756149934535294`*^9, 3.67561499486761*^9}, 3.6835989106366796`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BestOfMonotherapiesIntersection", ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"BestOfMonotherapiesIntersection", ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"BestOfMonotherapiesIntersection", ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs  monotherapy A", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756147686186695`*^9, 3.675614777345168*^9}, {3.6756149807128005`*^9, 
  3.675615005825237*^9}, {3.6835991540166*^9, 3.683599155112663*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}, {
  3.6756149524901857`*^9, 3.6756149536022496`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}, {
  3.6756149566724253`*^9, 3.675614956909439*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs  monotherapy B", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756147686186695`*^9, 3.675614777345168*^9}, {3.6756149807128005`*^9, 
  3.6756149817988625`*^9}, {3.683599160272958*^9, 3.6835991616330357`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}, {
  3.6756149524901857`*^9, 3.6756149536022496`*^9}, {3.6756150090314198`*^9, 
  3.6756150093254366`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}, {
  3.6756149566724253`*^9, 3.675614956909439*^9}, {3.675615012227603*^9, 
  3.675615012502619*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "One combination in colorectal carcinoma surpasses independent drug action\n",
 StyleBox["In this case the statistical significance is borderline when the \
observed effect of the combination is compared to the expectation of \
independent drug action, but strong when compared to the observed \
monotherapy.",
  FontSize->16]
}], "Subsection",
 CellChangeTimes->{{3.671886087609739*^9, 3.6718860927393503`*^9}, {
  3.671886410643597*^9, 3.671886410737197*^9}, {3.6718875092913923`*^9, 
  3.6718875190282145`*^9}, {3.6836358853981524`*^9, 3.6836359001379957`*^9}, {
  3.6836360707747555`*^9, 3.6836361458060474`*^9}}],

Cell[BoxData[{
 RowBox[{"DrugA", "=", "\"\<BYL719\>\""}], "\[IndentingNewLine]", 
 RowBox[{"DrugB", "=", "\"\<binimetinib\>\""}]}], "Input",
 CellChangeTimes->{{3.671886127855822*^9, 3.6718861385024424`*^9}, {
  3.6718864222702208`*^9, 3.671886424656426*^9}, {3.6718875258046265`*^9, 
  3.671887535033243*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DrugAresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ColorectalModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrugBresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ColorectalModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Combinationresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ColorectalModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6613007673441334`*^9, 3.661300836774104*^9}, 
   3.661301165157887*^9, {3.661301283973683*^9, 3.6613013402949047`*^9}, {
   3.6613014294230022`*^9, 3.661301437805482*^9}, {3.671886124435416*^9, 
   3.6718861740813155`*^9}, {3.6718875412690554`*^9, 3.6718875504640756`*^9}}],

Cell[BoxData[
 RowBox[{"ModelsInIntersection", "=", 
  RowBox[{"Intersection", "[", 
   RowBox[{
    RowBox[{"Combinationresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugAresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671287090388113*^9, 3.6712871195471573`*^9}, {
  3.6718861792463255`*^9, 3.671886190324746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugAresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrugBresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombinationresponsesIntersection", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ModelsInIntersection", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712871277401705`*^9, 3.671287161098223*^9}, {
  3.6718861952185555`*^9, 3.671886232196431*^9}, {3.67188633725865*^9, 
  3.6718863373210497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UntreatedIntersection", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ModelsInIntersection", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67128730001445*^9, 3.671287311188467*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BestOfMonotherapiesIntersection", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Max", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], 
      "\[Transpose]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712871799762516`*^9, 3.6712872113573003`*^9}, {
  3.6718862429226546`*^9, 3.6718862497844687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoublingFreeSurvival", "[", "ClinicalTrialResponses_", "]"}], ":=", 
  RowBox[{"SurvivalFunction", "[", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"ClinicalTrialResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugAresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugBresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestOfMonotherapiesIntersection", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "CombinationresponsesIntersection", "]"}],
        "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"3", "*", "61"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "*", "61"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "DrugA", ",", "DrugB", ",", "\"\<Independent drug action\>\"", ",", 
           "\"\<Observed combination\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.3"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "180", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4D, \>\"", "<>", "DrugA", "<>", "\"\< \>\"", "<>",
      "DrugB", "<>", "\"\< Colorectal PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661300853637069*^9, 3.6613008567582474`*^9}, {
   3.6613008946384144`*^9, 3.6613009549578643`*^9}, {3.6613010424708695`*^9, 
   3.6613010724825864`*^9}, {3.661301142078567*^9, 3.6613011528061805`*^9}, 
   3.6613012255833435`*^9, {3.6613012566631207`*^9, 3.661301269429851*^9}, {
   3.6613013438551083`*^9, 3.661301372453744*^9}, {3.6613015596694517`*^9, 
   3.661301607206171*^9}, {3.6613016580150766`*^9, 3.6613016720458794`*^9}, {
   3.6712871662052326`*^9, 3.671287168535236*^9}, {3.6712872201223145`*^9, 
   3.6712872651223907`*^9}, {3.6712873179054775`*^9, 3.671287376695573*^9}, {
   3.671287468063719*^9, 3.6712877867269917`*^9}, {3.6712882230362487`*^9, 
   3.6712882441942854`*^9}, {3.671886257959284*^9, 3.671886311324197*^9}, {
   3.671887565199705*^9, 3.6718875908137555`*^9}, 3.6718878532308865`*^9, {
   3.6739967261047072`*^9, 3.6739967280008154`*^9}, {3.673997171899205*^9, 
   3.673997172475238*^9}, {3.6739984331473446`*^9, 3.673998447987193*^9}, 
   3.6739988786088233`*^9, 3.6740007363880825`*^9, 3.67473245302802*^9, {
   3.6824738462837768`*^9, 3.6824738486779137`*^9}, {3.6824741435997825`*^9, 
   3.682474145269878*^9}, {3.6824745405074844`*^9, 3.6824745665339727`*^9}, 
   3.6824747908598037`*^9, 3.6835193321035595`*^9, {3.683599168156409*^9, 
   3.683599177386937*^9}, {3.6835992296389256`*^9, 3.6835992299049406`*^9}, 
   3.6856034953533735`*^9, 3.715465057778076*^9, 3.715468392000783*^9, {
   3.7154685394822187`*^9, 3.715468544072481*^9}}],

Cell[CellGroupData[{

Cell["statistics of observed vs independent drug action", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.6756147686186695`*^9, 3.675614769882742*^9}, 3.683598910767687*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BestOfMonotherapiesIntersection", ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"BestOfMonotherapiesIntersection", ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"BestOfMonotherapiesIntersection", ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs monotherapy A", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756147686186695`*^9, 3.675614777345168*^9}, {3.675615054371013*^9, 
  3.6756150551470575`*^9}, {3.6835991886245794`*^9, 3.683599189976657*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs  monotherapy B", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756147686186695`*^9, 3.675614777345168*^9}, {3.6756149807128005`*^9, 
  3.6756149817988625`*^9}, {3.683599195952999*^9, 3.6835991982491302`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}, {
  3.6756149524901857`*^9, 3.6756149536022496`*^9}, {3.6756150424753327`*^9, 
  3.67561504277135*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}, {
  3.6756149566724253`*^9, 3.675614956909439*^9}, {3.675615044855469*^9, 
  3.675615045133485*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["One combination in PDAC surpasses independent drug action", "Subsection",
 CellChangeTimes->{{3.671886087609739*^9, 3.6718860927393503`*^9}, {
  3.671886410643597*^9, 3.671886410737197*^9}, {3.6718875092913923`*^9, 
  3.6718875190282145`*^9}, {3.67188764133946*^9, 3.671887641823061*^9}, {
  3.683635870124279*^9, 3.683635881553933*^9}}],

Cell[BoxData[{
 RowBox[{"DrugA", "=", "\"\<BKM120\>\""}], "\[IndentingNewLine]", 
 RowBox[{"DrugB", "=", "\"\<binimetinib\>\""}]}], "Input",
 CellChangeTimes->{{3.671886127855822*^9, 3.6718861385024424`*^9}, {
  3.6718864222702208`*^9, 3.671886424656426*^9}, {3.6718875258046265`*^9, 
  3.671887535033243*^9}, {3.6718876468150697`*^9, 3.671887647596071*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DrugAresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"PDACModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrugBresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"PDACModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Combinationresponses", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"PDACModels", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6613007673441334`*^9, 3.661300836774104*^9}, 
   3.661301165157887*^9, {3.661301283973683*^9, 3.6613013402949047`*^9}, {
   3.6613014294230022`*^9, 3.661301437805482*^9}, {3.671886124435416*^9, 
   3.6718861740813155`*^9}, {3.6718875412690554`*^9, 
   3.6718875504640756`*^9}, {3.671887655941689*^9, 3.6718876612963004`*^9}}],

Cell[BoxData[
 RowBox[{"ModelsInIntersection", "=", 
  RowBox[{"Intersection", "[", 
   RowBox[{
    RowBox[{"Combinationresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugAresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671287090388113*^9, 3.6712871195471573`*^9}, {
  3.6718861792463255`*^9, 3.671886190324746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DrugAresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrugBresponsesIntersection", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"PDXclinicaltrialresponses", ",", 
      RowBox[{
       RowBox[{"And", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ModelsInIntersection", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombinationresponsesIntersection", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"ModelsInIntersection", ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", 
         RowBox[{"DrugA", "<>", "\"\< + \>\"", "<>", "DrugB"}]}]}], "]"}], 
      "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6712871277401705`*^9, 3.671287161098223*^9}, {
  3.6718861952185555`*^9, 3.671886232196431*^9}, {3.67188633725865*^9, 
  3.6718863373210497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BestOfMonotherapiesIntersection", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Max", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], 
      "\[Transpose]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6712871799762516`*^9, 3.6712872113573003`*^9}, {
  3.6718862429226546`*^9, 3.6718862497844687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoublingFreeSurvival", "[", "ClinicalTrialResponses_", "]"}], ":=", 
  RowBox[{"SurvivalFunction", "[", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"ClinicalTrialResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugAresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugBresponsesIntersection", "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", "BestOfMonotherapiesIntersection", 
         "]"}], "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "CombinationresponsesIntersection", "]"}],
        "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"3", "*", "61"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "*", "61"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PFS (months)\>\"", ",", "\"\<PDX patients (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "DrugA", ",", "DrugB", ",", "\"\<Independent drug action\>\"", ",", 
           "\"\<Observed combination\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.3"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "180", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"3", "/", "4"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S4D, \>\"", "<>", "DrugA", "<>", "\"\< \>\"", "<>",
      "DrugB", "<>", "\"\< Pancreatic PFS.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.661300853637069*^9, 3.6613008567582474`*^9}, {
   3.6613008946384144`*^9, 3.6613009549578643`*^9}, {3.6613010424708695`*^9, 
   3.6613010724825864`*^9}, {3.661301142078567*^9, 3.6613011528061805`*^9}, 
   3.6613012255833435`*^9, {3.6613012566631207`*^9, 3.661301269429851*^9}, {
   3.6613013438551083`*^9, 3.661301372453744*^9}, {3.6613015596694517`*^9, 
   3.661301607206171*^9}, {3.6613016580150766`*^9, 3.6613016720458794`*^9}, {
   3.6712871662052326`*^9, 3.671287168535236*^9}, {3.6712872201223145`*^9, 
   3.6712872651223907`*^9}, {3.6712873179054775`*^9, 3.671287376695573*^9}, {
   3.671287468063719*^9, 3.6712877867269917`*^9}, {3.6712882230362487`*^9, 
   3.6712882441942854`*^9}, {3.671886257959284*^9, 3.671886311324197*^9}, {
   3.671887565199705*^9, 3.6718875908137555`*^9}, {3.67188767082452*^9, 
   3.671887672776524*^9}, {3.6718878391164565`*^9, 3.6718878397092576`*^9}, {
   3.673996736137281*^9, 3.6739967373683515`*^9}, {3.6739971824098063`*^9, 
   3.6739971851229615`*^9}, {3.673998436187518*^9, 3.6739984438679576`*^9}, 
   3.673998881716001*^9, 3.6740007402033005`*^9, 3.67473245307802*^9, {
   3.682473859875554*^9, 3.6824738722432613`*^9}, {3.682474152804309*^9, 
   3.682474155067438*^9}, {3.6824745212993855`*^9, 3.6824745213283873`*^9}, {
   3.6824747042508497`*^9, 3.6824747539246907`*^9}, 3.6835193321155605`*^9, {
   3.6835992119279127`*^9, 3.6835992237285876`*^9}, 3.6856034975695004`*^9, 
   3.715465057792077*^9, 3.7154683935128694`*^9, {3.715468570840012*^9, 
   3.715468575897301*^9}}],

Cell[CellGroupData[{

Cell["statistics of observed vs independent drug action", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.6756147686186695`*^9, 3.675614769882742*^9}, 3.6835989108786936`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BestOfMonotherapiesIntersection", ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"BestOfMonotherapiesIntersection", ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"BestOfMonotherapiesIntersection", ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs monotherapy A", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
  3.6756147686186695`*^9, 3.675614777345168*^9}, {3.675615054371013*^9, 
  3.6756150551470575`*^9}, {3.683599411513328*^9, 3.6835994132494273`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["statistics of observed vs  monotherapy B", "Subsubsection",
 CellChangeTimes->{{3.6756139688679256`*^9, 3.675613971400071*^9}, {
   3.6756147686186695`*^9, 3.675614777345168*^9}, {3.6756149807128005`*^9, 
   3.6756149817988625`*^9}, 3.683599416043587*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"log", " ", "rank", " ", "test"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"LogRankTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
    "0", ",", "\"\<PValueTable\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675613410831008*^9, 3.6756134597018037`*^9}, {
  3.6756139731551714`*^9, 3.67561397627735*^9}, {3.6756147958012238`*^9, 
  3.6756147999504614`*^9}, {3.675614866770283*^9, 3.675614872946636*^9}, {
  3.6756149524901857`*^9, 3.6756149536022496`*^9}, {3.6756150424753327`*^9, 
  3.67561504277135*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DrugBresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "CombinationresponsesIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<independent\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"DrugAresponsesIntersection", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "BestOfMonotherapiesIntersection", "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.675613989689117*^9, 3.675614042988166*^9}, {
  3.6756142547972803`*^9, 3.6756142571904173`*^9}, {3.6756143062892256`*^9, 
  3.6756143289905243`*^9}, {3.675614398098477*^9, 3.6756143984104943`*^9}, {
  3.6756147039879723`*^9, 3.6756147041639824`*^9}, {3.675614805577783*^9, 
  3.675614811869143*^9}, {3.6756148757137947`*^9, 3.6756148760068116`*^9}, {
  3.6756149566724253`*^9, 3.675614956909439*^9}, {3.675615044855469*^9, 
  3.675615045133485*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Which monotherapies are \[OpenCurlyQuote]active\[CloseCurlyQuote], that is, \
significantly improve survival relative to no treatment?\n",
 StyleBox["This is determined by applying the Cox proportional hazards model, \
comparing PFS of each monotherapy to PFS in xenografts of the same tumor type \
that were untreated.",
  FontSize->16]
}], "Section",
 CellChangeTimes->{{3.6779430062118683`*^9, 3.677943034984514*^9}, {
  3.683636855689582*^9, 3.6836368975189743`*^9}, {3.6836372568045244`*^9, 
  3.683637346539657*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "PFS", " ", "times", " ", "in", " ", "each", " ", "tumor", " ", "type", 
    " ", "when", " ", "untreated"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MelanomaUntreatedResponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"CutaneousMelanomaModels", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NSCLCUntreatedResponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"NSCLCModels", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACUntreatedResponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"PDACModels", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCUntreatedResponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"ColorectalModels", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BreastUntreatedResponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"BreastModels", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GastricUntreatedResponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"GastricModels", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.677943136062295*^9, 3.677943198156847*^9}, {
  3.683637348374762*^9, 3.68363736198254*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "function", " ", "takes", " ", "two", " ", "lists", " ", "of",
     " ", "PFS", " ", "times", " ", 
    RowBox[{"(", 
     RowBox[{"treated", " ", "and", " ", "untreated"}], ")"}], " ", "and", 
    " ", "computes", " ", "the", " ", "hazard", " ", "ratio", " ", "by", " ", 
    "Cox", " ", "Model"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CoxModelRisk", "[", 
    RowBox[{"DrugResponses_", ",", "UntreatedResponses_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myeventdata", "=", 
       RowBox[{"EventData", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"DrugResponses", ",", "UntreatedResponses"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"DrugResponses", ",", "UntreatedResponses"}], "]"}], 
             "]"}], "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"descriptors", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"\"\<treated\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "DrugResponses", "]"}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"Table", "[", 
          RowBox[{"\"\<no treatment\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "UntreatedResponses", "]"}], "}"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MyModelFit", "=", 
       RowBox[{"CoxModelFit", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"{", "treatment", "}"}], ",", 
         RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"RiskInterval", "=", 
       RowBox[{
       "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.677943298289574*^9, 3.677943396942217*^9}, {
  3.6779434570476546`*^9, 3.677943471215465*^9}, {3.683637366010771*^9, 
  3.6836373895241156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "melanoma", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MelanomaTreatmentHazards", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CoxModelRisk", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"CutaneousMelanomaModels", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
                "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"MelanomaUntreatedResponses", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MonotherapiesByGroup", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MelanomaTreatmentHazardsPValues", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MelanomaTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MelanomaTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MelanomaTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "4"}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MelanomaTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "7"}], 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Melanoma monotherapy hazards.csv\>\""}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"MelanomaTreatmentHazardsPValues", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Treatment number\>\"", ",", "\"\<Drug name\>\"", ",", 
          "\"\<Relative risk\>\"", ",", "\"\<P-value, cox model\>\""}], 
         "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"MelanomaTreatmentHazards", "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.6779434904175634`*^9, 3.677943526515628*^9}, {
   3.677943635461859*^9, 3.6779436355008616`*^9}, {3.677944362823462*^9, 
   3.677944379873437*^9}, {3.6779445077057486`*^9, 3.6779446112516713`*^9}, {
   3.6836369583364534`*^9, 3.6836369587334757`*^9}, 3.715559786541069*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "NSCLC", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NSCLCTreatmentHazards", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CoxModelRisk", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"NSCLCModels", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
                "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"NSCLCUntreatedResponses", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MonotherapiesByGroup", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NSCLCTreatmentHazardsPValues", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NSCLCTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"NSCLCTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"NSCLCTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "4"}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"NSCLCTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "7"}], 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<NSCLC monotherapy hazards.csv\>\""}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"NSCLCTreatmentHazardsPValues", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Treatment number\>\"", ",", "\"\<Drug name\>\"", ",", 
          "\"\<Relative risk\>\"", ",", "\"\<P-value, cox model\>\""}], 
         "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"NSCLCTreatmentHazards", "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.677943531492913*^9, 3.67794356011055*^9}, {
   3.677943639371083*^9, 3.6779436394090853`*^9}, {3.6779446355600615`*^9, 
   3.6779446747883053`*^9}, 3.6779447729599204`*^9, 3.715559787823142*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "PDAC", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PDACTreatmentHazards", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CoxModelRisk", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"PDACModels", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
                   RowBox[{"3", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
                "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PDACUntreatedResponses", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MonotherapiesByGroup", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACTreatmentHazardsPValues", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PDACTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"PDACTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"PDACTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "4"}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"PDACTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "7"}], 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<PDAC monotherapy hazards.csv\>\""}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"PDACTreatmentHazardsPValues", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Treatment number\>\"", ",", "\"\<Drug name\>\"", ",", 
          "\"\<Relative risk\>\"", ",", "\"\<P-value, cox model\>\""}], 
         "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"PDACTreatmentHazards", "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.6779438071886816`*^9, 3.677943826614793*^9}, {
   3.6779447852876253`*^9, 3.677944820966666*^9}, {3.681344307564362*^9, 
   3.6813443077323713`*^9}, 3.715559789133217*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Colorectal", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CRCTreatmentHazards", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
          RowBox[{"4", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CoxModelRisk", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"ColorectalModels", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
                   RowBox[{"4", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
                "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"CRCUntreatedResponses", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MonotherapiesByGroup", "\[LeftDoubleBracket]", "4", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCTreatmentHazardsPValues", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CRCTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"CRCTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"CRCTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "4"}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"CRCTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "7"}], 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<CRC monotherapy hazards.csv\>\""}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"CRCTreatmentHazardsPValues", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Treatment number\>\"", ",", "\"\<Drug name\>\"", ",", 
          "\"\<Relative risk\>\"", ",", "\"\<P-value, cox model\>\""}], 
         "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"CRCTreatmentHazards", "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.6779439259044714`*^9, 3.677943962112543*^9}, {
   3.6779448304212074`*^9, 3.677944861649993*^9}, 3.715559789933263*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Breast", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BreastTreatmentHazards", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
          RowBox[{"5", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CoxModelRisk", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"BreastModels", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
                   RowBox[{"5", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
                "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"BreastUntreatedResponses", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MonotherapiesByGroup", "\[LeftDoubleBracket]", "5", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BreastTreatmentHazardsPValues", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"BreastTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"BreastTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"BreastTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "4"}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"BreastTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "7"}], 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Breast monotherapy hazards.csv\>\""}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"BreastTreatmentHazardsPValues", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Treatment number\>\"", ",", "\"\<Drug name\>\"", ",", 
          "\"\<Relative risk\>\"", ",", "\"\<P-value, cox model\>\""}], 
         "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BreastTreatmentHazards", "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.6779440005557413`*^9, 3.677944023980081*^9}, {
   3.6779448696424503`*^9, 3.677944888083505*^9}, {3.6779449264016967`*^9, 
   3.6779449498780394`*^9}, 3.7155597905843*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Gastric", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GastricTreatmentHazards", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
          RowBox[{"6", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"CoxModelRisk", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"GastricModels", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
                   RowBox[{"6", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
                "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"GastricUntreatedResponses", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MonotherapiesByGroup", "\[LeftDoubleBracket]", "6", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GastricTreatmentHazardsPValues", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GastricTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"GastricTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"GastricTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "4"}], 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"GastricTreatmentHazards", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1", ",", "1", ",", "2", ",", "7"}], 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Gastric monotherapy hazards.csv\>\""}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"GastricTreatmentHazardsPValues", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Treatment number\>\"", ",", "\"\<Drug name\>\"", ",", 
          "\"\<Relative risk\>\"", ",", "\"\<P-value, cox model\>\""}], 
         "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"GastricTreatmentHazards", "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.6779440005557413`*^9, 3.677944040790043*^9}, {
   3.677944119905568*^9, 3.6779441356444683`*^9}, {3.677944957977503*^9, 
   3.677944990521364*^9}, 3.7155597925324116`*^9}],

Cell[CellGroupData[{

Cell["\<\
A natural gap presents itself in the distribution of hazard ratios, \
separating hazard ratios larger or smaller than 0.7; this position coincides \
with P-values greater or smaller than approximately 0.1.
We take this gap as a convenient distinction between monotherapies that we \
deem \[OpenCurlyQuote]active\[CloseCurlyQuote] and or \
\[OpenCurlyQuote]inactive\[CloseCurlyQuote]. We consider the slight lenience \
in P-value acceptable in light of modest numbers of xenografts tested with \
each therapy (as compared to human clinical trials) and because this \
distinction has little significance - it is only used for measuring the \
distribution of response correlations between \[OpenCurlyQuote]active\
\[CloseCurlyQuote] agents (which is little different from response \
correlations between all agents).\
\>", "Subsubsection",
 CellChangeTimes->{{3.68363746671253*^9, 3.6836375276420155`*^9}, {
  3.683637609393691*^9, 3.6836376213873777`*^9}, {3.6836376531431932`*^9, 
  3.6836380278816276`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MelanomaTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{"MelanomaTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}]}], "]"}]}]}],
        "}"}], "\[Transpose]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NSCLCTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{"NSCLCTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}]}], "]"}]}]}],
        "}"}], "\[Transpose]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PDACTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{"PDACTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}]}], "]"}]}]}],
        "}"}], "\[Transpose]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CRCTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{"CRCTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}]}], "]"}]}]}],
        "}"}], "\[Transpose]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"BreastTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{"BreastTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}]}], "]"}]}]}],
        "}"}], "\[Transpose]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GastricTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{"GastricTreatmentHazardsPValues", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}]}], "]"}]}]}],
        "}"}], "\[Transpose]"}]}], "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1.3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Hazard ratio of treatment vs. untreated\>\"", ",", 
      "\"\<-\!\(\*SubscriptBox[\(Log\), \(10\)]\)P\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1000", "}"}], ",", 
      RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
      RowBox[{"Darker", "[", 
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}]}], "]"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "10", ",", "2"}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "9", ",", "2"}], "}"}]}], "]"}]}], 
         "]"}], ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "2", ",", "0.2"}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0.1", ",", "2", ",", "0.2"}], "}"}]}], 
           "]"}]}], "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.7", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.7", ",", "10"}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Arrowheads", "[", "0.05", "]"}], ",", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.68", ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.58", ",", "9"}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.72", ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.82", ",", "9"}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<Deemed\\nactive\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"0.65", ",", "8.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<Deemed\\ninactive\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"0.75", ",", "8.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.677945005272208*^9, 3.677945144672181*^9}, {
  3.677945267897229*^9, 3.677945430234514*^9}, {3.6785750236152415`*^9, 
  3.6785750877339087`*^9}, {3.678575914463195*^9, 3.6785759145411997`*^9}, {
  3.68363709867348*^9, 3.6836372051975727`*^9}, {3.6836375484282045`*^9, 
  3.6836375960899305`*^9}, {3.683637628536786*^9, 3.683637628716797*^9}, {
  3.683639776137622*^9, 3.68363978081989*^9}, {3.685603524904064*^9, 
  3.6856035253340883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "designating", " ", "lists", " ", "of", " ", "individually", " ", 
     "active", " ", "agents"}], ",", " ", 
    RowBox[{
     RowBox[{
     "according", " ", "to", " ", "having", " ", "hazard", " ", "ratio"}], 
     " ", "\[LessEqual]", " ", "0.7"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"which", " ", "coincides", " ", "with", " ", "P"}], "-", 
      RowBox[{
      "value", " ", "by", " ", "Cox", " ", "Model", " ", "of", " ", 
       "approximately"}]}], " ", "<", "0.1"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MelanomaActiveAgents", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"MelanomaTreatmentHazardsPValues", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "<", "0.7"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NSCLCActiveAgents", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"NSCLCTreatmentHazardsPValues", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "<", "0.7"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACActiveAgents", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDACTreatmentHazardsPValues", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "<", "0.7"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCActiveAgents", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CRCTreatmentHazardsPValues", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "<", "0.7"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BreastActiveAgents", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"BreastTreatmentHazardsPValues", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "<", "0.7"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GastricActiveAgents", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"GastricTreatmentHazardsPValues", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "<", "0.7"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6836400814520855`*^9, 3.6836401102727337`*^9}, {
  3.6836401607786226`*^9, 3.6836402202900257`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Estimating the effect of hypothetical combinations under the assumption of \
independent drug action\
\>", "Section",
 CellChangeTimes->{{3.661342859950693*^9, 3.661342868087158*^9}, {
  3.6836367322115197`*^9, 3.6836367489954796`*^9}, {3.683638085952949*^9, 
  3.683638130978524*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "from", " ", "the", " ", "above", " ", "measurements", " ", "of", " ", 
     "hazard", " ", "ratios"}], ",", " ", 
    RowBox[{
    "we", " ", "note", " ", "the", " ", "most", " ", "effective", " ", 
     "monotherapies", " ", "per", " ", "tumor", " ", "type"}], ",", " ", 
    RowBox[{"as", " ", "evaluated", " ", "by", " ", "hazard", " ", 
     RowBox[{"ratio", ".", " ", "These"}], " ", "are", " ", "used", " ", "as",
      " ", "a", " ", "point", " ", "of", " ", "comparison", " ", "to", " ", 
     "compute", " ", "the", " ", "hazard", " ", "ratio", " ", "of", " ", 
     "each", " ", "hypothetical", " ", "combination", " ", "compared", " ", 
     "to", " ", "the", " ", "most", " ", "effective", " ", "monotherapy", " ",
      "for", " ", "each", " ", "tumor", " ", 
     RowBox[{"type", ".", "\[IndentingNewLine]", "Where"}], " ", "multiple", 
     " ", "treatments", " ", "appear", " ", "similarly", " ", "efficacious"}],
     ",", " ", 
    RowBox[{
    "they", " ", "are", " ", "each", " ", "used", " ", "as", " ", "a", " ", 
     "point", " ", "of", " ", "comparison"}], ",", " ", 
    RowBox[{
    "with", " ", "the", " ", "final", " ", "reported", " ", "hazard", " ", 
     "ratio", " ", "of", " ", "a", " ", "hypothetical", " ", "combination", 
     " ", "always", " ", "based", " ", "on", " ", "comparison", " ", 
     "against", " ", "the", " ", "most", " ", "competitive", " ", "observed", 
     " ", 
     RowBox[{"monotherapy", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestMonotherapiesPerTumorType", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "\"\<binimetinib\>\"", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<binimetinib\>\"", ",", "\"\<BKM120\>\"", ",", "\"\<CKX620\>\""}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<binimetinib\>\"", ",", "\"\<gemcitabine-50mpk\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<CKX620\>\"", ",", "\"\<CLR457\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<BKM120\>\"", ",", "\"\<CLR457\>\""}], "}"}], ",", 
       RowBox[{"{", "\"\<BYL719\>\"", "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"note", ",", " ", 
     RowBox[{
     "to", " ", "appropriately", " ", "choose", " ", "the", " ", "drug", 
      RowBox[{"(", "s", ")"}], " ", "for", " ", "comparison"}], ",", " ", 
     RowBox[{
      RowBox[{"the", " ", "'"}], 
      RowBox[{"modelnumber", "'"}], " ", "variable", " ", 
      RowBox[{"(", 
       RowBox[{
       "a", " ", "number", " ", "from", " ", "1", " ", "to", " ", "6"}], 
       ")"}], " ", "must", " ", "be", " ", "correctly", " ", "defined", " ", 
      "before", " ", "calling", " ", "the", " ", 
      RowBox[{"function", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "function", " ", "takes", " ", "two", " ", "drugs", " ", 
      "and", " ", "a", " ", "tumor", " ", "type", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "specifying", " ", "a", " ", "list", " ", "of", " ", "PDX", " ", 
         "models"}], ",", " ", 
        RowBox[{
        "and", " ", "the", " ", "name", " ", "of", " ", "that", " ", "tumor", 
         " ", "type", " ", "for", " ", "purpose", " ", "of", " ", "labeling", 
         " ", "a", " ", "plot"}]}], ")"}]}], ",", " ", 
     RowBox[{
     "and", " ", "computes", " ", "the", " ", "effect", " ", "expected", " ", 
      "under", " ", "the", " ", "hypothetical", " ", "combination", " ", 
      "with", " ", "independent", " ", "drug", " ", "action"}], ",", " ", 
     RowBox[{
     "where", " ", "each", " ", "PDXs", " ", "response", " ", "to", " ", 
      "the", " ", "combination", " ", "is", " ", "the", " ", "best", " ", 
      "one", " ", "of", " ", "the", " ", "two", " ", "observed", " ", "PFS", 
      " ", "times"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndependentActionPrediction", "[", 
     RowBox[{"DrugA_", ",", "DrugB_", ",", "ModelSet_", ",", "ModelName_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{
        "DrugAresponses", ",", "DrugBresponses", ",", 
         "ModelsInBothMonotherapies", ",", "DrugAresponsesInIntersection", 
         ",", "DrugBresponsesInIntersection", ",", 
         "UntreatedResponsesInIntersection", ",", 
         "BestOfMonotherapyResponses"}], "*)"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "all", " ", "responses", " ", "to", " ", "drug", " ", "A", " ", "in", 
        " ", "the", " ", "set", " ", "of", " ", "PDX", " ", "models"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DrugAresponses", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"PDXclinicaltrialresponses", ",", 
          RowBox[{
           RowBox[{"And", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"ModelSet", ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"%", "//", "Length"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "all", " ", "responses", " ", "to", " ", "drug", " ", "B", " ", "in", 
         " ", "the", " ", "set", " ", "of", " ", "PDX", " ", "models"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"DrugBresponses", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"PDXclinicaltrialresponses", ",", 
          RowBox[{
           RowBox[{"And", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"ModelSet", ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"%", "//", "Length"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "this", " ", "function", " ", "converts", " ", "a", " ", "set", " ", 
         "of", " ", "PFS", " ", "times", " ", "to", " ", "a", " ", "survival",
          " ", "distribution"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DoublingFreeSurvival", "[", "ClinicalTrialResponses_", "]"}],
         ":=", 
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{"ClinicalTrialResponses", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "this", " ", "function", " ", "computes", " ", "a", " ", "hazard", 
          " ", "ratio", " ", "between", " ", "two", " ", "sets", " ", "of", 
          " ", "responses"}], ";", " ", 
         RowBox[{
         "intended", " ", "here", " ", "to", " ", "compare", " ", "the", " ", 
          "best", " ", "observed", " ", "monotherapy", " ", "with", " ", 
          "the", " ", "predicted", " ", "effects", " ", "of", " ", "a", " ", 
          "hypothetical", " ", "combination"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HazardRatio", "[", 
         RowBox[{
         "BestMonotherapyResponses_", ",", "PredictedCombinationResponses_"}],
          "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], " ",
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myeventdata", "=", 
            RowBox[{"EventData", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
               "BestMonotherapyResponses", ",", 
                "PredictedCombinationResponses"}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                   "BestMonotherapyResponses", ",", 
                    "PredictedCombinationResponses"}], "]"}], "]"}], "}"}]}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"descriptors", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"\"\<Observed monotherapy responses\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", "BestMonotherapyResponses", "]"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"\"\<predicted combination\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "Length", "[", "PredictedCombinationResponses", "]"}], 
                 "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"MyModelFit", "=", 
            RowBox[{"CoxModelFit", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
              RowBox[{"{", "treatment", "}"}], ",", 
              RowBox[{"{", "treatment", "}"}], ",", 
              RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"RelativeRisk", "=", 
            RowBox[{
             RowBox[{"MyModelFit", "[", "\"\<RelativeRisk\>\"", "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"PValue", "=", 
            RowBox[{
             RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1", ",", "2", ",", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"RelativeRisk", ",", "PValue"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "which", " ", "PDX", " ", "models", " ", "were", " ", "tested", " ", 
         "in", " ", "both", " ", 
         RowBox[{"monotherapies", "?", " ", "Only"}], " ", "this", " ", 
         "intersecting", " ", "set", " ", "can", " ", "be", " ", "used", " ", 
         "for", " ", "the", " ", 
         RowBox[{"comparison", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ModelsInBothMonotherapies", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"DrugAresponses", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"DrugBresponses", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"don", "'"}], "t", " ", "attempt", " ", "to", " ", 
         "calculate", " ", "a", " ", "survival", " ", "curve", " ", "when", 
         " ", "the", " ", "number", " ", "of", " ", "intersecting", " ", 
         "models", " ", 
         RowBox[{"(", 
          RowBox[{
          "treated", " ", "with", " ", "both", " ", "drugA", " ", "and", " ", 
           "drugB", " ", "monotherapies"}], ")"}], " ", "is", " ", "fewer", 
         " ", "than", " ", "this", " ", 
         RowBox[{"number", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"MinimalNumberOfIntersectingModels", "=", "10"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "too", " ", "few", " ", "PDXs", " ", "are", " ", "tested",
           " ", "in", " ", "both", " ", "therapies"}], ",", " ", 
         RowBox[{
         "report", " ", "this", " ", "error", " ", "message", " ", "of", " ", 
          "all", " ", 
          RowBox[{"zeros", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ModelsInBothMonotherapies", "]"}], "<", 
          "MinimalNumberOfIntersectingModels"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "responses", " ", "to", " ", "drug", " ", "A", " ", "in", " ", "the", 
         " ", "intersecting", " ", "set", " ", "of", " ", "PDX", " ", 
         "models"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"DrugAresponsesInIntersection", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"ModelsInBothMonotherapies", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "\[Equal]", "DrugA"}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "responses", " ", "to", " ", "drug", " ", "B", " ", "in", " ", "the", 
         " ", "intersecting", " ", "set", " ", "of", " ", "PDX", " ", 
         "models"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"DrugBresponsesInIntersection", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"ModelsInBothMonotherapies", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "\[Equal]", "DrugB"}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "responses", " ", "to", " ", "no", " ", "treatment", " ", "in", " ", 
         "the", " ", "intersecting", " ", "set", " ", "of", " ", "PDX", " ", 
         "models"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"UntreatedResponsesInIntersection", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"PDXclinicaltrialresponses", ",", 
          RowBox[{
           RowBox[{"And", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"ModelsInBothMonotherapies", ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "responses", " ", "to", " ", "the", " ", "best", " ", "observed", 
          " ", "monotherapy", " ", "for", " ", "that", " ", "tumor", " ", 
          "type", " ", "in", " ", "the", " ", "intersecting", " ", "set", " ",
           "of", " ", "PDX", " ", 
          RowBox[{"models", ".", " ", "Because"}], " ", "there", " ", "are", 
          " ", "sometimes", " ", "multiple", " ", "drugs", " ", "listed", " ",
           "as", " ", 
          RowBox[{"candidate", " ", "'"}], "best", " ", 
          RowBox[{"monotherapies", "'"}]}], ",", " ", 
         RowBox[{
         "this", " ", "is", " ", "a", " ", "list", " ", "over", " ", 
          "different", " ", 
          RowBox[{"drugs", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"BestMonotherapyForTumorTyperesponsesInIntersection", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"ModelsInBothMonotherapies", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "\[Equal]", 
                  RowBox[{
                  "BestMonotherapiesPerTumorType", "\[LeftDoubleBracket]", 
                   RowBox[{"tumortype", ",", "BestMonotherapyIndex"}], 
                   "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ">", 
              RowBox[{
              "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "&"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"BestMonotherapyIndex", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
             "BestMonotherapiesPerTumorType", "\[LeftDoubleBracket]", 
              "tumortype", "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "this", " ", "applies", " ", "the", " ", "principle", " ", "of", " ", 
         "independent", " ", "drug", " ", 
         RowBox[{"action", ":", " ", 
          RowBox[{"each", " ", "PDX", " ", 
           RowBox[{"model", "'"}], "s", " ", "response", " ", "is", " ", 
           "taken", " ", "to", " ", "be", " ", "the", " ", "stronger", " ", 
           "of", " ", "its", " ", "two", " ", "observed", " ", "responses", 
           " ", "to", " ", "the", " ", "two", " ", "monotherapies"}]}]}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"BestOfMonotherapyResponses", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{
            "DrugAresponsesInIntersection", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"9", "->", 
             RowBox[{"Max", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                "DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "9"}], "\[RightDoubleBracket]"}]}], "}"}], 
              "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "DrugAresponsesInIntersection", "]"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "computing", " ", "the", " ", "relative", " ", "risk", " ", "of", " ",
          "the", " ", "hypothetical", " ", "combination", " ", "versus", " ", 
         "the", " ", "best", " ", "observed", " ", "monotherapies", " ", 
         "for", " ", "that", " ", "tumor", " ", "type"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"RelativeRiskAndPValueAgainstBestMonotherapy", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"HazardRatio", "[", 
              RowBox[{
               RowBox[{
               "BestMonotherapyForTumorTyperesponsesInIntersection", 
                "\[LeftDoubleBracket]", 
                RowBox[{"BestMonotherapyIndex", ",", "All", ",", "9"}], 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"BestMonotherapyIndex", ",", "1", ",", 
               RowBox[{
               "Length", "[", 
                "BestMonotherapyForTumorTyperesponsesInIntersection", "]"}]}],
               "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ">", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Average", " ", "PFS", " ", "in", " ", "each", " ", "treatment", " ", 
         "condition"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"AverageUntreatedPFS", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"UntreatedResponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AverageDrugAPFS", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AverageDrugBPFS", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AveragePredictionPFS", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "fold", " ", "change", " ", "in", " ", "average", " ", "PFS", " ", 
          "in", " ", "comparison", " ", "to", " ", "no", " ", "treatment"}], 
         ",", " ", 
         RowBox[{
         "and", " ", "in", " ", "comparison", " ", "to", " ", "the", " ", 
          "best", " ", "of", " ", "the", " ", "two", " ", "tested", " ", 
          "combination", " ", 
          RowBox[{"therapies", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ImprovementOverUntreated", "=", 
        RowBox[{"AveragePredictionPFS", "/", "AverageUntreatedPFS"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ImprovementOverBestMonotherapy", "=", 
        RowBox[{"AveragePredictionPFS", "/", 
         RowBox[{"Max", "[", 
          RowBox[{"{", 
           RowBox[{"AverageDrugAPFS", ",", "AverageDrugBPFS"}], "}"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MinimalPredictedCombinationPlot", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DoublingFreeSurvival", "[", "UntreatedResponsesInIntersection", 
              "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "DoublingFreeSurvival", "[", "DrugAresponsesInIntersection", 
              "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "DoublingFreeSurvival", "[", "DrugBresponsesInIntersection", 
              "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "DoublingFreeSurvival", "[", "BestOfMonotherapyResponses", "]"}],
              "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "200"}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "120"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
          RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
               RowBox[{"AbsoluteThickness", "[", "1.5", "]"}]}], "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"3", ",", "2"}], "]"}], ",", 
               RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", 
                RowBox[{"3", ",", "9"}], "]"}], ",", 
               RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", 
               RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], 
            "}"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"PlotLegends", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Untreated\>\"", ",", "DrugA", ",", "DrugB", ",", 
               "\"\<Minimal prediction\>\""}], "}"}]}], ","}], "*)"}], 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Days\>\"", ",", "\"\<Doubling-free survival\>\""}], 
            "}"}]}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "250", "}"}], ",", 
             RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"50", ",", "10"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"PlotLabel", "\[Rule]", "ModelName"}]}], "*)"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"N", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "1", ",", "0.5"}], "}"}]}], 
                "]"}], ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "i", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", "120", ",", "30"}], "}"}]}], 
                "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"3", "/", "4"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "computing", " ", "correlation", " ", "in", " ", "drug", " ", 
         "response", " ", "by", " ", 
         RowBox[{"Spearman", "'"}], "s", " ", "Rho", " ", "Rank", " ", 
         "Correlation"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RankCorrelationBetweenAandBPFS", "=", 
        RowBox[{"SpearmanRho", "[", 
         RowBox[{
          RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "ImprovementOverUntreated", ",", "ImprovementOverBestMonotherapy", 
         ",", "MinimalPredictedCombinationPlot", ",", 
         "RankCorrelationBetweenAandBPFS", ",", 
         "RelativeRiskAndPValueAgainstBestMonotherapy"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6613444292654524`*^9, 3.66134460563454*^9}, {
   3.6613446796997766`*^9, 3.6613447624845114`*^9}, {3.6613448060910053`*^9, 
   3.6613449212295914`*^9}, {3.6613450128998346`*^9, 3.661345050796002*^9}, {
   3.661345088093135*^9, 3.661345107092222*^9}, {3.6613451373089504`*^9, 
   3.661345169195774*^9}, {3.6613472468906116`*^9, 3.661347294579339*^9}, {
   3.661866917379743*^9, 3.661867010573886*^9}, {3.661872549554984*^9, 
   3.6618725517521095`*^9}, 3.6620922253882866`*^9, {3.6621043894270296`*^9, 
   3.6621044166035843`*^9}, {3.6813450077154083`*^9, 
   3.6813450084454503`*^9}, {3.681345108819191*^9, 3.6813451301644125`*^9}, {
   3.6813451630062904`*^9, 3.6813451660134625`*^9}, 3.6813452087979097`*^9, {
   3.681345789369116*^9, 3.681345796124502*^9}, {3.6813460367162633`*^9, 
   3.681346046756838*^9}, {3.681346108351361*^9, 3.681346110029457*^9}, {
   3.681346154617007*^9, 3.6813461726300373`*^9}, {3.6836381582560844`*^9, 
   3.683638163684395*^9}, {3.683638202913639*^9, 3.683638432371763*^9}, {
   3.6836384696798973`*^9, 3.683638926458023*^9}, {3.683638973979741*^9, 
   3.683639015176098*^9}, {3.6836390456898427`*^9, 3.683639328783035*^9}, 
   3.6836393988840446`*^9, {3.6836521133462605`*^9, 3.68365217050653*^9}, {
   3.683653092397259*^9, 3.683653107064098*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Examining the hypothetical combination of BYL719 (alpelisib) and LLM871 in \
gastric cancer xenografts\
\>", "Section",
 CellChangeTimes->{{3.662091973935904*^9, 3.6620919798852444`*^9}, {
  3.6836393386295977`*^9, 3.6836393593077807`*^9}, {3.683639636551638*^9, 
  3.6836396395738115`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drugAnumber", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drugBnumber", "=", "13"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BYL719LLM871Prediction", "=", 
    RowBox[{"IndependentActionPrediction", "[", 
     RowBox[{
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "drugAnumber"}], "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "drugBnumber"}], "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{
      "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Style", "[", 
   RowBox[{"\"\<untreated\>\"", ",", "Gray"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{"tumortype", ",", "drugAnumber"}], "\[RightDoubleBracket]"}], 
    ",", 
    RowBox[{"ColorData", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{"tumortype", ",", "drugBnumber"}], "\[RightDoubleBracket]"}], 
    ",", 
    RowBox[{"ColorData", "[", 
     RowBox[{"3", ",", "9"}], "]"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Style", "[", 
   RowBox[{
   "\"\<hypothetical combination, according to independent action\>\"", ",", 
    "Black"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "BYL719LLM871Prediction", "\[LeftDoubleBracket]", "3", 
   "\[RightDoubleBracket]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Hazard ratio (predicted combination vs BYL719 alone) = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"BYL719LLM871Prediction", "\[LeftDoubleBracket]", 
     RowBox[{"5", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<P-value = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"BYL719LLM871Prediction", "\[LeftDoubleBracket]", 
     RowBox[{"5", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6620920403487024`*^9, 3.6620920405007114`*^9}, {
  3.6620923779010096`*^9, 3.662092380917182*^9}, {3.6836393718735*^9, 
  3.6836393876184*^9}, {3.6836531140664988`*^9, 3.6836531140794992`*^9}, {
  3.683718891058255*^9, 3.6837189450333424`*^9}, {3.6837189909759703`*^9, 
  3.683719196456723*^9}}],

Cell[CellGroupData[{

Cell["Survival rates at 3 months :", "Subsubsection",
 CellChangeTimes->{{3.683639469130062*^9, 3.6836394923213887`*^9}}],

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"\"\<BYL719 PFS at 3 months = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugAresponsesInIntersection", "]"}], 
       "[", 
       RowBox[{"30.5", "*", "3"}], "]"}], "*", "100"}], "]"}], "]"}], "<>", 
   "\"\<%\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<LLM871 PFS at 3 months = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "DrugBresponsesInIntersection", "]"}], 
       "[", 
       RowBox[{"30.5", "*", "3"}], "]"}], "*", "100"}], "]"}], "]"}], "<>", 
   "\"\<%\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<predicted combination PFS at 3 months = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "DoublingFreeSurvival", "[", "BestOfMonotherapyResponses", "]"}], "[", 
       RowBox[{"30.5", "*", "3"}], "]"}], "*", "100"}], "]"}], "]"}], "<>", 
   "\"\<%\>\""}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6639131859705324`*^9, 3.6639132354513626`*^9}, {
  3.663914002178217*^9, 3.663914022954405*^9}, {3.683639494419509*^9, 
  3.683639589096924*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "sorting", " ", "drug", " ", "responses", " ", "and", " ", "model", " ", 
    "names", " ", "in", " ", "order", " ", "of", " ", "best", " ", "response",
     " ", "to", " ", "BYL719"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SortedResponses", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "DrugAresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "DrugBresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
           "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}], ">", 
         RowBox[{"#2", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"SortedModelNames", "=", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "1"}], 
     "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.664179901359028*^9, 3.6641799276295304`*^9}, {
  3.6678399142604656`*^9, 3.6678399145954847`*^9}, {3.6836395991604996`*^9, 
  3.6836396187426195`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GastricExampleBarChartPlot", "=", 
   RowBox[{"BarChart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}]}], 
       "}"}], "\[Transpose]"}], ",", 
     RowBox[{"BarOrigin", "\[Rule]", "Bottom"}], ",", 
     RowBox[{"Axes", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<PDX identity\>\"", ",", 
        "\"\<Progression free survival (months)\>\""}], "}"}]}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"Reverse", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"12", "*", 
                RowBox[{"61", "/", "2"}]}], ",", "61"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"61", "/", "2"}], ",", 
               RowBox[{"12", "*", 
                RowBox[{"61", "/", "2"}]}], ",", "61"}], "}"}]}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", ",", 
               RowBox[{"{", 
                RowBox[{"0.01", ",", "0.01"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"0", "+", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{
                RowBox[{"41", "*", "2"}], "+", 
                RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Rotate", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"SortedModelNames", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}], "/", "2"}], "-", 
                    RowBox[{"1", "/", "4"}]}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"FontSize", "\[Rule]", "8"}], ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Consolas\>\""}]}], 
                  "]"}], ",", 
                 RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"1", "+", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{
                RowBox[{"41", "*", "2"}], "+", 
                RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}]}], 
          "]"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"Reverse", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"11", "*", 
            RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"41", "*", "2"}], "+", 
            RowBox[{"1", "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "320", "}"}], ",", 
        RowBox[{"{", "1000", "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"BarSpacing", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 2B, PFS with BYL719 and LLM871.pdf\>\""}], ",", 
    "GastricExampleBarChartPlot", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682478156179289*^9, 3.682478199164747*^9}, {
   3.6836396537596226`*^9, 3.683639701937378*^9}, 3.715465057830079*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GastricExampleSurvivalPlot", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "DoublingFreeSurvival", "[", "UntreatedResponsesInIntersection", 
         "]"}], "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "DoublingFreeSurvival", "[", "DrugAresponsesInIntersection", "]"}], 
        "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "DoublingFreeSurvival", "[", "DrugBresponsesInIntersection", "]"}], 
        "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "DoublingFreeSurvival", "[", "BestOfMonotherapyResponses", "]"}], "[",
         "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "200"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"6", "*", 
           RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
     RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"3", ",", "4"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Untreated\>\"", ",", "DrugA", ",", "DrugB", ",", 
          "\"\<Minimal prediction\>\""}], "}"}]}], ","}], "*)"}], 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Progression free survival (months)\>\"", ",", 
        RowBox[{"Rotate", "[", 
         RowBox[{"\"\<PDX patients (%)\>\"", ",", "0"}], "]"}]}], "}"}]}], 
     ",", 
     RowBox[{"ImageSize", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "240", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"PlotLabel", "\[Rule]", "ModelName"}]}], "*)"}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "*", "100"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "1", ",", 
              RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"6", "*", 
               RowBox[{"61", "/", "2"}]}], ",", 
              RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"3", "/", "4"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"LineLegend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<Untreated\>\"", ",", "\"\<Alpelisib\>\"", ",", "\"\<LLM871\>\"",
           ",", "\"\<Hypothetical combination,\\nindependent action\>\""}], 
         "}"}], ",", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.25", ",", "0.4"}], "}"}]}], ",", 
        RowBox[{"LegendMarkerSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"20", ",", "12"}], "}"}]}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 2C, survival plot with BYL719 and LLM871.pdf\>\""}], ",", 
    "GastricExampleSurvivalPlot", ",", "\"\<PDF\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.674002229648492*^9, 3.674002230033514*^9}, {
   3.6740022837865887`*^9, 3.674002321610752*^9}, {3.6740024065476103`*^9, 
   3.6740024609157195`*^9}, {3.674002496741769*^9, 3.6740024981078467`*^9}, {
   3.6740026016757708`*^9, 3.6740026201248255`*^9}, {3.6740026647283773`*^9, 
   3.674002668210576*^9}, {3.6740030878845797`*^9, 3.674003094817977*^9}, 
   3.674732454338024*^9, 3.682474540749498*^9, {3.682476971015501*^9, 
   3.6824770956826315`*^9}, {3.6824777217644415`*^9, 3.682477729555887*^9}, {
   3.6836396255870113`*^9, 3.6836396259820337`*^9}, {3.6836396588449135`*^9, 
   3.683639674805826*^9}, {3.683639711268912*^9, 3.6836397159681807`*^9}, 
   3.7154650578370795`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Predictions from drug pairs in each tumor type\n",
 StyleBox["Note, this step is time-consuming",
  FontSize->18]
}], "Section",
 CellChangeTimes->{{3.6813485392073975`*^9, 3.6813485493399773`*^9}, {
  3.683644029643899*^9, 3.683644036227276*^9}}],

Cell[CellGroupData[{

Cell["Testing all possible pairs of monotherapies in melanoma", "Subsection",
 CellChangeTimes->{{3.661349315391923*^9, 3.6613493215412745`*^9}, {
  3.683642439461946*^9, 3.683642449021493*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllMelanomaPairs", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"IndependentActionPrediction", "[", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6613449339833207`*^9, 3.661344984535212*^9}, {
   3.661345201880644*^9, 3.661345205695862*^9}, {3.661871721657631*^9, 
   3.6618717249288177`*^9}, 3.683636454551638*^9, {3.6836531140955*^9, 
   3.6836531141105013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Response", " ", "correlations", " ", "between", " ", "all", " ", 
    "agents"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MelanomaResponseCorrelations", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "AllMelanomaPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Response", " ", "correlations", " ", "between", " ", "active", " ", 
     "agents", " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MelanomaResponseCorrelationsActiveAgentsOnly", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
            RowBox[{"MelanomaActiveAgents", ",", "MelanomaActiveAgents"}], 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
            RowBox[{"MelanomaActiveAgents", ",", "MelanomaActiveAgents"}], 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"histogram", " ", "of", " ", "hazard", " ", "ratios"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "5", ",", "1"}], 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0.05"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Hazard ratio (hypothetical combination vs best monotherapy)\>\"", 
        ",", "\"\<Count\>\""}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"EdgeForm", "[", "None", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6836427479175887`*^9, 3.6836427486496305`*^9}, {
  3.6836427801424317`*^9, 3.683642817257555*^9}, {3.683643131917552*^9, 
  3.6836431756030507`*^9}, {3.683643210750061*^9, 3.6836432340673947`*^9}}],

Cell[CellGroupData[{

Cell["\<\
In melanoma, the best \[OpenCurlyQuote]predicted \
combination\[CloseCurlyQuote] was among those experimentally tested and was \
the most effective observed combination in melanoma.
By independent action alone it is not expected to significantly improve on \
monotherapy (p=0.29); but it was observed to far surpass independent action \
(See Supplementary Figure S4D).\
\>", "Subsubsection",
 CellChangeTimes->{{3.6836433392984133`*^9, 3.683643378761671*^9}, {
   3.6836445217450457`*^9, 3.6836446055908413`*^9}, {3.6836446587758837`*^9, 
   3.6836446809961543`*^9}, 3.6836455220442595`*^9, {3.683649895837426*^9, 
   3.6836499112253065`*^9}, {3.683650126609626*^9, 3.6836501942374935`*^9}, {
   3.6856035019377503`*^9, 3.6856035020177546`*^9}, 3.71546839911919*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MelanomaBestPrediction", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MelanomaBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "MelanomaBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "MelanomaBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "MelanomaBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<{Hazard ratio, P value} = \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "MelanomaBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "MelanomaBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "5"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "MelanomaBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "MelanomaBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "3"}], 
  "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6613501733729963`*^9, 3.6613502374456615`*^9}, {
   3.661666335355115*^9, 3.6616663405944147`*^9}, {3.661871463153846*^9, 
   3.661871513636733*^9}, 3.6836426627947197`*^9, {3.6836446191066146`*^9, 
   3.683644643655019*^9}, {3.683644695852004*^9, 3.6836447282908597`*^9}, {
   3.6836448190940533`*^9, 3.683644824689373*^9}, {3.6836450807600193`*^9, 
   3.683645086025321*^9}, {3.6836453490953674`*^9, 3.683645353419615*^9}, {
   3.683653114123502*^9, 3.683653114127502*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing all possible pairs of monotherapies in NSCLC", "Subsection",
 CellChangeTimes->{{3.661349315391923*^9, 3.6613493215412745`*^9}, {
  3.6613493742212877`*^9, 3.661349374941329*^9}, {3.683644442899536*^9, 
  3.6836444504839697`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllNSCLCPairs", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"IndependentActionPrediction", "[", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6613449339833207`*^9, 3.661344984535212*^9}, {
   3.661345201880644*^9, 3.661345205695862*^9}, {3.6613493806856575`*^9, 
   3.661349399701745*^9}, 3.6836364545586386`*^9, {3.6836531141325026`*^9, 
   3.683653114145503*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Response", " ", "correlations", " ", "between", " ", "all", " ", 
    "agents"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NSCLCResponseCorrelations", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "AllNSCLCPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Response", " ", "correlations", " ", "between", " ", "active", " ", 
     "agents", " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NSCLCResponseCorrelationsActiveAgentsOnly", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"NSCLCActiveAgents", ",", "NSCLCActiveAgents"}], 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"NSCLCActiveAgents", ",", "NSCLCActiveAgents"}], 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"histogram", " ", "of", " ", "hazard", " ", "ratios"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "5", ",", "1"}], 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0.05"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Hazard ratio (hypothetical combination vs best monotherapy)\>\"", 
        ",", "\"\<Count\>\""}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"EdgeForm", "[", "None", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6836427479175887`*^9, 3.6836427486496305`*^9}, {
  3.6836427801424317`*^9, 3.683642817257555*^9}, {3.683643131917552*^9, 
  3.6836431756030507`*^9}, {3.683643210750061*^9, 3.6836432340673947`*^9}, {
  3.6836440759155455`*^9, 3.683644110989552*^9}}],

Cell[CellGroupData[{

Cell["\<\
In NSCLC, the best \[OpenCurlyQuote]predicted combination\[CloseCurlyQuote] \
was among those experimentally tested and was the most effective observed \
combination in NSCLC (tied for efficacy with LFW527 + binimetinib).
Although, from independent action alone there was not a statistically \
significant expectation of benefit (p=0.23), and its observed effect was \
indeed not significantly superior to binimetinib monotherapy.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6836433392984133`*^9, 3.683643378761671*^9}, {
  3.6836445217450457`*^9, 3.6836446055908413`*^9}, {3.6836446587758837`*^9, 
  3.6836446809961543`*^9}, {3.68364485085487*^9, 3.6836448732091484`*^9}, {
  3.683645399035224*^9, 3.6836455105566025`*^9}, {3.6836502101434035`*^9, 
  3.6836503522705326`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSCLCBestPrediction", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSCLCBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "NSCLCBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "NSCLCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "NSCLCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<{Hazard ratio, P value} = \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "NSCLCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "NSCLCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "5"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "NSCLCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "NSCLCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "3"}], 
  "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6613501733729963`*^9, 3.6613502696855054`*^9}, {
  3.661350305454551*^9, 3.661350337285372*^9}, {3.661871494305627*^9, 
  3.6618715055862722`*^9}, {3.6836447611627398`*^9, 3.683644808777463*^9}, {
  3.6836450705274343`*^9, 3.6836450753907127`*^9}, {3.6836453573478394`*^9, 
  3.683645365082282*^9}, {3.6836531141575036`*^9, 3.683653114162504*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing all possible pairs of monotherapies in PDAC", "Subsection",
 CellChangeTimes->{{3.661349315391923*^9, 3.6613493215412745`*^9}, {
  3.6613493742212877`*^9, 3.661349374941329*^9}, {3.683644442899536*^9, 
  3.683644459983513*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllPDACPairs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"IndependentActionPrediction", "[", 
      RowBox[{
       RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
        RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
        RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
       "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
        "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
        "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6613449339833207`*^9, 3.661344984535212*^9}, {
   3.661345201880644*^9, 3.661345205695862*^9}, {3.6613493806856575`*^9, 
   3.661349399701745*^9}, {3.661666377354517*^9, 3.6616663857869997`*^9}, {
   3.661666475935156*^9, 3.661666494474216*^9}, {3.6618626563220816`*^9, 
   3.6618626586822166`*^9}, 3.683636454565639*^9, {3.6836531141685047`*^9, 
   3.683653114180505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Response", " ", "correlations", " ", "between", " ", "all", " ", 
    "agents"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PDACResponseCorrelations", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "AllPDACPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Response", " ", "correlations", " ", "between", " ", "active", " ", 
     "agents", " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACResponseCorrelationsActiveAgentsOnly", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
            RowBox[{"PDACActiveAgents", ",", "PDACActiveAgents"}], 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
            RowBox[{"PDACActiveAgents", ",", "PDACActiveAgents"}], 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"histogram", " ", "of", " ", "hazard", " ", "ratios"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "5", ",", "1"}], 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0.05"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Hazard ratio (hypothetical combination vs best monotherapy)\>\"", 
        ",", "\"\<Count\>\""}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"EdgeForm", "[", "None", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6836427479175887`*^9, 3.6836427486496305`*^9}, {
  3.6836427801424317`*^9, 3.683642817257555*^9}, {3.683643131917552*^9, 
  3.6836431756030507`*^9}, {3.683643210750061*^9, 3.6836432340673947`*^9}, {
  3.6836440759155455`*^9, 3.6836441521709075`*^9}}],

Cell[CellGroupData[{

Cell["Best predicted combination in PDAC:", "Subsubsection",
 CellChangeTimes->{{3.6836433392984133`*^9, 3.683643378761671*^9}, {
  3.6836445217450457`*^9, 3.6836446055908413`*^9}, {3.6836446587758837`*^9, 
  3.6836446809961543`*^9}, {3.68364485085487*^9, 3.6836448732091484`*^9}, {
  3.6836449308824472`*^9, 3.683644958428023*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PDACBestPrediction", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PDACBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "PDACBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "PDACBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "PDACBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<{Hazard ratio, P value} = \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "PDACBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "PDACBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "5"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "PDACBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "PDACBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "3"}], 
  "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6613501733729963`*^9, 3.6613502696855054`*^9}, {
  3.661350305454551*^9, 3.661350337285372*^9}, {3.6616663892161956`*^9, 
  3.6616663914483232`*^9}, {3.661871537209081*^9, 3.661871549581789*^9}, {
  3.683644899623659*^9, 3.6836449180577135`*^9}, {3.6836449904388533`*^9, 
  3.683645001110464*^9}, {3.683645061871939*^9, 3.6836450667042155`*^9}, {
  3.683645111348769*^9, 3.6836451116217847`*^9}, {3.683645224815259*^9, 
  3.683645224958267*^9}, {3.683645370245577*^9, 3.6836453752238617`*^9}, {
  3.6836531141945057`*^9, 3.6836531142065067`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Testing all possible pairs of monotherapies in Colorectal carcinoma\
\>", "Subsection",
 CellChangeTimes->{{3.661349315391923*^9, 3.6613493215412745`*^9}, {
  3.6613493742212877`*^9, 3.661349374941329*^9}, {3.683644442899536*^9, 
  3.6836444738313055`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllCRCPairs", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"IndependentActionPrediction", "[", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6613449339833207`*^9, 3.661344984535212*^9}, {
   3.661345201880644*^9, 3.661345205695862*^9}, {3.6613493806856575`*^9, 
   3.661349399701745*^9}, {3.6613495663422766`*^9, 3.6613495751177783`*^9}, {
   3.6613496112328444`*^9, 3.661349611366852*^9}, 3.661349726159417*^9, 
   3.683636454570639*^9, {3.683653114211507*^9, 3.683653114223508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Response", " ", "correlations", " ", "between", " ", "all", " ", 
    "agents"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CRCResponseCorrelations", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "AllCRCPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Response", " ", "correlations", " ", "between", " ", "active", " ", 
     "agents", " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCResponseCorrelationsActiveAgentsOnly", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"CRCActiveAgents", ",", "CRCActiveAgents"}], 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"CRCActiveAgents", ",", "CRCActiveAgents"}], 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"histogram", " ", "of", " ", "hazard", " ", "ratios"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "5", ",", "1"}], 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0.05"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Hazard ratio (hypothetical combination vs best monotherapy)\>\"", 
        ",", "\"\<Count\>\""}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"EdgeForm", "[", "None", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6836427479175887`*^9, 3.6836427486496305`*^9}, {
  3.6836427801424317`*^9, 3.683642817257555*^9}, {3.683643131917552*^9, 
  3.6836431756030507`*^9}, {3.683643210750061*^9, 3.6836432340673947`*^9}, {
  3.6836440759155455`*^9, 3.6836441521709075`*^9}, {3.6836442021767673`*^9, 
  3.683644210050218*^9}}],

Cell[CellGroupData[{

Cell["Best predicted combination in CRC:", "Subsubsection",
 CellChangeTimes->{{3.6836433392984133`*^9, 3.683643378761671*^9}, {
  3.6836445217450457`*^9, 3.6836446055908413`*^9}, {3.6836446587758837`*^9, 
  3.6836446809961543`*^9}, {3.68364485085487*^9, 3.6836448732091484`*^9}, {
  3.6836449308824472`*^9, 3.683644958428023*^9}, {3.683645158362458*^9, 
  3.683645158772482*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CRCBestPrediction", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CRCBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "CRCBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "CRCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "CRCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<{Hazard ratio, P value} = \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "CRCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "CRCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "5"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "CRCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "CRCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "3"}], 
  "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6613501733729963`*^9, 3.6613502696855054`*^9}, {
   3.661350305454551*^9, 3.661350337285372*^9}, {3.661350426806492*^9, 
   3.6613504285975943`*^9}, {3.6618715648026595`*^9, 
   3.6618715782104263`*^9}, {3.6836449767600713`*^9, 
   3.6836449807122974`*^9}, {3.6836450239367695`*^9, 
   3.6836450508903112`*^9}, {3.6836451340370665`*^9, 
   3.6836451391853614`*^9}, {3.683645213927636*^9, 3.683645215128705*^9}, {
   3.6836453201017094`*^9, 3.6836453222738333`*^9}, 3.6836453831883173`*^9, {
   3.6836531142395086`*^9, 3.683653114245509*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing all possible pairs of monotherapies in Breast cancer", \
"Subsection",
 CellChangeTimes->{{3.661349315391923*^9, 3.6613493215412745`*^9}, {
  3.6613493742212877`*^9, 3.661349374941329*^9}, {3.683644442899536*^9, 
  3.683644486747044*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllBCPairs", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"IndependentActionPrediction", "[", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6613449339833207`*^9, 3.661344984535212*^9}, {
   3.661345201880644*^9, 3.661345205695862*^9}, {3.6613493806856575`*^9, 
   3.661349399701745*^9}, {3.6613495663422766`*^9, 3.6613495751177783`*^9}, {
   3.6613496112328444`*^9, 3.661349611366852*^9}, 3.661349726159417*^9, {
   3.661349927805951*^9, 3.66134993828555*^9}, 3.6836364545776396`*^9, {
   3.683653114252509*^9, 3.68365311427151*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Response", " ", "correlations", " ", "between", " ", "all", " ", 
    "agents"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BCResponseCorrelations", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "AllBCPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Response", " ", "correlations", " ", "between", " ", "active", " ", 
     "agents", " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCResponseCorrelationsActiveAgentsOnly", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"BreastActiveAgents", ",", "BreastActiveAgents"}], 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"BreastActiveAgents", ",", "BreastActiveAgents"}], 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"histogram", " ", "of", " ", "hazard", " ", "ratios"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "5", ",", "1"}], 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0.05"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Hazard ratio (hypothetical combination vs best monotherapy)\>\"", 
        ",", "\"\<Count\>\""}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"EdgeForm", "[", "None", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6836427479175887`*^9, 3.6836427486496305`*^9}, {
  3.6836427801424317`*^9, 3.683642817257555*^9}, {3.683643131917552*^9, 
  3.6836431756030507`*^9}, {3.683643210750061*^9, 3.6836432340673947`*^9}, {
  3.6836440759155455`*^9, 3.6836441521709075`*^9}, {3.6836442021767673`*^9, 
  3.683644210050218*^9}, {3.6836442413240066`*^9, 3.68364426952662*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCBestPrediction", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "BCBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "BCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "BCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<{Hazard ratio, P value} = \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "BCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "BCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "5"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "BCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "BCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "3"}], 
  "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.661350624661809*^9, 3.6613506346703815`*^9}, {
  3.6618715848568068`*^9, 3.6618715951733966`*^9}, {3.683644287997676*^9, 
  3.6836442883546968`*^9}, {3.683645178214594*^9, 3.6836452074792676`*^9}, {
  3.683645298177455*^9, 3.6836453294102416`*^9}, {3.683653114287511*^9, 
  3.6836531142925115`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Testing all possible pairs of monotherapies in Gastric cancer\
\>", "Subsection",
 CellChangeTimes->{{3.661349315391923*^9, 3.6613493215412745`*^9}, {
  3.6613493742212877`*^9, 3.661349374941329*^9}, {3.683644442899536*^9, 
  3.6836444958395643`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "6"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllGCPairs", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"IndependentActionPrediction", "[", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
          "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6613449339833207`*^9, 3.661344984535212*^9}, {
   3.661345201880644*^9, 3.661345205695862*^9}, {3.6613493806856575`*^9, 
   3.661349399701745*^9}, {3.6613495663422766`*^9, 3.6613495751177783`*^9}, {
   3.6613496112328444`*^9, 3.661349611366852*^9}, 3.661349726159417*^9, {
   3.6613507211663284`*^9, 3.6613507323889704`*^9}, 3.68363645458364*^9, {
   3.6836531142985115`*^9, 3.683653114316513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Response", " ", "correlations", " ", "between", " ", "all", " ", 
    "agents"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GCResponseCorrelations", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "AllGCPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Response", " ", "correlations", " ", "between", " ", "active", " ", 
     "agents", " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GCResponseCorrelationsActiveAgentsOnly", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"GastricActiveAgents", ",", "GastricActiveAgents"}], 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"GastricActiveAgents", ",", "GastricActiveAgents"}], 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"histogram", " ", "of", " ", "hazard", " ", "ratios"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "5", ",", "1"}], 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0.05"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Hazard ratio (hypothetical combination vs best monotherapy)\>\"", 
        ",", "\"\<Count\>\""}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"EdgeForm", "[", "None", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6836427479175887`*^9, 3.6836427486496305`*^9}, {
  3.6836427801424317`*^9, 3.683642817257555*^9}, {3.683643131917552*^9, 
  3.6836431756030507`*^9}, {3.683643210750061*^9, 3.6836432340673947`*^9}, {
  3.6836440759155455`*^9, 3.6836441521709075`*^9}, {3.6836442021767673`*^9, 
  3.683644210050218*^9}, {3.6836443154352455`*^9, 3.683644332857242*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GCBestPrediction", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GCBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "GCBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "GCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", 
   RowBox[{
   "GCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<{Hazard ratio, P value} = \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "GCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "GCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "5"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
  RowBox[{
   RowBox[{
   "GCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "GCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], ",", "3"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6613501733729963`*^9, 3.6613502696855054`*^9}, {
  3.661350305454551*^9, 3.661350337285372*^9}, {3.661350426806492*^9, 
  3.6613504285975943`*^9}, {3.6613507357721643`*^9, 3.661350737364255*^9}, {
  3.661488665303978*^9, 3.661488687168228*^9}, {3.6614887336158853`*^9, 
  3.661488738792181*^9}, {3.6618716084121537`*^9, 3.661871618921755*^9}, {
  3.6836452430042996`*^9, 3.6836452797984037`*^9}, {3.683645332597424*^9, 
  3.6836453336574845`*^9}, {3.683653114335514*^9, 3.6836531143425145`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting hazard ratios of all hypothetical combinations", "Section",
 CellChangeTimes->{{3.681350116575618*^9, 3.681350130844434*^9}, {
  3.6836464435259657`*^9, 3.6836464443480124`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MelanomaAllCombinationsHazardRatios", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", 
         RowBox[{"Length", "[", "AllMelanomaPairs", "]"}]}], "}"}]}], "]"}], 
     ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSCLCAllCombinationsHazardRatios", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", 
         RowBox[{"Length", "[", "AllNSCLCPairs", "]"}]}], "}"}]}], "]"}], ",",
      "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PDACAllCombinationsHazardRatios", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", 
         RowBox[{"Length", "[", "AllPDACPairs", "]"}]}], "}"}]}], "]"}], ",", 
     "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CRCAllCombinationsHazardRatios", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", 
         RowBox[{"Length", "[", "AllCRCPairs", "]"}]}], "}"}]}], "]"}], ",", 
     "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCAllCombinationsHazardRatios", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", 
         RowBox[{"Length", "[", "AllBCPairs", "]"}]}], "}"}]}], "]"}], ",", 
     "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GCAllCombinationsHazardRatios", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", 
            RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j", ",", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "AllGCPairs", "]"}]}], "}"}]}], "]"}], ",", 
      "1"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllCombinationsHazardRatios", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
    "MelanomaAllCombinationsHazardRatios", ",", "\[IndentingNewLine]", 
     "NSCLCAllCombinationsHazardRatios", ",", "\[IndentingNewLine]", 
     "PDACAllCombinationsHazardRatios", ",", "\[IndentingNewLine]", 
     "CRCAllCombinationsHazardRatios", ",", "\[IndentingNewLine]", 
     "BCAllCombinationsHazardRatios", ",", "\[IndentingNewLine]", 
     "GCAllCombinationsHazardRatios"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6814276258995943`*^9, 3.68142769051529*^9}, {
  3.681427769835827*^9, 3.681427873129735*^9}, {3.683646450892387*^9, 
  3.683646456480706*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"For", " ", "each", " ", "predicted", " ", "combination"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"the", " ", "P"}], "-", 
     RowBox[{
     "value", " ", "for", " ", "a", " ", "significant", " ", "improvement", 
      " ", "in", " ", "hazard", " ", "ratio", " ", 
      RowBox[{"(", 
       RowBox[{
       "by", " ", "Cox", " ", "proportional", " ", "hazards", " ", "model"}], 
       ")"}], " ", "is", " ", "closely", " ", "related", " ", "to", " ", 
      "the", " ", "hazard", " ", 
      RowBox[{"ratio", ".", " ", "We"}], " ", "fit", " ", "a", " ", 
      "function", " ", "to", " ", "this", " ", "relationship"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "in", " ", "order", " ", "to", " ", "color", " ", "the", " ", 
      "histogram", " ", "of", " ", "hazard", " ", "ratio", " ", "by", " ", 
      "the", " ", "approximate", " ", "P"}], "-", 
     RowBox[{
     "value", " ", "of", " ", "the", " ", "predictions", " ", "in", " ", 
      RowBox[{"each", " ", "'"}], 
      RowBox[{"bin", "'"}], " ", "of", " ", "hazard", " ", "ratios"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QuadraticFit", "=", 
     RowBox[{"FindFit", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AllCombinationsHazardRatios", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"10", ",", 
               RowBox[{"AllCombinationsHazardRatios", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "3", ",", "2"}], 
                "\[RightDoubleBracket]"}]}], "]"}]}]}], "}"}], 
          "\[Transpose]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
           "1"}], "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "*", 
          SuperscriptBox["x", "2"]}], "+", 
         RowBox[{"b", "*", "x"}], "+", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"AllCombinationsHazardRatios", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{"10", ",", 
             RowBox[{"AllCombinationsHazardRatios", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "3", ",", "2"}], 
              "\[RightDoubleBracket]"}]}], "]"}]}]}], "}"}], "\[Transpose]"}],
        ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.4"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Hazard ratio (combination vs. best monotherapy)\>\"", ",", 
          "\"\<-\!\(\*SubscriptBox[\(Log\), \(10\)]\) P  for improvement in \
hazard ratio\>\""}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Red", ",", 
          RowBox[{"AbsolutePointSize", "[", "3", "]"}]}], "]"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"3", "/", "4"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1000", "}"}], ",", 
          RowBox[{"{", "250", "}"}]}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "*", 
           SuperscriptBox["x", "2"]}], "+", 
          RowBox[{"b", "*", "x"}], "+", "c"}], ")"}], "/.", "QuadraticFit"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "5"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6814292539057107`*^9, 3.681429264283304*^9}, {
  3.681429323772707*^9, 3.6814293620998993`*^9}, {3.6814325315721827`*^9, 
  3.6814325323892293`*^9}, {3.681433780797634*^9, 3.6814337986926575`*^9}, {
  3.683646534275156*^9, 3.683646550672094*^9}, {3.6836466496117525`*^9, 
  3.683646898377981*^9}, {3.683647805935891*^9, 3.6836478177865686`*^9}, {
  3.6836478514924965`*^9, 3.6836478893966646`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"defining", " ", "a", " ", "custom", " ", "color", " ", "scale"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "ColorData", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ColorData", "[", "\"\<PValue\>\"", "]"}], "=", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0.025", ",", "0.05", ",", "0.1", ",", "0.2", ",", 
              "0.275", ",", "0.325", ",", "1.0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Orange", ",", "Yellow"}], "}"}], ",", "0.85"}], 
               "]"}], ",", 
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Orange", ",", "Yellow"}], "}"}], ",", "0.85"}], 
               "]"}], ",", 
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Orange", ",", "Yellow"}], "}"}], ",", "0.5"}], 
               "]"}], ",", "Red", ",", 
              RowBox[{"Darker", "[", 
               RowBox[{"Red", ",", "0.3"}], "]"}], ",", 
              RowBox[{"Darker", "[", 
               RowBox[{"Red", ",", "0.6"}], "]"}], ",", 
              RowBox[{"GrayLevel", "[", "0.1", "]"}], ",", 
              RowBox[{"GrayLevel", "[", "0.1", "]"}]}], "}"}]}], "}"}], "]"}],
          ",", "x"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Protect", "[", "ColorData", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "function", " ", "allows", " ", "each", " ", "bar", " ", 
      "in", " ", "the", " ", "histogram", " ", "to", " ", "be", " ", 
      "colored", " ", "according", " ", "to", " ", "the", " ", "P"}], "-", 
     RowBox[{
     "value", " ", "of", " ", "the", " ", "combinations", " ", "in", " ", 
      "that", " ", "bar"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CustomChartElementFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xmin_", ",", "xmax_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ymin_", ",", "ymax_"}], "}"}]}], "}"}], ",", "___"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<PValue\>\"", "]"}], "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"xmax", ">", "1"}], ",", "1", ",", 
         RowBox[{"10", "^", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "*", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xmin", "/", "2"}], "+", 
                   RowBox[{"xmax", "/", "2"}]}], ")"}], "2"]}], "+", 
               RowBox[{"b", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"xmin", "/", "2"}], "+", 
                  RowBox[{"xmax", "/", "2"}]}], ")"}]}], "+", "c"}], ")"}], "/.",
              "QuadraticFit"}], ")"}]}]}]}], "]"}], "]"}], ",", 
      RowBox[{"Dynamic", "@", 
       RowBox[{"EdgeForm", "[", "None", "]"}]}], ",", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xmin", ",", "ymin"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xmax", ",", "ymax"}], "}"}], ",", 
        RowBox[{"RoundingRadius", "\[Rule]", "0"}]}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "plotting", " ", "a", " ", "histogram", " ", "of", " ", "hazard", " ", 
     "ratios"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"HRHistogram", "=", 
    RowBox[{"Histogram", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"#", ",", "2.5"}], "}"}], "]"}], "&"}], ",", 
        RowBox[{"AllCombinationsHazardRatios", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}]}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "2.55", ",", "0.05"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2.55"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{
      "ChartElementFunction", "\[Rule]", "CustomChartElementFunction"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "2", ",", "0.5"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"2.5", ",", "\"\<2.5+\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.015"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "100", ",", "10"}], "}"}]}], "]"}]}], 
        "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Hazard Ratio (combination vs. best monotherapy)\>\"", ",", 
         "\"\<Number of combinations\>\""}], "}"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"3", "/", "5"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1000", "}"}], ",", 
         RowBox[{"{", "220", "}"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 5A, Hazard ratio of predicted combinations.pdf\>\""}], ",",
       "HRHistogram", ",", "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6814278847884016`*^9, 3.6814280233633275`*^9}, {
   3.6814288280533533`*^9, 3.6814288368198547`*^9}, {3.68142899531192*^9, 
   3.6814290038514085`*^9}, {3.6814290859681053`*^9, 3.681429092945504*^9}, {
   3.681429170917964*^9, 3.6814292054119368`*^9}, {3.681432754888955*^9, 
   3.681432798925474*^9}, {3.681432971077321*^9, 3.681432977269675*^9}, {
   3.681433678922807*^9, 3.6814337046552787`*^9}, {3.6814338089192424`*^9, 
   3.681433857564025*^9}, {3.681434166485694*^9, 3.681434312845065*^9}, {
   3.681435028261985*^9, 3.681435105440399*^9}, {3.6814351412934504`*^9, 
   3.6814351945654964`*^9}, {3.6814352806784225`*^9, 
   3.6814352808524323`*^9}, {3.681435423405586*^9, 3.681435489362358*^9}, {
   3.681435590182125*^9, 3.6814356341496396`*^9}, {3.681435665374426*^9, 
   3.681435691260906*^9}, {3.6814359090233617`*^9, 3.6814359093013773`*^9}, {
   3.681435949414672*^9, 3.681435955077996*^9}, {3.681436119951426*^9, 
   3.6814361972738485`*^9}, {3.6814441254123125`*^9, 3.681444174552123*^9}, {
   3.681444861358406*^9, 3.6814449013336926`*^9}, {3.681445850274969*^9, 
   3.6814458930574155`*^9}, {3.6814467131463223`*^9, 
   3.6814467195126863`*^9}, {3.68144699704156*^9, 3.68144699790961*^9}, {
   3.6836465719473104`*^9, 3.6836466231552396`*^9}, {3.683646903891297*^9, 
   3.683646911976759*^9}, {3.6836470337667255`*^9, 3.6836470464874525`*^9}, {
   3.683647910862892*^9, 3.683647943328749*^9}, {3.6855758728668857`*^9, 
   3.6855758768341126`*^9}, 3.715465057880082*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HRHistogramZoom", "=", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"{", 
          RowBox[{"#", ",", "2.5"}], "}"}], "]"}], "&"}], ",", 
       RowBox[{"AllCombinationsHazardRatios", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", 
       RowBox[{"1.0", "-", 
        RowBox[{"4", "*", "0.05"}]}], ",", "0.05"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.575", ",", "0.8"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "11.3"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{
     "ChartElementFunction", "\[Rule]", "CustomChartElementFunction"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.05"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.05"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "30", ",", "5"}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.03"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "30", ",", "1"}], "}"}]}], "]"}]}], 
         "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\>\"", ",", "\"\<Number of combinations\>\""}], "}"}]}], 
     ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "2"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1000", "}"}], ",", 
        RowBox[{"{", "220", "}"}]}], "}"}]}], ",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "a", " ", "white", " ", "sinusoid", " ", 
        "over", " ", "the", " ", "top", " ", "of", " ", "the", " ", "highest",
         " ", "bar", " ", "to", " ", "indicate", " ", "that", " ", "the", " ",
         "vertical", " ", "scale", " ", "is", " ", "truncated"}], " ", "*)"}], 
      RowBox[{"{", 
       RowBox[{"White", ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.7", "+", 
                  RowBox[{
                   RowBox[{"\[Theta]", "/", 
                    RowBox[{"(", 
                    RowBox[{"6.4", "\[Pi]"}], ")"}]}], "*", "0.1"}]}], ",", 
                 RowBox[{"11", "+", 
                  RowBox[{"0.14", "*", 
                   RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "0", ",", 
                 RowBox[{"6.4", "\[Pi]"}], ",", "0.2"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.7", ",", "13"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.8", ",", "13"}], "}"}]}], "]"}], "]"}]}], "}"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 5A, zoomed.pdf\>\""}], ",", "HRHistogramZoom", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.685573116296219*^9, 3.685573271931121*^9}, {
   3.6855733360947905`*^9, 3.6855734369785604`*^9}, {3.68557492218651*^9, 
   3.6855749309060087`*^9}, {3.6855750307867217`*^9, 3.685575033001848*^9}, {
   3.68557521084402*^9, 3.6855752305791492`*^9}, {3.685575306075467*^9, 
   3.6855753529471483`*^9}, {3.6855754178058577`*^9, 
   3.6855755351315684`*^9}, {3.6855755661473427`*^9, 3.685575584899415*^9}, {
   3.6855757697959905`*^9, 3.685575811971403*^9}, {3.685575901142503*^9, 
   3.685575984416266*^9}, 3.6857693991059637`*^9, 3.715465057890083*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"color", " ", "scale"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HRHistogramColorScale", "=", 
    RowBox[{
     RowBox[{"ContourPlot", "[", 
      RowBox[{"y", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "0.5"}], "}"}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<PValue\>\"", "]"}], "[", "#", "]"}],
           "&"}], ")"}]}], ",", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
       RowBox[{"Contours", "\[Rule]", "50"}], ",", 
       RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "10"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.25"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "0.5", ",", "0.1"}], "}"}]}], 
             "]"}], ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"100", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"10", ",", "10"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "500", "}"}], ",", 
          RowBox[{"{", "160", "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{",", "\"\<P-value for Hazard Ratio <1\>\""}], "}"}]}], ",", 
       RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "]"}], ",", 
         RowBox[{"r_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "RGBColor", ",", "Hue", ",", "CMYKColor", ",", "GrayLevel"}], 
               "}"}], ",", 
              RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}], ")"}]}], ",", 
         "i___"}], "}"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "r", "]"}], ",", "r", ",", "i"}], "}"}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 5A, color scale.pdf\>\""}], ",", "HRHistogramColorScale", 
      ",", "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.68143291249297*^9, 3.681432930314989*^9}, {
   3.681432997346823*^9, 3.681433045682588*^9}, {3.6814335346525555`*^9, 
   3.6814335444151134`*^9}, {3.681433595677046*^9, 3.6814335960920696`*^9}, {
   3.681434334531306*^9, 3.6814343490361357`*^9}, {3.681434403716263*^9, 
   3.6814345243811646`*^9}, {3.681434587853795*^9, 3.681434669574469*^9}, {
   3.681434736150277*^9, 3.681434761708739*^9}, {3.6814348429983883`*^9, 
   3.681434871651027*^9}, {3.6814449384878173`*^9, 3.6814449464282713`*^9}, {
   3.6814467373487062`*^9, 3.6814467420229735`*^9}, {3.681447008746229*^9, 
   3.681447021435955*^9}, {3.6824809134859977`*^9, 3.6824809200013704`*^9}, {
   3.683646922371354*^9, 3.6836469226543703`*^9}, {3.6836469674699335`*^9, 
   3.6836469701720877`*^9}, {3.6855759915056715`*^9, 3.6855759962319417`*^9}, 
   3.685769401761116*^9, 3.715465057899083*^9}],

Cell[CellGroupData[{

Cell["\<\
If we call a P-value of 0.2 as a \[OpenCurlyQuote]trend towards significance\
\[CloseCurlyQuote], then only 10 out of 566 possible combinations even trend \
towards significance.
This is ~2% of all possible combinations, or ~4% of all combinations of \
individually active agents\
\>", "Subsubsection",
 CellChangeTimes->{{3.683647158385853*^9, 3.6836472279228306`*^9}, {
  3.683648320502322*^9, 3.6836483297738523`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PValueForTrendingToSignificance", "=", "0.2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberOfPossibleCombinationsOfActiveAgents", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "MelanomaActiveAgents", "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "MelanomaActiveAgents", "]"}], "-", "1"}], 
        ")"}], "/", "2"}]}], "+", 
     RowBox[{
      RowBox[{"Length", "[", "NSCLCActiveAgents", "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "NSCLCActiveAgents", "]"}], "-", "1"}], ")"}],
        "/", "2"}]}], "+", 
     RowBox[{
      RowBox[{"Length", "[", "PDACActiveAgents", "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "PDACActiveAgents", "]"}], "-", "1"}], ")"}], 
       "/", "2"}]}], "+", 
     RowBox[{
      RowBox[{"Length", "[", "CRCActiveAgents", "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "CRCActiveAgents", "]"}], "-", "1"}], ")"}], 
       "/", "2"}]}], "+", 
     RowBox[{
      RowBox[{"Length", "[", "BreastActiveAgents", "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "BreastActiveAgents", "]"}], "-", "1"}], 
        ")"}], "/", "2"}]}], "+", 
     RowBox[{
      RowBox[{"Length", "[", "GastricActiveAgents", "]"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "GastricActiveAgents", "]"}], "-", "1"}], 
        ")"}], "/", "2"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CombinationsWithHRpvaluezeropointtwo", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
      "AllCombinationsHazardRatios", "\[LeftDoubleBracket]", "All", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "\[LessEqual]", 
         "1"}], "&&", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "\[LessEqual]", 
         "PValueForTrendingToSignificance"}]}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total number of hypothetical combinations = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Length", "[", "AllCombinationsHazardRatios", "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Number of hypothetical combinations of individually active agents = \>\
\"", "<>", 
   RowBox[{
   "ToString", "[", "NumberOfPossibleCombinationsOfActiveAgents", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Number of hypothetical combinations that trend to significant \
improvement in hazard ratio = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"Length", "[", "CombinationsWithHRpvaluezeropointtwo", "]"}], 
     "]"}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Percentage of all hypothetical combinations that trend to significant \
improvement in hazard ratio = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "CombinationsWithHRpvaluezeropointtwo", "]"}], 
      "/", 
      RowBox[{"Length", "[", "AllCombinationsHazardRatios", "]"}]}], "*", 
     "100."}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Percentage of all hypothetical combinations of individually active \
agents that trend to significant improvement in hazard ratio = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "CombinationsWithHRpvaluezeropointtwo", "]"}], 
      "/", "NumberOfPossibleCombinationsOfActiveAgents"}], "*", "100."}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.68135047782728*^9, 3.6813505099651184`*^9}, {
  3.681351356628545*^9, 3.6813514011320906`*^9}, {3.681427490308839*^9, 
  3.681427528009995*^9}, {3.6836471128602495`*^9, 3.683647157495802*^9}, {
  3.683647341698338*^9, 3.6836474977722645`*^9}, {3.683648161448225*^9, 
  3.6836481684876275`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Charts of predicted combinations (Figure 5B)", "Section",
 CellChangeTimes->{{3.667839890823125*^9, 3.6678398997866383`*^9}, {
  3.683645548691784*^9, 3.68364557502929*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NameSubstitutions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<LEE011\>\"", "\[Rule]", "\"\<Ribociclib\>\""}], ",", 
     RowBox[{"\"\<BKM120\>\"", "\[Rule]", "\"\<Buparlisib\>\""}], ",", 
     RowBox[{"\"\<BYL719\>\"", "\[Rule]", "\"\<Alpelisib\>\""}], ",", 
     RowBox[{"\"\<encorafenib\>\"", "\[Rule]", "\"\<Encorafenib\>\""}], ",", 
     RowBox[{"\"\<binimetinib\>\"", "\[Rule]", "\"\<Binimetinib\>\""}], ",", 
     RowBox[{"\"\<paclitaxel\>\"", "\[Rule]", "\"\<Paclitaxel\>\""}], ",", 
     RowBox[{"\"\<gemcitabine\>\"", "\[Rule]", "\"\<Gemcitabine\>\""}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6740064884180794`*^9, 3.6740065091852674`*^9}}],

Cell[CellGroupData[{

Cell["PDAC", "Subsection",
 CellChangeTimes->{{3.667841277472437*^9, 3.6678413923460073`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ModelNames", "\[LeftDoubleBracket]", "tumortype", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionPrediction", "[", 
     RowBox[{
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "3", 
    "\[RightDoubleBracket]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortedResponses", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "DrugAresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "DrugBresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}], ">", 
       RowBox[{"#2", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SortedModelNames", "=", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"$FrontEndSession", ",", 
    RowBox[{"PrintingStyleEnvironment", "\[Rule]", "\"\<Working\>\""}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarChart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}]}], 
      "}"}], "\[Transpose]"}], ",", 
    RowBox[{"BarOrigin", "\[Rule]", "Left"}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<PDX identity\>\"", ",", 
       "\"\<Progression free survival (months)\>\""}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.008"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"0", "+", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], 
              "+", 
              RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"SortedModelNames", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"i", "/", "2"}], "+", 
                 RowBox[{"1", "/", "4"}]}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"FontSize", "\[Rule]", "7"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Consolas\>\""}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], 
              "+", 
              RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}]}], 
        "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "4"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], "+", 
          RowBox[{"1", "/", "2"}]}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"120", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"BarSpacing", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"ChartLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
            RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
           "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
            RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
           "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], "}"}]}], "/.", "NameSubstitutions"}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<\[Rho] = \>\"", "<>", 
             RowBox[{"ToString", "[", "RankCorrelation", "]"}]}], ",", 
            RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.98", ",", "0.98"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], "*)"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Figure 5B,\>\"", "<>", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], "<>", 
     "\"\< best prediction barchart.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667840138385285*^9, 3.6678401437375913`*^9}, {
   3.667840423443589*^9, 3.667840423521594*^9}, {3.6678409292455196`*^9, 
   3.667840940491163*^9}, 3.6678410450621443`*^9, {3.6719061317709475`*^9, 
   3.6719061357021723`*^9}, {3.67190633078333*^9, 3.6719063309323387`*^9}, {
   3.6719064835110655`*^9, 3.671906483614072*^9}, {3.6719076711329937`*^9, 
   3.6719076719160385`*^9}, {3.6719077488964415`*^9, 3.671907754234747*^9}, {
   3.674005415164693*^9, 3.6740054154837112`*^9}, {3.674005472092949*^9, 
   3.674005472410967*^9}, 3.6740055996232433`*^9, {3.674006467357875*^9, 
   3.6740064718581324`*^9}, {3.6742902478223305`*^9, 3.674290326629838*^9}, {
   3.6747324564280295`*^9, 3.6747324564280295`*^9}, {3.6748298355537357`*^9, 
   3.6748298426147456`*^9}, {3.6824799213702517`*^9, 3.6824799757553625`*^9}, 
   3.683519332198565*^9, {3.683600101465791*^9, 3.6836001057070336`*^9}, 
   3.683636454492635*^9, {3.683639952283697*^9, 3.683639952541712*^9}, {
   3.683640265272599*^9, 3.6836402889299426`*^9}, {3.683653114401518*^9, 
   3.6836531144485207`*^9}, 3.715465057914084*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MedianA", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MedianB", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MedianIndependent", "=", 
    RowBox[{"Median", "[", 
     RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"UntreatedResponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"4", "*", "30.5"}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Progression free survival (months)\>\"", ",", 
       "\"\<PDX patients (%)\>\""}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.06"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"120", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", "+", "14"}], 
        RowBox[{"(*", " ", 
         RowBox[{"for", " ", "the", " ", "median", " ", "bar"}], "*)"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "*", 
      RowBox[{"(", "1.06", 
       RowBox[{"(*", 
        RowBox[{"median", " ", "bar"}], "*)"}], ")"}]}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Untreated\>\"", ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
               RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], 
              ",", "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
               RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], 
              ",", "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           "\"\<Independent\\ndrug action\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.4"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"4", "*", "30.5"}], ",", "1.06"}], "}"}]}], "]"}]}], 
      "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Median:\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "4"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianA", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianA", ",", "1.06"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianB", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianB", ",", "1.06"}], "}"}]}], "}"}], "]"}], ",", 
       "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianIndependent", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianIndependent", ",", "1.06"}], "}"}]}], "}"}], 
        "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Figure 5B,\>\"", "<>", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], "<>", 
     "\"\< best prediction survival plot.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.674829908944839*^9, 3.67482994527989*^9}, {
   3.674829992925957*^9, 3.674830074984076*^9}, {3.6748301526581864`*^9, 
   3.6748304023375454`*^9}, {3.6748304605176277`*^9, 3.674830573358383*^9}, {
   3.6748307707928514`*^9, 3.674830772350875*^9}, 3.682474540926508*^9, {
   3.682480015836655*^9, 3.6824800549568925`*^9}, {3.682480091066958*^9, 
   3.6824800963862624`*^9}, {3.6824801378546343`*^9, 3.682480138274658*^9}, 
   3.683519332214566*^9, {3.6836399118503847`*^9, 3.683639912071397*^9}, 
   3.6836402998425665`*^9, {3.683653114491523*^9, 3.683653114510524*^9}, 
   3.7154650579260845`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Rank", " ", "correlation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SpearmanRho", "[", 
   RowBox[{
    RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Colorectal", "Subsection",
 CellChangeTimes->{{3.668292488155779*^9, 3.668292492458025*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ModelNames", "\[LeftDoubleBracket]", "tumortype", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionPrediction", "[", 
     RowBox[{
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "3", 
    "\[RightDoubleBracket]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortedResponses", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "DrugAresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "DrugBresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}], ">", 
       RowBox[{"#2", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SortedModelNames", "=", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarChart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}]}], 
      "}"}], "\[Transpose]"}], ",", 
    RowBox[{"BarOrigin", "\[Rule]", "Left"}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<PDX identity\>\"", ",", 
       "\"\<Progression free survival (months)\>\""}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.008"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"0", "+", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], 
              "+", 
              RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"SortedModelNames", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"i", "/", "2"}], "+", 
                 RowBox[{"1", "/", "4"}]}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"FontSize", "\[Rule]", "7"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Consolas\>\""}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], 
              "+", 
              RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}]}], 
        "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"3.5", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "4"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], "+", 
          RowBox[{"1", "/", "2"}]}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"120", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"BarSpacing", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"ChartLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}]}], 
       "}"}]}], "/.", "NameSubstitutions"}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<\[Rho] = \>\"", "<>", 
             RowBox[{"ToString", "[", "RankCorrelation", "]"}]}], ",", 
            RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.98", ",", "0.98"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], "*)"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Figure 5B,\>\"", "<>", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], "<>", 
     "\"\< best prediction barchart.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667840138385285*^9, 3.6678401437375913`*^9}, {
   3.66784025683606*^9, 3.6678402574750967`*^9}, {3.6678403299722433`*^9, 
   3.6678403477842617`*^9}, {3.667840418923331*^9, 3.6678404190373373`*^9}, {
   3.667840660633156*^9, 3.667840673206875*^9}, {3.667840974479107*^9, 
   3.6678409813875017`*^9}, {3.667841052459567*^9, 3.6678410525515723`*^9}, {
   3.668274664419319*^9, 3.6682746649303484`*^9}, {3.671906206246207*^9, 
   3.671906232573713*^9}, {3.6719065094875517`*^9, 3.6719065095795565`*^9}, {
   3.6740054201089754`*^9, 3.674005420730011*^9}, {3.6740054757001553`*^9, 
   3.674005476267188*^9}, {3.674005600006265*^9, 3.6740056003802867`*^9}, {
   3.674005759167369*^9, 3.6740057851898575`*^9}, {3.674290359304707*^9, 
   3.674290367466174*^9}, {3.674732457910035*^9, 3.674732457910035*^9}, {
   3.6748316847372255`*^9, 3.674831685551272*^9}, {3.682480179602022*^9, 
   3.682480185240344*^9}, {3.6824802656299424`*^9, 3.6824802755815115`*^9}, 
   3.6835193322255664`*^9, {3.683600128928362*^9, 3.683600133738637*^9}, 
   3.683636454504636*^9, {3.6836399805343127`*^9, 3.6836399812063513`*^9}, 
   3.683640306609954*^9, {3.683653114534525*^9, 3.683653114587528*^9}, 
   3.7154650579350853`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MedianA", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MedianB", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MedianIndependent", "=", 
    RowBox[{"Median", "[", 
     RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"UntreatedResponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"4", "*", "30.5"}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Progression free survival (months)\>\"", ",", 
       "\"\<PDX patients (%)\>\""}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"3.5", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.06"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"120", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", "+", "14"}], 
        RowBox[{"(*", " ", 
         RowBox[{"for", " ", "the", " ", "median", " ", "bar"}], "*)"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "*", 
      RowBox[{"(", "1.06", 
       RowBox[{"(*", 
        RowBox[{"median", " ", "bar"}], "*)"}], ")"}]}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Untreated\>\"", ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
               RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], 
              ",", "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
               RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], 
              ",", "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           "\"\<Independent\\ndrug action\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.4"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"4", "*", "30.5"}], ",", "1.06"}], "}"}]}], "]"}]}], 
      "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Median:\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "4"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianA", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianA", ",", "1.06"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianB", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianB", ",", "1.06"}], "}"}]}], "}"}], "]"}], ",", 
       "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianIndependent", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianIndependent", ",", "1.06"}], "}"}]}], "}"}], 
        "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Figure 5B,\>\"", "<>", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], "<>", 
     "\"\< best prediction survival plot.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.674829908944839*^9, 3.67482994527989*^9}, {
   3.674829992925957*^9, 3.674830074984076*^9}, {3.6748301526581864`*^9, 
   3.6748304023375454`*^9}, {3.6748304605176277`*^9, 3.674830573358383*^9}, {
   3.674830753784792*^9, 3.6748307539647923`*^9}, {3.6748315183385124`*^9, 
   3.674831518848513*^9}, {3.674831557956648*^9, 3.6748315635866556`*^9}, 
   3.6824745410345144`*^9, {3.6824803303486443`*^9, 3.6824803399551935`*^9}, {
   3.682480479390169*^9, 3.682480479807193*^9}, 3.6835193322455673`*^9, {
   3.683639930212435*^9, 3.6836399304504485`*^9}, 3.683640312028264*^9, {
   3.6836531146265306`*^9, 3.6836531146465316`*^9}, 3.715465057945086*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Rank", " ", "correlation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SpearmanRho", "[", 
   RowBox[{
    RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6682925612009563`*^9, 3.6682925906976433`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Breast cancer", "Subsection",
 CellChangeTimes->{{3.6682926131919303`*^9, 3.6682926176021824`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ModelNames", "\[LeftDoubleBracket]", "tumortype", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionPrediction", "[", 
     RowBox[{
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "3", 
    "\[RightDoubleBracket]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortedResponses", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "DrugAresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "DrugBresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}], ">", 
       RowBox[{"#2", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SortedModelNames", "=", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarChart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}]}], 
      "}"}], "\[Transpose]"}], ",", 
    RowBox[{"BarOrigin", "\[Rule]", "Left"}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<PDX identity\>\"", ",", 
       "\"\<Progression free survival (months)\>\""}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.008"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"0", "+", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], 
              "+", 
              RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"SortedModelNames", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"i", "/", "2"}], "+", 
                 RowBox[{"1", "/", "4"}]}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"FontSize", "\[Rule]", "7"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Consolas\>\""}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], 
              "+", 
              RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}]}], 
        "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "4"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], "+", 
          RowBox[{"1", "/", "2"}]}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"120", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"BarSpacing", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"ChartLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}]}], 
       "}"}]}], "/.", "NameSubstitutions"}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<\[Rho] = \>\"", "<>", 
             RowBox[{"ToString", "[", "RankCorrelation", "]"}]}], ",", 
            RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.98", ",", "0.98"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], "*)"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Figure 5B,\>\"", "<>", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], "<>", 
     "\"\< best prediction barchart.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667840138385285*^9, 3.6678401437375913`*^9}, {
   3.66784025683606*^9, 3.6678402574750967`*^9}, {3.6678403299722433`*^9, 
   3.6678403477842617`*^9}, {3.6678403851864014`*^9, 
   3.6678404059295874`*^9}, {3.667840999624545*^9, 3.667841006072914*^9}, {
   3.667841067792444*^9, 3.667841083189325*^9}, {3.671906296699381*^9, 
   3.6719063139003644`*^9}, {3.6719065278306007`*^9, 3.671906527918606*^9}, {
   3.671907438240673*^9, 3.671907440611809*^9}, {3.674005422708124*^9, 
   3.674005423259156*^9}, {3.6740054780372887`*^9, 3.674005478610322*^9}, {
   3.6740056006713033`*^9, 3.6740056009733205`*^9}, {3.674290396736848*^9, 
   3.674290415935946*^9}, {3.674732458628044*^9, 3.674732458638044*^9}, {
   3.682480360953395*^9, 3.6824803841477213`*^9}, 3.6835193322575684`*^9, {
   3.683600155096859*^9, 3.683600158354045*^9}, 3.6836364545176363`*^9, {
   3.6836399943211017`*^9, 3.683639994598117*^9}, 3.6836403175065775`*^9, {
   3.683653114669533*^9, 3.683653114722536*^9}, 3.7154650579530864`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MedianA", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MedianB", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MedianIndependent", "=", 
    RowBox[{"Median", "[", 
     RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"UntreatedResponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"4", "*", "30.5"}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Progression free survival (months)\>\"", ",", 
       "\"\<PDX patients (%)\>\""}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"4", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.06"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"120", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", "+", "14"}], 
        RowBox[{"(*", " ", 
         RowBox[{"for", " ", "the", " ", "median", " ", "bar"}], "*)"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "*", 
      RowBox[{"(", "1.06", 
       RowBox[{"(*", 
        RowBox[{"median", " ", "bar"}], "*)"}], ")"}]}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Untreated\>\"", ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
               RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], 
              ",", "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
               RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], 
              ",", "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           "\"\<Independent\\ndrug action\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.4"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"4", "*", "30.5"}], ",", "1.06"}], "}"}]}], "]"}]}], 
      "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Median:\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "4"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianA", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianA", ",", "1.06"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianB", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianB", ",", "1.06"}], "}"}]}], "}"}], "]"}], ",", 
       "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianIndependent", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianIndependent", ",", "1.06"}], "}"}]}], "}"}], 
        "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Figure 5B,\>\"", "<>", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], "<>", 
     "\"\< best prediction survival plot.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.674829908944839*^9, 3.67482994527989*^9}, {
   3.674829992925957*^9, 3.674830074984076*^9}, {3.6748301526581864`*^9, 
   3.6748304023375454`*^9}, {3.6748304605176277`*^9, 3.674830573358383*^9}, {
   3.674830753784792*^9, 3.6748307539647923`*^9}, 3.682474541092518*^9, {
   3.682480424141009*^9, 3.6824804416370096`*^9}, 3.683519332273569*^9, {
   3.6836400039326515`*^9, 3.6836400040946603`*^9}, 3.68364032228485*^9, {
   3.683653114757538*^9, 3.683653114774539*^9}, 3.7154650579620867`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Rank", " ", "correlation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SpearmanRho", "[", 
   RowBox[{
    RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6682925612009563`*^9, 3.6682925906976433`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gastric", "Subsection",
 CellChangeTimes->{{3.668292631909001*^9, 3.6682926355612097`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ModelNames", "\[LeftDoubleBracket]", "tumortype", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndependentActionPrediction", "[", 
     RowBox[{
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
       RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
       "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "3", 
    "\[RightDoubleBracket]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortedResponses", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "DrugAresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "DrugBresponsesInIntersection", "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}], ">", 
       RowBox[{"#2", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "9"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SortedModelNames", "=", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Rank", " ", "correlation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RankCorrelation", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"SpearmanRho", "[", 
      RowBox[{
       RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     "0.01"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarChart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}]}], 
      "}"}], "\[Transpose]"}], ",", 
    RowBox[{"BarOrigin", "\[Rule]", "Left"}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<PDX identity\>\"", ",", 
       "\"\<Progression free survival (months)\>\""}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.008"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"0", "+", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], 
              "+", 
              RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"SortedModelNames", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"i", "/", "2"}], "+", 
                 RowBox[{"1", "/", "4"}]}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"FontSize", "\[Rule]", "7"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Consolas\>\""}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"1", "+", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], 
              "+", 
              RowBox[{"1", "/", "2"}]}], ",", "2"}], "}"}]}], "]"}]}], 
        "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"8", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "4"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "SortedModelNames", "]"}], "*", "2"}], "+", 
          RowBox[{"1", "/", "2"}]}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"120", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "300", "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"BarSpacing", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"ChartLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}]}], 
       "}"}]}], "/.", "NameSubstitutions"}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<\[Rho] = \>\"", "<>", 
             RowBox[{"ToString", "[", "RankCorrelation", "]"}]}], ",", 
            RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.98", ",", "0.98"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], "*)"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], "<>", 
     "\"\< best prediction barchart.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667840138385285*^9, 3.6678401437375913`*^9}, {
   3.66784025683606*^9, 3.6678402574750967`*^9}, {3.6678403299722433`*^9, 
   3.6678403477842617`*^9}, {3.6678403851864014`*^9, 
   3.6678404059295874`*^9}, {3.6678404416406302`*^9, 3.667840459365644*^9}, {
   3.667841093364907*^9, 3.667841093581919*^9}, {3.6678411235846353`*^9, 
   3.6678411302820187`*^9}, {3.6719065582373395`*^9, 3.671906561494526*^9}, {
   3.6740054253642764`*^9, 3.6740054259313087`*^9}, {3.6740054804044247`*^9, 
   3.674005481058462*^9}, {3.674005601334341*^9, 3.6740056016773605`*^9}, {
   3.6742904021811595`*^9, 3.674290403273222*^9}, {3.6742904754073477`*^9, 
   3.6742904757443666`*^9}, {3.6747324593040514`*^9, 
   3.6747324593040514`*^9}, {3.6824805007083883`*^9, 3.682480512859083*^9}, 
   3.68351933228657*^9, {3.6836001840815163`*^9, 3.6836001871636925`*^9}, 
   3.683636454530637*^9, {3.68365311479554*^9, 3.683653114844543*^9}, 
   3.715465057970087*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MedianA", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MedianB", "=", 
   RowBox[{"Median", "[", 
    RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MedianIndependent", "=", 
    RowBox[{"Median", "[", 
     RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"UntreatedResponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1", ",", "9"}], "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"SortedResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2", ",", "9"}], "\[RightDoubleBracket]"}], 
         "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"BestOfMonotherapyResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"9", "*", "30.5"}]}], "}"}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "500"}], ",", 
    RowBox[{"Axes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Progression free survival (months)\>\"", ",", 
       "\"\<PDX patients (%)\>\""}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"GrayLevel", "[", "0.6", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"12", "*", 
            RowBox[{"61", "/", "2"}]}], ",", 
           RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "*", "100"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"8", "*", 
          RowBox[{"61", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.06"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"120", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", "+", "14"}], 
        RowBox[{"(*", " ", 
         RowBox[{"for", " ", "the", " ", "median", " ", "bar"}], "*)"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "*", 
      RowBox[{"(", "1.06", 
       RowBox[{"(*", 
        RowBox[{"median", " ", "bar"}], "*)"}], ")"}]}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Untreated\>\"", ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
               RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], 
              ",", "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
               RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], 
              ",", "\"\<-50mpk\>\""}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           "\"\<Independent\\ndrug action\>\""}], "}"}], "/.", 
         "NameSubstitutions"}], ")"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.4"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"20", ",", "12"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"Prolog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Yellow", ",", "0.75"}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"8", "*", "30.5"}], ",", "1.06"}], "}"}]}], "]"}]}], 
      "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\[LeftArrow] Median\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"70", ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
       RowBox[{"ColorData", "[", 
        RowBox[{"3", ",", "4"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianA", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianA", ",", "1.06"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianB", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianB", ",", "1.06"}], "}"}]}], "}"}], "]"}], ",", 
       "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MedianIndependent", ",", "1.0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MedianIndependent", ",", "1.06"}], "}"}]}], "}"}], 
        "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], "<>", 
     "\"\< best prediction survival plot.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.674829908944839*^9, 3.67482994527989*^9}, {
   3.674829992925957*^9, 3.674830074984076*^9}, {3.6748301526581864`*^9, 
   3.6748304023375454`*^9}, {3.6748304605176277`*^9, 3.674830573358383*^9}, {
   3.674830753784792*^9, 3.6748307539647923`*^9}, {3.6748349727021585`*^9, 
   3.6748350228832717`*^9}, 3.674835059280363*^9, {3.6748351430205607`*^9, 
   3.674835154402585*^9}, 3.682474541171522*^9, {3.6824805681612463`*^9, 
   3.6824805761917057`*^9}, 3.683519332311571*^9, {3.683600197091261*^9, 
   3.6836001973552756`*^9}, {3.683653114886545*^9, 3.683653114905546*^9}, 
   3.715465057980088*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Rank", " ", "correlation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SpearmanRho", "[", 
   RowBox[{
    RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6682925612009563`*^9, 3.6682925906976433`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Examining drug pairs of similar mechanisms and computing their response \
correlations\
\>", "Section",
 CellChangeTimes->{{3.678199766483322*^9, 3.678199777654961*^9}, {
  3.6836455851658697`*^9, 3.6836456019678307`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "begin", " ", "with", " ", "an", " ", "empty", " ", "list", " ",
     "and", " ", "gradually", " ", "fill", " ", "it", " ", "with", " ", 
    "response", " ", "correlations", " ", "between", " ", "drugs", " ", 
    "with", " ", "similar", " ", "mechanism", " ", "of", " ", "action"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SimilarDrugCorrelations", "=", 
    RowBox[{"{", "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.678199967397814*^9, 3.6781999754552746`*^9}, {
  3.683645604275963*^9, 3.6836456321795588`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "RAF", " ", "and", " ", "MEK", " ", "inhibitors", " ", "in", " ", 
    "melanoma"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "1"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6781999041141944`*^9, 3.678199984530794*^9}, 
   3.6836393989170465`*^9, {3.6836522408785553`*^9, 3.6836522409005566`*^9}, {
   3.6837193275372205`*^9, 3.683719355609826*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", "melanoma"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "2"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6782000139294753`*^9, 3.6782000301094007`*^9}, {
   3.678200579647833*^9, 3.6782005797658396`*^9}, 3.683639398939048*^9, {
   3.6836522409215574`*^9, 3.6836522409355583`*^9}, {3.6837193409759893`*^9, 
   3.68371936161817*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "MAPK", " ", "and", " ", "MEK", " ", "inhibitors", " ", "in", " ", 
    "NSCLC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "2"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "7"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "7"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.678200102354533*^9, 3.6782001220606604`*^9}, 
   3.683639398961049*^9, {3.683652224939643*^9, 3.683652224956644*^9}, {
   3.6837193477453766`*^9, 3.6837193631682587`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", "NSCLC"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.678200134246357*^9, 3.678200144891966*^9}, 
   3.68363939898105*^9, {3.6836522250026464`*^9, 3.683652225019648*^9}, 
   3.683719364505335*^9, {3.683719397841242*^9, 3.6837193980422535`*^9}, {
   3.68371944466492*^9, 3.6837194447289233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", 
    "NSCLC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "8"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "8"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.678200156392624*^9, 3.678200169512374*^9}, 
   3.683639399000051*^9, {3.68365222505165*^9, 3.68365222506365*^9}, 
   3.6837193657374053`*^9, {3.683719399880358*^9, 3.6837194000893703`*^9}, {
   3.6837194472090654`*^9, 3.6837194483601313`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", 
    "NSCLC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "8"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "8"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, 
   3.6836393990210524`*^9, {3.683652225084652*^9, 3.6836522250976524`*^9}, 
   3.68371936704148*^9, {3.683719401768466*^9, 3.6837194019614773`*^9}, {
   3.6837194506072598`*^9, 3.683719451992339*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"two", " ", "MEK", " ", "inhibitors", " ", "in", " ", "PDAC"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "2"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "13"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "13"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, 3.6836393990400534`*^9, {
   3.683652225110653*^9, 3.6836522251216536`*^9}, 3.683719368577568*^9, {
   3.6837194035365677`*^9, 3.683719403737579*^9}, {3.683719455536542*^9, 
   3.683719455719552*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", "PDAC"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "5"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "5"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200367458696*^9}, 3.6836393990620546`*^9, {3.683652225137655*^9, 
   3.6836522251476555`*^9}, 3.6837193698336396`*^9, {3.683719405552683*^9, 
   3.6837194057516937`*^9}, {3.683719483097118*^9, 3.683719484320188*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", 
    "PDAC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200409585106*^9}, 3.6836393990800557`*^9, {3.683652225160656*^9, 
   3.6836522251706567`*^9}, 3.6837193710497093`*^9, {3.6837194072637806`*^9, 
   3.683719407471792*^9}, {3.683719486825331*^9, 3.6837194886964383`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", 
    "PDAC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "5"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "5"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, 3.683639399098057*^9, {3.6836522251826572`*^9, 
   3.6836522251926575`*^9}, 3.6837193726087985`*^9, {3.683719409192891*^9, 
   3.6837194093929024`*^9}, {3.6837194906085477`*^9, 3.683719491408593*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "MEK", " ", "and", " ", "MAPK", " ", "inhibitors", " ", "in", " ", "CRC"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "2"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "7"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "7"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007018148203`*^9}, 
   3.6836364542586217`*^9, {3.6836522252046585`*^9, 3.683652225212659*^9}, 
   3.6837193740648813`*^9, {3.6837194111450024`*^9, 3.683719411328013*^9}, {
   3.683719494448767*^9, 3.683719494984798*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", "CRC"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.678200740834052*^9}, 
   3.683636454269622*^9, {3.68365222522666*^9, 3.68365222523366*^9}, 
   3.683719375376957*^9, {3.6837194138641577`*^9, 3.68371941407417*^9}, {
   3.683719497000913*^9, 3.68371949712792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", 
    "CRC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "8"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "8"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, 
   3.683636454288623*^9, {3.683652225245661*^9, 3.6836522252546616`*^9}, 
   3.683719376569025*^9, {3.6837194157202644`*^9, 3.683719415945277*^9}, {
   3.6837194998330755`*^9, 3.683719501248156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "inhibitors", " ", "in", " ", 
    "CRC"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "8"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "8"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, 3.683636454298624*^9, {
   3.6836522252666616`*^9, 3.6836522252786627`*^9}, 3.6837193776640873`*^9, {
   3.6837194175603695`*^9, 3.683719417761381*^9}, {3.6837195034962845`*^9, 
   3.6837195049283667`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "FGFR", " ", "mAb", " ", "and", " ", "FGFR", " ", "kinase", " ", 
    "inhibitors", " ", "in", " ", "Breast"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "1"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "13"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "13"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, {3.6782009131149063`*^9, 
   3.6782009326570234`*^9}, {3.678200975446471*^9, 3.678200975586479*^9}, 
   3.6836364543086243`*^9, {3.683652225295664*^9, 3.683652225303664*^9}, 
   3.6837193788891573`*^9, {3.683719419440477*^9, 3.6837194196334877`*^9}, {
   3.683719507976541*^9, 3.6837195087835875`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "two", " ", "PI3K", " ", "kinase", " ", "inhibitors", " ", "in", " ", 
    "Breast"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, {3.6782009131149063`*^9, 
   3.6782009326570234`*^9}, {3.678200975446471*^9, 3.6782010096324263`*^9}, 
   3.6836364543186245`*^9, {3.6836522253166647`*^9, 3.6836522253256655`*^9}, 
   3.683719380609256*^9, {3.683719421144574*^9, 3.683719421345586*^9}, {
   3.6837195113047314`*^9, 3.683719511384736*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "kinase", " ", "inhibitors", " ", 
    "in", " ", "Breast"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, {3.6782009131149063`*^9, 
   3.6782009326570234`*^9}, {3.678200975446471*^9, 3.6782010294785614`*^9}, 
   3.6836364543286257`*^9, {3.683652225338666*^9, 3.6836522253476667`*^9}, 
   3.6837193820973415`*^9, {3.683719423024682*^9, 3.6837194232396946`*^9}, {
   3.6837195143769073`*^9, 3.6837195156569805`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "kinase", " ", "inhibitors", " ", 
    "in", " ", "Breast"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "6"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, {3.6782009131149063`*^9, 
   3.6782009326570234`*^9}, {3.678200975446471*^9, 3.6782010472415776`*^9}, 
   3.683636454338626*^9, {3.683652225360667*^9, 3.683652225368668*^9}, 
   3.6837193832254057`*^9, {3.683719425368816*^9, 3.683719425545826*^9}, {
   3.683719517649094*^9, 3.6837195191041775`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "FGFR", " ", "mAb", " ", "and", " ", "FGFR", " ", "kinase", " ", 
    "inhibitors", " ", "in", " ", "Gastric"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "1"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "13"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "13"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, {3.6782009131149063`*^9, 
   3.6782009803427515`*^9}, {3.6782010730660543`*^9, 3.6782010731880617`*^9}, 
   3.6836364543496265`*^9, {3.6836522253806686`*^9, 3.6836522253916693`*^9}, 
   3.6837193844094734`*^9, {3.6837194271929207`*^9, 3.683719427377931*^9}, {
   3.6837195209512835`*^9, 3.6837195226233788`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "two", " ", "PI3K", " ", "kinase", " ", "inhibitors", " ", "in", " ", 
    "Gastric"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, {3.6782009131149063`*^9, 
   3.6782009803427515`*^9}, {3.6782010730660543`*^9, 3.678201095105315*^9}, {
   3.678201154511713*^9, 3.678201156628834*^9}, 3.6836364543586273`*^9, {
   3.68365222540467*^9, 3.68365222541267*^9}, 3.6837193854895353`*^9, {
   3.683719429089029*^9, 3.6837194292890406`*^9}, {3.683719524696497*^9, 
   3.683719525368536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "kinase", " ", "inhibitors", " ", 
    "in", " ", "Gastric"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "5"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "5"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, {3.6782009131149063`*^9, 
   3.6782009803427515`*^9}, {3.6782010730660543`*^9, 3.678201095105315*^9}, {
   3.678201154511713*^9, 3.6782011661553793`*^9}, 3.683636454371628*^9, {
   3.683645761274943*^9, 3.6836457619669824`*^9}, {3.683652225426671*^9, 
   3.683652225435672*^9}, 3.6837193866656027`*^9, {3.683719430912133*^9, 
   3.683719431113145*^9}, {3.683719527600663*^9, 3.6837195286327224`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "another", " ", "two", " ", "PI3K", " ", "kinase", " ", "inhibitors", " ", 
    "in", " ", "Gastric"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "5"}], "\[RightDoubleBracket]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "5"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SimilarDrugCorrelations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"SimilarDrugCorrelations", ",", 
       RowBox[{"SpearmanRho", "[", 
        RowBox[{
         RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67820018097003*^9, 3.6782001810690355`*^9}, {
   3.678200302220965*^9, 3.678200322645133*^9}, {3.6782003588692045`*^9, 
   3.678200423032875*^9}, {3.6782006840208025`*^9, 3.6782007662505054`*^9}, {
   3.6782008383116274`*^9, 3.6782008383896317`*^9}, {3.6782009131149063`*^9, 
   3.6782009803427515`*^9}, {3.6782010730660543`*^9, 3.678201095105315*^9}, {
   3.678201154511713*^9, 3.6782011773550196`*^9}, 3.6836364543986297`*^9, {
   3.6836457645411296`*^9, 3.683645765277172*^9}, {3.6836522254496727`*^9, 
   3.683652225458673*^9}, 3.6837193883697*^9, {3.6837194327522383`*^9, 
   3.6837194329692507`*^9}, {3.683719530440826*^9, 3.683719532048918*^9}}],

Cell[CellGroupData[{

Cell["analyzing results", "Subsubsection",
 CellChangeTimes->{{3.6836484547440004`*^9, 3.6836484662396584`*^9}}],

Cell[BoxData[{
 RowBox[{"Mean", "[", "SimilarDrugCorrelations", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Median", "[", "SimilarDrugCorrelations", "]"}]}], "Input",
 CellChangeTimes->{{3.683645997137433*^9, 3.6836460028557606`*^9}}],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"SimilarDrugCorrelations", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.225"}], ",", "1.125", ",", "0.05"}], "}"}], ",", 
   "\"\<Count\>\"", ",", 
   RowBox[{"ChartLayout", "\[Rule]", "\"\<Stacked\>\""}], ",", 
   RowBox[{"Frame", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"ChartStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", "Black"}], "]"}], "}"}]}], 
   ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Correlation in response\>\"", ",", "\"\<Number of drug pairs\>\""}],
      "}"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "i", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "10", ",", "2"}], "}"}]}], "]"}], ",", 
        "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "\"\<0.5\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.025"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "0.2"}], ",", "1", ",", "0.1"}], "}"}]}], "]"}]}], 
         "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "1."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "8"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "500", "}"}], ",", 
      RowBox[{"{", "220", "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"45", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<Drug pairs of\\nsimilar mechanism\>\"", ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Black"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6836458755764804`*^9, 3.683645977208294*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting response correlations", "Section",
 CellChangeTimes->{{3.6836484452314568`*^9, 3.683648449552704*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllActiveAgentsCorrelations", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
    "MelanomaResponseCorrelationsActiveAgentsOnly", ",", 
     "\[IndentingNewLine]", "NSCLCResponseCorrelationsActiveAgentsOnly", ",", 
     "\[IndentingNewLine]", "PDACResponseCorrelationsActiveAgentsOnly", ",", 
     "\[IndentingNewLine]", "CRCResponseCorrelationsActiveAgentsOnly", ",", 
     "\[IndentingNewLine]", "BCResponseCorrelationsActiveAgentsOnly", ",", 
     "\[IndentingNewLine]", "GCResponseCorrelationsActiveAgentsOnly"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820088196707044`*^9, 3.682008857294856*^9}, {
  3.6820092810230923`*^9, 3.682009283382227*^9}, {3.6836460669964294`*^9, 
  3.6836460706736393`*^9}}],

Cell[BoxData[{
 RowBox[{"Mean", "[", "AllActiveAgentsCorrelations", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Median", "[", "AllActiveAgentsCorrelations", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "from", " ", "the", " ", "list", " ", "of", " ", "all", " ", "response", 
     " ", "correlations", " ", "between", " ", "active", " ", "agents"}], ",",
     " ", 
    RowBox[{
    "remove", " ", "those", " ", "entries", " ", "corresponding", " ", "to", 
     " ", "drugs", " ", "with", " ", "similar", " ", "mechanisms"}], ",", " ", 
    RowBox[{
    "because", " ", "these", " ", "are", " ", "plotted", " ", "separately", 
     " ", "in", " ", "a", " ", "\"\<stacked\>\"", " ", "histogram"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AllActiveAgentsExcludingSimilarMechanismPairs", "=", 
    RowBox[{"Complement", "[", 
     RowBox[{"AllActiveAgentsCorrelations", ",", "SimilarDrugCorrelations"}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6836461928636284`*^9, 3.683646261861575*^9}}],

Cell[CellGroupData[{

Cell["\<\
Identifying correlations between chemotherapy and targeted therapy\
\>", "Subsubsection",
 CellChangeTimes->{{3.6744677233192797`*^9, 3.6744677411723013`*^9}, {
  3.6836477212260456`*^9, 3.683647723596181*^9}, {3.6836484848307214`*^9, 
  3.6836484990625353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"melanoma", ":", " ", 
    RowBox[{
    "mono", " ", "#5", " ", "is", " ", "the", " ", "only", " ", "classic", 
     " ", "cytotoxic", " ", "chemotherapy"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "MonotherapiesByGroup", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8", ",", 
       "9", ",", "10", ",", "11", ",", "12"}], "}"}]}], 
    "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6744677718330545`*^9, 3.6744678198278*^9}, {
  3.674467851324601*^9, 3.6744679309961586`*^9}}],

Cell[BoxData[
 RowBox[{"MelanomaChemoTargetedCorrelations", "=", 
  RowBox[{"AllMelanomaPairs", "\[LeftDoubleBracket]", 
   RowBox[{"5", ",", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8", ",", 
      "9", ",", "10", ",", "11", ",", "12"}], "}"}], ",", "4"}], 
   "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.6744691385962296`*^9, 3.674469176740411*^9}, {
   3.674469236835848*^9, 3.674469242660181*^9}, 3.6782049076843824`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"NSCLC", ":", " ", 
    RowBox[{
    "mono", " ", "#16", " ", "is", " ", "the", " ", "only", " ", "classic", 
     " ", "cytotoxic", " ", "chemotherapy"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "MonotherapiesByGroup", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
       "8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", 
       ",", "15"}], "}"}]}], "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6744679434038677`*^9, 3.6744679707324314`*^9}}],

Cell[BoxData[
 RowBox[{"NSCLCChemoTargetedCorrelations", "=", 
  RowBox[{"AllNSCLCPairs", "\[LeftDoubleBracket]", 
   RowBox[{"16", ",", 
    RowBox[{"{", 
     RowBox[{
     "2", ",", "3", ",", "4", ",", "7", ",", "8", ",", "9", ",", "11", ",", 
      "13", ",", "15"}], "}"}], ",", "4"}], 
   "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.6744692502206135`*^9, 3.6744692627253284`*^9}, {
   3.6744695581162243`*^9, 3.674469558412241*^9}, {3.67794946046103*^9, 
   3.6779494798831415`*^9}, 3.6782049190760336`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"PDAC", ":", " ", 
      RowBox[{
      "mono", " ", "#1", " ", "and", " ", "#8", " ", "is", " ", "the", " ", 
       "only", " ", "classic", " ", "cytotoxic", " ", "chemotherapy"}]}], ";",
      " ", 
     RowBox[{"but", " ", "#1"}]}], ",", " ", "abraxane", ",", " ", 
    RowBox[{"had", " ", "no", " ", "effect", " ", "in", " ", 
     RowBox[{"mice", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "MonotherapiesByGroup", "\[LeftDoubleBracket]", "3", 
    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "9", ",", 
       "10", ",", "11", ",", "12", ",", "13", ",", "14"}], "}"}]}], 
    "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6744679434038677`*^9, 3.6744679937797494`*^9}, {
  3.6744687607486176`*^9, 3.6744687846759863`*^9}, {3.6779494943149667`*^9, 
  3.6779495030514665`*^9}}],

Cell[BoxData[
 RowBox[{"PDACChemoTargetedCorrelations", "=", 
  RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
   RowBox[{"8", ",", 
    RowBox[{"{", 
     RowBox[{
     "2", ",", "4", ",", "5", ",", "6", ",", "9", ",", "10", ",", "11", ",", 
      "13"}], "}"}], ",", "4"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.6744692502206135`*^9, 3.6744692898528805`*^9}, {
  3.6744695883169518`*^9, 3.674469600820667*^9}, {3.6779495093088245`*^9, 
  3.677949557425576*^9}, {3.678204876478597*^9, 3.678204879459768*^9}, {
  3.678204976869339*^9, 3.6782049777393894`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"CRC", ":", " ", 
    RowBox[{
    "mono", " ", "#1", " ", "is", " ", "the", " ", "only", " ", "classic", 
     " ", "cytotoxic", " ", "chemotherapy"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "MonotherapiesByGroup", "\[LeftDoubleBracket]", "4", 
    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", ",", 
       "9", ",", "10", ",", "11", ",", "12", ",", "13"}], "}"}]}], 
    "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6744679434038677`*^9, 3.6744679937797494`*^9}, {
   3.6744687607486176`*^9, 3.6744687846759863`*^9}, {3.6744688517238207`*^9, 
   3.6744688874758663`*^9}, 3.6744690178123207`*^9, {3.677949583869089*^9, 
   3.6779495978138866`*^9}}],

Cell[BoxData[
 RowBox[{"CRCChemoTargetedCorrelations", "=", 
  RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{
     "2", ",", "3", ",", "4", ",", "5", ",", "7", ",", "8", ",", "11"}], 
     "}"}], ",", "4"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.6744692502206135`*^9, 3.674469308955973*^9}, {
  3.674469611795295*^9, 3.6744696118993006`*^9}, {3.6779496096725645`*^9, 
  3.677949631713825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Breast", ":", " ", 
    RowBox[{
    "mono", " ", "#14", " ", "is", " ", "the", " ", "only", " ", "classic", 
     " ", "cytotoxic", " ", "chemotherapy"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "MonotherapiesByGroup", "\[LeftDoubleBracket]", "5", 
    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
       "8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "15", 
       ",", "16"}], "}"}]}], "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6744679434038677`*^9, 3.6744679937797494`*^9}, {
  3.6744687607486176`*^9, 3.6744687846759863`*^9}, {3.6744688517238207`*^9, 
  3.6744688874758663`*^9}, {3.6744690178123207`*^9, 3.6744690629319015`*^9}}],

Cell[BoxData[
 RowBox[{"BCChemoTargetedCorrelations", "=", 
  RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
   RowBox[{"14", ",", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8", ",", 
      "9", ",", "11", ",", "13"}], "}"}], ",", "4"}], 
   "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.6744692502206135`*^9, 3.6744693658692284`*^9}, {
  3.674469534076849*^9, 3.6744695342358584`*^9}, {3.6779496461256495`*^9, 
  3.677949671960127*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Gastric", ":", " ", 
    RowBox[{"no", " ", "classic", " ", "cytotoxic", " ", "chemotherapy"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "MonotherapiesByGroup", "\[LeftDoubleBracket]", "6", 
    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
       "8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14"}],
       "}"}]}], "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6744679434038677`*^9, 3.6744679937797494`*^9}, {
  3.6744687607486176`*^9, 3.6744687846759863`*^9}, {3.6744688517238207`*^9, 
  3.6744688874758663`*^9}, {3.6744690178123207`*^9, 3.6744691000520244`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllChemoTargetedCorrelations", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
    "MelanomaChemoTargetedCorrelations", ",", "\[IndentingNewLine]", 
     "NSCLCChemoTargetedCorrelations", ",", "\[IndentingNewLine]", 
     "PDACChemoTargetedCorrelations", ",", "\[IndentingNewLine]", 
     "CRCChemoTargetedCorrelations", ",", "\[IndentingNewLine]", 
     "BCChemoTargetedCorrelations"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67446937201558*^9, 3.6744694083726597`*^9}, 
   3.682020999559354*^9, {3.68364855491173*^9, 3.6836485557617784`*^9}}],

Cell[BoxData[{
 RowBox[{"Mean", "[", "AllActiveAgentsCorrelations", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Mean", "[", "AllChemoTargetedCorrelations", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Mean", "[", "SimilarDrugCorrelations", "]"}]}], "Input",
 CellChangeTimes->{{3.6782051891684823`*^9, 3.678205207191513*^9}, {
   3.6782055791367874`*^9, 3.6782055866082144`*^9}, 3.6836485999073033`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "from", " ", "the", " ", "list", " ", "of", " ", "all", " ", "response", 
     " ", "correlations", " ", "between", " ", "active", " ", "agents"}], ",",
     " ", 
    RowBox[{
    "remove", " ", "those", " ", "entries", " ", "corresponding", " ", "to", 
     " ", "drugs", " ", "with", " ", "similar", " ", "mechanisms"}], ",", " ", 
    RowBox[{
    "and", " ", "entries", " ", "corresponding", " ", "to", " ", 
     "chemotherapies", " ", "combined", " ", "with", " ", "targeted", " ", 
     "therapies"}], ",", " ", 
    RowBox[{
    "because", " ", "these", " ", "are", " ", "plotted", " ", "separately", 
     " ", "in", " ", "a", " ", "\"\<stacked\>\"", " ", "histogram"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "AllActiveAgentsExcludingSimilarMechanismAndChemoTargetedPairs", "=", 
    RowBox[{"Complement", "[", 
     RowBox[{
     "AllActiveAgentsCorrelations", ",", "SimilarDrugCorrelations", ",", " ", 
      "AllChemoTargetedCorrelations"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.684071489799657*^9, 3.6840715199623823`*^9}, {
  3.6840715629068384`*^9, 3.6840715718563504`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "option", " ", "allows", " ", "legends", " ", "to", " ", "be",
     " ", "included", " ", "in", " ", "exported", " ", "images", " ", 
    "without", " ", "interfering", " ", "with", " ", "image", " ", "size"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"$FrontEndSession", ",", 
     RowBox[{"PrintingStyleEnvironment", "\[Rule]", "\"\<Working\>\""}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "AllChemoTargetedCorrelations", ",", "SimilarDrugCorrelations", ",", 
       "AllActiveAgentsExcludingSimilarMechanismAndChemoTargetedPairs"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.225"}], ",", "1.125", ",", "0.05"}], "}"}], ",", 
     "\"\<Count\>\"", ",", 
     RowBox[{"ChartLayout", "\[Rule]", "\"\<Stacked\>\""}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
     RowBox[{"ChartStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "None", "]"}], ",", "Black", ",", 
          RowBox[{"Opacity", "[", "1", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
            RowBox[{"250", "/", "255"}], ",", 
            RowBox[{"210", "/", "255"}], ",", "0."}], "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"RGBColor", "[", 
               RowBox[{
                RowBox[{"0", "/", "255"}], ",", 
                RowBox[{"150", "/", "255"}], ",", 
                RowBox[{"210", "/", "255"}]}], "]"}], ",", 
              RowBox[{"GrayLevel", "[", "0.7", "]"}]}], "}"}], ",", "0.6"}], 
           "]"}]}], "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Correlation between\\ndrug sensitivities\>\"", ",", 
        "\"\<Number of drug pairs\>\""}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "50", ",", "10"}], "}"}]}], "]"}], 
          ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "\"\<0.5\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.04"}], "}"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.025"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"-", "0.2"}], ",", "1", ",", "0.1"}], "}"}]}], 
             "]"}]}], "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.2"}], ",", "1."}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "500", "}"}], ",", 
        RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "20"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"70", ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ChartLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Pairs: chemotherapy\\nplus targeted\>\"", ",", 
        "\"\<Pairs: same target\\nor pathway\>\"", ",", 
        "\"\<Pairs: All drugs\>\""}], "}"}]}]}], "]"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Figure 2A, response correlations in PDX trials.pdf\>\""}], ",", 
      "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.684072087871865*^9, 3.684072205120571*^9}, {
   3.684072264266954*^9, 3.6840723229213085`*^9}, {3.684072419586838*^9, 
   3.6840724815883837`*^9}, {3.6840725364245205`*^9, 
   3.6840726006131916`*^9}, {3.6840726378243203`*^9, 3.68407272244516*^9}, {
   3.6855779027929907`*^9, 3.685577946955517*^9}, {3.6855780003625717`*^9, 
   3.685578000577584*^9}, 3.7154650580140896`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "range", " ", "of", " ", "correlation", " ", "in", " ", "chemotherapy", 
    " ", "plus", " ", "targeted", " ", "therapy", " ", "drug", " ", "pairs"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Mean", "[", "AllChemoTargetedCorrelations", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mean", "[", "AllChemoTargetedCorrelations", "]"}], "+", 
    RowBox[{"StandardDeviation", "[", "AllChemoTargetedCorrelations", "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mean", "[", "AllChemoTargetedCorrelations", "]"}], "-", 
    RowBox[{
    "StandardDeviation", "[", "AllChemoTargetedCorrelations", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.68407275565906*^9, 3.684072814786442*^9}, {
  3.684072863137207*^9, 3.6840728821012917`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "range", " ", "of", " ", "correlation", " ", "in", " ", "drugs", " ", 
    "acting", " ", "on", " ", "common", " ", "target", " ", "or", " ", 
    "pathway"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Mean", "[", "SimilarDrugCorrelations", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mean", "[", "SimilarDrugCorrelations", "]"}], "+", 
    RowBox[{"StandardDeviation", "[", "SimilarDrugCorrelations", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mean", "[", "SimilarDrugCorrelations", "]"}], "-", 
    RowBox[{
    "StandardDeviation", "[", "SimilarDrugCorrelations", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6840728902057557`*^9, 3.6840729081547823`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Response correlations have similar distributions in each tumor type:\
\>", "Subsubsection",
 CellChangeTimes->{{3.684071554285345*^9, 3.684071556478471*^9}, {
  3.685578050389433*^9, 3.6855780855814457`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{
    "Intersection", "[", "MelanomaResponseCorrelationsActiveAgentsOnly", 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.05"}], ",", "1.05", ",", "0.1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Rank correlation between\\ndrug sensitivities\>\"", ",", 
       "\"\<Number of drug pairs\>\""}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "200", ",", "5"}], "}"}]}], "]"}], 
         ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "0.5"}], ",", "0.5", ",", "1"}], "}"}]}], "]"}]}],
           "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1."}], ",", "1."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "17"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Melanoma\>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Black"}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{
    "Intersection", "[", "NSCLCResponseCorrelationsActiveAgentsOnly", "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.05"}], ",", "1.05", ",", "0.1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Rank correlation between\\ndrug sensitivities\>\"", ",", 
       "\"\<Number of drug pairs\>\""}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "200", ",", "5"}], "}"}]}], "]"}], 
         ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "0.5"}], ",", "0.5", ",", "1"}], "}"}]}], "]"}]}],
           "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1."}], ",", "1."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "12"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Non-small cell lung cancer\>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Black"}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{
    "Intersection", "[", "PDACResponseCorrelationsActiveAgentsOnly", "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.05"}], ",", "1.05", ",", "0.1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Rank correlation between\\ndrug sensitivities\>\"", ",", 
       "\"\<Number of drug pairs\>\""}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "200", ",", "5"}], "}"}]}], "]"}], 
         ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "0.5"}], ",", "0.5", ",", "1"}], "}"}]}], "]"}]}],
           "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1."}], ",", "1."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "13"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Pancreatic ductal adenocarcinoma\>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Black"}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{
    "Intersection", "[", "CRCResponseCorrelationsActiveAgentsOnly", "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.05"}], ",", "1.05", ",", "0.1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Rank correlation between\\ndrug sensitivities\>\"", ",", 
       "\"\<Number of drug pairs\>\""}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "200", ",", "5"}], "}"}]}], "]"}], 
         ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "0.5"}], ",", "0.5", ",", "1"}], "}"}]}], "]"}]}],
           "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1."}], ",", "1."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Colorectal carcinoma\>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Black"}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{
    "Intersection", "[", "BCResponseCorrelationsActiveAgentsOnly", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.05"}], ",", "1.05", ",", "0.1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Rank correlation between\\ndrug sensitivities\>\"", ",", 
       "\"\<Number of drug pairs\>\""}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "200", ",", "5"}], "}"}]}], "]"}], 
         ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "0.5"}], ",", "0.5", ",", "1"}], "}"}]}], "]"}]}],
           "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1."}], ",", "1."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "20"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Breast cancer\>\"", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Black"}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{
   "Intersection", "[", "GCResponseCorrelationsActiveAgentsOnly", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.05"}], ",", "1.05", ",", "0.1"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
   RowBox[{"ChartStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{
      RowBox[{"EdgeForm", "[", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "]"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Rank correlation between\\ndrug sensitivities\>\"", ",", 
      "\"\<Number of drug pairs\>\""}], "}"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "i", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "200", ",", "2"}], "}"}]}], "]"}], ",",
         "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.02"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "0.5"}], ",", "0.5", ",", "1"}], "}"}]}], "]"}]}], 
         "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1."}], ",", "1."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "8"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1000", "}"}], ",", 
      RowBox[{"{", "250", "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"50", ",", "50"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"80", ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<Gastric cancer\>\"", ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Black"}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.678206315562908*^9, 3.6782065201066074`*^9}, {
  3.6785341123442507`*^9, 3.678534197900144*^9}, {3.6836486840431156`*^9, 
  3.6836487145078583`*^9}, {3.6836487541141233`*^9, 3.683648775923371*^9}, {
  3.6836488300454664`*^9, 3.6836488912239656`*^9}, {3.6836489479052076`*^9, 
  3.683648959612877*^9}, {3.68557808915065*^9, 3.6855781090977907`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Pairs of Chemotherapy plus targeted, and pairs of drugs with similar \
mechanism, are each significantly different from the distribution of response \
correlations of all active agents:\
\>", "Subsubsection",
 CellChangeTimes->{{3.685578126776802*^9, 3.6855781702852907`*^9}}],

Cell[BoxData[{
 RowBox[{"TTest", "[", 
  RowBox[{"{", 
   RowBox[{
   "AllActiveAgentsCorrelations", ",", "AllChemoTargetedCorrelations"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TTest", "[", 
  RowBox[{"{", 
   RowBox[{"AllActiveAgentsCorrelations", ",", "SimilarDrugCorrelations"}], 
   "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6782084797076902`*^9, 3.6782084854140167`*^9}, {
  3.683649241426996*^9, 3.683649298706272*^9}, {3.6855781223275476`*^9, 
  3.68557812568674*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Pooled comparison of best predicted combinations and best observed \
combinations\
\>", "Section",
 CellChangeTimes->{{3.661869239228063*^9, 3.661869257542091*^9}, {
  3.6618765040031652`*^9, 3.661876506937333*^9}, {3.6618791174986486`*^9, 
  3.6618791311044273`*^9}, {3.68364973820041*^9, 3.6836497507641287`*^9}}],

Cell[CellGroupData[{

Cell["PDAC", "Subsection",
 CellChangeTimes->{{3.661872330154435*^9, 3.661872332968596*^9}, {
  3.661878867816368*^9, 3.6618788685604105`*^9}, {3.6618789767876005`*^9, 
  3.6618789772576275`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "best", " ", "survival", " ", "over", 
    " ", "untreated", " ", "predicted", " ", "for", " ", "any", " ", 
    RowBox[{"combination", "?"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PDACBestPrediction", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "where", " ", "does", " ", "that", " ", "best", " ", "prediction", " ", 
    "lie", " ", "in", " ", "the", " ", "matrix", " ", "over", " ", "all", " ",
     "combination", " ", 
    RowBox[{"predictions", "?", " ", "The"}], " ", "drug", " ", "names", " ", 
    "are", " ", "in", " ", "the", " ", "corresponding", " ", "positions", " ",
     "of", " ", 
    RowBox[{
     RowBox[{
     "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], " ", "."}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PDACBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "PDACBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug1index", "=", 
   RowBox[{
   "PDACBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug2index", "=", 
   RowBox[{
   "PDACBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"drug1name", "=", 
  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
   RowBox[{"tumortype", ",", "drug1index"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug2name", "=", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug2index"}], "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "running", " ", "the", " ", "combination", " ", "prediction", " ", "for", 
     " ", "this", " ", "best", " ", "pair"}], ",", " ", 
    RowBox[{
    "to", " ", "load", " ", "into", " ", "memory", " ", "the", " ", "best", 
     " ", "monotherapy", " ", "responses", " ", 
     RowBox[{"(", "BestOfMonotherapyResponses", ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "also", " ", "the", " ", "set", " ", "of", " ", "PDX", " ", 
      "models", " ", "involved", " ", "in", " ", "this", " ", "prediction", 
      " ", 
      RowBox[{
       RowBox[{"(", "ModelsInBothMonotherapies", ")"}], ".", " ", "No"}], " ",
       "larger", " ", "set", " ", "of", " ", "models", " ", "is", " ", 
      "possible"}], ";", " ", 
     RowBox[{
     "the", " ", "prediction", " ", "does", " ", "not", " ", "exist", " ", 
      "when", " ", "the", " ", "model", " ", "has", " ", "not", " ", "been", 
      " ", "treated", " ", "with", " ", "both", " ", 
      RowBox[{"monotherapies", "."}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"IndependentActionPrediction", "[", 
  RowBox[{
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug1index"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug2index"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
    "\[RightDoubleBracket]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.661871641532048*^9, 3.661871695347126*^9}, {
   3.6618723011897783`*^9, 3.6618723044899673`*^9}, {3.6618723387879286`*^9, 
   3.6618724315302334`*^9}, {3.661872563613788*^9, 3.6618725638528023`*^9}, {
   3.661877494324809*^9, 3.6618775904663076`*^9}, {3.661877627489425*^9, 
   3.661877685511744*^9}, {3.661878109406989*^9, 3.661878109587*^9}, {
   3.6618788701515017`*^9, 3.6618788806131*^9}, {3.6618789804188085`*^9, 
   3.6618789891603084`*^9}, 3.683636454640643*^9, {3.683652225472674*^9, 
   3.683652225492675*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "taking", " ", "these", " ", "terms", " ", "from", " ", "the", " ", 
     "IndependentActionPrediction", " ", "function", " ", "and", " ", 
     "giving", " ", "them", " ", "disease"}], "-", "class", "-", 
    RowBox[{"specific", " ", "names", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", ".", "g", ".", " ", "PDAC"}], "..."}], ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "PDACModelsInBothMonotherapies", "=", "ModelsInBothMonotherapies"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACBestPredictedResponses", "=", "BestOfMonotherapyResponses"}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6618725829678955`*^9, 3.661872588193194*^9}, {
   3.6618726295045567`*^9, 3.661872629764572*^9}, {3.661877692683154*^9, 
   3.6618777181156087`*^9}, 3.6618781459680805`*^9, {3.661878880981121*^9, 
   3.6618788823161974`*^9}, {3.6618789894023223`*^9, 3.661878989979355*^9}, 
   3.683636454653644*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "looking", " ", "along", " ", "the", " ", "diagonal", " ", "of", " ", 
     "the", " ", "all", " ", "pair", " ", "predictions"}], " ", "-", " ", 
    RowBox[{
    "here", " ", "drug1", " ", "and", " ", "drug2", " ", "are", " ", 
     "identical"}], " ", "-", " ", 
    RowBox[{
    "to", " ", "determine", " ", "the", " ", "monotherapy", " ", "with", " ", 
     "the", " ", "best", " ", "single"}], "-", 
    RowBox[{"agent", " ", "improvement", " ", "over", " ", "untreated", " ", 
     RowBox[{"(", 
      RowBox[{"quantified", " ", "by", " ", "average", " ", "PFS"}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestPDACMonotherapyResponseOverUntreated", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "AllPDACPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionOfBestPDACMonotherapyResponseOverUntreated", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllPDACPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "AllPDACPairs", "]"}]}], "}"}]}], "]"}], 
        ",", "BestPDACMonotherapyResponseOverUntreated"}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"what", " ", "is", " ", "this", " ", 
     RowBox[{"therapy", "'"}], "s", " ", 
     RowBox[{"name", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BestPDACMonotherapyResponseOverUntreatedCompound", "=", 
    RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{
     "tumortype", ",", "PositionOfBestPDACMonotherapyResponseOverUntreated"}],
      "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "PDX", " ", "models", " ", "were", " ", "in", " ", "this", 
     " ", "best", " ", 
     RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACModelsInBestMonotherapy", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{
             "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BestPDACMonotherapyResponseOverUntreatedCompound"}]}], "]"}], 
         "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661874763318604*^9, 3.661874812601423*^9}, {
   3.6618777281231813`*^9, 3.661877842693734*^9}, {3.6618780253211803`*^9, 
   3.661878044435273*^9}, {3.6618780977893248`*^9, 3.6618781277170367`*^9}, {
   3.661878886285424*^9, 3.661878891221707*^9}, {3.6618789902063684`*^9, 
   3.661878992565503*^9}, 3.683649507087191*^9, {3.683652225508676*^9, 
   3.683652225511676*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "gather", " ", "all", " ", "empirically", " ", "tested", " ", 
    "combination", " ", "therapy", " ", "responses", " ", "for", " ", "this", 
    " ", "disease", " ", "class"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PDACCombinationTherapyResponses", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
             RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
              RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
           "]"}], "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "CombinationTherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "...", " ", "and", " ", "their", " ", "survival", " ", "functions"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACCombinationSurvivalFunctions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{"PDACCombinationTherapyResponses", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}], 
          "]"}], "]"}], "[", "x", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PDACCombinationTherapyResponses", "]"}]}], 
        "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661876649980515*^9, 3.661876705040664*^9}, {
  3.661877870298313*^9, 3.6618779111956525`*^9}, {3.6618781939688263`*^9, 
  3.6618782065935483`*^9}, {3.661878891776738*^9, 3.6618788962439938`*^9}, {
  3.6618789927915163`*^9, 3.661878993626564*^9}, {3.6618790701299396`*^9, 
  3.661879070347952*^9}, {3.6836495277143707`*^9, 3.683649528310405*^9}, {
  3.683652225524677*^9, 3.6836522255306773`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "cap", " ", "the", " ", "survival", " ", "time", " ", "to", " ", "360", 
     " ", "days"}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "take", " ", "the", " ", "average", " ", 
     "across", " ", "all", " ", "models", " ", "to", " ", "measure", " ", 
     "the", " ", "\"\<area under the PFS curve\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "t"}], "=", 
     RowBox[{
      RowBox[{"0", " ", 
       RowBox[{"to", " ", "~", "t"}]}], "=", 
      RowBox[{"1", " ", "year"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "AUCfromSurvivalDistribution", "[", "survivaldistribution_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegrationTime", "=", "360"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Mean", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"{", 
             RowBox[{"#", ",", "IntegrationTime"}], "}"}], "]"}], "&"}], ",", 
          "survivaldistribution"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"equivalent", " ", "to", "\[IndentingNewLine]", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SurvivalFunction", "[", 
           RowBox[{"EmpiricalDistribution", "[", 
            RowBox[{
            "PDACCombinationTherapyResponses", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "IntegrationTime"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "combination", " ", "had", " ", "the", " ", "best", " ", 
     "AUC", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"integrated", " ", "over", " ", "1", " ", "year"}], ")"}], 
      "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACBestCombinationAUC", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"AUCfromSurvivalDistribution", ",", 
       RowBox[{"PDACCombinationTherapyResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}]}], 
      "]"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}], " ",
        "=", " ", 
       RowBox[{"All", " ", "combinations"}]}], ",", " ", 
      RowBox[{
      "All", " ", "rows", " ", "describing", " ", "the", " ", "individual", 
       " ", "PDXs", " ", "tested", " ", "for", " ", "a", " ", "given", " ", 
       "combination"}], ",", " ", 
      RowBox[{
      "9", "th", " ", "column", " ", "is", " ", "time", " ", "to", " ", 
       RowBox[{"double", "."}]}]}], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACPositionOfBestCombination", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"PDACBestCombinationAUC", ",", 
        RowBox[{"Max", "[", "PDACBestCombinationAUC", "]"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "are", " ", "the", " ", "names", " ", "of", " ", "the", " ", 
     "therapies", " ", "in", " ", "this", " ", 
     RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"PDACBestCombinationName", "=", 
    RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{"tumortype", ",", "PDACPositionOfBestCombination"}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "PDX", " ", "models", " ", "of", " ", "this", " ", 
     "disease", " ", "group", " ", "were", " ", "tested", " ", "with", " ", 
     "this", " ", 
     RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"PDACModelsInBestCombination", "=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{
            "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
           RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
            RowBox[{"tumortype", ",", "PDACPositionOfBestCombination"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6618770724856806`*^9, 3.66187713034099*^9}, {
   3.6618771617767878`*^9, 3.661877285538867*^9}, 3.6618779159779263`*^9, {
   3.6618782246555815`*^9, 3.661878303819109*^9}, {3.6618784283062296`*^9, 
   3.661878442955067*^9}, {3.6618786033372407`*^9, 3.6618786085815406`*^9}, {
   3.661878897963092*^9, 3.6618789018303137`*^9}, {3.6618789952066545`*^9, 
   3.6618789973617773`*^9}, {3.6836522255436783`*^9, 3.683652225549678*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "which", " ", "models", " ", "were", " ", "tested", " ", "in", " ", "all",
      " ", "of", " ", "the", " ", 
     RowBox[{"following", ":", "\[IndentingNewLine]", 
      RowBox[{"the", " ", "best", " ", "empirical", " ", "monotherapy"}]}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
    "the", " ", "best", " ", "empirical", " ", "combination", " ", 
     "therapy"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "both", " ", "monotherapies", " ", "that", " ", "comprise", " ", "the", 
     " ", "best", " ", "predicted", " ", "combination", " ", "therapy"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PDACModelsInAllTherapiesForComparison", "=", 
    RowBox[{"Intersection", "[", 
     RowBox[{
     "PDACModelsInBothMonotherapies", ",", "PDACModelsInBestMonotherapy", ",",
       "PDACModelsInBestCombination"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6618784487283974`*^9, 3.661878532028162*^9}, {
  3.6618785656210833`*^9, 3.6618785664971333`*^9}, {3.6618789023383427`*^9, 
  3.6618789034154043`*^9}, {3.661878997697797*^9, 3.6618789986038485`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Within", " ", "this", " ", "set", " ", "of", " ", "PDX", " ", "models"}],
     "..."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
    "distribution", " ", "for", " ", "the", " ", "best", " ", 
    RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PDACSurvivalDistributionBestMonotherapy", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"PDACModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BestPDACMonotherapyResponseOverUntreatedCompound"}]}], "]"}], 
         "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
     "distribution", " ", "for", " ", "the", " ", "best", " ", 
     RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACSurvivalDistributionBestCombination", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"PDACModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "PDACBestCombinationName"}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "what", " ", "is", " ", "the", " ", "predicted", " ", "survival", " ", 
      "distribution", " ", "for", " ", "the", " ", "best", " ", 
      "heterogeneity"}], "-", 
     RowBox[{"addressing", " ", "pair", " ", "of", " ", 
      RowBox[{"monotherapies", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "PDACSurvivalDistributionBestPredictedPairOfMonotherapies", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDACBestPredictedResponses", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"PDACModelsInAllTherapiesForComparison", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
     "distribution", " ", "for", " ", 
     RowBox[{"untreated", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PDACSurvivalDistributionUntreated", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"PDACModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.66187853513334*^9, 3.661878730099491*^9}, {
  3.6618789038764305`*^9, 3.6618789069156046`*^9}, {3.661878998870864*^9, 
  3.6618790014880133`*^9}, {3.661881518516979*^9, 3.661881536763023*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["CRC", "Subsection",
 CellChangeTimes->{{3.661872330154435*^9, 3.661872332968596*^9}, {
  3.661878867816368*^9, 3.6618788685604105`*^9}, {3.6618789767876005`*^9, 
  3.6618789772576275`*^9}, {3.661879149840499*^9, 3.6618791500765123`*^9}, {
  3.7154695171091356`*^9, 3.7154695177811737`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "best", " ", "survival", " ", "over", 
    " ", "untreated", " ", "predicted", " ", "for", " ", "any", " ", 
    RowBox[{"combination", "?"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CRCBestPrediction", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "where", " ", "does", " ", "that", " ", "best", " ", "prediction", " ", 
    "lie", " ", "in", " ", "the", " ", "matrix", " ", "over", " ", "all", " ",
     "combination", " ", 
    RowBox[{"predictions", "?", " ", "The"}], " ", "drug", " ", "names", " ", 
    "are", " ", "in", " ", "the", " ", "corresponding", " ", "positions", " ",
     "of", " ", 
    RowBox[{
     RowBox[{
     "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], " ", "."}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CRCBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "CRCBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug1index", "=", 
   RowBox[{
   "CRCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug2index", "=", 
   RowBox[{
   "CRCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"drug1name", "=", 
  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
   RowBox[{"tumortype", ",", "drug1index"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug2name", "=", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug2index"}], "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "running", " ", "the", " ", "combination", " ", "prediction", " ", "for", 
     " ", "this", " ", "best", " ", "pair"}], ",", " ", 
    RowBox[{
    "to", " ", "load", " ", "into", " ", "memory", " ", "the", " ", "best", 
     " ", "monotherapy", " ", "responses", " ", 
     RowBox[{"(", "BestOfMonotherapyResponses", ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "also", " ", "the", " ", "set", " ", "of", " ", "PDX", " ", 
      "models", " ", "involved", " ", "in", " ", "this", " ", "prediction", 
      " ", 
      RowBox[{
       RowBox[{"(", "ModelsInBothMonotherapies", ")"}], ".", " ", "No"}], " ",
       "larger", " ", "set", " ", "of", " ", "models", " ", "is", " ", 
      "possible"}], ";", " ", 
     RowBox[{
     "the", " ", "prediction", " ", "does", " ", "not", " ", "exist", " ", 
      "when", " ", "the", " ", "model", " ", "has", " ", "not", " ", "been", 
      " ", "treated", " ", "with", " ", "both", " ", 
      RowBox[{"monotherapies", "."}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"IndependentActionPrediction", "[", 
  RowBox[{
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug1index"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug2index"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
    "\[RightDoubleBracket]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.661871641532048*^9, 3.661871695347126*^9}, {
   3.6618723011897783`*^9, 3.6618723044899673`*^9}, {3.6618723387879286`*^9, 
   3.6618724315302334`*^9}, {3.661872563613788*^9, 3.6618725638528023`*^9}, {
   3.661877494324809*^9, 3.6618775904663076`*^9}, {3.661877627489425*^9, 
   3.661877685511744*^9}, {3.661878109406989*^9, 3.661878109587*^9}, {
   3.6618788701515017`*^9, 3.6618788806131*^9}, {3.6618789804188085`*^9, 
   3.6618789891603084`*^9}, {3.6618791577179494`*^9, 3.6618791768430433`*^9}, 
   3.6836364546646447`*^9, {3.6836522255606785`*^9, 3.6836522255766797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "taking", " ", "these", " ", "terms", " ", "from", " ", "the", " ", 
     "IndependentActionPrediction", " ", "function", " ", "and", " ", 
     "giving", " ", "them", " ", "disease"}], "-", "class", "-", 
    RowBox[{"specific", " ", "names", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", ".", "g", ".", " ", "CRC"}], "..."}], ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "CRCModelsInBothMonotherapies", "=", "ModelsInBothMonotherapies"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCBestPredictedResponses", "=", "BestOfMonotherapyResponses"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6618725829678955`*^9, 3.661872588193194*^9}, {
   3.6618726295045567`*^9, 3.661872629764572*^9}, {3.661877692683154*^9, 
   3.6618777181156087`*^9}, 3.6618781459680805`*^9, {3.661878880981121*^9, 
   3.6618788823161974`*^9}, {3.6618789894023223`*^9, 3.661878989979355*^9}, {
   3.6618791593110404`*^9, 3.661879159746065*^9}, 3.6836364546776457`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "looking", " ", "along", " ", "the", " ", "diagonal", " ", "of", " ", 
     "the", " ", "all", " ", "pair", " ", "predictions"}], " ", "-", " ", 
    RowBox[{
    "here", " ", "drug1", " ", "and", " ", "drug2", " ", "are", " ", 
     "identical"}], " ", "-", " ", 
    RowBox[{
    "to", " ", "determine", " ", "the", " ", "monotherapy", " ", "with", " ", 
     "the", " ", "best", " ", "single"}], "-", 
    RowBox[{"agent", " ", "improvement", " ", "over", " ", "untreated", " ", 
     RowBox[{"(", 
      RowBox[{"quantified", " ", "by", " ", "average", " ", "PFS"}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestCRCMonotherapyResponseOverUntreated", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "AllCRCPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionOfBestCRCMonotherapyResponseOverUntreated", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllCRCPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "AllCRCPairs", "]"}]}], "}"}]}], "]"}], 
        ",", "BestCRCMonotherapyResponseOverUntreated"}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"what", " ", "is", " ", "this", " ", 
     RowBox[{"therapy", "'"}], "s", " ", 
     RowBox[{"name", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BestCRCMonotherapyResponseOverUntreatedCompound", "=", 
    RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{
     "tumortype", ",", "PositionOfBestCRCMonotherapyResponseOverUntreated"}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "PDX", " ", "models", " ", "were", " ", "in", " ", "this", 
     " ", "best", " ", 
     RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCModelsInBestMonotherapy", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{
             "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BestCRCMonotherapyResponseOverUntreatedCompound"}]}], "]"}], 
         "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661874763318604*^9, 3.661874812601423*^9}, {
   3.6618777281231813`*^9, 3.661877842693734*^9}, {3.6618780253211803`*^9, 
   3.661878044435273*^9}, {3.6618780977893248`*^9, 3.6618781277170367`*^9}, {
   3.661878886285424*^9, 3.661878891221707*^9}, {3.6618789902063684`*^9, 
   3.661878992565503*^9}, {3.6618791599750786`*^9, 3.6618791621462026`*^9}, 
   3.683649507112192*^9, {3.6836522255896807`*^9, 3.683652225593681*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "gather", " ", "all", " ", "empirically", " ", "tested", " ", 
    "combination", " ", "therapy", " ", "responses", " ", "for", " ", "this", 
    " ", "disease", " ", "class"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CRCCombinationTherapyResponses", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
             RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
              RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
           "]"}], "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "CombinationTherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "...", " ", "and", " ", "their", " ", "survival", " ", "functions"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCCombinationSurvivalFunctions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{"CRCCombinationTherapyResponses", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}], 
          "]"}], "]"}], "[", "x", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "CRCCombinationTherapyResponses", "]"}]}], 
        "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661876649980515*^9, 3.661876705040664*^9}, {
  3.661877870298313*^9, 3.6618779111956525`*^9}, {3.6618781939688263`*^9, 
  3.6618782065935483`*^9}, {3.661878891776738*^9, 3.6618788962439938`*^9}, {
  3.6618789927915163`*^9, 3.661878993626564*^9}, {3.6618790701299396`*^9, 
  3.661879070347952*^9}, {3.661879162364215*^9, 3.661879163255266*^9}, {
  3.6836496344214745`*^9, 3.68364963470049*^9}, {3.683652225606682*^9, 
  3.683652225612682*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "cap", " ", "the", " ", "survival", " ", "time", " ", "to", " ", "360", 
     " ", "days"}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "take", " ", "the", " ", "average", " ", 
     "across", " ", "all", " ", "models", " ", "to", " ", "measure", " ", 
     "the", " ", "\"\<area under the PFS curve\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "t"}], "=", 
     RowBox[{
      RowBox[{"0", " ", 
       RowBox[{"to", " ", "~", "t"}]}], "=", 
      RowBox[{"1", " ", "year"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "AUCfromSurvivalDistribution", "[", "survivaldistribution_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegrationTime", "=", "360"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Mean", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"{", 
             RowBox[{"#", ",", "IntegrationTime"}], "}"}], "]"}], "&"}], ",", 
          "survivaldistribution"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"equivalent", " ", "to", "\[IndentingNewLine]", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SurvivalFunction", "[", 
           RowBox[{"EmpiricalDistribution", "[", 
            RowBox[{
            "CRCCombinationTherapyResponses", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "IntegrationTime"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "combination", " ", "had", " ", "the", " ", "best", " ", 
     "AUC", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"integrated", " ", "over", " ", "1", " ", "year"}], ")"}], 
      "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCBestCombinationAUC", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"AUCfromSurvivalDistribution", ",", 
       RowBox[{"CRCCombinationTherapyResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}]}], 
      "]"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}], " ",
        "=", " ", 
       RowBox[{"All", " ", "combinations"}]}], ",", " ", 
      RowBox[{
      "All", " ", "rows", " ", "describing", " ", "the", " ", "individual", 
       " ", "PDXs", " ", "tested", " ", "for", " ", "a", " ", "given", " ", 
       "combination"}], ",", " ", 
      RowBox[{
      "9", "th", " ", "column", " ", "is", " ", "time", " ", "to", " ", 
       RowBox[{"double", "."}]}]}], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCPositionOfBestCombination", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"CRCBestCombinationAUC", ",", 
        RowBox[{"Max", "[", "CRCBestCombinationAUC", "]"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "are", " ", "the", " ", "names", " ", "of", " ", "the", " ", 
     "therapies", " ", "in", " ", "this", " ", 
     RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"CRCBestCombinationName", "=", 
    RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{"tumortype", ",", "CRCPositionOfBestCombination"}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "PDX", " ", "models", " ", "of", " ", "this", " ", 
     "disease", " ", "group", " ", "were", " ", "tested", " ", "with", " ", 
     "this", " ", 
     RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"CRCModelsInBestCombination", "=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{
            "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
           RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
            RowBox[{"tumortype", ",", "CRCPositionOfBestCombination"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6618770724856806`*^9, 3.66187713034099*^9}, {
   3.6618771617767878`*^9, 3.661877285538867*^9}, 3.6618779159779263`*^9, {
   3.6618782246555815`*^9, 3.661878303819109*^9}, {3.6618784283062296`*^9, 
   3.661878442955067*^9}, {3.6618786033372407`*^9, 3.6618786085815406`*^9}, {
   3.661878897963092*^9, 3.6618789018303137`*^9}, {3.6618789952066545`*^9, 
   3.6618789973617773`*^9}, {3.661879163514281*^9, 3.6618791661364307`*^9}, {
   3.6836522256246824`*^9, 3.6836522256296825`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "which", " ", "models", " ", "were", " ", "tested", " ", "in", " ", "all",
      " ", "of", " ", "the", " ", 
     RowBox[{"following", ":", "\[IndentingNewLine]", 
      RowBox[{"the", " ", "best", " ", "empirical", " ", "monotherapy"}]}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
    "the", " ", "best", " ", "empirical", " ", "combination", " ", 
     "therapy"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "both", " ", "monotherapies", " ", "that", " ", "comprise", " ", "the", 
     " ", "best", " ", "predicted", " ", "combination", " ", "therapy"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CRCModelsInAllTherapiesForComparison", "=", 
    RowBox[{"Intersection", "[", 
     RowBox[{
     "CRCModelsInBothMonotherapies", ",", "CRCModelsInBestMonotherapy", ",", 
      "CRCModelsInBestCombination"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6618784487283974`*^9, 3.661878532028162*^9}, {
  3.6618785656210833`*^9, 3.6618785664971333`*^9}, {3.6618789023383427`*^9, 
  3.6618789034154043`*^9}, {3.661878997697797*^9, 3.6618789986038485`*^9}, {
  3.6618791663474426`*^9, 3.661879167005481*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Within", " ", "this", " ", "set", " ", "of", " ", "PDX", " ", "models"}],
     "..."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
    "distribution", " ", "for", " ", "the", " ", "best", " ", 
    RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CRCSurvivalDistributionBestMonotherapy", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"CRCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BestCRCMonotherapyResponseOverUntreatedCompound"}]}], "]"}], 
         "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
     "distribution", " ", "for", " ", "the", " ", "best", " ", 
     RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCSurvivalDistributionBestCombination", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"CRCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "CRCBestCombinationName"}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "what", " ", "is", " ", "the", " ", "predicted", " ", "survival", " ", 
      "distribution", " ", "for", " ", "the", " ", "best", " ", 
      "heterogeneity"}], "-", 
     RowBox[{"addressing", " ", "pair", " ", "of", " ", 
      RowBox[{"monotherapies", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "CRCSurvivalDistributionBestPredictedPairOfMonotherapies", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CRCBestPredictedResponses", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"CRCModelsInAllTherapiesForComparison", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
     "distribution", " ", "for", " ", 
     RowBox[{"untreated", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CRCSurvivalDistributionUntreated", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"CRCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.66187853513334*^9, 3.661878730099491*^9}, {
  3.6618789038764305`*^9, 3.6618789069156046`*^9}, {3.661878998870864*^9, 
  3.6618790014880133`*^9}, {3.6618791672084923`*^9, 3.661879168943591*^9}, {
  3.661881544208449*^9, 3.6618815522269077`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Breast Cancer", "Subsection",
 CellChangeTimes->{{3.661872330154435*^9, 3.661872332968596*^9}, {
  3.661878867816368*^9, 3.6618788685604105`*^9}, {3.6618789767876005`*^9, 
  3.6618789772576275`*^9}, {3.661879261025858*^9, 3.661879261143865*^9}, {
  3.683649662029053*^9, 3.683649664693206*^9}, {3.715469525205599*^9, 
  3.715469525844635*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "best", " ", "survival", " ", "over", 
    " ", "untreated", " ", "predicted", " ", "for", " ", "any", " ", 
    RowBox[{"combination", "?"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCBestPrediction", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "where", " ", "does", " ", "that", " ", "best", " ", "prediction", " ", 
    "lie", " ", "in", " ", "the", " ", "matrix", " ", "over", " ", "all", " ",
     "combination", " ", 
    RowBox[{"predictions", "?", " ", "The"}], " ", "drug", " ", "names", " ", 
    "are", " ", "in", " ", "the", " ", "corresponding", " ", "positions", " ",
     "of", " ", 
    RowBox[{
     RowBox[{
     "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], " ", "."}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "BCBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug1index", "=", 
   RowBox[{
   "BCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug2index", "=", 
   RowBox[{
   "BCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"drug1name", "=", 
  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
   RowBox[{"tumortype", ",", "drug1index"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug2name", "=", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug2index"}], "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "running", " ", "the", " ", "combination", " ", "prediction", " ", "for", 
     " ", "this", " ", "best", " ", "pair"}], ",", " ", 
    RowBox[{
    "to", " ", "load", " ", "into", " ", "memory", " ", "the", " ", "best", 
     " ", "monotherapy", " ", "responses", " ", 
     RowBox[{"(", "BestOfMonotherapyResponses", ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "also", " ", "the", " ", "set", " ", "of", " ", "PDX", " ", 
      "models", " ", "involved", " ", "in", " ", "this", " ", "prediction", 
      " ", 
      RowBox[{
       RowBox[{"(", "ModelsInBothMonotherapies", ")"}], ".", " ", "No"}], " ",
       "larger", " ", "set", " ", "of", " ", "models", " ", "is", " ", 
      "possible"}], ";", " ", 
     RowBox[{
     "the", " ", "prediction", " ", "does", " ", "not", " ", "exist", " ", 
      "when", " ", "the", " ", "model", " ", "has", " ", "not", " ", "been", 
      " ", "treated", " ", "with", " ", "both", " ", 
      RowBox[{"monotherapies", "."}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"IndependentActionPrediction", "[", 
  RowBox[{
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug1index"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug2index"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
    "\[RightDoubleBracket]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.661871641532048*^9, 3.661871695347126*^9}, {
   3.6618723011897783`*^9, 3.6618723044899673`*^9}, {3.6618723387879286`*^9, 
   3.6618724315302334`*^9}, {3.661872563613788*^9, 3.6618725638528023`*^9}, {
   3.661877494324809*^9, 3.6618775904663076`*^9}, {3.661877627489425*^9, 
   3.661877685511744*^9}, {3.661878109406989*^9, 3.661878109587*^9}, {
   3.6618788701515017`*^9, 3.6618788806131*^9}, {3.6618789804188085`*^9, 
   3.6618789891603084`*^9}, {3.66187926297897*^9, 3.661879272312504*^9}, 
   3.6836364546886463`*^9, {3.6836522256436834`*^9, 3.6836522256586847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "taking", " ", "these", " ", "terms", " ", "from", " ", "the", " ", 
     "IndependentActionPrediction", " ", "function", " ", "and", " ", 
     "giving", " ", "them", " ", "disease"}], "-", "class", "-", 
    RowBox[{"specific", " ", "names", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", ".", "g", ".", " ", "BC"}], "..."}], ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BCModelsInBothMonotherapies", "=", "ModelsInBothMonotherapies"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCBestPredictedResponses", "=", "BestOfMonotherapyResponses"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6618725829678955`*^9, 3.661872588193194*^9}, {
   3.6618726295045567`*^9, 3.661872629764572*^9}, {3.661877692683154*^9, 
   3.6618777181156087`*^9}, 3.6618781459680805`*^9, {3.661878880981121*^9, 
   3.6618788823161974`*^9}, {3.6618789894023223`*^9, 3.661878989979355*^9}, {
   3.6618792725545177`*^9, 3.6618792730075436`*^9}, 3.683636454701647*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "looking", " ", "along", " ", "the", " ", "diagonal", " ", "of", " ", 
     "the", " ", "all", " ", "pair", " ", "predictions"}], " ", "-", " ", 
    RowBox[{
    "here", " ", "drug1", " ", "and", " ", "drug2", " ", "are", " ", 
     "identical"}], " ", "-", " ", 
    RowBox[{
    "to", " ", "determine", " ", "the", " ", "monotherapy", " ", "with", " ", 
     "the", " ", "best", " ", "single"}], "-", 
    RowBox[{"agent", " ", "improvement", " ", "over", " ", "untreated", " ", 
     RowBox[{"(", 
      RowBox[{"quantified", " ", "by", " ", "average", " ", "PFS"}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestBCMonotherapyResponseOverUntreated", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "AllBCPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionOfBestBCMonotherapyResponseOverUntreated", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllBCPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "AllBCPairs", "]"}]}], "}"}]}], "]"}], ",",
         "BestBCMonotherapyResponseOverUntreated"}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"what", " ", "is", " ", "this", " ", 
     RowBox[{"therapy", "'"}], "s", " ", 
     RowBox[{"name", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BestBCMonotherapyResponseOverUntreatedCompound", "=", 
    RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{
     "tumortype", ",", "PositionOfBestBCMonotherapyResponseOverUntreated"}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "PDX", " ", "models", " ", "were", " ", "in", " ", "this", 
     " ", "best", " ", 
     RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCModelsInBestMonotherapy", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{
             "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BestBCMonotherapyResponseOverUntreatedCompound"}]}], "]"}], 
         "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661874763318604*^9, 3.661874812601423*^9}, {
   3.6618777281231813`*^9, 3.661877842693734*^9}, {3.6618780253211803`*^9, 
   3.661878044435273*^9}, {3.6618780977893248`*^9, 3.6618781277170367`*^9}, {
   3.661878886285424*^9, 3.661878891221707*^9}, {3.6618789902063684`*^9, 
   3.661878992565503*^9}, {3.661879273219556*^9, 3.6618792753826795`*^9}, 
   3.683649507134194*^9, {3.683652225672685*^9, 3.6836522256746855`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "gather", " ", "all", " ", "empirically", " ", "tested", " ", 
    "combination", " ", "therapy", " ", "responses", " ", "for", " ", "this", 
    " ", "disease", " ", "class"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BCCombinationTherapyResponses", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
             RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
              RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
           "]"}], "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "CombinationTherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "...", " ", "and", " ", "their", " ", "survival", " ", "functions"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCCombinationSurvivalFunctions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{"BCCombinationTherapyResponses", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}], 
          "]"}], "]"}], "[", "x", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "BCCombinationTherapyResponses", "]"}]}], 
        "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661876649980515*^9, 3.661876705040664*^9}, {
  3.661877870298313*^9, 3.6618779111956525`*^9}, {3.6618781939688263`*^9, 
  3.6618782065935483`*^9}, {3.661878891776738*^9, 3.6618788962439938`*^9}, {
  3.6618789927915163`*^9, 3.661878993626564*^9}, {3.6618790701299396`*^9, 
  3.661879070347952*^9}, {3.6618792756026917`*^9, 3.6618792764667416`*^9}, {
  3.683649674103744*^9, 3.6836496746597757`*^9}, {3.683652225687686*^9, 
  3.683652225692686*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "cap", " ", "the", " ", "survival", " ", "time", " ", "to", " ", "360", 
     " ", "days"}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "take", " ", "the", " ", "average", " ", 
     "across", " ", "all", " ", "models", " ", "to", " ", "measure", " ", 
     "the", " ", "\"\<area under the PFS curve\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "t"}], "=", 
     RowBox[{
      RowBox[{"0", " ", 
       RowBox[{"to", " ", "~", "t"}]}], "=", 
      RowBox[{"1", " ", "year"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "AUCfromSurvivalDistribution", "[", "survivaldistribution_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegrationTime", "=", "360"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Mean", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"{", 
             RowBox[{"#", ",", "IntegrationTime"}], "}"}], "]"}], "&"}], ",", 
          "survivaldistribution"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"equivalent", " ", "to", "\[IndentingNewLine]", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SurvivalFunction", "[", 
           RowBox[{"EmpiricalDistribution", "[", 
            RowBox[{
            "BCCombinationTherapyResponses", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "IntegrationTime"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "combination", " ", "had", " ", "the", " ", "best", " ", 
     "AUC", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"integrated", " ", "over", " ", "1", " ", "year"}], ")"}], 
      "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCBestCombinationAUC", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"AUCfromSurvivalDistribution", ",", 
       RowBox[{"BCCombinationTherapyResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}]}], 
      "]"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}], " ",
        "=", " ", 
       RowBox[{"All", " ", "combinations"}]}], ",", " ", 
      RowBox[{
      "All", " ", "rows", " ", "describing", " ", "the", " ", "individual", 
       " ", "PDXs", " ", "tested", " ", "for", " ", "a", " ", "given", " ", 
       "combination"}], ",", " ", 
      RowBox[{
      "9", "th", " ", "column", " ", "is", " ", "time", " ", "to", " ", 
       RowBox[{"double", "."}]}]}], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCPositionOfBestCombination", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"BCBestCombinationAUC", ",", 
        RowBox[{"Max", "[", "BCBestCombinationAUC", "]"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "are", " ", "the", " ", "names", " ", "of", " ", "the", " ", 
     "therapies", " ", "in", " ", "this", " ", 
     RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BCBestCombinationName", "=", 
    RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{"tumortype", ",", "BCPositionOfBestCombination"}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "PDX", " ", "models", " ", "of", " ", "this", " ", 
     "disease", " ", "group", " ", "were", " ", "tested", " ", "with", " ", 
     "this", " ", 
     RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BCModelsInBestCombination", "=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{
            "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
           RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
            RowBox[{"tumortype", ",", "BCPositionOfBestCombination"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6618770724856806`*^9, 3.66187713034099*^9}, {
   3.6618771617767878`*^9, 3.661877285538867*^9}, 3.6618779159779263`*^9, {
   3.6618782246555815`*^9, 3.661878303819109*^9}, {3.6618784283062296`*^9, 
   3.661878442955067*^9}, {3.6618786033372407`*^9, 3.6618786085815406`*^9}, {
   3.661878897963092*^9, 3.6618789018303137`*^9}, {3.6618789952066545`*^9, 
   3.6618789973617773`*^9}, {3.6618792766877537`*^9, 3.661879278680868*^9}, {
   3.6836522257056875`*^9, 3.6836522257116876`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "which", " ", "models", " ", "were", " ", "tested", " ", "in", " ", "all",
      " ", "of", " ", "the", " ", 
     RowBox[{"following", ":", "\[IndentingNewLine]", 
      RowBox[{"the", " ", "best", " ", "empirical", " ", "monotherapy"}]}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
    "the", " ", "best", " ", "empirical", " ", "combination", " ", 
     "therapy"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "both", " ", "monotherapies", " ", "that", " ", "comprise", " ", "the", 
     " ", "best", " ", "predicted", " ", "combination", " ", "therapy"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BCModelsInAllTherapiesForComparison", "=", 
    RowBox[{"Intersection", "[", 
     RowBox[{
     "BCModelsInBothMonotherapies", ",", "BCModelsInBestMonotherapy", ",", 
      "BCModelsInBestCombination"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6618784487283974`*^9, 3.661878532028162*^9}, {
  3.6618785656210833`*^9, 3.6618785664971333`*^9}, {3.6618789023383427`*^9, 
  3.6618789034154043`*^9}, {3.661878997697797*^9, 3.6618789986038485`*^9}, {
  3.6618792788978806`*^9, 3.6618792795619183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Within", " ", "this", " ", "set", " ", "of", " ", "PDX", " ", "models"}],
     "..."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
    "distribution", " ", "for", " ", "the", " ", "best", " ", 
    RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BCSurvivalDistributionBestMonotherapy", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"BCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BestBCMonotherapyResponseOverUntreatedCompound"}]}], "]"}], 
         "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
     "distribution", " ", "for", " ", "the", " ", "best", " ", 
     RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCSurvivalDistributionBestCombination", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"BCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BCBestCombinationName"}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "what", " ", "is", " ", "the", " ", "predicted", " ", "survival", " ", 
      "distribution", " ", "for", " ", "the", " ", "best", " ", 
      "heterogeneity"}], "-", 
     RowBox[{"addressing", " ", "pair", " ", "of", " ", 
      RowBox[{"monotherapies", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "BCSurvivalDistributionBestPredictedPairOfMonotherapies", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"BCBestPredictedResponses", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"BCModelsInAllTherapiesForComparison", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
     "distribution", " ", "for", " ", 
     RowBox[{"untreated", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BCSurvivalDistributionUntreated", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"BCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.66187853513334*^9, 3.661878730099491*^9}, {
  3.6618789038764305`*^9, 3.6618789069156046`*^9}, {3.661878998870864*^9, 
  3.6618790014880133`*^9}, {3.6618792797829313`*^9, 3.6618792815160303`*^9}, {
  3.6618815602363653`*^9, 3.661881567296769*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gastric Cancer", "Subsection",
 CellChangeTimes->{{3.661872330154435*^9, 3.661872332968596*^9}, {
  3.661878867816368*^9, 3.6618788685604105`*^9}, {3.6618789767876005`*^9, 
  3.6618789772576275`*^9}, {3.661879261025858*^9, 3.661879261143865*^9}, {
  3.661879333416999*^9, 3.661879333593009*^9}, {3.6836496919507647`*^9, 
  3.683649693952879*^9}, {3.715469533253059*^9, 3.7154695338610935`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "best", " ", "survival", " ", "over", 
    " ", "untreated", " ", "predicted", " ", "for", " ", "any", " ", 
    RowBox[{"combination", "?"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GCBestPrediction", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "where", " ", "does", " ", "that", " ", "best", " ", "prediction", " ", 
    "lie", " ", "in", " ", "the", " ", "matrix", " ", "over", " ", "all", " ",
     "combination", " ", 
    RowBox[{"predictions", "?", " ", "The"}], " ", "drug", " ", "names", " ", 
    "are", " ", "in", " ", "the", " ", "corresponding", " ", "positions", " ",
     "of", " ", 
    RowBox[{
     RowBox[{
     "MonotherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], " ", "."}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GCBestPredictionPosition", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
      "GCBestPrediction"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug1index", "=", 
   RowBox[{
   "GCBestPredictionPosition", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug2index", "=", 
   RowBox[{
   "GCBestPredictionPosition", "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"drug1name", "=", 
  RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
   RowBox[{"tumortype", ",", "drug1index"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drug2name", "=", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug2index"}], "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "running", " ", "the", " ", "combination", " ", "prediction", " ", "for", 
     " ", "this", " ", "best", " ", "pair"}], ",", " ", 
    RowBox[{
    "to", " ", "load", " ", "into", " ", "memory", " ", "the", " ", "best", 
     " ", "monotherapy", " ", "responses", " ", 
     RowBox[{"(", "BestOfMonotherapyResponses", ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "also", " ", "the", " ", "set", " ", "of", " ", "PDX", " ", 
      "models", " ", "involved", " ", "in", " ", "this", " ", "prediction", 
      " ", 
      RowBox[{
       RowBox[{"(", "ModelsInBothMonotherapies", ")"}], ".", " ", "No"}], " ",
       "larger", " ", "set", " ", "of", " ", "models", " ", "is", " ", 
      "possible"}], ";", " ", 
     RowBox[{
     "the", " ", "prediction", " ", "does", " ", "not", " ", "exist", " ", 
      "when", " ", "the", " ", "model", " ", "has", " ", "not", " ", "been", 
      " ", "treated", " ", "with", " ", "both", " ", 
      RowBox[{"monotherapies", "."}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"IndependentActionPrediction", "[", 
  RowBox[{
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug1index"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
    RowBox[{"tumortype", ",", "drug2index"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
    "\[RightDoubleBracket]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.661871641532048*^9, 3.661871695347126*^9}, {
   3.6618723011897783`*^9, 3.6618723044899673`*^9}, {3.6618723387879286`*^9, 
   3.6618724315302334`*^9}, {3.661872563613788*^9, 3.6618725638528023`*^9}, {
   3.661877494324809*^9, 3.6618775904663076`*^9}, {3.661877627489425*^9, 
   3.661877685511744*^9}, {3.661878109406989*^9, 3.661878109587*^9}, {
   3.6618788701515017`*^9, 3.6618788806131*^9}, {3.6618789804188085`*^9, 
   3.6618789891603084`*^9}, {3.66187926297897*^9, 3.661879272312504*^9}, {
   3.661879334954087*^9, 3.661879345974717*^9}, 3.6836364547126474`*^9, {
   3.683652225723688*^9, 3.683652225739689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "taking", " ", "these", " ", "terms", " ", "from", " ", "the", " ", 
     "IndependentActionPrediction", " ", "function", " ", "and", " ", 
     "giving", " ", "them", " ", "disease"}], "-", "class", "-", 
    RowBox[{"specific", " ", "names", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", ".", "g", ".", " ", "GC"}], "..."}], ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GCModelsInBothMonotherapies", "=", "ModelsInBothMonotherapies"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GCBestPredictedResponses", "=", "BestOfMonotherapyResponses"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6618725829678955`*^9, 3.661872588193194*^9}, {
   3.6618726295045567`*^9, 3.661872629764572*^9}, {3.661877692683154*^9, 
   3.6618777181156087`*^9}, 3.6618781459680805`*^9, {3.661878880981121*^9, 
   3.6618788823161974`*^9}, {3.6618789894023223`*^9, 3.661878989979355*^9}, {
   3.6618792725545177`*^9, 3.6618792730075436`*^9}, {3.6618793466997585`*^9, 
   3.6618793477858205`*^9}, 3.6836364547266483`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "looking", " ", "along", " ", "the", " ", "diagonal", " ", "of", " ", 
     "the", " ", "all", " ", "pair", " ", "predictions"}], " ", "-", " ", 
    RowBox[{
    "here", " ", "drug1", " ", "and", " ", "drug2", " ", "are", " ", 
     "identical"}], " ", "-", " ", 
    RowBox[{
    "to", " ", "determine", " ", "the", " ", "monotherapy", " ", "with", " ", 
     "the", " ", "best", " ", "single"}], "-", 
    RowBox[{"agent", " ", "improvement", " ", "over", " ", "untreated", " ", 
     RowBox[{"(", 
      RowBox[{"quantified", " ", "by", " ", "average", " ", "PFS"}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestGCMonotherapyResponseOverUntreated", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "AllGCPairs", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionOfBestGCMonotherapyResponseOverUntreated", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"AllGCPairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "AllGCPairs", "]"}]}], "}"}]}], "]"}], ",",
         "BestGCMonotherapyResponseOverUntreated"}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"what", " ", "is", " ", "this", " ", 
     RowBox[{"therapy", "'"}], "s", " ", 
     RowBox[{"name", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BestGCMonotherapyResponseOverUntreatedCompound", "=", 
    RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{
     "tumortype", ",", "PositionOfBestGCMonotherapyResponseOverUntreated"}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "PDX", " ", "models", " ", "were", " ", "in", " ", "this", 
     " ", "best", " ", 
     RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GCModelsInBestMonotherapy", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{
             "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BestGCMonotherapyResponseOverUntreatedCompound"}]}], "]"}], 
         "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661874763318604*^9, 3.661874812601423*^9}, {
   3.6618777281231813`*^9, 3.661877842693734*^9}, {3.6618780253211803`*^9, 
   3.661878044435273*^9}, {3.6618780977893248`*^9, 3.6618781277170367`*^9}, {
   3.661878886285424*^9, 3.661878891221707*^9}, {3.6618789902063684`*^9, 
   3.661878992565503*^9}, {3.661879273219556*^9, 3.6618792753826795`*^9}, {
   3.6618793483078504`*^9, 3.6618793513320236`*^9}, 3.6836495071481943`*^9, {
   3.68365222575169*^9, 3.68365222575469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "gather", " ", "all", " ", "empirically", " ", "tested", " ", 
    "combination", " ", "therapy", " ", "responses", " ", "for", " ", "this", 
    " ", "disease", " ", "class"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GCCombinationTherapyResponses", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"PDXclinicaltrialresponses", ",", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
             RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
              RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}]}]}], 
           "]"}], "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "CombinationTherapiesByGroup", "\[LeftDoubleBracket]", "tumortype", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "...", " ", "and", " ", "their", " ", "survival", " ", "functions"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GCCombinationSurvivalFunctions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SurvivalFunction", "[", 
         RowBox[{"EmpiricalDistribution", "[", 
          RowBox[{"GCCombinationTherapyResponses", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}], 
          "]"}], "]"}], "[", "x", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "GCCombinationTherapyResponses", "]"}]}], 
        "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.661876649980515*^9, 3.661876705040664*^9}, {
  3.661877870298313*^9, 3.6618779111956525`*^9}, {3.6618781939688263`*^9, 
  3.6618782065935483`*^9}, {3.661878891776738*^9, 3.6618788962439938`*^9}, {
  3.6618789927915163`*^9, 3.661878993626564*^9}, {3.6618790701299396`*^9, 
  3.661879070347952*^9}, {3.6618792756026917`*^9, 3.6618792764667416`*^9}, {
  3.6618793515900383`*^9, 3.661879352582095*^9}, {3.6836497175912313`*^9, 
  3.683649717851246*^9}, {3.6836522257666903`*^9, 3.683652225772691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "cap", " ", "the", " ", "survival", " ", "time", " ", "to", " ", "360", 
     " ", "days"}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "take", " ", "the", " ", "average", " ", 
     "across", " ", "all", " ", "models", " ", "to", " ", "measure", " ", 
     "the", " ", "\"\<area under the PFS curve\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "t"}], "=", 
     RowBox[{
      RowBox[{"0", " ", 
       RowBox[{"to", " ", "~", "t"}]}], "=", 
      RowBox[{"1", " ", "year"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "AUCfromSurvivalDistribution", "[", "survivaldistribution_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegrationTime", "=", "360"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Mean", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"{", 
             RowBox[{"#", ",", "IntegrationTime"}], "}"}], "]"}], "&"}], ",", 
          "survivaldistribution"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"equivalent", " ", "to", "\[IndentingNewLine]", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SurvivalFunction", "[", 
           RowBox[{"EmpiricalDistribution", "[", 
            RowBox[{
            "GCCombinationTherapyResponses", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], "]"}], "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "IntegrationTime"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "combination", " ", "had", " ", "the", " ", "best", " ", 
     "AUC", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"integrated", " ", "over", " ", "1", " ", "year"}], ")"}], 
      "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GCBestCombinationAUC", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"AUCfromSurvivalDistribution", ",", 
       RowBox[{"GCCombinationTherapyResponses", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}]}], 
      "]"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "9"}], "\[RightDoubleBracket]"}], " ",
        "=", " ", 
       RowBox[{"All", " ", "combinations"}]}], ",", " ", 
      RowBox[{
      "All", " ", "rows", " ", "describing", " ", "the", " ", "individual", 
       " ", "PDXs", " ", "tested", " ", "for", " ", "a", " ", "given", " ", 
       "combination"}], ",", " ", 
      RowBox[{
      "9", "th", " ", "column", " ", "is", " ", "time", " ", "to", " ", 
       RowBox[{"double", "."}]}]}], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GCPositionOfBestCombination", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"GCBestCombinationAUC", ",", 
        RowBox[{"Max", "[", "GCBestCombinationAUC", "]"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "are", " ", "the", " ", "names", " ", "of", " ", "the", " ", 
     "therapies", " ", "in", " ", "this", " ", 
     RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"GCBestCombinationName", "=", 
    RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
     RowBox[{"tumortype", ",", "GCPositionOfBestCombination"}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "PDX", " ", "models", " ", "of", " ", "this", " ", 
     "disease", " ", "group", " ", "were", " ", "tested", " ", "with", " ", 
     "this", " ", 
     RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"GCModelsInBestCombination", "=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{
            "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
           RowBox[{"CombinationTherapiesByGroup", "\[LeftDoubleBracket]", 
            RowBox[{"tumortype", ",", "GCPositionOfBestCombination"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], "&"}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6618770724856806`*^9, 3.66187713034099*^9}, {
   3.6618771617767878`*^9, 3.661877285538867*^9}, 3.6618779159779263`*^9, {
   3.6618782246555815`*^9, 3.661878303819109*^9}, {3.6618784283062296`*^9, 
   3.661878442955067*^9}, {3.6618786033372407`*^9, 3.6618786085815406`*^9}, {
   3.661878897963092*^9, 3.6618789018303137`*^9}, {3.6618789952066545`*^9, 
   3.6618789973617773`*^9}, {3.6618792766877537`*^9, 3.661879278680868*^9}, {
   3.6618793528251085`*^9, 3.661879355222246*^9}, {3.683652225784692*^9, 
   3.6836522257906923`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "which", " ", "models", " ", "were", " ", "tested", " ", "in", " ", "all",
      " ", "of", " ", "the", " ", 
     RowBox[{"following", ":", "\[IndentingNewLine]", 
      RowBox[{"the", " ", "best", " ", "empirical", " ", "monotherapy"}]}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
    "the", " ", "best", " ", "empirical", " ", "combination", " ", 
     "therapy"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "both", " ", "monotherapies", " ", "that", " ", "comprise", " ", "the", 
     " ", "best", " ", "predicted", " ", "combination", " ", "therapy"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GCModelsInAllTherapiesForComparison", "=", 
    RowBox[{"Intersection", "[", 
     RowBox[{
     "GCModelsInBothMonotherapies", ",", "GCModelsInBestMonotherapy", ",", 
      "GCModelsInBestCombination"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6618784487283974`*^9, 3.661878532028162*^9}, {
  3.6618785656210833`*^9, 3.6618785664971333`*^9}, {3.6618789023383427`*^9, 
  3.6618789034154043`*^9}, {3.661878997697797*^9, 3.6618789986038485`*^9}, {
  3.6618792788978806`*^9, 3.6618792795619183`*^9}, {3.6618793555432644`*^9, 
  3.6618793563483105`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Within", " ", "this", " ", "set", " ", "of", " ", "PDX", " ", "models"}],
     "..."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
    "distribution", " ", "for", " ", "the", " ", "best", " ", 
    RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GCSurvivalDistributionBestMonotherapy", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"GCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "BestGCMonotherapyResponseOverUntreatedCompound"}]}], "]"}], 
         "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
     "distribution", " ", "for", " ", "the", " ", "best", " ", 
     RowBox[{"monotherapy", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GCSurvivalDistributionBestCombination", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"GCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
             "GCBestCombinationName"}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "what", " ", "is", " ", "the", " ", "predicted", " ", "survival", " ", 
      "distribution", " ", "for", " ", "the", " ", "best", " ", 
      "heterogeneity"}], "-", 
     RowBox[{"addressing", " ", "pair", " ", "of", " ", 
      RowBox[{"monotherapies", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "GCSurvivalDistributionBestPredictedPairOfMonotherapies", "=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"GCBestPredictedResponses", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"GCModelsInAllTherapiesForComparison", ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "what", " ", "is", " ", "the", " ", "observed", " ", "survival", " ", 
     "distribution", " ", "for", " ", 
     RowBox[{"untreated", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GCSurvivalDistributionUntreated", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"PDXclinicaltrialresponses", ",", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"GCModelsInAllTherapiesForComparison", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.66187853513334*^9, 3.661878730099491*^9}, {
  3.6618789038764305`*^9, 3.6618789069156046`*^9}, {3.661878998870864*^9, 
  3.6618790014880133`*^9}, {3.6618792797829313`*^9, 3.6618792815160303`*^9}, {
  3.661879356622326*^9, 3.6618793586924443`*^9}, {3.661881573626131*^9, 
  3.6618815836157026`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Pooling data from different tumor types (PDAC, CRC, Breast cancer, Gastric \
cancer)\n",
 StyleBox["(Melanoma and NSCLC are excluded because their \
\[OpenCurlyQuote]best predicted\[CloseCurlyQuote] combinations were \
experimentally measured and were confirmed as the best or approximately the \
best combinations; with the combination in melanoma showing efficacy far \
surpassing independent drug action)",
  FontSize->16]
}], "Subsection",
 CellChangeTimes->{{3.6618794756861362`*^9, 3.66187948012039*^9}, {
  3.6719046391385736`*^9, 3.6719046844261637`*^9}, {3.677950403792986*^9, 
  3.677950403890991*^9}, {3.6836497659519973`*^9, 3.6836498636875877`*^9}, {
  3.683650381222189*^9, 3.6836504539853506`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllModelPositionsInBothMonotherapiesOfPrediction", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "PDACModelsInBothMonotherapies", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PDACModelsInBothMonotherapies", "]"}]}], 
        "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "CRCModelsInBothMonotherapies", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "CRCModelsInBothMonotherapies", "]"}]}], 
        "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "BCModelsInBothMonotherapies", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "BCModelsInBothMonotherapies", "]"}]}], 
        "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "GCModelsInBothMonotherapies", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "GCModelsInBothMonotherapies", "]"}]}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.678552327590103*^9, 3.6785523811481667`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllModelPositionsInBestCombinations", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "PDACModelsInBestCombination", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PDACModelsInBestCombination", "]"}]}], 
        "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "CRCModelsInBestCombination", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "CRCModelsInBestCombination", "]"}]}], 
        "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "BCModelsInBestCombination", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "BCModelsInBestCombination", "]"}]}], "}"}]}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"WellCoveredModels", ",", 
          RowBox[{
          "GCModelsInBestCombination", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "GCModelsInBestCombination", "]"}]}], "}"}]}],
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6785521321569247`*^9, 3.6785522281874175`*^9}, {
  3.6785523193096294`*^9, 3.678552320740711*^9}, {3.678552385709427*^9, 
  3.678552387492529*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "analysis", " ", "is", " ", "limited", " ", "to", " ", "148", " ", "PDX", 
     " ", "models", " ", "that", " ", "were", " ", "tested", " ", "in", " ", 
     "both", " ", "the", " ", "best", " ", "observed", " ", "combination"}], 
    ",", " ", 
    RowBox[{
    "both", " ", "monotherapy", " ", "constituents", " ", "of", " ", "the", 
     " ", "best", " ", "predicted", " ", "combination"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "best", " ", "observed", " ", "monotherapy"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AllOverlappingModelsBetweenPredictionsAndBestCombinations", "=", 
     RowBox[{"Intersection", "[", 
      RowBox[{
      "AllModelPositionsInBothMonotherapiesOfPrediction", ",", 
       "AllModelPositionsInBestCombinations"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//", "Length"}]}]}]], "Input",
 CellChangeTimes->{{3.678552392808833*^9, 3.678552406643625*^9}, {
  3.6785524587726064`*^9, 3.678552473291437*^9}, {3.6836504781727343`*^9, 
  3.6836505013970623`*^9}, {3.683650540572303*^9, 3.6836505501258497`*^9}}],

Cell[BoxData[{"BestPDACMonotherapyResponseOverUntreatedCompound", "\
\[IndentingNewLine]", "BestCRCMonotherapyResponseOverUntreatedCompound", "\
\[IndentingNewLine]", "BestBCMonotherapyResponseOverUntreatedCompound", "\
\[IndentingNewLine]", "BestGCMonotherapyResponseOverUntreatedCompound"}], \
"Input",
 CellChangeTimes->{{3.678553455068591*^9, 3.678553463548076*^9}}],

Cell[BoxData[{"PDACBestCombinationName", "\[IndentingNewLine]", \
"CRCBestCombinationName", "\[IndentingNewLine]", "BCBestCombinationName", "\
\[IndentingNewLine]", "GCBestCombinationName"}], "Input",
 CellChangeTimes->{{3.6785532528200235`*^9, 3.6785532586843586`*^9}, {
  3.678553290158159*^9, 3.678553320219878*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"selecting", " ", "the", " ", "overall", " ", 
      RowBox[{"(", "\"\<one-size-fits-all\>\"", ")"}], " ", "best", " ", 
      "monotherapy", " ", "per", " ", "tumor", " ", "type"}], ";", " ", 
     RowBox[{
     "limited", " ", "to", " ", "those", " ", "PDXs", " ", "profiled", " ", 
      "in", " ", "both", " ", "monotherapies", " ", "of", " ", "the", " ", 
      "prediction"}]}], ",", " ", 
    RowBox[{"and", " ", "the", " ", "best", " ", "combination"}], ",", " ", 
    RowBox[{"and", " ", "the", " ", "best", " ", "monotherapy"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestMonotherapyPerTypeResponses", "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"WellCoveredModels", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "AllOverlappingModelsBetweenPredictionsAndBestCombinations"\
, "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"PDACModelsInBothMonotherapies", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"PDACModelsInBestCombination", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", "BestPDACMonotherapyResponseOverUntreatedCompound"}]}\
], "]"}], "&"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", 
               "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
               "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"WellCoveredModels", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "AllOverlappingModelsBetweenPredictionsAndBestCombinations"\
, "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"CRCModelsInBothMonotherapies", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"CRCModelsInBestCombination", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", 
                  "BestCRCMonotherapyResponseOverUntreatedCompound"}]}], 
                "]"}], "&"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", 
               "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
               "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"WellCoveredModels", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "AllOverlappingModelsBetweenPredictionsAndBestCombinations"\
, "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"BCModelsInBothMonotherapies", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"BCModelsInBestCombination", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", "BestBCMonotherapyResponseOverUntreatedCompound"}]}],
                 "]"}], "&"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", 
               "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
               "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"PDXclinicaltrialresponses", ",", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "==", 
                  RowBox[{"WellCoveredModels", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "AllOverlappingModelsBetweenPredictionsAndBestCombinations"\
, "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"GCModelsInBothMonotherapies", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"GCModelsInBestCombination", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "==", "BestGCMonotherapyResponseOverUntreatedCompound"}]}],
                 "]"}], "&"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
              "Length", "[", 
               "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
               "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"%", "//", "Length"}]}]}]], "Input",
 CellChangeTimes->{{3.6785538841081305`*^9, 3.678553885641218*^9}, {
  3.6785539373561764`*^9, 3.6785539864849863`*^9}, {3.678554038596967*^9, 
  3.678554253150239*^9}, {3.678554330636671*^9, 3.6785543322207613`*^9}, {
  3.6785548331914153`*^9, 3.678554893709877*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BestCombinationPerTypeResponses", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{"WellCoveredModels", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
                  "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"PDACModelsInBothMonotherapies", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"PDACModelsInBestCombination", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==",
                 "PDACBestCombinationName"}]}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", 
             "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
             "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{"WellCoveredModels", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
                  "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"CRCModelsInBothMonotherapies", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"CRCModelsInBestCombination", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "\[Equal]", "CRCBestCombinationName"}]}], "]"}], "&"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", 
             "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
             "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{"WellCoveredModels", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
                  "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"BCModelsInBothMonotherapies", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"BCModelsInBestCombination", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "\[Equal]", "BCBestCombinationName"}]}], "]"}], "&"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", 
             "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
             "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"PDXclinicaltrialresponses", ",", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
                RowBox[{"WellCoveredModels", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
                  "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"GCModelsInBothMonotherapies", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"GCModelsInBestCombination", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "\[Equal]", "GCBestCombinationName"}]}], "]"}], "&"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
            "Length", "[", 
             "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
             "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.678554290830394*^9, 3.6785543251963596`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PredictedResponsesInOverlappingModels", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
      "PDACBestPredictedResponses", ",", "CRCBestPredictedResponses", ",", 
       "BCBestPredictedResponses", ",", "GCBestPredictedResponses"}], "]"}], 
     ",", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{
        "WellCoveredModels", "\[LeftDoubleBracket]", 
         "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "]"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6785543855168095`*^9, 3.67855446279523*^9}}],

Cell[CellGroupData[{

Cell["\<\
Predicted combinations are expected, by independent action, to be \
significantly superior to treating each tumor type with its best observed \
monotherapy (Hazard Ratio = 0.69)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6836506527687206`*^9, 3.6836506948721285`*^9}, {
  3.6836507350154247`*^9, 3.683650762264983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], 
    ",", " ", 
    RowBox[{
    "comparing", " ", "predicted", " ", "combinations", " ", "to", " ", "the",
      " ", "observed", " ", "best", " ", "overall", " ", "monotherapy", " ", 
     "for", " ", "each", " ", "tumor", " ", "type"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"BestMonotherapyPerTypeResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PredictedResponsesInOverlappingModels", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "BestMonotherapyPerTypeResponses", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PredictedResponsesInOverlappingModels", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed monotherapies\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"BestMonotherapyPerTypeResponses", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<predicted combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PredictedResponsesInOverlappingModels", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6785547080852594`*^9, 3.6785547190928893`*^9}, {
  3.6836505934173255`*^9, 3.68365061674466*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Predicted combinations are expected, by independent action, to be \
statistically indistinguishable in effect from treating each tumor type with \
its best observed combination therapy (Hazard Ratio = 0.84)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6836506527687206`*^9, 3.6836507777768707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"hazard", " ", "ratio", " ", "by", " ", "Cox", " ", "Model"}], 
    ",", " ", 
    RowBox[{
    "comparing", " ", "predicted", " ", "combinations", " ", "to", " ", "the",
      " ", "observed", " ", "best", " ", "overall", " ", "combination", " ", 
     "therapy", " ", "for", " ", "each", " ", "tumor", " ", "type"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"myeventdata", "=", 
     RowBox[{"EventData", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"BestCombinationPerTypeResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "PredictedResponsesInOverlappingModels", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
             "BestCombinationPerTypeResponses", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "PredictedResponsesInOverlappingModels", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"descriptors", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<observed combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"BestCombinationPerTypeResponses", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<predicted combinations\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{
           "PredictedResponsesInOverlappingModels", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], 
          "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyModelFit", "=", 
     RowBox[{"CoxModelFit", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"descriptors", ",", "myeventdata"}], "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"{", "treatment", "}"}], ",", 
       RowBox[{"NominalVariables", "\[Rule]", "treatment"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"MyModelFit", "[", "\"\<ParameterTable\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "MyModelFit", "[", "\"\<RelativeRiskConfidenceIntervals\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6785546337170057`*^9, 3.6785546775505133`*^9}, {
  3.683650621066907*^9, 3.683650647655428*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UntreatedResponsesWithinOverlappingModels", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"PDXclinicaltrialresponses", ",", 
     RowBox[{
      RowBox[{"And", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{
          "WellCoveredModels", "\[LeftDoubleBracket]", 
           "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Equal]", "\"\<untreated\>\""}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6785552083258715`*^9, 3.678555299925111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "average", " ", "effect", " ", "of", " ", "all", " ", "monotherapies"}], 
    ",", " ", 
    RowBox[{
    "or", " ", "average", " ", "of", " ", "all", " ", "combination", " ", 
     "therapies"}], ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "particular", " ", "PDX", " ", "models", " ", 
     "that", " ", "have", " ", "constituted", " ", "this", " ", 
     "analysis"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MeanMonoWithin4IndicationsAndOverlappingModels", "=", 
     RowBox[{
     "PerModelMeanMonoResponses", "\[LeftDoubleBracket]", 
      "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
      "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MeanComboWithin4IndicationsAndOverlappingModels", "=", 
     RowBox[{
     "PerModelMeanComboResponses", "\[LeftDoubleBracket]", 
      "AllOverlappingModelsBetweenPredictionsAndBestCombinations", 
      "\[RightDoubleBracket]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.678555433988779*^9, 3.678555475476152*^9}, {
  3.6836507924117074`*^9, 3.683650834900138*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "UntreatedResponsesWithinOverlappingModels", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", 
         "MeanMonoWithin4IndicationsAndOverlappingModels", "]"}], "]"}], "[", 
       "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{
        "EmpiricalDistribution", "[", 
         "MeanComboWithin4IndicationsAndOverlappingModels", "]"}], "]"}], "[",
        "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"BestMonotherapyPerTypeResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{"BestCombinationPerTypeResponses", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SurvivalFunction", "[", 
        RowBox[{"EmpiricalDistribution", "[", 
         RowBox[{
         "PredictedResponsesInOverlappingModels", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
       "[", "x", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"30.5", "*", "7"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"30.5", "*", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "*", "100"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"i", "/", "61"}], "*", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.01"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "300", ",", 
             RowBox[{"61", "/", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Gray", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Darker", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
         RowBox[{"Dashing", "[", 
          RowBox[{"{", 
           RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"Dashing", "[", 
          RowBox[{"{", 
           RowBox[{"0.015", ",", "0.01"}], "}"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Darker", "[", 
          RowBox[{
           RowBox[{"ColorData", "[", 
            RowBox[{"3", ",", "4"}], "]"}], ",", "0.1"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "6"}], "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], "}"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"LineLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Untreated\>\"", ",", "\"\<Average monotherapy\>\"", ",", 
         "\"\<Average combination\>\"", ",", 
         "\"\<Best observed monotherapy per tumor type\>\"", ",", 
         "\"\<Best observed combination per tumor type\>\"", ",", 
         "\"\<Best predicted combination per tumor type\>\""}], "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.4"}], "}"}]}], ",", 
       RowBox[{"LegendMarkerSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"25", ",", "12"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Progression free survival (months)\>\"", ",", 
       RowBox[{"Rotate", "[", 
        RowBox[{"\"\<PDX patients (%)\>\"", ",", "0"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "230", "}"}]}], "}"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.45"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Figure 5C, comparison of predicted combinations and observed \
therapies.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.678555360191558*^9, 3.6785553922323904`*^9}, {
   3.6785554817695117`*^9, 3.678555484295656*^9}, {3.678555587704571*^9, 
   3.67855558839061*^9}, {3.6785557645556865`*^9, 3.678555779444538*^9}, 
   3.6824745413185306`*^9, 3.683519332368575*^9, {3.6836508397784166`*^9, 
   3.6836508708201923`*^9}, {3.6836509195569797`*^9, 
   3.6836509965513835`*^9}, {3.6836511070867057`*^9, 3.683651107983757*^9}, 
   3.7154650580870943`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Evaluating the expected benefits of predicted combinations in context of \
animal-to-animal variability.
Can animal-to-animal variability (when the same PDX model is treated with the \
same therapy in a replicate animal) explain the predicted benefits?\
\>", "Section",
 CellChangeTimes->{{3.662206868963071*^9, 3.6622068842289443`*^9}, {
  3.6836398418163786`*^9, 3.6836398605024476`*^9}, {3.68365142710601*^9, 
  3.683651508685676*^9}, {3.6836523937402983`*^9, 3.6836524189237385`*^9}}],

Cell[CellGroupData[{

Cell["\<\
A degree of animal-to-animal variability was reported by Gao et al. Nature \
Medicine (Figure 2a of that article) on the basis of 440 treatment models \
(meaning a specific treatment applied to a specific PDX) that were repeated \
on average in 5 different mice each, for a total of over 2000 drug-treated \
animals. Each treatment model was classified according to its ' majority' \
response criteria (which response was most commonly observed across the \
repeats). Figure 2a of Gao et al shows the fraction of times that each \
response criteria was observed within treatment models belonging to each \
majority response criteria (i.e, how often did an individual animal vary from \
other replicates of the same treatment model?). For example, treatment models \
that were most often a complete response (CR) were only CR in 74% of \
individual animals, being PR in 18% of animals and SD in 6% of animals.
This data was extracted from the published figure by digital image analysis.
  
Here we use this data as an error model for Gao et al' s PDX drug trials, and \
compute the expected benefit of repeating each measurement of a drug in a \
predicted combination twice and choosing the best observed response from two \
replicates. If this often provides similar benefit to that expected from \
predicted combinations, then their predicted benefits may be no more than the \
benefit of random experimental repeats.\
\>", "Subsubsection",
 CellChangeTimes->{{3.683651509523724*^9, 3.6836516352949176`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AnimalToAnimalVariabilityMatrix", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Animal to animal consistency probability matrix.csv\>\""}], ",", 
      "\"\<CSV\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Reproducing", " ", "Figure", " ", "2", "A", " ", "of", " ", "Gao", " ", 
     "et", " ", "al"}], ",", " ", 
    RowBox[{"Nature", " ", "Medicine"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"BarChart", "[", 
  RowBox[{
   RowBox[{"100", "*", 
    RowBox[{"AnimalToAnimalVariabilityMatrix", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"2", ";;"}], ",", 
      RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "100"}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"BarSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"ChartStyle", "\[Rule]", 
    RowBox[{"EdgeForm", "[", "None", "]"}]}], ",", 
   RowBox[{"ChartLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<CR\>\"", ",", "\"\<PR\>\"", ",", "\"\<SD\>\"", ",", "\"\<PD\>\""}], 
     "}"}]}], ",", 
   RowBox[{"ChartLabels", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Majority\\nresponse\\nCR\>\"", ",", 
        "\"\<Majority\\nresponse\\nPR\>\"", ",", 
        "\"\<Majority\\nresponse\\nSD\>\"", ",", 
        "\"\<Majority\\nresponse\\nPD\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{",", ",", ","}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"50", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"70", ",", "30"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<\>\"", ",", "\"\<Fraction (%)\>\""}], "}"}]}], ",", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"BaseStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
      RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6678349635923038`*^9, 3.6678350029195533`*^9}, {
  3.6835948777390113`*^9, 3.683595098100615*^9}, {3.6835951451573067`*^9, 
  3.6835951858816357`*^9}, {3.683595351966135*^9, 3.6835953528691874`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
    " ", "observed", " ", "response", " ", "criteria", " ", "and", " ", 
    "returns", " ", "the", " ", 
    RowBox[{"strongest", " ", "/", " ", "best"}], " ", "response"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BestResponseOfSet", "[", "listofresponsetypes_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"InitialResponse", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
          "listofresponsetypes"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ReponsesAsNumbers", "=", 
        RowBox[{"InitialResponse", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<CR\>\"", "\[Rule]", "3"}], ",", 
           RowBox[{"\"\<PR\>\"", "\[Rule]", "2"}], ",", 
           RowBox[{"\"\<SD\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<PD\>\"", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BestResponseAsNumber", "=", 
        RowBox[{"Max", "[", "ReponsesAsNumbers", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BestResponseType", "=", 
        RowBox[{"(", 
         RowBox[{"BestResponseAsNumber", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "\[Rule]", "\"\<CR\>\""}], ",", 
            RowBox[{"2", "\[Rule]", "\"\<PR\>\""}], ",", 
            RowBox[{"1", "\[Rule]", "\"\<SD\>\""}], ",", 
            RowBox[{"0", "\[Rule]", "\"\<PD\>\""}]}], "}"}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "function", " ", "takes", " ", "a", " ", "response", " ", 
      "criteria"}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "applies", " ", 
       RowBox[{"the", " ", "'"}], "error", " ", 
       RowBox[{"model", "'"}]}], " ", "-", " ", 
      RowBox[{"it", " ", "samples", " ", "from", " ", "the", " ", "animal"}], 
      "-", "to", "-", 
      RowBox[{
      "animal", " ", "variability", " ", "data", " ", "so", " ", "that", " ", 
       "there", " ", "is", " ", "a", " ", "chance", " ", "of", " ", 
       "obtaining", " ", "a", " ", "different", " ", "response"}]}], ",", " ", 
     RowBox[{
     "consistent", " ", "with", " ", "observed", " ", "probabilities", " ", 
      "of", " ", "variation"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "SampleResponseInDifferentAnimal", "[", "responsecategory_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "which", " ", "row", " ", "of", " ", "probabilities", " ", "in", " ", 
        "the", " ", "ConsistencyMatrix", " ", "should", " ", "we", " ", 
        "look", " ", 
        RowBox[{"up", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppropriateRow", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"responsecategory", "\[Equal]", "\"\<CR\>\""}], ",", "2", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"responsecategory", "\[Equal]", "\"\<PR\>\""}], ",", "3", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"responsecategory", "\[Equal]", "\"\<SD\>\""}], ",", "4", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"responsecategory", "\[Equal]", "\"\<PD\>\""}], ",", "5"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RandomizedResponseInDifferentAnimal", "=", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{"AnimalToAnimalVariabilityMatrix", "\[LeftDoubleBracket]", 
           RowBox[{"AppropriateRow", ",", 
            RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "->", 
          RowBox[{"{", 
           RowBox[{
           "\"\<CR\>\"", ",", "\"\<PR\>\"", ",", "\"\<SD\>\"", ",", 
            "\"\<PD\>\""}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
      " ", "response", " ", "criteria"}], ",", " ", 
     RowBox[{
     "and", " ", "applies", " ", "the", " ", "error", " ", "model", " ", "to",
       " ", "each", " ", "response", " ", "in", " ", "the", " ", "list"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "SimulatedAnimalToAnimalVariability", "[", "listofresponses_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "take", " ", "just", " ", "the", " ", "first", " ", "two", " ", 
         "characters", " ", 
         RowBox[{"(", 
          RowBox[{"CR", ",", " ", "PR", ",", " ", "SD", ",", " ", "PD"}], 
          ")"}], " ", "to", " ", "look", " ", "at", " ", "major", " ", 
         "response", " ", "categories"}], ",", " ", 
        RowBox[{
         RowBox[{"which", " ", "is", " ", "what", " ", "the", " ", "animal"}],
          "-", "to", "-", 
         RowBox[{
         "animal", " ", "consistency", " ", "data", " ", "addresses"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListOfMajorResponses", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "listofresponses"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
        "SampleResponseInDifferentAnimal", ",", "ListOfMajorResponses"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
      " ", "response", " ", "criteria", " ", 
      RowBox[{"(", 
       RowBox[{
       "representing", " ", "different", " ", "tumors", " ", "receiving", " ",
         "a", " ", "treatment"}], ")"}]}], ",", " ", 
     RowBox[{
     "uses", " ", "the", " ", "above", " ", "function", " ", "to", " ", 
      "apply", " ", "the", " ", "error", " ", "model"}], ",", " ", 
     RowBox[{
     "and", " ", "then", " ", "selects", " ", "for", " ", "each", " ", 
      "individual", " ", "tumor", " ", "the", " ", "best", " ", "of", " ", 
      "the", " ", "two", " ", "responses"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "BestResponsesPerPDXFromRealAnimalAndSimulatedSecondAnimalWithVariability"\
, "[", "listofresponses_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListOfMajorResponses", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "listofresponses"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SecondAnimalMajorResponses", "=", 
        RowBox[{
        "SimulatedAnimalToAnimalVariability", "[", "ListOfMajorResponses", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BestResponseOfSet", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "ListOfMajorResponses", "\[LeftDoubleBracket]", "pdx", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "SecondAnimalMajorResponses", "\[LeftDoubleBracket]", "pdx", 
             "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pdx", ",", "1", ",", 
           RowBox[{"Length", "[", "ListOfMajorResponses", "]"}]}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "function", " ", "converts", " ", "a", " ", "response", " ",
       "to", " ", "a", " ", 
      RowBox[{"number", ":", " ", 
       RowBox[{"1", " ", "for", " ", "any", " ", "response", " ", 
        RowBox[{"(", 
         RowBox[{"SD", ",", " ", "PR", ",", " ", "CR"}], ")"}]}]}]}], ",", 
     " ", 
     RowBox[{"0", " ", "for", " ", "no", " ", "response", " ", 
      RowBox[{"(", "PD", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ResponseAsNumber", "[", "responsestring_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MajorCategory", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"responsestring", ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MajorCategory", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<PD\>\"", "\[Rule]", "0"}], ",", 
          RowBox[{"\"\<SD\>\"", "\[Rule]", "1"}], ",", 
          RowBox[{"\"\<PR\>\"", "\[Rule]", "1"}], ",", 
          RowBox[{"\"\<CR\>\"", "\[Rule]", "1"}]}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.6678350235627337`*^9, {3.667837016336714*^9, 3.6678370213620014`*^9}, {
   3.6678373285455713`*^9, 3.6678373289665956`*^9}, {3.667837813244294*^9, 
   3.6678378142573524`*^9}, {3.6678384782443304`*^9, 
   3.6678384857987623`*^9}, {3.6678385399358587`*^9, 
   3.6678385404758897`*^9}, {3.6681676932437277`*^9, 3.668167731584921*^9}, {
   3.668175858609126*^9, 3.6681758608282533`*^9}, {3.668176410920417*^9, 
   3.668176411981219*^9}, {3.6681857014001937`*^9, 3.668185711234756*^9}, {
   3.66829238327478*^9, 3.668292383506793*^9}, {3.668339538643819*^9, 
   3.6683395475883307`*^9}, {3.6745013665250654`*^9, 3.674501367147066*^9}, 
   3.675528717486018*^9, 3.6756047981707325`*^9, 3.6836364544186306`*^9, {
   3.6836516400821915`*^9, 3.683651715638513*^9}, {3.683651796832157*^9, 
   3.6836518344853106`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This function takes a given tumor type and two monotherapies (according to \
their number in the list of therapies tested on that tumor type). It performs \
100,000 simulations of performing each monotherapy treatment twice, applying \
the error model to simulate the effect of animal-to-animal variability, and \
always returning the better response (i.e. calling the result a \
\[OpenCurlyQuote]response\[CloseCurlyQuote] if at least one of the two \
replicates demonstrates a response). These 100,000 simulations provide a \
distribution from which a P-value is computed for the probability that the \
predicted benefit of a combination (which stems from inducing responses in \
different individuals in a population) could be attributed to \
animal-to-animal variability.

Note that executing this is time-consuming.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6836518389795675`*^9, 3.683651842506769*^9}, {
  3.683652016439718*^9, 3.6836520187978525`*^9}, {3.6836524418800516`*^9, 
  3.683652653530157*^9}, {3.68371995640819*^9, 3.683719977632404*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "PvalueForBestResponsesOfDrugPairToBeExplainedByAnimalToAnimalVariability", 
   "[", 
   RowBox[{"tumortype_", ",", "drug1number_", ",", "drug2number_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"calling", " ", "the", " ", "function", " ", 
        RowBox[{"for", " ", "'"}], "independent", " ", "action", " ", 
        RowBox[{"prediction", "'"}], " ", "so", " ", "that", " ", "drug", " ",
         "responses", " ", "in", " ", "the", " ", "appropriate", " ", "set", 
        " ", "of", " ", "PDX", " ", "models", " ", "are", " ", "loaded", " ", 
        "into", " ", "memory"}], ";", " ", 
       RowBox[{
       "the", " ", "output", " ", "itself", " ", "does", " ", "not", " ", 
        "matter"}]}], ",", " ", 
      RowBox[{
      "only", " ", "defining", " ", "the", " ", "necessary", " ", "terms", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "loading"}], " ", "into", " ", 
         "memory"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoadingIntoMemory", "=", 
      RowBox[{"IndependentActionPrediction", "[", 
       RowBox[{
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
         RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
        "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
         "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"binarizing", " ", "each", " ", "PDXs", " ", 
       RowBox[{"response", ":", " ", 
        RowBox[{"1", " ", "or", " ", "0", " ", "for", " ", 
         RowBox[{"response", " ", "/", " ", "no"}], " ", "response"}]}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DrugAresponsesAsNumbers", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"ResponseAsNumber", ",", 
        RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"binarizing", " ", "each", " ", "PDXs", " ", 
       RowBox[{"response", ":", " ", 
        RowBox[{"1", " ", "or", " ", "0", " ", "for", " ", 
         RowBox[{"response", " ", "/", " ", "no"}], " ", "response"}]}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DrugBresponsesAsNumbers", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"ResponseAsNumber", ",", 
        RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"assuming", " ", "independent", " ", 
        RowBox[{"action", ":", " ", 
         RowBox[{
         "if", " ", "a", " ", "PDX", " ", "responds", " ", "to", " ", "one", 
          " ", "drug"}]}]}], ",", " ", 
       RowBox[{
       "it", " ", "will", " ", "respond", " ", "to", " ", "the", " ", 
        "second", " ", "drug"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"BestOfDrugADrugBresponsesAsNumbers", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"ResponseAsNumber", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"BestResponseOfSet", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"pdx", ",", 
               RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
              RowBox[{"pdx", ",", 
               RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"pdx", ",", "1", ",", 
            RowBox[{"Length", "[", "DrugAresponsesInIntersection", "]"}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"perform", " ", "100"}], ",", 
       RowBox[{
       "000", " ", "repeats", " ", "of", " ", "applying", " ", "the", " ", 
        "error", " ", "model", " ", "to", " ", "observed", " ", "monotherapy",
         " ", "responses"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"samplesize", "=", "100000"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ManyDrugABestsOfSimulatedAnimalPairs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"ResponseAsNumber", ",", 
           RowBox[{
           "BestResponsesPerPDXFromRealAnimalAndSimulatedSecondAnimalWithVaria\
bility", "[", 
            RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], "]"}],
          "]"}], ",", 
        RowBox[{"{", "samplesize", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ManyDrugBBestsOfSimulatedAnimalPairs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"ResponseAsNumber", ",", 
           RowBox[{
           "BestResponsesPerPDXFromRealAnimalAndSimulatedSecondAnimalWithVaria\
bility", "[", 
            RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], "]"}],
          "]"}], ",", 
        RowBox[{"{", "samplesize", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "how", " ", "many", " ", "of", " ", "the", " ", "repeats", " ", 
       "showed", " ", "a", " ", "response", " ", "rate", " ", "greater", " ", 
       "than", " ", "or", " ", "equal", " ", "to", " ", "the", " ", 
       "predicted", " ", "effect", " ", "of", " ", "the", " ", 
       RowBox[{"combination", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PvalueFromDrugA", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"ManyDrugABestsOfSimulatedAnimalPairs", ",", 
           RowBox[{
            RowBox[{"#", "\[GreaterEqual]", 
             RowBox[{
             "Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}]}], 
            "&"}]}], "]"}], "]"}], "/", "samplesize"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PvalueFromDrugB", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"ManyDrugBBestsOfSimulatedAnimalPairs", ",", 
           RowBox[{
            RowBox[{"#", "\[GreaterEqual]", 
             RowBox[{
             "Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}]}], 
            "&"}]}], "]"}], "]"}], "/", "samplesize"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "from", " ", "simulations", " ", "of", " ", "monotherapy", " ", "A", 
        " ", "and", " ", "monotherapy", " ", "B"}], ",", " ", 
       RowBox[{
        RowBox[{
        "report", " ", "the", " ", "larger", " ", "of", " ", "the", " ", 
         "two", " ", "P"}], "-", "values", " ", "-", " ", 
        RowBox[{
        "if", " ", "either", " ", "one", " ", "is", " ", "large", " ", "it", 
         " ", "suggests", " ", "that", " ", "animal"}], "-", "to", "-", 
        RowBox[{
        "animal", " ", "variability", " ", "might", " ", "explain", " ", 
         "the", " ", "predicted", " ", "effect"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Max", "[", 
      RowBox[{"{", 
       RowBox[{"PvalueFromDrugA", ",", "PvalueFromDrugB"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.6678350235627337`*^9, {3.667837016336714*^9, 3.6678370213620014`*^9}, {
   3.6678373285455713`*^9, 3.6678373289665956`*^9}, {3.667837813244294*^9, 
   3.6678378142573524`*^9}, {3.6678384782443304`*^9, 
   3.6678384857987623`*^9}, {3.6678385399358587`*^9, 
   3.6678385404758897`*^9}, {3.6681676932437277`*^9, 3.668167731584921*^9}, {
   3.668175858609126*^9, 3.6681758608282533`*^9}, {3.668176410920417*^9, 
   3.668176411981219*^9}, {3.6681857014001937`*^9, 3.668185711234756*^9}, {
   3.66829238327478*^9, 3.668292383506793*^9}, {3.668339538643819*^9, 
   3.6683395475883307`*^9}, {3.6745013665250654`*^9, 3.674501367147066*^9}, 
   3.675528717486018*^9, 3.6756047981707325`*^9, 3.6836364544186306`*^9, {
   3.6836516400821915`*^9, 3.683651715638513*^9}, {3.683651796832157*^9, 
   3.683651838264527*^9}, {3.68365187695674*^9, 3.6836519922263327`*^9}, {
   3.683652225803693*^9, 3.6836522258206935`*^9}, {3.6836526563833203`*^9, 
   3.6836527955122786`*^9}, {3.6836532790759363`*^9, 3.68365330326232*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["PDAC", "Subsection",
 CellChangeTimes->{{3.67552892684338*^9, 3.675528929342411*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
   "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "numbers", " ", "corresponding", " ", "to", " ", "the", " ", "two", " ", 
    "drugs", " ", "in", " ", "the", " ", "best", " ", "predicted", " ", 
    "combination", " ", "for", " ", "PDAC"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", "i"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6678405572442427`*^9, 3.667840557500257*^9}, {
  3.6836522259236994`*^9, 3.6836522259287*^9}, {3.6836528177175484`*^9, 
  3.683652840449848*^9}, {3.683719981096602*^9, 3.6837199816806355`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ModelNames", "\[LeftDoubleBracket]", "tumortype", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "3", 
   "\[RightDoubleBracket]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PvalueForBestResponsesOfDrugPairToBeExplainedByAnimalToAnimalVariabi\
lity", "[", 
  RowBox[{"tumortype", ",", "i", ",", "j"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6622068984727592`*^9, 3.6622069598862715`*^9}, {
   3.662207552083143*^9, 3.6622075759145064`*^9}, {3.6622076458385057`*^9, 
   3.6622076708839383`*^9}, {3.6678386645369854`*^9, 3.66783866636709*^9}, 
   3.6836364544556327`*^9, {3.6836522259316998`*^9, 3.6836522259447007`*^9}, {
   3.683653178412179*^9, 3.683653178571188*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binsize", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"height", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ManyDrugABestsOfSimulatedAnimalPairs", ",", 
      "ManyDrugBBestsOfSimulatedAnimalPairs"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "binsize"}], "/", "2"}], ",", 
      RowBox[{"1", "+", 
       RowBox[{"binsize", "/", "2"}]}], ",", "binsize"}], "}"}], ",", 
    "\"\<Probability\>\"", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "binsize"}], "/", "2"}], ",", 
         RowBox[{"1", "+", 
          RowBox[{"binsize", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"2", "/", "10"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", "0.1"}], "]"}],
        ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0.2"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "height"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Response rate (%)\>\"", ",", "\"\<Probability (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Bold"}], "]"}]}], ",", 
    RowBox[{"ChartLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Binimetinib\>\"", ",", "\"\<Gemcitabine\>\""}], "}"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S6, PDAC.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.674510035198144*^9, 3.6745103323977814`*^9}, {
   3.6745103787350326`*^9, 3.6745103853090644`*^9}, {3.6745104769275494`*^9, 
   3.6745104921306396`*^9}, {3.6745105464379244`*^9, 
   3.6745108010052705`*^9}, {3.674510846210518*^9, 3.6745112749817915`*^9}, {
   3.674511332511103*^9, 3.674511383848365*^9}, {3.674511620143671*^9, 
   3.6745116202936716`*^9}, {3.6745116631809034`*^9, 
   3.6745116682019343`*^9}, {3.6745118064906764`*^9, 
   3.6745118073236775`*^9}, {3.674511979107601*^9, 3.674511979741604*^9}, {
   3.675528939477991*^9, 3.675528944226262*^9}, 3.683652225950701*^9, {
   3.683653186091618*^9, 3.683653192894007*^9}, {3.683720866621251*^9, 
   3.6837209049824452`*^9}, {3.6837210091744046`*^9, 3.6837210187899547`*^9}, 
   3.6837210908720775`*^9, {3.6837211895417213`*^9, 3.683721242045724*^9}, {
   3.6837282174826965`*^9, 3.68372822698724*^9}, {3.6837290871494384`*^9, 
   3.6837291022193003`*^9}, 3.7154650581070952`*^9, 3.7154700660085306`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "predicted", " ", "combination", " ", "for", " ", "PDAC", " ",
      "reached", " ", "statistical", " ", "significance"}], ",", " ", 
    RowBox[{
    "but", " ", "in", " ", "terms", " ", "of", " ", "response", " ", "rate"}],
     ",", " ", 
    RowBox[{
    "being", " ", "any", " ", "response", " ", "better", " ", "than", " ", 
     "progressive", " ", "disease", " ", 
     RowBox[{"(", "PD", ")"}]}], ",", " ", 
    RowBox[{
    "the", " ", "magnitude", " ", "of", " ", "effect", " ", "is", " ", 
     "small", " ", "because", " ", "binimetinib", " ", "induces", " ", "at", 
     " ", "least", " ", "stable", " ", "disease", " ", "nearly", " ", "all", 
     " ", "PDAC", " ", "PDX", " ", 
     RowBox[{"tumors", ".", " ", "We"}], " ", "therefore", " ", "repeat", " ",
      "the", " ", "analysis", " ", "at", " ", "a", " ", "more", " ", 
     "stringent", " ", "level", " ", "of", " ", "response"}], ",", " ", 
    RowBox[{"considering", " ", "only", " ", "partial", " ", "response", " ", 
     RowBox[{"(", "PR", ")"}], " ", "or", " ", "complete", " ", "response", 
     " ", 
     RowBox[{"(", "CR", ")"}]}]}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "PartialOrCompleteResponseAsNumber", "[", "responsestring_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MajorCategory", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"responsestring", ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MajorCategory", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<PD\>\"", "\[Rule]", "0"}], ",", 
          RowBox[{"\"\<SD\>\"", "\[Rule]", "0"}], ",", 
          RowBox[{"\"\<PR\>\"", "\[Rule]", "1"}], ",", 
          RowBox[{"\"\<CR\>\"", "\[Rule]", "1"}]}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "PartialOrCompletePvalueForBestResponsesOfDrugPairToBeExplainedByAnimalToA\
nimalVariability", "[", 
     RowBox[{"tumortype_", ",", "drug1number_", ",", "drug2number_"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LoadingIntoMemory", "=", 
        RowBox[{"IndependentActionPrediction", "[", 
         RowBox[{
          RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
           RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
           RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
           "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DrugAresponsesAsNumbers", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"PartialOrCompleteResponseAsNumber", ",", 
          RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DrugBresponsesAsNumbers", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"PartialOrCompleteResponseAsNumber", ",", 
          RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BestOfDrugADrugBresponsesAsNumbers", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"PartialOrCompleteResponseAsNumber", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"BestResponseOfSet", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
                RowBox[{"pdx", ",", 
                 RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
                RowBox[{"pdx", ",", 
                 RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"pdx", ",", "1", ",", 
              RowBox[{"Length", "[", "DrugAresponsesInIntersection", "]"}]}], 
             "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"samplesize", "=", "100000"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ManyDrugABestsOfSimulatedAnimalPairs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"PartialOrCompleteResponseAsNumber", ",", 
             RowBox[{
             "BestResponsesPerPDXFromRealAnimalAndSimulatedSecondAnimalWithVar\
iability", "[", 
              RowBox[{"DrugAresponsesInIntersection", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", "samplesize", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ManyDrugBBestsOfSimulatedAnimalPairs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"PartialOrCompleteResponseAsNumber", ",", 
             RowBox[{
             "BestResponsesPerPDXFromRealAnimalAndSimulatedSecondAnimalWithVar\
iability", "[", 
              RowBox[{"DrugBresponsesInIntersection", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", "samplesize", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PvalueFromDrugA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"ManyDrugABestsOfSimulatedAnimalPairs", ",", 
             RowBox[{
              RowBox[{"#", ">", 
               RowBox[{
               "Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}]}], 
              "&"}]}], "]"}], "]"}], "/", "samplesize"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PvalueFromDrugB", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"ManyDrugBBestsOfSimulatedAnimalPairs", ",", 
             RowBox[{
              RowBox[{"#", ">", 
               RowBox[{
               "Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}]}], 
              "&"}]}], "]"}], "]"}], "/", "samplesize"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{"PvalueFromDrugA", ",", "PvalueFromDrugB"}], "}"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6745138751882105`*^9, 3.6745139115154*^9}, 
   3.6755289706348248`*^9, 3.683636454464633*^9, {3.6836522259547014`*^9, 
   3.6836522259647017`*^9}, 3.6837213194261503`*^9, {3.6837292962013955`*^9, 
   3.6837294261088257`*^9}}],

Cell[BoxData[
 RowBox[{"PartialOrCompletePvalueForBestResponsesOfDrugPairToBeExplainedByAnim\
alToAnimalVariability", "[", 
  RowBox[{"tumortype", ",", "i", ",", "j"}], "]"}]], "Input",
 CellChangeTimes->{3.6745139290454855`*^9, 3.683652225967702*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"height", "=", "0.35"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binsize", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"height", "=", "0.4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ManyDrugABestsOfSimulatedAnimalPairs", ",", 
      "ManyDrugBBestsOfSimulatedAnimalPairs"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "binsize"}], "/", "2"}], ",", 
      RowBox[{"1", "+", 
       RowBox[{"binsize", "/", "2"}]}], ",", "binsize"}], "}"}], ",", 
    "\"\<Probability\>\"", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "binsize"}], "/", "2"}], ",", 
         RowBox[{"1", "+", 
          RowBox[{"binsize", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", "0.1"}], "]"}],
        ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0.2"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "height"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Response rate (PR or CR) (%)\>\"", ",", 
       "\"\<Probability (%)\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Bold"}], "]"}]}], ",", 
    RowBox[{"ChartLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Binimetinib\>\"", ",", "\"\<Gemcitabine\>\""}], "}"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S6, PDAC, partial or complete \
response.pdf\>\""}], ",", "%", ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6745139443255644`*^9, 3.67451395624463*^9}, {
   3.6745141667205954`*^9, 3.674514169094619*^9}, {3.6755289758268332`*^9, 
   3.675528977076835*^9}, 3.6836522259747024`*^9, {3.683653201033473*^9, 
   3.68365320797787*^9}, 3.6837210506637774`*^9, 3.6837210912861013`*^9, {
   3.683721283041069*^9, 3.6837213051723347`*^9}, {3.6837215537305517`*^9, 
   3.6837216135079703`*^9}, {3.6837217803975163`*^9, 
   3.6837217805655255`*^9}, {3.683729129450858*^9, 3.683729150657071*^9}, {
   3.6837294503112097`*^9, 3.6837294503702135`*^9}, 3.7154650581160955`*^9, 
   3.715470067592621*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["colorectal cancer", "Subsection",
 CellChangeTimes->{{3.668176359070463*^9, 3.66817637170249*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
   "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "numbers", " ", "corresponding", " ", "to", " ", "the", " ", "two", " ", 
    "drugs", " ", "in", " ", "the", " ", "best", " ", "predicted", " ", 
    "combination", " ", "for", " ", "PDAC"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", "i"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6678405572442427`*^9, 3.667840557500257*^9}, {
  3.6836522259236994`*^9, 3.6836522259287*^9}, {3.6836528177175484`*^9, 
  3.683652840449848*^9}, {3.683719981096602*^9, 3.6837199816806355`*^9}, {
  3.683729568655979*^9, 3.6837295706730947`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "3", 
   "\[RightDoubleBracket]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PvalueForBestResponsesOfDrugPairToBeExplainedByAnimalToAnimalVariabi\
lity", "[", 
  RowBox[{"tumortype", ",", "i", ",", "j"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6622068984727592`*^9, 3.6622069598862715`*^9}, {
   3.6622069911810617`*^9, 3.6622070157964697`*^9}, {3.6622070703315887`*^9, 
   3.6622070716036615`*^9}, {3.662207684007689*^9, 3.662207695845366*^9}, {
   3.66783867929483*^9, 3.667838679670851*^9}, {3.667838862362301*^9, 
   3.6678388640513973`*^9}, 3.6836364544696336`*^9, {3.6836522259787025`*^9, 
   3.6836522260097046`*^9}, {3.6837295054583645`*^9, 3.6837295056173735`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binsize", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"height", "=", "0.4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ManyDrugABestsOfSimulatedAnimalPairs", ",", 
      "ManyDrugBBestsOfSimulatedAnimalPairs"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "binsize"}], "/", "2"}], ",", 
      RowBox[{"1", "+", 
       RowBox[{"binsize", "/", "2"}]}], ",", "binsize"}], "}"}], ",", 
    "\"\<Probability\>\"", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "binsize"}], "/", "2"}], ",", 
         RowBox[{"1", "+", 
          RowBox[{"binsize", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", "0.1"}], "]"}],
        ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0.2"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "height"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Response rate (%)\>\"", ",", "\"\<Probability (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Bold"}], "]"}]}], ",", 
    RowBox[{"ChartLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Binimetinib\>\"", ",", "\"\<CLR457\>\""}], "}"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S6, Colorectal carcinoma.pdf\>\""}], ",", "%", 
    ",", "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.674510035198144*^9, 3.6745103323977814`*^9}, {
   3.6745103787350326`*^9, 3.6745103853090644`*^9}, {3.6745104769275494`*^9, 
   3.6745104921306396`*^9}, {3.6745105464379244`*^9, 
   3.6745108010052705`*^9}, {3.674510846210518*^9, 3.6745112749817915`*^9}, {
   3.674511332511103*^9, 3.674511383848365*^9}, {3.674511620143671*^9, 
   3.6745116202936716`*^9}, {3.6745116631809034`*^9, 
   3.6745116682019343`*^9}, {3.6745118064906764`*^9, 
   3.6745118073236775`*^9}, {3.674511979107601*^9, 3.674511979741604*^9}, {
   3.674514636508318*^9, 3.6745146372573414`*^9}, {3.675529050045032*^9, 
   3.6755290564280453`*^9}, 3.6836522260147047`*^9, 3.6837210513278155`*^9, 
   3.6837210919581394`*^9, 3.683721553755553*^9, 3.6837216482119555`*^9, {
   3.6837221266313195`*^9, 3.683722180777416*^9}, 3.683723280411312*^9, 
   3.683723348889229*^9, {3.68372508117831*^9, 3.683725117433384*^9}, 
   3.715465058124096*^9, 3.715470068143653*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["breast cancer", "Subsection",
 CellChangeTimes->{{3.6681763648070745`*^9, 3.668176368152882*^9}, {
  3.7154701161804004`*^9, 3.715470116884441*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ModelNames", "\[LeftDoubleBracket]", "tumortype", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", "i"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6678405773183904`*^9, 3.667840580300561*^9}, {
  3.6836522260257053`*^9, 3.6836522260307055`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "3", 
   "\[RightDoubleBracket]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PvalueForBestResponsesOfDrugPairToBeExplainedByAnimalToAnimalVariabi\
lity", "[", 
  RowBox[{"tumortype", ",", "i", ",", "j"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6622068984727592`*^9, 3.6622069598862715`*^9}, {
   3.6622069911810617`*^9, 3.6622070157964697`*^9}, {3.6622077026097527`*^9, 
   3.6622077072390175`*^9}, {3.6678386858852067`*^9, 3.667838686223226*^9}, 
   3.6836364544746337`*^9, {3.6836522260337057`*^9, 3.6836522260457067`*^9}, {
   3.6837295146268888`*^9, 3.6837295147858973`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binsize", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"height", "=", "0.4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ManyDrugABestsOfSimulatedAnimalPairs", ",", 
      "ManyDrugBBestsOfSimulatedAnimalPairs"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "binsize"}], "/", "2"}], ",", 
      RowBox[{"1", "+", 
       RowBox[{"binsize", "/", "2"}]}], ",", "binsize"}], "}"}], ",", 
    "\"\<Probability\>\"", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "binsize"}], "/", "2"}], ",", 
         RowBox[{"1", "+", 
          RowBox[{"binsize", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", "0.1"}], "]"}],
        ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0.2"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "height"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Response rate (%)\>\"", ",", "\"\<Probability (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Bold"}], "]"}]}], ",", 
    RowBox[{"ChartLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Buparlisib\>\"", ",", "\"\<Paclitaxel\>\""}], "}"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S6, Breast cancer.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.674510035198144*^9, 3.6745103323977814`*^9}, {
   3.6745103787350326`*^9, 3.6745103853090644`*^9}, {3.6745104769275494`*^9, 
   3.6745104921306396`*^9}, {3.6745105464379244`*^9, 
   3.6745108010052705`*^9}, {3.674510846210518*^9, 3.6745112749817915`*^9}, {
   3.674511332511103*^9, 3.674511383848365*^9}, {3.674511620143671*^9, 
   3.6745116202936716`*^9}, {3.6745116631809034`*^9, 
   3.6745116682019343`*^9}, {3.6745118064906764`*^9, 
   3.6745118073236775`*^9}, {3.674511979107601*^9, 3.674511979741604*^9}, {
   3.674514636508318*^9, 3.6745146372573414`*^9}, {3.674515298797448*^9, 
   3.6745152993794494`*^9}, {3.6755291983524494`*^9, 3.6755292076404753`*^9}, 
   3.6836522260527067`*^9, 3.683721052255869*^9, 3.683721095335333*^9, 
   3.683721553777554*^9, 3.6837216494090242`*^9, 3.6837221614053087`*^9, {
   3.6837251405137033`*^9, 3.6837251783448677`*^9}, {3.6837273943506155`*^9, 
   3.683727394444621*^9}, 3.7154650581310964`*^9, 3.7154700685676775`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["gastric cancer", "Subsection",
 CellChangeTimes->{{3.6755292398715415`*^9, 3.675529243216546*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ModelNames", "\[LeftDoubleBracket]", "tumortype", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", "i"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
  RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.683729622784075*^9, 3.683729625952256*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tumortype", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndependentActionPrediction", "[", 
    RowBox[{
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"MonotherapiesByGroup", "\[LeftDoubleBracket]", 
      RowBox[{"tumortype", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "AllModelGroups", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
     "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
      "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "3", 
   "\[RightDoubleBracket]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PvalueForBestResponsesOfDrugPairToBeExplainedByAnimalToAnimalVariabi\
lity", "[", 
  RowBox[{"tumortype", ",", "i", ",", "j"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6622068984727592`*^9, 3.6622069598862715`*^9}, {
   3.6622069911810617`*^9, 3.6622070157964697`*^9}, {3.662207084668409*^9, 
   3.6622071035054865`*^9}, {3.662207714043407*^9, 3.662207718364654*^9}, {
   3.6678386895354156`*^9, 3.667838689891436*^9}, {3.6678390041884127`*^9, 
   3.6678390046054363`*^9}, 3.6836364544796343`*^9, {3.6836522260647078`*^9, 
   3.6836522260767083`*^9}, {3.683729519082144*^9, 3.6837295192251515`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binsize", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"height", "=", "0.4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Histogram", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ManyDrugABestsOfSimulatedAnimalPairs", ",", 
      "ManyDrugBBestsOfSimulatedAnimalPairs"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "binsize"}], "/", "2"}], ",", 
      RowBox[{"1", "+", 
       RowBox[{"binsize", "/", "2"}]}], ",", "binsize"}], "}"}], ",", 
    "\"\<Probability\>\"", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "binsize"}], "/", "2"}], ",", 
         RowBox[{"1", "+", 
          RowBox[{"binsize", "/", "2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
    RowBox[{"ChartStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], ",", "None"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"100", "*", "i"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.02", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "5"}]}], "}"}]}], "]"}], ",", "None"}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "[", "1.5", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0.1", ",", "0.6"}], "]"}], ",", "0.1"}], "]"}],
        ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugAresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0.2"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", "0"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "DrugBresponsesAsNumbers", "]"}], ",", 
            "height"}], "}"}]}], "}"}], "]"}], ",", "Black", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "BestOfDrugADrugBresponsesAsNumbers", "]"}], 
            ",", "height"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Response rate (%)\>\"", ",", "\"\<Probability (%)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"80", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "200", "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{
       "ModelNames", "\[LeftDoubleBracket]", "tumortype", 
        "\[RightDoubleBracket]"}], ",", "Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Bold"}], "]"}]}], ",", 
    RowBox[{"ChartLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Alpelisib\>\"", ",", "\"\<LLM871\>\""}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Supplementary Figure S6, Gastric cancer.pdf\>\""}], ",", "%", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.674510035198144*^9, 3.6745103323977814`*^9}, {
   3.6745103787350326`*^9, 3.6745103853090644`*^9}, {3.6745104769275494`*^9, 
   3.6745104921306396`*^9}, {3.6745105464379244`*^9, 
   3.6745108010052705`*^9}, {3.674510846210518*^9, 3.6745112749817915`*^9}, {
   3.674511332511103*^9, 3.674511383848365*^9}, {3.674511620143671*^9, 
   3.6745116202936716`*^9}, {3.6745116631809034`*^9, 
   3.6745116682019343`*^9}, {3.6745118064906764`*^9, 
   3.6745118073236775`*^9}, {3.674511979107601*^9, 3.674511979741604*^9}, {
   3.674514636508318*^9, 3.6745146372573414`*^9}, {3.674515298797448*^9, 
   3.6745152993794494`*^9}, {3.6745158856203575`*^9, 3.674515887276363*^9}, {
   3.675529334784784*^9, 3.6755293409347935`*^9}, 3.683652226082709*^9, 
   3.6837210530959167`*^9, 3.6837210983025026`*^9, 3.683721553792555*^9, 
   3.6837216527532153`*^9, 3.6837221614273095`*^9, {3.683728100736019*^9, 
   3.683728115877885*^9}, 3.715465058139097*^9, 3.7154700704637856`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Correlation between MEK and RAF inhibitors in BRAF-mutant melanoma\
\>", "Section",
 CellChangeTimes->{{3.67779348756658*^9, 3.677793498687216*^9}, {
  3.683479893267829*^9, 3.683479895001928*^9}}],

Cell[CellGroupData[{

Cell["\<\
which melanoma tumors are BRAF mutant, and have been tested under treatment \
with both RAF inhibition and MEK inhibition?\
\>", "Subsubsection",
 CellChangeTimes->{{3.6777993901531887`*^9, 3.677799401766853*^9}, {
  3.683555970801674*^9, 3.6835559901017113`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Melanoma", " ", "responses", " ", "to", " ", "RAF", " ", "inhibition", 
    " ", "by", " ", "encorafenib"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RAFresponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"CutaneousMelanomaModels", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
           "\"\<encorafenib\>\""}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Melanoma", " ", "responses", " ", "to", " ", "MEK", " ", "inhibition", 
     " ", "by", " ", "binimetinib"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"MEKresponses", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"PDXclinicaltrialresponses", ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"CutaneousMelanomaModels", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
           "\"\<binimetinib\>\""}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "PDX", " ", "models", " ", "were", " ", "tested", " ", 
     "with", " ", "both", " ", "RAF", " ", "and", " ", "MEK", " ", 
     RowBox[{"inhibition", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RAFMEKIntersection", "=", 
     RowBox[{"Intersection", "[", 
      RowBox[{
       RowBox[{"MEKresponses", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RAFresponses", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "importing", " ", "a", " ", "table", " ", "of", " ", "all", " ", "BRAF", 
     " ", "mutations", " ", "in", " ", "PDX", " ", 
     RowBox[{"models", ".", " ", "This"}], " ", "is", " ", "a", " ", "subset",
      " ", "of", " ", "the", " ", "mutation", " ", "data", " ", "in", " ", 
     "the", " ", "Supplementary", " ", "Materials", " ", "of", " ", "Gao", 
     " ", "et", " ", 
     RowBox[{"al", ".", " ", "Nature"}], " ", "Medicine"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BRAFmutations", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<BRAF mutations.csv\>\""}], ",", "\"\<CSV\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "identifying", " ", "PDX", " ", "models", " ", "that", " ", "were", " ", 
      "tested", " ", "with", " ", "both", " ", "RAF", " ", "and", " ", "MEK", 
      " ", "inhibition"}], ",", " ", 
     RowBox[{
     "and", " ", "which", " ", "contains", " ", "BRAF", " ", "V600", " ", 
      "mutations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Off", "[", 
    RowBox[{"StringTake", "::", "strse"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RAKMEKIntersectionWithBRAFV600mutations", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"BRAFmutations", "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"RAFMEKIntersection", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",",
              "4"}], "]"}], "\[Equal]", "\"\<V600\>\""}]}], "]"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"%", "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.677799620525365*^9, 3.677799637534338*^9}, {
  3.683479712454487*^9, 3.6834797492205896`*^9}, {3.6834797799873495`*^9, 
  3.683479780185361*^9}, {3.68347981514036*^9, 3.683479846333144*^9}, {
  3.6834800544960504`*^9, 3.683480071065998*^9}, {3.68348010169775*^9, 
  3.6834801018577595`*^9}, {3.683517910619255*^9, 3.6835179512355785`*^9}, {
  3.683555996488722*^9, 3.6835560026877346`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MEKresponsesinBRAFmutantPDXs", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"MEKresponses", ",", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{
        "RAKMEKIntersectionWithBRAFV600mutations", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "]"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RAFresponsesinBRAFmutantPDXs", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"RAFresponses", ",", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{
        "RAKMEKIntersectionWithBRAFV600mutations", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "]"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.6777998254770875`*^9, 3.6777999135181236`*^9}, {
  3.6778000735752783`*^9, 3.677800079011589*^9}, {3.6835178816195965`*^9, 
  3.683517900633684*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "correlation", " ", "between", " ", "RAF", " ", "and", " ", "MEK", " ", 
    "responses", " ", "in", " ", "BRAF", " ", "V600", " ", "mutant", " ", 
    "tumors"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SpearmanRho", "[", 
   RowBox[{
    RowBox[{"MEKresponsesinBRAFmutantPDXs", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"RAFresponsesinBRAFmutantPDXs", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "9"}], "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.677799921341571*^9, 3.677799960805828*^9}, {
   3.677800098140683*^9, 3.6778000988297224`*^9}, 3.683479803355686*^9, {
   3.6834798353035135`*^9, 3.6834798591338763`*^9}, {3.683479951699171*^9, 
   3.6834799581105375`*^9}, {3.683556017204759*^9, 3.683556018887762*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1902, 980},
WindowMargins->{{1, Automatic}, {Automatic, 1}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{1191., 1684.02},
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->36},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 120, 1, 70, "Section"],
Cell[681, 23, 1038, 18, 431, "Section"],
Cell[CellGroupData[{
Cell[1744, 45, 315, 8, 56, "Section"],
Cell[2062, 55, 143, 2, 30, "Input"],
Cell[2208, 59, 418, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[2651, 73, 336, 6, 67, "Subsubsection"],
Cell[2990, 81, 296, 6, 30, "Input"],
Cell[3289, 89, 449, 10, 30, "Input"],
Cell[3741, 101, 340, 8, 30, "Input"],
Cell[4084, 111, 346, 8, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4467, 124, 202, 4, 39, "Subsubsection"],
Cell[4672, 130, 485, 11, 30, "Input"],
Cell[5160, 143, 3102, 77, 240, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8299, 225, 433, 8, 63, "Subsubsection"],
Cell[8735, 235, 3596, 90, 297, "Input"],
Cell[12334, 327, 3703, 91, 221, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16086, 424, 231, 3, 70, "Section"],
Cell[16320, 429, 1864, 40, 316, "Input"],
Cell[18187, 471, 1756, 45, 69, "Input"],
Cell[19946, 518, 377, 7, 50, "Input"],
Cell[20326, 527, 1462, 32, 107, "Input"],
Cell[21791, 561, 1433, 34, 88, "Input"],
Cell[23227, 597, 1539, 36, 88, "Input"],
Cell[24769, 635, 1559, 34, 69, "Input"],
Cell[CellGroupData[{
Cell[26353, 673, 1272, 20, 431, "Subsubsection"],
Cell[27628, 695, 4899, 116, 88, "Input"],
Cell[32530, 813, 400, 9, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32967, 827, 197, 2, 49, "Subsection"],
Cell[33167, 831, 769, 19, 50, "Input"],
Cell[33939, 852, 1369, 33, 50, "Input"],
Cell[35311, 887, 331, 8, 30, "Input"],
Cell[35645, 897, 958, 20, 30, "Input"],
Cell[36606, 919, 1495, 42, 69, "Input"],
Cell[38104, 963, 826, 19, 107, "Input"],
Cell[38933, 984, 373, 10, 30, "Input"],
Cell[39309, 996, 1845, 36, 69, "Input"],
Cell[41157, 1034, 19532, 488, 316, "Input"],
Cell[60692, 1524, 11132, 271, 240, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71873, 1801, 250, 3, 70, "Section"],
Cell[72126, 1806, 5850, 143, 240, "Input"],
Cell[77979, 1951, 1822, 47, 107, "Input"],
Cell[79804, 2000, 2016, 53, 183, "Input"],
Cell[81823, 2055, 3256, 77, 240, "Input"],
Cell[85082, 2134, 8713, 207, 337, "Input"],
Cell[93798, 2343, 1578, 41, 145, "Input"],
Cell[95379, 2386, 1503, 39, 145, "Input"],
Cell[96885, 2427, 2069, 54, 126, "Input"],
Cell[CellGroupData[{
Cell[98979, 2485, 278, 3, 39, "Subsubsection"],
Cell[99260, 2490, 4123, 105, 145, "Input"],
Cell[103386, 2597, 2845, 70, 145, "Input"],
Cell[106234, 2669, 3126, 76, 145, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109397, 2750, 329, 6, 39, "Subsubsection"],
Cell[109729, 2758, 2752, 71, 164, "Input"],
Cell[112484, 2831, 2715, 71, 164, "Input"],
Cell[115202, 2904, 2710, 71, 164, "Input"],
Cell[117915, 2977, 2720, 71, 164, "Input"],
Cell[120638, 3050, 2719, 71, 164, "Input"],
Cell[123360, 3123, 2723, 71, 164, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126120, 3199, 237, 3, 39, "Subsubsection"],
Cell[126360, 3204, 6232, 165, 240, "Input"],
Cell[132595, 3371, 6199, 165, 240, "Input"],
Cell[138797, 3538, 6258, 166, 259, "Input"],
Cell[145058, 3706, 6282, 166, 240, "Input"],
Cell[151343, 3874, 6219, 166, 240, "Input"],
Cell[157565, 4042, 6271, 166, 240, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163873, 4213, 520, 9, 67, "Subsubsection"],
Cell[164396, 4224, 5744, 151, 259, "Input"],
Cell[170143, 4377, 3389, 83, 145, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173569, 4465, 237, 5, 39, "Subsubsection"],
Cell[173809, 4472, 6432, 169, 221, "Input"],
Cell[180244, 4643, 2377, 60, 126, "Input"]
}, Open  ]],
Cell[182636, 4706, 426, 8, 67, "Subsubsection"],
Cell[CellGroupData[{
Cell[183087, 4718, 226, 5, 61, "Subsubsection"],
Cell[183316, 4725, 1868, 41, 107, "Input"],
Cell[185187, 4768, 692, 18, 50, "Input"],
Cell[185882, 4788, 11151, 269, 354, "Input"],
Cell[197036, 5059, 890, 18, 69, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197963, 5082, 251, 5, 39, "Subsubsection"],
Cell[198217, 5089, 3092, 79, 126, "Input"],
Cell[201312, 5170, 820, 21, 50, "Input"],
Cell[202135, 5193, 11138, 269, 354, "Input"],
Cell[213276, 5464, 866, 18, 69, "Input"],
Cell[214145, 5484, 5871, 148, 202, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220053, 5637, 267, 5, 39, "Subsubsection"],
Cell[220323, 5644, 3215, 76, 145, "Input"],
Cell[223541, 5722, 3382, 81, 145, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226960, 5808, 324, 5, 39, "Subsubsection"],
Cell[227287, 5815, 6193, 158, 259, "Input"],
Cell[233483, 5975, 3313, 81, 164, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236833, 6061, 398, 10, 179, "Subsubsection"],
Cell[237234, 6073, 1940, 48, 145, "Input"],
Cell[239177, 6123, 2439, 64, 69, "Input"],
Cell[241619, 6189, 5250, 136, 164, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246906, 6330, 559, 9, 67, "Subsubsection"],
Cell[247468, 6341, 3043, 75, 437, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[250560, 6422, 451, 8, 99, "Section"],
Cell[251014, 6432, 1045, 29, 50, "Input"],
Cell[252062, 6463, 7857, 183, 468, "Input"],
Cell[259922, 6648, 2579, 57, 107, "Input"],
Cell[262504, 6707, 3780, 92, 145, "Input"],
Cell[266287, 6801, 7179, 181, 221, "Input"],
Cell[CellGroupData[{
Cell[273491, 6986, 476, 8, 67, "Subsubsection"],
Cell[273970, 6996, 335, 7, 30, "Input"],
Cell[274308, 7005, 1689, 38, 107, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276034, 7048, 130, 1, 39, "Subsubsection"],
Cell[276167, 7051, 1524, 36, 88, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[277740, 7093, 237, 5, 70, "Section"],
Cell[277980, 7100, 2235, 55, 69, "Input"],
Cell[280218, 7157, 217, 3, 30, "Input"],
Cell[280438, 7162, 1262, 32, 30, "Input"],
Cell[281703, 7196, 2933, 69, 183, "Input"],
Cell[284639, 7267, 3351, 77, 202, "Input"],
Cell[287993, 7346, 3434, 76, 145, "Input"],
Cell[291430, 7424, 8084, 186, 373, "Input"],
Cell[299517, 7612, 4625, 123, 221, "Input"],
Cell[304145, 7737, 2444, 65, 164, "Input"],
Cell[306592, 7804, 2459, 64, 164, "Input"],
Cell[309054, 7870, 2454, 64, 145, "Input"],
Cell[311511, 7936, 2464, 65, 145, "Input"],
Cell[313978, 8003, 2465, 65, 145, "Input"],
Cell[316446, 8070, 259, 5, 50, "Input"],
Cell[316708, 8077, 6920, 177, 202, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323665, 8259, 593, 11, 215, "Section"],
Cell[324261, 8272, 2077, 49, 88, "Input"],
Cell[326341, 8323, 1633, 41, 69, "Input"],
Cell[327977, 8366, 1851, 44, 145, "Input"],
Cell[329831, 8412, 681, 16, 50, "Input"],
Cell[330515, 8430, 1779, 44, 69, "Input"],
Cell[332297, 8476, 1277, 30, 50, "Input"],
Cell[333577, 8508, 2836, 68, 221, "Input"],
Cell[CellGroupData[{
Cell[336438, 8580, 361, 6, 39, "Subsubsection"],
Cell[336802, 8588, 988, 25, 50, "Input"],
Cell[337793, 8615, 975, 24, 50, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[338817, 8645, 287, 5, 70, "Section"],
Cell[339107, 8652, 831, 22, 50, "Input"],
Cell[339941, 8676, 5019, 114, 183, "Input"],
Cell[344963, 8792, 4719, 111, 354, "Input"],
Cell[349685, 8905, 2569, 59, 126, "Input"],
Cell[352257, 8966, 6409, 145, 297, "Input"],
Cell[358669, 9113, 1808, 45, 107, "Input"],
Cell[CellGroupData[{
Cell[360502, 9162, 199, 4, 39, "Subsubsection"],
Cell[360704, 9168, 228, 4, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[360969, 9177, 531, 8, 67, "Subsubsection"],
Cell[361503, 9187, 396, 8, 30, "Input"],
Cell[361902, 9197, 965, 25, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362904, 9227, 331, 6, 67, "Subsubsection"],
Cell[363238, 9235, 1561, 36, 50, "Input"],
Cell[364802, 9273, 13840, 353, 354, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[378679, 9631, 181, 3, 39, "Subsubsection"],
Cell[378863, 9636, 1585, 37, 164, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[380485, 9678, 387, 5, 39, "Subsubsection"],
Cell[380875, 9685, 13588, 349, 335, "Input"],
Cell[394466, 10036, 5436, 137, 278, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[399939, 10178, 1926, 32, 291, "Subsubsection"],
Cell[401868, 10212, 2697, 71, 126, "Input"],
Cell[404568, 10285, 2595, 58, 240, "Input"],
Cell[407166, 10345, 1820, 45, 126, "Input"],
Cell[408989, 10392, 2220, 54, 145, "Input"],
Cell[411212, 10448, 1742, 42, 88, "Input"],
Cell[412957, 10492, 17332, 455, 468, "Input"],
Cell[430292, 10949, 548, 12, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[430877, 10966, 414, 7, 67, "Subsubsection"],
Cell[431294, 10975, 706, 16, 50, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[432049, 10997, 260, 5, 70, "Section"],
Cell[432312, 11004, 820, 17, 50, "Input"],
Cell[CellGroupData[{
Cell[433157, 11025, 232, 5, 49, "Subsection"],
Cell[433392, 11032, 259, 4, 50, "Input"],
Cell[433654, 11038, 2383, 60, 278, "Input"],
Cell[436040, 11100, 596, 11, 30, "Input"],
Cell[436639, 11113, 2187, 54, 221, "Input"],
Cell[438829, 11169, 1130, 23, 50, "Input"],
Cell[439962, 11194, 333, 7, 30, "Input"],
Cell[440298, 11203, 7015, 168, 259, "Input"],
Cell[CellGroupData[{
Cell[447338, 11375, 248, 3, 39, "Subsubsection"],
Cell[447589, 11380, 573, 13, 50, "Input"],
Cell[448165, 11395, 2341, 56, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[450543, 11456, 237, 3, 39, "Subsubsection"],
Cell[450783, 11461, 768, 16, 50, "Input"],
Cell[451554, 11479, 2759, 63, 126, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[454362, 11548, 635, 11, 121, "Subsection"],
Cell[455000, 11561, 317, 5, 50, "Input"],
Cell[455320, 11568, 2383, 60, 278, "Input"],
Cell[457706, 11630, 596, 11, 30, "Input"],
Cell[458305, 11643, 2187, 54, 221, "Input"],
Cell[460495, 11699, 632, 14, 30, "Input"],
Cell[461130, 11715, 333, 7, 30, "Input"],
Cell[461466, 11724, 6716, 164, 259, "Input"],
Cell[CellGroupData[{
Cell[468207, 11892, 218, 2, 39, "Subsubsection"],
Cell[468428, 11896, 573, 13, 50, "Input"],
Cell[469004, 11911, 2342, 56, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[471383, 11972, 263, 3, 39, "Subsubsection"],
Cell[471649, 11977, 768, 16, 50, "Input"],
Cell[472420, 11995, 2759, 63, 126, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[475228, 12064, 353, 5, 43, "Subsection"],
Cell[475584, 12071, 4724, 115, 259, "Input"],
Cell[480311, 12188, 2509, 61, 221, "Input"],
Cell[482823, 12251, 509, 12, 30, "Input"],
Cell[483335, 12265, 333, 7, 30, "Input"],
Cell[483671, 12274, 6739, 163, 259, "Input"],
Cell[CellGroupData[{
Cell[490435, 12441, 218, 2, 39, "Subsubsection"],
Cell[490656, 12445, 573, 13, 50, "Input"],
Cell[491232, 12460, 2342, 56, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493611, 12521, 263, 3, 39, "Subsubsection"],
Cell[493877, 12526, 768, 16, 50, "Input"],
Cell[494648, 12544, 2759, 63, 126, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[497456, 12613, 283, 6, 49, "Subsection"],
Cell[497742, 12621, 208, 3, 50, "Input"],
Cell[497953, 12626, 2383, 60, 278, "Input"],
Cell[500339, 12688, 596, 11, 30, "Input"],
Cell[500938, 12701, 2187, 54, 221, "Input"],
Cell[503128, 12757, 632, 14, 30, "Input"],
Cell[503763, 12773, 333, 7, 30, "Input"],
Cell[504099, 12782, 6737, 164, 259, "Input"],
Cell[CellGroupData[{
Cell[510861, 12950, 214, 2, 39, "Subsubsection"],
Cell[511078, 12954, 573, 13, 50, "Input"],
Cell[511654, 12969, 2342, 56, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[514033, 13030, 278, 3, 39, "Subsubsection"],
Cell[514314, 13035, 768, 16, 50, "Input"],
Cell[515085, 13053, 2759, 63, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[517881, 13121, 283, 3, 39, "Subsubsection"],
Cell[518167, 13126, 821, 17, 50, "Input"],
Cell[518991, 13145, 2810, 64, 126, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[521850, 13215, 282, 5, 49, "Subsection"],
Cell[522135, 13222, 259, 4, 50, "Input"],
Cell[522397, 13228, 2383, 60, 278, "Input"],
Cell[524783, 13290, 596, 11, 30, "Input"],
Cell[525382, 13303, 2187, 54, 221, "Input"],
Cell[527572, 13359, 632, 14, 30, "Input"],
Cell[528207, 13375, 333, 7, 30, "Input"],
Cell[528543, 13384, 6684, 163, 259, "Input"],
Cell[CellGroupData[{
Cell[535252, 13551, 217, 2, 39, "Subsubsection"],
Cell[535472, 13555, 573, 13, 50, "Input"],
Cell[536048, 13570, 2342, 56, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[538427, 13631, 279, 3, 39, "Subsubsection"],
Cell[538709, 13636, 821, 17, 50, "Input"],
Cell[539533, 13655, 2810, 64, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[542380, 13724, 285, 3, 39, "Subsubsection"],
Cell[542668, 13729, 874, 18, 50, "Input"],
Cell[543545, 13749, 2859, 65, 126, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[546453, 13820, 634, 11, 73, "Subsection"],
Cell[547090, 13833, 310, 5, 50, "Input"],
Cell[547403, 13840, 2412, 60, 278, "Input"],
Cell[549818, 13902, 596, 11, 30, "Input"],
Cell[550417, 13915, 2187, 54, 221, "Input"],
Cell[552607, 13971, 688, 17, 69, "Input"],
Cell[553298, 13990, 632, 14, 30, "Input"],
Cell[553933, 14006, 333, 7, 30, "Input"],
Cell[554269, 14015, 6819, 165, 259, "Input"],
Cell[CellGroupData[{
Cell[561113, 14184, 216, 2, 39, "Subsubsection"],
Cell[561332, 14188, 573, 13, 50, "Input"],
Cell[561908, 14203, 2342, 56, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[564287, 14264, 282, 3, 39, "Subsubsection"],
Cell[564572, 14269, 722, 16, 50, "Input"],
Cell[565297, 14287, 2709, 63, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[568043, 14355, 285, 3, 39, "Subsubsection"],
Cell[568331, 14360, 871, 18, 50, "Input"],
Cell[569205, 14380, 2859, 65, 126, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[572113, 14451, 343, 4, 49, "Subsection"],
Cell[572459, 14457, 358, 5, 50, "Input"],
Cell[572820, 14464, 2446, 61, 278, "Input"],
Cell[575269, 14527, 596, 11, 30, "Input"],
Cell[575868, 14540, 2187, 54, 221, "Input"],
Cell[578058, 14596, 632, 14, 30, "Input"],
Cell[578693, 14612, 333, 7, 30, "Input"],
Cell[579029, 14621, 6893, 166, 278, "Input"],
Cell[CellGroupData[{
Cell[585947, 14791, 218, 2, 39, "Subsubsection"],
Cell[586168, 14795, 573, 13, 50, "Input"],
Cell[586744, 14810, 2342, 56, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[589123, 14871, 282, 3, 39, "Subsubsection"],
Cell[589408, 14876, 722, 16, 50, "Input"],
Cell[590133, 14894, 2709, 63, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[592879, 14962, 261, 3, 39, "Subsubsection"],
Cell[593143, 14967, 871, 18, 50, "Input"],
Cell[594017, 14987, 2859, 65, 126, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[596937, 15059, 540, 10, 95, "Section"],
Cell[597480, 15071, 4034, 110, 145, "Input"],
Cell[601517, 15183, 2484, 59, 164, "Input"],
Cell[604004, 15244, 3560, 77, 164, "Input"],
Cell[607567, 15323, 3436, 76, 164, "Input"],
Cell[611006, 15401, 3401, 76, 164, "Input"],
Cell[614410, 15479, 3351, 75, 164, "Input"],
Cell[617764, 15556, 3425, 76, 164, "Input"],
Cell[621192, 15634, 3437, 76, 164, "Input"],
Cell[CellGroupData[{
Cell[624654, 15714, 1017, 16, 123, "Subsubsection"],
Cell[625674, 15732, 8105, 205, 241, "Input"],
Cell[633782, 15939, 3291, 86, 145, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[637122, 16031, 295, 6, 70, "Section"],
Cell[637420, 16039, 32978, 712, 1874, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[670435, 16756, 301, 6, 70, "Section"],
Cell[670739, 16764, 2993, 72, 278, "Input"],
Cell[CellGroupData[{
Cell[673757, 16840, 121, 1, 39, "Subsubsection"],
Cell[673881, 16843, 1379, 35, 88, "Input"],
Cell[675263, 16880, 1417, 34, 69, "Input"],
Cell[676683, 16916, 6421, 167, 145, "Input"],
Cell[683107, 17085, 6591, 168, 259, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[689747, 17259, 265, 6, 99, "Section"],
Cell[CellGroupData[{
Cell[690037, 17269, 194, 2, 49, "Subsection"],
Cell[690234, 17273, 1577, 36, 69, "Input"],
Cell[691814, 17311, 3644, 86, 164, "Input"],
Cell[CellGroupData[{
Cell[695483, 17401, 776, 12, 67, "Subsubsection"],
Cell[696262, 17415, 2528, 56, 164, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[698839, 17477, 244, 3, 49, "Subsection"],
Cell[699086, 17482, 1618, 38, 88, "Input"],
Cell[700707, 17522, 3662, 87, 164, "Input"],
Cell[CellGroupData[{
Cell[704394, 17613, 788, 12, 67, "Subsubsection"],
Cell[705185, 17627, 2361, 54, 164, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[707595, 17687, 241, 3, 49, "Subsection"],
Cell[707839, 17692, 1702, 39, 88, "Input"],
Cell[709544, 17733, 3653, 87, 164, "Input"],
Cell[CellGroupData[{
Cell[713222, 17824, 332, 4, 39, "Subsubsection"],
Cell[713557, 17830, 2547, 57, 164, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[716153, 17893, 267, 5, 49, "Subsection"],
Cell[716423, 17900, 1736, 39, 88, "Input"],
Cell[718162, 17941, 3693, 88, 164, "Input"],
Cell[CellGroupData[{
Cell[721880, 18033, 380, 5, 39, "Subsubsection"],
Cell[722263, 18040, 2529, 58, 164, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[724841, 18104, 252, 4, 49, "Subsection"],
Cell[725096, 18110, 1785, 40, 88, "Input"],
Cell[726884, 18152, 3745, 88, 164, "Input"],
Cell[730632, 18242, 2274, 54, 164, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[732943, 18301, 261, 5, 49, "Subsection"],
Cell[733207, 18308, 1790, 40, 88, "Input"],
Cell[735000, 18350, 3750, 88, 164, "Input"],
Cell[738753, 18440, 2493, 56, 183, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[741295, 18502, 193, 2, 70, "Section"],
Cell[741491, 18506, 5249, 135, 297, "Input"],
Cell[746743, 18643, 5290, 131, 194, "Input"],
Cell[752036, 18776, 9310, 226, 340, "Input"],
Cell[761349, 19004, 5762, 145, 145, "Input"],
Cell[767114, 19151, 4548, 107, 126, "Input"],
Cell[CellGroupData[{
Cell[771687, 19262, 431, 8, 67, "Subsubsection"],
Cell[772121, 19272, 4445, 116, 259, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[776615, 19394, 179, 2, 70, "Section"],
Cell[776797, 19398, 712, 13, 30, "Input"],
Cell[CellGroupData[{
Cell[777534, 19415, 94, 1, 49, "Subsection"],
Cell[777631, 19418, 10432, 261, 394, "Input"],
Cell[788066, 19681, 10573, 271, 335, "Input"],
Cell[798642, 19954, 449, 9, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[799128, 19968, 98, 1, 49, "Subsection"],
Cell[799229, 19971, 9971, 249, 335, "Input"],
Cell[809203, 20222, 10627, 271, 335, "Input"],
Cell[819833, 20495, 519, 10, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[820389, 20510, 105, 1, 49, "Subsection"],
Cell[820497, 20513, 9766, 246, 335, "Input"],
Cell[830266, 20761, 10468, 269, 335, "Input"],
Cell[840737, 21032, 519, 10, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[841293, 21047, 97, 1, 49, "Subsection"],
Cell[841393, 21050, 10273, 259, 392, "Input"],
Cell[851669, 21311, 10558, 271, 335, "Input"],
Cell[862230, 21584, 519, 10, 50, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[862798, 21600, 232, 5, 70, "Section"],
Cell[863033, 21607, 616, 13, 50, "Input"],
Cell[863652, 21622, 1898, 41, 145, "Input"],
Cell[865553, 21665, 1937, 42, 145, "Input"],
Cell[867493, 21709, 1892, 41, 145, "Input"],
Cell[869388, 21752, 1945, 41, 145, "Input"],
Cell[871336, 21795, 1968, 42, 145, "Input"],
Cell[873307, 21839, 1970, 42, 145, "Input"],
Cell[875280, 21883, 1998, 42, 145, "Input"],
Cell[877281, 21927, 2047, 42, 145, "Input"],
Cell[879331, 21971, 2070, 43, 145, "Input"],
Cell[881404, 22016, 2070, 43, 145, "Input"],
Cell[883477, 22061, 2116, 44, 145, "Input"],
Cell[885596, 22107, 2088, 43, 145, "Input"],
Cell[887687, 22152, 2119, 44, 145, "Input"],
Cell[889809, 22198, 2179, 45, 145, "Input"],
Cell[891991, 22245, 2307, 47, 145, "Input"],
Cell[894301, 22294, 2279, 46, 145, "Input"],
Cell[896583, 22342, 2299, 46, 145, "Input"],
Cell[898885, 22390, 2291, 46, 145, "Input"],
Cell[901179, 22438, 2318, 47, 145, "Input"],
Cell[903500, 22487, 2326, 47, 145, "Input"],
Cell[905829, 22536, 2392, 47, 145, "Input"],
Cell[908224, 22585, 2394, 47, 145, "Input"],
Cell[CellGroupData[{
Cell[910643, 22636, 112, 1, 39, "Subsubsection"],
Cell[910758, 22639, 231, 3, 50, "Input"],
Cell[910992, 22644, 3738, 105, 88, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[914779, 22755, 117, 1, 70, "Section"],
Cell[914899, 22758, 797, 14, 164, "Input"],
Cell[915699, 22774, 174, 3, 50, "Input"],
Cell[915876, 22779, 901, 20, 50, "Input"],
Cell[CellGroupData[{
Cell[916802, 22803, 273, 5, 39, "Subsubsection"],
Cell[917078, 22810, 804, 20, 69, "Input"],
Cell[917885, 22832, 500, 10, 30, "Input"],
Cell[918388, 22844, 801, 19, 69, "Input"],
Cell[919192, 22865, 530, 11, 30, "Input"],
Cell[919725, 22878, 1103, 26, 69, "Input"],
Cell[920831, 22906, 585, 11, 30, "Input"],
Cell[921419, 22919, 947, 22, 69, "Input"],
Cell[922369, 22943, 471, 10, 30, "Input"],
Cell[922843, 22955, 958, 21, 69, "Input"],
Cell[923804, 22978, 508, 11, 30, "Input"],
Cell[924315, 22991, 887, 19, 69, "Input"],
Cell[925205, 23012, 633, 12, 145, "Input"],
Cell[925841, 23026, 402, 7, 69, "Input"],
Cell[926246, 23035, 1209, 27, 69, "Input"],
Cell[927458, 23064, 6285, 159, 223, "Input"],
Cell[933746, 23225, 846, 20, 88, "Input"],
Cell[934595, 23247, 773, 18, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[935405, 23270, 218, 4, 39, "Subsubsection"],
Cell[935626, 23276, 22790, 626, 563, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[958453, 23907, 286, 5, 39, "Subsubsection"],
Cell[958742, 23914, 495, 12, 50, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[959286, 23932, 325, 6, 70, "Section"],
Cell[CellGroupData[{
Cell[959636, 23942, 196, 3, 49, "Subsection"],
Cell[959835, 23947, 4532, 100, 259, "Input"],
Cell[964370, 24049, 1053, 25, 69, "Input"],
Cell[965426, 24076, 3782, 87, 145, "Input"],
Cell[969211, 24165, 2650, 61, 88, "Input"],
Cell[971864, 24228, 5598, 129, 316, "Input"],
Cell[977465, 24359, 1172, 25, 107, "Input"],
Cell[978640, 24386, 4407, 107, 183, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[983084, 24498, 296, 4, 49, "Subsection"],
Cell[983383, 24504, 4581, 100, 259, "Input"],
Cell[987967, 24606, 1099, 25, 69, "Input"],
Cell[989069, 24633, 3823, 87, 145, "Input"],
Cell[992895, 24722, 2692, 62, 88, "Input"],
Cell[995590, 24786, 5642, 130, 316, "Input"],
Cell[1001235, 24918, 1219, 26, 107, "Input"],
Cell[1002457, 24946, 4449, 108, 183, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1006943, 25059, 349, 5, 49, "Subsection"],
Cell[1007295, 25066, 4569, 100, 259, "Input"],
Cell[1011867, 25168, 1092, 24, 69, "Input"],
Cell[1012962, 25194, 3810, 87, 145, "Input"],
Cell[1016775, 25283, 2693, 62, 88, "Input"],
Cell[1019471, 25347, 5632, 130, 316, "Input"],
Cell[1025106, 25479, 1217, 26, 107, "Input"],
Cell[1026326, 25507, 4440, 108, 183, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1030803, 25620, 400, 5, 49, "Subsection"],
Cell[1031206, 25627, 4615, 101, 259, "Input"],
Cell[1035824, 25730, 1148, 25, 69, "Input"],
Cell[1036975, 25757, 3862, 88, 145, "Input"],
Cell[1040840, 25847, 2743, 62, 88, "Input"],
Cell[1043586, 25911, 5682, 131, 316, "Input"],
Cell[1049271, 26044, 1270, 27, 107, "Input"],
Cell[1050544, 26073, 4491, 109, 183, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1055072, 26187, 731, 13, 97, "Subsection"],
Cell[1055806, 26202, 2505, 59, 145, "Input"],
Cell[1058314, 26263, 2571, 60, 145, "Input"],
Cell[1060888, 26325, 1184, 26, 69, "Input"],
Cell[1062075, 26353, 370, 5, 88, "Input"],
Cell[1062448, 26360, 319, 4, 88, "Input"],
Cell[1062770, 26366, 9144, 205, 373, "Input"],
Cell[1071917, 26573, 7806, 181, 354, "Input"],
Cell[1079726, 26756, 826, 20, 69, "Input"],
Cell[CellGroupData[{
Cell[1080577, 26780, 331, 6, 39, "Subsubsection"],
Cell[1080911, 26788, 2964, 71, 126, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1083912, 26864, 309, 5, 39, "Subsubsection"],
Cell[1084224, 26871, 2979, 71, 126, "Input"],
Cell[1087206, 26944, 828, 21, 30, "Input"],
Cell[1088037, 26967, 1186, 28, 69, "Input"],
Cell[1089226, 26997, 7695, 191, 297, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1096982, 27195, 498, 8, 111, "Section"],
Cell[CellGroupData[{
Cell[1097505, 27207, 1519, 22, 235, "Subsubsection"],
Cell[1099027, 27231, 2697, 71, 126, "Input"],
Cell[1101727, 27304, 10335, 236, 772, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1112099, 27545, 1068, 17, 179, "Subsubsection"],
Cell[1113170, 27564, 9359, 201, 430, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1122566, 27770, 91, 1, 49, "Subsection"],
Cell[1122660, 27773, 1122, 24, 145, "Input"],
Cell[1123785, 27799, 1533, 31, 145, "Input"],
Cell[1125321, 27832, 7295, 190, 221, "Input"],
Cell[1132619, 28024, 7563, 166, 449, "Input"],
Cell[1140185, 28192, 251, 4, 30, "Input"],
Cell[1140439, 28198, 7074, 190, 278, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1147550, 28393, 104, 1, 49, "Subsection"],
Cell[1147657, 28396, 1173, 25, 145, "Input"],
Cell[1148833, 28423, 1521, 30, 126, "Input"],
Cell[1150357, 28455, 7274, 190, 221, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1157668, 28650, 154, 2, 49, "Subsection"],
Cell[1157825, 28654, 740, 15, 126, "Input"],
Cell[1158568, 28671, 1427, 29, 126, "Input"],
Cell[1159998, 28702, 7305, 190, 221, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1167340, 28897, 104, 1, 49, "Subsection"],
Cell[1167447, 28900, 685, 14, 126, "Input"],
Cell[1168135, 28916, 1523, 30, 126, "Input"],
Cell[1169661, 28948, 7294, 190, 221, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1177004, 29144, 207, 4, 70, "Section"],
Cell[CellGroupData[{
Cell[1177236, 29152, 274, 5, 39, "Subsubsection"],
Cell[1177513, 29159, 4724, 115, 259, "Input"],
Cell[1182240, 29276, 1199, 28, 69, "Input"],
Cell[1183442, 29306, 879, 16, 50, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

